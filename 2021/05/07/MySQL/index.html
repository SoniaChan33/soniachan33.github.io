<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>MySQL | Sonia33's Blog</title><meta name="keywords" content="DataBase,MySQL"><meta name="author" content="Sonia33"><meta name="copyright" content="Sonia33"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="MySQL"><meta name="application-name" content="MySQL"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="MySQL"><meta property="og:url" content="https://soniachen.com/2021/05/07/MySQL/index.html"><meta property="og:site_name" content="Sonia33's Blog"><meta property="og:description" content="引入1.数据库基本概念1.1 数据所谓数据（Data）是指对客观事物进行描述并可以鉴别的符号，这些符号是可识别的、抽象的。它不仅仅指狭义上的数字，而是有多种表现形式：字母、文字、文本、图形、音频、视频等。现在计算机存储和处理的数据范围十分广泛，而描述这些数据的符号也变得越来越复杂了。 1.2 数据库"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta property="article:author" content="Sonia33"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta name="description" content="引入1.数据库基本概念1.1 数据所谓数据（Data）是指对客观事物进行描述并可以鉴别的符号，这些符号是可识别的、抽象的。它不仅仅指狭义上的数字，而是有多种表现形式：字母、文字、文本、图形、音频、视频等。现在计算机存储和处理的数据范围十分广泛，而描述这些数据的符号也变得越来越复杂了。 1.2 数据库"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://soniachen.com/2021/05/07/MySQL/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Sonia33","link":"链接: ","source":"来源: Sonia33's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Sonia33's Blog',
  title: 'MySQL',
  postAI: '',
  pageFillDescription: '引入, 1.数据库基本概念, 1.1 数据, 1.2 数据库, 1.3 数据库管理系统, 1.4数据库应用程序, 1.5 数据库管理员, 1.6 最终用户, 1.7 数据库系统, 2. 数据库表列类型, 2.1 整数类型, 表的完整性约束, 1. 非外键约束, 实例一：建立一张用来存储学生信息的表, - 列级约束和表级约束, 实例二, - 创建表之后添加约束, 实例三, 2. 外键约束, 实例四, 外键策略：, 策略一：no action 不允许操作, 策略二：使用cascade级联操作, 策略三：set null     置空操作, DQL查询操作*, 1. 常见表的准备, 部门表(dept), 员工表（emp), 薪资登记表(salgrade), 奖金表(bonus), 操作, 结果(表格形式), 2.  单表查询, 2.1 简单的SQL查询, 2.2 where子句, 2.3 函数, - 单行函数, 1. 字符串函数, 2. 数值函数, 3. 日期与时间函数, 4. 流程函数, 5. JSON函数, 6. 其他函数, - 多行函数, 2.4 分组与筛选, group by 分组, having 分组后筛选, 总结, [1] select语句总结, [2] select语句的执行顺序, [3] 单表查询练习, 3.  多表查询, 3.1  交叉连接 cross join, 3.2  自然连接 natural, 3.3 内连接 inner join, 3.4 外连接  outer  join, 左外连接, 右外连接, 全外连接, 并集 union, union all, 3.5 三表查询, 3.6 自连接查询, 补充：92语法的多表查询, 4. 不相关子查询, 引入, 4.1  单行子查询, 4.2  多行子查询, 实例一, 实例二, 实例三, 5. 相关子查询, 引入, 实例, 数据库对象, 1. 事务, 概念, 特性, 实例：使用事务保证转账安全, 事务并发问题, 脏读（Dirty read）, 不可重复读 （Unrepeatableread）, 幻读 （Phantom read）, 事务隔离级别, 实例, 2. 视图, 概念, 优点, 实例一：单表视图, 实例二：多表视图, 实例三：统计视图, 实例四：基于视图的视图, 3. 存储过程, 概念, 优点, 实例引入数据库基本概念数据所谓数据是指对客观事物进行描述并可以鉴别的符号这些符号是可识别的抽象的它不仅仅指狭义上的数字而是有多种表现形式字母文字文本图形音频视频等现在计算机存储和处理的数据范围十分广泛而描述这些数据的符号也变得越来越复杂了数据库数据库指的是以一定格式存放能够实现多个用户共享与应用程序彼此独立的数据集合数据库管理系统数据库管理系统是用来定义和管理数据的软件如何科学的组织和存储数据如何高效的获取和维护数据如何保证数据的安全性和完整性这些都需要靠数据库管理系统完成目前比较流行的数据库管理系统有等数据库应用程序数据库应用程序是在数据库管理系统基础上使用数据库管理系统的语法开发的直接面对最终用户的应用程序如学生管理系统人事管理系统图书管理系统等数据库管理员数据库管理员是指对数据库管理系统进行操作的人员其主要负责数据库的运营和维护最终用户最终用户指的是数据库应用程序的使用者用户面向的是数据库应用程序通过应用程序操作数据并不会直接与数据库打交道数据库系统数据库系统一般是由数据库数据库管理系统数据库应用程序数据库管理员和最终用户构成其中是数据库系统的基础和核心数据库表列类型整数类型支持选择在该类型关键字后面的括号内指定整数值的显示宽度例如显示宽度并不限制可以在列内保存的值的范围也不限制超过列的指定宽度的值的显示主键自增不使用序列通过要求是整数类型支持选择在该类型关键字后面的括号内指定整数值的显示宽度表的完整性约束非外键约束约束条件约束描述主键约束约束字段的值可唯一地标识对应的记录非空约束约束字段的值不能为空唯一约束约束字段的值是唯一的检查约束限制某个字段的取值范围默认值约束约束字段的默认值自动增加约束约束字段的值自动递增外键约束约束表与表之间的关系实例一建立一张用来存储学生信息的表建立一张用来存储学生信息的表字段包含学号姓名性别年龄入学日期班级等信息约束建立一张用来存储学生信息的表字段包含学号姓名性别年龄入学日期班级等信息学号是主键不能为空唯一主键的作用可以通过主键查到唯一的一条记录如果主键是整数类型那么需要自增姓名不能为空唯一性别默认值是男性别只能是男女年龄只能在之间创建数据库表主键自增男男女唯一查看数据添加数据添加数据不能为违反检查约束张三男班主键重复违反唯一约束李四男班露露男班如果主键没有设定值或者用都可以完成主键自增的效果菲菲小明男班小刚男班如果报错可能主键就浪费了后续插入的主键是不连号的我们主键也不要求连号的小明男班常见错误不能为违反检查约束重复的主键重复违反唯一约束使用自增的时候用和都是可以如果报错可能主键就浪费了后续插入的主键是不连号的主键也不要求连号的列级约束和表级约束表级约束可以约束表中任意一个或多个字段与列定义相互独立不包含在列定义中与定义用分隔必须指出要约束的列的名称列级约束包含在列定义中直接跟在该列的其它定义之后用空格分隔不必指定列名实例二删除表创建数据库表男表级约束主键约束的名字男女添加数据张三男班李四男班查看数据创建表之后添加约束实例三删除表创建数据库表男错误的解决办法就是去掉在创建表以后添加约束主键约束修改自增条件男女查看表结构验证约束添加成功外键约束外键约束缩写是用来实现数据库表的参照完整性的外键约束可以使两张表紧密的结合起来特别是针对修改或者删除的级联操作时会保证数据的完整性外键是指表中某个字段的值依赖于另一张表中某个字段的值而被依赖的字段必须具有主键约束或者唯一约束被依赖的表我们通常称之为父表或者主表设置外键约束的表称为子表或者从表只有表级约束没有列级约束实例四主表父表班级表班级编号主键从表子表学生表班级编号外键创建父表班级表主键自增不为空先删除表先删除从表再删除父表先创建父表班级表创建从表学生表主键自增不为空取值参考表中的字段不要求字段名字完全重复但是类型长度定义尽量要求相同添加外键约束添加学生表添加外键约束取值参考表中的字段不要求字段名字完全重复但是类型长度定义尽量要求相同外键约束删除外键约束删除外键约束添加数据可以一次性添加多条记录可以一次性添加多条记录大数据张三李四王五朱六查询班级表查看班级表和学生表添加外键的效果删除班级会出错尝试删除班级外键策略直接删除班级会错误有时候必须删可以加入外键策略策略一不允许操作策略不允许操作通过操作来完成先把班级的学生对应的班级改为然后再删除班级结果策略二使用级联操作操作主表的时候影响从表的外键先删除外键约束策略级联操作操作主表的时候影响从表的外键信息重新添加外键约束增加一个级联操作重新添加外键约束试着更新和删除操作试试更新试试删除结果策略三置空操作先删除之前的外键约束先删除之前的外键约束重新添加外键约束重新添加外键约束试着更新操作更新结果注策略级联操作和策略的删除操作可以混着使用应用场合朋友圈删除点赞留言都删除级联操作解散班级对应的学生置为班级为就可以了查询操作常见表的准备部门表员工表薪资登记表奖金表操作查看表部门表部分位置员工表员工上级领导编号入职日期解雇日期补助外键参考字段外键参考自身表产生了自关联结果表格形式单表查询简单的查询对表查询代表所有数据显示部分列显示部分行子句显示部分列部分行起别名员工编号姓名工资省略或者省略了别名员工编号姓名工资员工编号姓名工资编号姓名工资错误原因在别名中有特殊符号的时候或者不可以省略不写员工编号姓名工资算术运算符涨薪后后面再说去重操作对后面的所有列组合去重而不是单独的某一列去重排序默认情况下是按照升序排列的升序可以默认不写降序在工资升序的情况下按照降序排列子句将过滤条件放在子句的后面可以筛选过滤出我们想要的符合条件的数据加关系运算符子句关系运算符默认情况下不区分大小写区分大小写加逻辑运算符子句逻辑运算符子句逻辑运算符加模糊查询子句模糊查询查询名字中带的员工代表任意多个字符任意一个字符关于的判断关于的判断小括号的使用因为不同运算符的优先级别不同加括号为了可读性小括号的使用因为不同的运算符的优先级别不同加括号为了可读性先再函数除了多行函数都是单行函数单行函数字符串函数函数描述将拼接成一个新的字符串将字符串从第位置开始的个字符替换成字符串获取字符串的长度将字符串中的每个字符转换为小写将字符串中的每个字符转换为大写获取字符串最左边的个字符获取字符串最右边的个字符使用字符串在的最左边进行填充直到长度为个字符为止使用字符串在的最右边进行填充直到长度为个字符为止去除字符串左侧的空格去除字符串右侧的空格去除字符串左右两侧的空格用字符串替换字符串中所有的子字符串将字符串中的字符逆序比较字符串和的大小获取从字符串的位置开始的个字符字符串函数字符串截取从字符下标为开始截取长度下标从开始显示结果数值函数函数描述返回的绝对值返回大于的最小整数向上取整返回小于的最大整数向下取整返回的余数取模返回圆周率的值返回的次方返回之间的随机数返回四舍五入后的值该值保留到小数点后位返回被舍去至小数点后位的值数值函数实际就是一个伪表绝对值向上取整向下取整四舍五入如果没有条件的话可以省略不写显示结果日期与时间函数函数描述返回当前日期返回当前时间返回当前日期和时间返回该函数执行时的日期和时间返回日期为一年中的第几天返回日期为一年中的第几周返回按字符串格式化后的日期返回加上一个时间间隔后的新时间值返回减去一个时间间隔后的新时间值返回起始日期与结束日期之间的间隔天数日期与时间函数年月日时分秒年月日时分秒可以表示年月日时分秒但是插入数据的时候还是要参照表的结构的流程函数流程函数相关高薪底薪薪资等级双分支结构如果是那么取值为单分支如果等于则返回否则返回相关等值判断店员销售经理其他岗位区间判断工资等级函数其他函数其他函数多行函数对一组数据进行运算针对一组数据多行记录只返回一个结果也称分组函数多行函数多行函数自动忽略值针对所有类型只针对数值型类型有效计数统计表的记录数方式统计表的记录数方式分组与筛选分组统计各个部门的平均工资字段和多行函数不可以同时使用字段和多行函数不可以同时使用除非这个字段属于分组统计各个岗位的平均工资统计各个岗位的分组后筛选统计各个部门的平均工资只显示平均工资以上的分组以后进行二次筛选平均工资平均工资平均工资平均工资在分组前进行过滤的在分组后进行后滤对比实例对比实例统计各个岗位的平均工资除了方法方法在分组前进行过滤的在分组后进行后滤总结语句总结注意顺序固定不可以改变顺序语句的执行顺序单表查询练习单表查询练习列出工资最小值小于的职位列出平均工资大于元的部门和工作搭配组合统计人数小于的部门的平均工资这里可用统计各部门的最高工资排除最高工资小于的部门多表查询交叉连接自然连接优点自动匹配所有的同名列同名列只显示一次简单缺点查询字段的时候没有指定字段对应的数据库表效率低解决指定表名缺点表名太长解决起表名缺点会自动匹配所有表中同名的字段有时候我们只需要部分相同的字段内连接同名字段才有效缺点连接的表字段不同时无法使用解决使用子句使用的时候可以省略外连接内连接只显示匹配的数据例如一个部门没有员工就不会显示外连接可以显示不匹配的数据都可以省略的左外连接左边的那个表的信息即使不匹配也可以查看出结果结果右外连接右边的那个表的信息即使不匹配也可以查看出结果结果全外连接这个语法在里面不支持才支持为了代替可以取左外连接和右外连接的并集并集并集不去重效率低结果不去重的并集效率高结果三表查询案例查询员工的编号姓名薪水部门编号部门名称薪水等级可以看做就是上面的结果是一张表然后再和第三张表进行连接结果自连接查询相当于把本身表复制一份本质与前面的连接没有区别查询员工的编号姓名上级编号上级的姓名员工编号员工姓名领导编号员工领导姓名左外连接员工编号员工姓名领导编号员工领导姓名结果补充语法的多表查询查询员工的编号员工姓名薪水员工部门编号部门名称相当于语法中的出现笛卡尔积没有意义相当于语法中的查询员工的编号员工姓名薪水员工部门编号部门名称查询出工资大于的员工查询员工的名字岗位上级编号上级名称自连接查询员工的编号姓名薪水部门编号部门名称薪水等级总结语法麻烦语法中表的连接条件和筛选条件是放在一起的没有分开语法中提供了更多的查询连接类型不相关子查询引入要查询所有比工资高的员工的信息需要两个命令而且第二个命令依托于第一个命令会相互影响命令一查询的工资命令二查询所有比其工资高的员工信息子查询可以通过一个命令解决问题单行子查询将上面两个命令合并查询工资高于平均工资的雇员的名字和工资查询和同一部门且比他工资低的雇员的名字和工资查询职务和相同比雇佣时间早的雇员信息多行子查询子查询查出来的记录为多条实例一查询部门中职务同部门的雇员一样的雇员信息查询雇员信息查询部门中的雇员信息部门的雇员的职务如果使用单行子查询就会报错多行子查询可以解决实例二查询工资比所有的都高的雇员的编号名字和工资查询雇员的编号名字和工资的工资查询工资比所有的都高的雇员的编号名字和工资多行子查询单行子查询实例三查询工资低于任意一个的工资的雇员信息查询雇员信息查询工资低于任意一个的工资的雇员信息单行子查询相关子查询引入不相关的子查询引入不相关的子查询子查询可以独立运行先运行子查询再运行外查询相关子查询子查询不可以独立运行并且先运行外查询再运行子查询不相关的子查询优缺点好处简单功能强大一些使用不相关子查询不能实现或者实现繁琐的子查询可以使用相关子查询实现缺点稍难理解实例查询各个部门最高工资的员工不相关子查询太复杂了相关子查询简单多啦查询工高于所在岗位的平均工资的那些员工不相关子查询相关子查询数据库对象事务事务是用来维护数据库完整性的它能够保证一系列的操作要么全部执行要么全不执行转账操作账户要转账给账户那么账户上减少的钱数和账户上增加的钱数必须一致也就是说账户的转出操作和账户的转入操作要么全部执行要么全不执行如果其中一个操作出现异常而没有执行的话就会导致账户和账户的转入转出金额不一致的情况为而事实上这种情况是不允许发生的所以为了防止这种情况的发生需要使用事务处理在淘宝购物下订单的时候商家库存要减少订单增加记录付款我的账号少元操作要么全部执行要么全不执行概念事务指的是一个操作序列该操作序列中的多个操作要么都做要么都不做是一个不可分割的工作单位是数据库环境中的逻辑工作单位由数据库管理系统中的事务管理子系统负责事务的处理目前常用的存储引擎有以后默认的存储引擎和之前默认的存储引擎其中支持事务处理机制而不支持特性事务处理可以确保除非事务性序列内的所有操作都成功完成否则不会永久更新面向数据的资源通过将一组相关操作组合为一个要么全部成功要么全部失败的序列可以简化错误恢复并使应用程序更加可靠但并不是所有的操作序列都可以称为事务这是因为一个操作序列要成为事务必须满足事务的原子性一致性隔离性和持久性这四个特性简称为特性原子性原子是自然界最小的颗粒具有不可再分的特性事务中的所有操作可以看做一个原子事务是应用中不可再分的最小的逻辑执行体使用事务对数据进行修改的操作序列要么全部执行要么全不执行通常某个事务中的操作都具有共同的目标并且是相互依赖的如果数据库系统只执行这些操作中的一部分则可能会破坏事务的总体目标而原子性消除了系统只处理部分操作的可能性一致性一致性是指事务执行的结果必须使数据库从一个一致性状态变到另一个一致性状态当数据库中只包含事务成功提交的结果时数据库处于一致性状态一致性是通过原子性来保证的例如在转账时只有保证转出和转入的金额一致才能构成事务也就是说事务发生前和发生后数据的总额依然匹配隔离性隔离性是指各个事务的执行互不干扰任意一个事务的内部操作对其他并发的事务都是隔离的也就是说并发执行的事务之间既不能看到对方的中间状态也不能相互影响例如在转账时只有当账户中的转出和账户中转入操作都执行成功后才能看到账户中的金额减少以及账户中的金额增多并且其他的事务对于转账操作的事务是不能产生任何影响的持久性持久性指事务一旦提交对数据所做的任何改变都要记录到永久存储器中通常是保存进物理数据库即使数据库出现故障提交的数据也应该能够恢复但如果是由于外部原因导致的数据库故障如硬盘被损坏那么之前提交的数据则有可能会丢失实例使用事务保证转账安全创建账户表查看账户表在表中插入数据丽丽小刚丽丽给小刚转元默认一个语句是一个事务所以上面的操作执行了个事务必须让上面的两个操作控制在一个事务中手动开启事务操作手动回滚刚才执行的操作全部取消手动提交在回滚和提交之前数据库中的数据都是操作的缓存中的数据而不是数据库的真实数据事务并发问题脏读当一个事务正在访问数据并且对数据进行了修改而这种修改还没有提交到数据库中这时另外一个事务也访问了这个数据然后使用了这个数据因为这个数据是还没有提交的数据那么另外一个事务读到的这个数据是脏数据依据脏数据所做的操作可能是不正确的不可重复读指在一个事务内多次读同一数据在这个事务还没有结束时另一个事务也访问该数据那么在第一个事务中的两次读数据之间由于第二个事务的修改导致第一个事务两次读取的数据可能不太一样这就发生了在一个事务内两次读到的数据是不一样的情况因此称为不可重复读幻读幻读与不可重复读类似它发生在一个事务读取了几行数据接着另一个并发事务插入了一些数据时在随后的查询中第一个事务就会发现多了一些原本不存在的记录就好像发生了幻觉一样所以称为幻读不可重复度和幻读区别不可重复读的重点是修改幻读的重点在于新增或者删除解决不可重复读的问题只需锁住满足条件的行解决幻读需要锁表例同样的条件你读取过的数据再次读取出来发现值不一样了事务中的先生读取自己的工资为的操作还没完成事务中的先生就修改了的工资为导致再读自己的工资时工资变为这就是不可重复读例同样的条件第次和第次读出来的记录数不一样假某工资单表中工资大于的有人事务读取了所有工资大于的人共查到条记录这时事务又插入了一条工资大于的记录事务再次读取时查到的记录就变为了条这样就导致了幻读事务隔离级别事务的隔离级别用于决定如何控制并发用户读写数据的操作数据库是允许多用户并发访问的如果多个用户同时开启事务并对同一数据进行读写操作的话有可能会出现脏读不可重复读和幻读问题所以中提供了四种隔离级别来解决上述问题从低到高依次为以及隔离级别越低越能支持高并发的数据库操作查看默认的事务隔离级别默认的是设置事务的隔离级别设置当前会话的隔离级别默认的实例必须是两个事务都开始以后执行的操作才会影响在的情况下开始两个事务事务一事务二事务一查询操作事务二更新操作且没提交事务一再次查询读到了在脏数据如果设置为事务二就不会读到脏数据视图概念视图是一个从单张或多张基础数据表或其他视图中构建出来的虚拟表同基础表一样视图中也包含了一系列带有名称的列和行数据但是数据库中只是存放视图的定义也就是动态检索数据的查询语句而并不存放视图中的数据这些数据依旧存放于构建视图的基础表中只有当用户使用视图是才去数据库请求相对应的数据即视图中的数据是在引用视图时动态生成的因此视图中的数据发生了变化视图中相应的数据也会跟着改变视图本质上就是一个查询语句是一个虚拟的表不存在的表你查看视图其实就是查看视图对应的语句优点简化用户操作视图可以使用户将注意力集中在所关心地数据上而不需要关心数据表的结构与其他表的关联条件以及查询条件等对机密数据提供安全保护有了视图就可以在设计数据库应用系统时对不同的用户定义不同的视图避免机密数据如敏感字段出现在不应该看到这些数据的用户视图上这样视图就自动提供了对机密数据的安全保护功能实例一单表视图创建替换单表视图创建替换单表视图查看视图查看视图向视图中插入满足条件的数据在视图中插入数据查看视图向视图中插入不满足条件的数据查看原来的表发现成功插进去了解决上面问题需要加上创建替换单表视图这样不满足条件的数据就不会轻易被加进去实例二多表视图创建替换多表视图实例三统计视图创建统计视图实例四基于视图的视图创建基于视图的视图存储过程概念通过前面章节的学习我们已经知道是一种非常便利的语言从数据库抽取数据或者对特定的数据集中更新时都能通过简洁直观的代码实现但是这个所谓的简洁也是有限制基本是一个命令实现一个处理是所谓的非程序语言在不能编写流程的情况下所有的处理只能通过一个个命令来实现当然通过使用连接及子查询即使使用的单一命令也能实现一些高级的处理但是其局限性是显而易见的例如在中就很难实现针对不同条件进行不同的处理以及循环等功能这个时候就出现了存储过程这个概念简单地说存储过程就是数据库中保存的一系列命令的集合也可以将其看作相互之间有关系的命令组织在一起形成的一个小程序优点提高执行性能存储过程执行效率之所高在于普通的语句每次都会对语法分析编译执行而存储过程只是在第一次执行语法分析编译执行以后都是对结果进行调用可减轻网络负担使用存储过程复杂的数据库操作也可以在数据库服务器中完成只需要从客户端或应用程序传递给数据库必要的参数就行比起需要多次传递命令本身这大大减轻了网络负担可将数据库的处理黑匣子化应用程序中完全不用考虑存储过程的内部详细处理只需要知道调用哪个存储过程就可以了实例定义一个没有返回值的存储过程定义一个没有返回值存储过程实现模糊查询操作传入就查看全表删除存储过程调用存储过程结果定义一个有返回值的存储过程定义一个有返回值的存储过程参数前面的可以不写是定义的一个函数作用返回查询结果的条数调用存储过程传入的参数名不一定要一样结果',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-16 11:34:44',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">Sonia33's Blog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/BlockChain/" style="font-size: 1.05rem;">BlockChain<sup>1</sup></a><a href="/tags/CSS/" style="font-size: 1.05rem;">CSS<sup>1</sup></a><a href="/tags/DataBase/" style="font-size: 1.05rem;">DataBase<sup>2</sup></a><a href="/tags/FastDFS/" style="font-size: 1.05rem;">FastDFS<sup>1</sup></a><a href="/tags/Git/" style="font-size: 1.05rem;">Git<sup>1</sup></a><a href="/tags/HTML/" style="font-size: 1.05rem;">HTML<sup>1</sup></a><a href="/tags/IO/" style="font-size: 1.05rem;">IO<sup>1</sup></a><a href="/tags/JDBC/" style="font-size: 1.05rem;">JDBC<sup>1</sup></a><a href="/tags/JQuery/" style="font-size: 1.05rem;">JQuery<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.05rem;">Java<sup>3</sup></a><a href="/tags/JavaScript/" style="font-size: 1.05rem;">JavaScript<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 1.05rem;">MySQL<sup>2</sup></a><a href="/tags/NoSQL/" style="font-size: 1.05rem;">NoSQL<sup>1</sup></a><a href="/tags/RabbitMQ/" style="font-size: 1.05rem;">RabbitMQ<sup>1</sup></a><a href="/tags/Redis/" style="font-size: 1.05rem;">Redis<sup>1</sup></a><a href="/tags/Zookeeper/" style="font-size: 1.05rem;">Zookeeper<sup>1</sup></a><a href="/tags/hexo/" style="font-size: 1.05rem;">hexo<sup>1</sup></a><a href="/tags/java/" style="font-size: 1.05rem;">java<sup>1</sup></a><a href="/tags/macOS/" style="font-size: 1.05rem;">macOS<sup>2</sup></a><a href="/tags/web/" style="font-size: 1.05rem;">web<sup>1</sup></a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 1.05rem;">分布式<sup>1</sup></a><a href="/tags/%E5%90%8E%E7%AB%AF/" style="font-size: 1.05rem;">后端<sup>1</sup></a><a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 1.05rem;">多线程<sup>1</sup></a><a href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" style="font-size: 1.05rem;">并发编程<sup>1</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 1.05rem;">测试<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 1.05rem;">网络<sup>1</sup></a><a href="/tags/%E8%B8%A9%E9%9B%B7/" style="font-size: 1.05rem;">踩雷<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">六月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/05/"><span class="card-archive-list-date">五月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/03/"><span class="card-archive-list-date">三月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/02/"><span class="card-archive-list-date">二月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/09/"><span class="card-archive-list-date">九月 2021</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/08/"><span class="card-archive-list-date">八月 2021</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/07/"><span class="card-archive-list-date">七月 2021</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/06/"><span class="card-archive-list-date">六月 2021</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/MySQL/" itemprop="url">MySQL</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/DataBase/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>DataBase</span></a><a class="article-meta__tags" href="/tags/MySQL/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>MySQL</span></a></span></div></div><h1 class="post-title" itemprop="name headline">MySQL</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2021-05-07T01:21:10.000Z" title="发表于 2021-05-07 09:21:10">2021-05-07</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2022-05-16T03:34:44.587Z" title="更新于 2022-05-16 11:34:44">2022-05-16</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为长沙"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>长沙</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://soniachen.com/2021/05/07/MySQL/"><header><a class="post-meta-categories" href="/categories/MySQL/" itemprop="url">MySQL</a><a href="/tags/DataBase/" tabindex="-1" itemprop="url">DataBase</a><a href="/tags/MySQL/" tabindex="-1" itemprop="url">MySQL</a><h1 id="CrawlerTitle" itemprop="name headline">MySQL</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Sonia33</span><time itemprop="dateCreated datePublished" datetime="2021-05-07T01:21:10.000Z" title="发表于 2021-05-07 09:21:10">2021-05-07</time><time itemprop="dateCreated datePublished" datetime="2022-05-16T03:34:44.587Z" title="更新于 2022-05-16 11:34:44">2022-05-16</time></header><h1 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h1><h2 id="1-数据库基本概念"><a href="#1-数据库基本概念" class="headerlink" title="1.数据库基本概念"></a>1.数据库基本概念</h2><h3 id="1-1-数据"><a href="#1-1-数据" class="headerlink" title="1.1 数据"></a>1.1 数据</h3><p>所谓数据（Data）是指对客观事物进行描述并可以鉴别的符号，这些符号是可识别的、抽象的。它不仅仅指狭义上的数字，而是有多种表现形式：字母、文字、文本、图形、音频、视频等。现在计算机存储和处理的数据范围十分广泛，而描述这些数据的符号也变得越来越复杂了。</p>
<h3 id="1-2-数据库"><a href="#1-2-数据库" class="headerlink" title="1.2 数据库"></a>1.2 数据库</h3><p>数据库（Database，DB）指的是以一定格式存放、能够实现多个用户共享、与应用程序彼此独立的数据集合。</p>
<span id="more"></span>

<h3 id="1-3-数据库管理系统"><a href="#1-3-数据库管理系统" class="headerlink" title="1.3 数据库管理系统"></a>1.3 数据库管理系统</h3><p>数据库管理系统（Database Management System，DBMS）是用来定义和管理数据的软件。如何科学的组织和存储数据，如何高效的获取和维护数据，如何保证数据的安全性和完整性，这些都需要靠数据库管理系统完成。目前，比较流行的数据库管理系统有：Oracle、MySQL、SQL Server、DB2等。</p>
<h3 id="1-4数据库应用程序"><a href="#1-4数据库应用程序" class="headerlink" title="1.4数据库应用程序"></a>1.4数据库应用程序</h3><p>数据库应用程序（Database Application System，DBAS）是在数据库管理系统基础上，使用数据库管理系统的语法，开发的直接面对最终用户的应用程序，如学生管理系统、人事管理系统、图书管理系统等。</p>
<h3 id="1-5-数据库管理员"><a href="#1-5-数据库管理员" class="headerlink" title="1.5 数据库管理员"></a>1.5 数据库管理员</h3><p>数据库管理员（Database Administrator，DBA）是指对数据库管理系统进行操作的人员，其主要负责数据库的运营和维护。</p>
<h3 id="1-6-最终用户"><a href="#1-6-最终用户" class="headerlink" title="1.6 最终用户"></a>1.6 最终用户</h3><p>最终用户（User）指的是数据库应用程序的使用者。用户面向的是数据库应用程序（通过应用程序操作数据），并不会直接与数据库打交道。</p>
<h3 id="1-7-数据库系统"><a href="#1-7-数据库系统" class="headerlink" title="1.7 数据库系统"></a>1.7 数据库系统</h3><p>数据库系统（Database System，DBS）一般是由数据库、数据库管理系统、数据库应用程序、数据库管理员和最终用户构成。其中DBMS是数据库系统的基础和核心</p>
<h2 id="2-数据库表列类型"><a href="#2-数据库表列类型" class="headerlink" title="2. 数据库表列类型"></a>2. 数据库表列类型</h2><h3 id="2-1-整数类型"><a href="#2-1-整数类型" class="headerlink" title="2.1 整数类型"></a>2.1 整数类型</h3><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210630201735.png" alt="image-20210630201735014" style="zoom:67%;" />

<ol>
<li><p>MySQL支持选择在该类型关键字后面的括号内指定整数值的<strong>显示宽度</strong>(例如，INT(4))。显示宽度并不限制可以在列内保存的值的范围，也不限制超过列的指定宽度的值的显示</p>
</li>
<li><p>主键自增：不使用序列，通过<strong>auto_increment</strong>，要求是<strong>整数类型</strong></p>
</li>
<li><p>支持选择在该类型关键字后面的括号内指定整数值的显示宽度</p>
</li>
</ol>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210630201859.png" alt="image-20210630201859642" style="zoom:67%;" />







<h1 id="表的完整性约束"><a href="#表的完整性约束" class="headerlink" title="表的完整性约束"></a>表的完整性约束</h1><h2 id="1-非外键约束"><a href="#1-非外键约束" class="headerlink" title="1. 非外键约束"></a>1. 非外键约束</h2><table>
<thead>
<tr>
<th><strong>约束条件</strong></th>
<th><strong>约束描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td>PRIMARY KEY</td>
<td>主键约束，约束字段的值可唯一地标识对应的记录</td>
</tr>
<tr>
<td>NOT NULL</td>
<td>非空约束，约束字段的值不能为空</td>
</tr>
<tr>
<td>UNIQUE</td>
<td>唯一约束，约束字段的值是唯一的</td>
</tr>
<tr>
<td>CHECK</td>
<td>检查约束，限制某个字段的取值范围</td>
</tr>
<tr>
<td>DEFAULT</td>
<td>默认值约束，约束字段的默认值</td>
</tr>
<tr>
<td>AUTO_INCREMENT</td>
<td>自动增加约束，约束字段的值自动递增</td>
</tr>
<tr>
<td>FOREIGN KEY</td>
<td>外键约束，约束表与表之间的关系</td>
</tr>
</tbody></table>
<h5 id="实例一：建立一张用来存储学生信息的表"><a href="#实例一：建立一张用来存储学生信息的表" class="headerlink" title="实例一：建立一张用来存储学生信息的表"></a><strong>实例一</strong>：建立一张用来存储学生信息的表</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">建立一张用来存储学生信息的表</span><br><span class="line">字段包含学号、姓名、性别，年龄、入学日期、班级，email等信息</span><br><span class="line">约束：</span><br><span class="line">建立一张用来存储学生信息的表</span><br><span class="line">字段包含学号、姓名、性别，年龄、入学日期、班级，email等信息</span><br><span class="line">【1】学号是主键 = 不能为空 +  唯一 ，主键的作用：可以通过主键查到唯一的一条记录【2】如果主键是整数类型，那么需要自增</span><br><span class="line">【3】姓名不能为空</span><br><span class="line">【4】Email唯一</span><br><span class="line">【5】性别默认值是男</span><br><span class="line">【6】性别只能是男女</span><br><span class="line">【7】年龄只能在18-50之间</span><br><span class="line">*/</span><br><span class="line">-- 创建数据库表：</span><br><span class="line">create table t_student(</span><br><span class="line">        sno int(6) primary key auto_increment, -- 主键自增</span><br><span class="line">        sname varchar(5) not null, </span><br><span class="line">        sex char(1) default &#x27;男&#x27; check(sex=&#x27;男&#x27; || sex=&#x27;女&#x27;),</span><br><span class="line">        age int(3) check(age&gt;=18 and age&lt;=50),</span><br><span class="line">        enterdate date,</span><br><span class="line">        classname varchar(10),</span><br><span class="line">        email varchar(15) unique -- 唯一</span><br><span class="line">);</span><br><span class="line">-- 查看数据：</span><br><span class="line">select * from t_student;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701085258.png" alt="image-20210701085258650" style="zoom:67%;" />

<ul>
<li><p>添加数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-- 添加数据：</span><br><span class="line">--  1048 - Column &#x27;sname&#x27; cannot be null 不能为null</span><br><span class="line">-- 3819 - Check constraint &#x27;t_student_chk_1&#x27; is violated. 违反检查约束</span><br><span class="line">insert into t_student values (1,&#x27;张三&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;zs@126.com&#x27;);</span><br><span class="line">-- 1062 - Duplicate entry &#x27;1&#x27; for key &#x27;t_student.PRIMARY&#x27; 主键重复</span><br><span class="line">-- &gt; 1062 - Duplicate entry &#x27;ls@126.com&#x27; for key &#x27;t_student.email&#x27; 违反唯一约束</span><br><span class="line">insert into t_student values (2,&#x27;李四&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;ls@126.com&#x27;);</span><br><span class="line">insert into t_student values (3,&#x27;露露&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;ls@126.com&#x27;);</span><br><span class="line">-- 如果主键没有设定值，或者用null.default都可以完成主键自增的效果</span><br><span class="line">insert into t_student (sname,enterdate) values (&#x27;菲菲&#x27;,&#x27;2029-4-5&#x27;);</span><br><span class="line">insert into t_student values (null,&#x27;小明&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;xm@126.com&#x27;);</span><br><span class="line">insert into t_student values (default,&#x27;小刚&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;xg@126.com&#x27;);</span><br><span class="line">-- 如果sql报错，可能主键就浪费了，后续插入的主键是不连号的，我们主键也不要求连号的</span><br><span class="line">insert into t_student values (null,&#x27;小明&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;oo@126.com&#x27;);</span><br></pre></td></tr></table></figure>

<p><strong>常见错误：</strong></p>
<p>  –》 1048 - Column ‘sname’ cannot be null <strong>不能为null</strong></p>
<p>  –》 819 - Check constraint ‘t_student_chk_1’ is violated. <strong>违反检查约束</strong></p>
<p>  – 》1062 - Duplicate（重复的） entry ‘1’ for key ‘t_student.PRIMARY’ <strong>主键重复</strong></p>
<p>  – 》1062 - Duplicate entry ‘<a href="mailto:&#x6c;&#x73;&#64;&#49;&#x32;&#54;&#46;&#x63;&#x6f;&#x6d;">&#x6c;&#x73;&#64;&#49;&#x32;&#54;&#46;&#x63;&#x6f;&#x6d;</a>‘ for key ‘t_student.email’ <strong>违反唯一约束</strong></p>
<ul>
<li>使用自增的时候用<strong>null和default</strong>都是可以</li>
<li>如果sql报错，可能<strong>主键</strong>就浪费了，后续插入的主键是不连号的，主键也不要求连号的</li>
</ul>
</li>
</ul>
<h4 id="列级约束和表级约束"><a href="#列级约束和表级约束" class="headerlink" title="- 列级约束和表级约束"></a>- 列级约束和表级约束</h4><p>(1)   <strong>表级约束</strong>：可以约束表中任意一个或多个字段。与列定义相互独立，不包含在列定义中；与定义用‘，’分隔；必须指出要约束的列的名称；</p>
<p>(2)   <strong>列级约束</strong>：包含在列定义中，直接跟在该列的其它定义之后 ，用空格分隔；不必指定列名；</p>
<h5 id="实例二"><a href="#实例二" class="headerlink" title="实例二"></a>实例二</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">-- 删除表：</span><br><span class="line">drop table t_student;</span><br><span class="line">-- 创建数据库表：</span><br><span class="line">create table t_student(</span><br><span class="line">        sno int(6) auto_increment, </span><br><span class="line">        sname varchar(5) not null, </span><br><span class="line">        sex char(1) default &#x27;男&#x27;,</span><br><span class="line">        age int(3),</span><br><span class="line">        enterdate date,</span><br><span class="line">        classname varchar(10),</span><br><span class="line">        email varchar(15),</span><br><span class="line">    -- 表级约束：</span><br><span class="line">        constraint pk_stu primary key (sno),  -- pk_stu 主键约束的名字</span><br><span class="line">        constraint ck_stu_sex check (sex = &#x27;男&#x27; || sex = &#x27;女&#x27;),</span><br><span class="line">        constraint ck_stu_age check (age &gt;= 18 and age &lt;= 50),</span><br><span class="line">        constraint uq_stu_email unique (email)</span><br><span class="line">);</span><br><span class="line">-- 添加数据：</span><br><span class="line">insert into t_student values (1,&#x27;张三&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;zs@126.com&#x27;);</span><br><span class="line">-- &gt; 3819 - Check constraint &#x27;ck_stu_sex&#x27; is violated.</span><br><span class="line">-- &gt; 3819 - Check constraint &#x27;ck_stu_age&#x27; is violated.</span><br><span class="line">-- &gt; 1062 - Duplicate entry &#x27;zs@126.com&#x27; for key &#x27;t_student.uq_stu_email&#x27;</span><br><span class="line">insert into t_student values (3,&#x27;李四&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;zs@126.com&#x27;);</span><br><span class="line">-- 查看数据：</span><br><span class="line">select * from t_student;</span><br></pre></td></tr></table></figure>

<h4 id="创建表之后添加约束"><a href="#创建表之后添加约束" class="headerlink" title="- 创建表之后添加约束"></a>- 创建表之后添加约束</h4><h5 id="实例三"><a href="#实例三" class="headerlink" title="实例三"></a>实例三</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">-- 删除表：</span><br><span class="line">drop table t_student;</span><br><span class="line">-- 创建数据库表：</span><br><span class="line">create table t_student(</span><br><span class="line">        sno int(6), </span><br><span class="line">        sname varchar(5) not null, </span><br><span class="line">        sex char(1) default &#x27;男&#x27;,</span><br><span class="line">        age int(3),</span><br><span class="line">        enterdate date,</span><br><span class="line">        classname varchar(10),</span><br><span class="line">        email varchar(15)</span><br><span class="line">);</span><br><span class="line">-- &gt; 1075 - Incorrect table definition; there can be only one auto column and it must be defined as a key</span><br><span class="line">-- 错误的解决办法：就是auto_increment去掉</span><br><span class="line">-- 在创建表以后添加约束：</span><br><span class="line">alter table t_student add constraint pk_stu primary key (sno) ; -- 主键约束</span><br><span class="line">alter table t_student modify sno int(6) auto_increment; -- 修改自增条件</span><br><span class="line">alter table t_student add constraint ck_stu_sex check (sex = &#x27;男&#x27; || sex = &#x27;女&#x27;);</span><br><span class="line">alter table t_student add constraint ck_stu_age check (age &gt;= 18 and age &lt;= 50);</span><br><span class="line">alter table t_student add constraint uq_stu_email unique (email);</span><br><span class="line">-- 查看表结构：</span><br><span class="line">desc t_student;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>验证约束添加成功：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701105406.png" alt="image-20210701105405972" style="zoom:67%;" />



<h2 id="2-外键约束"><a href="#2-外键约束" class="headerlink" title="2. 外键约束"></a>2. 外键约束</h2><ul>
<li>外键约束（FOREIGN KEY，缩写FK）是用来实现数据库表的参照完整性的。<strong>外键约束可以使两张表紧密的结合起来，特别是针对修改或者删除的级联操作时，会保证数据的完整性。</strong></li>
<li>外键是指表中某个字段的值依赖于另一张表中某个字段的值，而被依赖的字段必须具有主键约束或者唯一约束。被依赖的表我们通常称之为父表或者主表，设置外键约束的表称为子表或者从表。</li>
<li>只有<strong>表级约束</strong>没有列级约束</li>
</ul>
<h5 id="实例四"><a href="#实例四" class="headerlink" title="实例四"></a>实例四</h5><p>主表（父表）：班级表  -  班级编号 - 主键</p>
<p> 从表（子表）：学生表 - 班级编号 - 外键</p>
<ol>
<li><p>创建父表—班级表：</p>
</li>
<li><ul>
<li><p>cno(主键、自增)；cname（不为空）；room；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 先删除表，先删除从表再删除父表</span><br><span class="line">drop table t_student;</span><br><span class="line">drop table t_class;</span><br><span class="line">-- 先创建父表：班级表：</span><br><span class="line">create table t_class(</span><br><span class="line">        cno int(4) primary key auto_increment,</span><br><span class="line">        cname varchar(10) not null,</span><br><span class="line">        room char(4)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>创建从表—学生表：</p>
<ul>
<li><p>sno(主键、自增)；sname（不为空）；classno（取值参考t_class表中的cno字段，不要求字段名字完全重复，但是类型长度定义 尽量要求相同。);</p>
</li>
<li><p><strong>添加外键约束</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 添加学生表，添加外键约束：</span><br><span class="line">create table t_student(</span><br><span class="line">        sno int(6) primary key auto_increment, </span><br><span class="line">        sname varchar(5) not null, </span><br><span class="line">        classno int(4),-- 取值参考t_class表中的cno字段，不要求字段名字完全重复，但是类型长度定义 尽量要求相同。</span><br><span class="line">    -- 外键约束：</span><br><span class="line">        constraint fk_stu_classno foreign key (classno) references t_class (cno)</span><br><span class="line">    </span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ul>
<ul>
<li><p><strong>删除外键约束</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 删除外键约束</span><br><span class="line">alter table EMP</span><br><span class="line">	drop foreign key FK_DEPTNO</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>添加数据：</p>
</li>
<li><p>可以一次性添加多条记录：</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 可以一次性添加多条记录：</span><br><span class="line">insert into t_class values (null,&#x27;java001&#x27;,&#x27;r803&#x27;),(null,&#x27;java002&#x27;,&#x27;r416&#x27;),(null,&#x27;大数据001&#x27;,&#x27;r103&#x27;);</span><br><span class="line">insert into t_student values (null,&#x27;张三&#x27;,1),(null,&#x27;李四&#x27;,1),(null,&#x27;王五&#x27;,2),(null,&#x27;朱六&#x27;,3);</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询班级表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 查看班级表和学生表：</span><br><span class="line">select * from t_class;</span><br><span class="line">select * from t_student;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>添加外键的效果</strong>：</p>
<ul>
<li>删除班级会出错</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 尝试删除班级</span><br><span class="line">delete from t_class where cno = 1;</span><br></pre></td></tr></table></figure>

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701111051.png" alt="image-20210701111051536" style="zoom:67%;" /></li>
</ol>
<h4 id="外键策略："><a href="#外键策略：" class="headerlink" title="外键策略："></a><strong>外键策略：</strong></h4><p>直接删除班级会错误，有时候必须删，可以加入外键策略</p>
<h6 id="策略一：no-action-不允许操作"><a href="#策略一：no-action-不允许操作" class="headerlink" title="策略一：no action 不允许操作"></a>策略一：no action 不允许操作</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 策略1：no action 不允许操作</span><br><span class="line">-- 通过操作sql来完成：</span><br><span class="line">-- 先把班级2的学生对应的班级 改为null </span><br><span class="line">update t_student set classno = null where classno = 2;</span><br><span class="line">-- 然后再删除班级2   </span><br><span class="line">delete from t_class where cno = 2;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701112307.png" alt="image-20210701112307207" style="zoom:67%;" />

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701112344.png" alt="image-20210701112344539" style="zoom: 50%;" />

<h6 id="策略二：使用cascade级联操作"><a href="#策略二：使用cascade级联操作" class="headerlink" title="策略二：使用cascade级联操作"></a>策略二：使用cascade级联操作</h6><p>操作主表的时候影响从表的外键</p>
<ul>
<li><p>先删除外键约束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 策略2：cascade 级联操作：操作主表的时候影响从表的外键信息：</span><br><span class="line">alter table t_student drop foreign key fk_stu_classno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>重新添加外键约束（增加一个级联操作）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 重新添加外键约束：</span><br><span class="line">alter table t_student add constraint fk_stu_classno foreign key (classno) references t_class (cno) on update cascade on delete cascade;</span><br></pre></td></tr></table></figure>
</li>
<li><p>试着更新和删除操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 试试更新：</span><br><span class="line">update t_class set cno = 5 where cno = 3;</span><br><span class="line">-- 试试删除：</span><br><span class="line">delete from t_class where cno = 5;</span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701113031.png" alt="image-20210701113031631" style="zoom:50%;" /></li>
</ul>
<h6 id="策略三：set-null-置空操作"><a href="#策略三：set-null-置空操作" class="headerlink" title="策略三：set null     置空操作"></a>策略三：set null     置空操作</h6><ul>
<li><p>先删除之前的外键约束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 先删除之前的外键约束：</span><br><span class="line">alter table t_student drop foreign key fk_stu_classno;</span><br></pre></td></tr></table></figure>


</li>
<li><p>重新添加外键约束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 重新添加外键约束：</span><br><span class="line">alter table t_student add constraint fk_stu_classno foreign key (classno) references t_class (cno) on update set null on delete set null;</span><br></pre></td></tr></table></figure>
</li>
<li><p>试着更新操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 更新</span><br><span class="line">update t_class set cno = 5 whwere con = 1;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701142452.png" alt="image-20210701142451962" style="zoom:67%;" />

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701142510.png" alt="image-20210701142510409" style="zoom: 50%;" /></li>
</ul>
<p>注：策略2 级联操作  和  策略2 的  删除操作  可以混着使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table t_student add constraint fk_stu_classno foreign key (classno) references t_class (cno) on update cascade on delete set null ;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>应用场合：</p>
<p>– （1）朋友圈删除，点赞。留言都删除  –  级联操作<br>– （2）解散班级，对应的学生 置为班级为null就可以了，– set null</p>
<h1 id="DQL查询操作"><a href="#DQL查询操作" class="headerlink" title="DQL查询操作*"></a>DQL查询操作*</h1><h2 id="1-常见表的准备"><a href="#1-常见表的准备" class="headerlink" title="1. 常见表的准备"></a>1. 常见表的准备</h2><h3 id="部门表-dept"><a href="#部门表-dept" class="headerlink" title="部门表(dept)"></a>部门表(dept)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table DEPT(  </span><br><span class="line">  DEPTNO int(2) not null,  </span><br><span class="line">  DNAME  VARCHAR(14),  </span><br><span class="line">  LOC    VARCHAR(13)  </span><br><span class="line">);  </span><br><span class="line">alter table DEPT </span><br><span class="line">  add constraint PK_DEPT primary key (DEPTNO); </span><br></pre></td></tr></table></figure>

<h3 id="员工表（emp"><a href="#员工表（emp" class="headerlink" title="员工表（emp)"></a>员工表（emp)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">create table EMP  </span><br><span class="line">(  </span><br><span class="line">  EMPNO    int(4) primary key,  </span><br><span class="line">  ENAME    VARCHAR(10),  </span><br><span class="line">  JOB      VARCHAR(9),  </span><br><span class="line">  MGR      int(4),  </span><br><span class="line">  HIREDATE DATE,  </span><br><span class="line">  SAL      double(7,2),  </span><br><span class="line">  COMM     double(7,2),  </span><br><span class="line">  DEPTNO   int(2)  </span><br><span class="line">);  </span><br><span class="line">alter table EMP  </span><br><span class="line">  add constraint FK_DEPTNO foreign key (DEPTNO)  </span><br><span class="line">  references DEPT (DEPTNO);  </span><br></pre></td></tr></table></figure>

<h3 id="薪资登记表-salgrade"><a href="#薪资登记表-salgrade" class="headerlink" title="薪资登记表(salgrade)"></a>薪资登记表(salgrade)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table SALGRADE  </span><br><span class="line">(  </span><br><span class="line">  GRADE int primary key,  </span><br><span class="line">  LOSAL double(7,2),  </span><br><span class="line">  HISAL double(7,2)  </span><br><span class="line">);  </span><br></pre></td></tr></table></figure>

<h3 id="奖金表-bonus"><a href="#奖金表-bonus" class="headerlink" title="奖金表(bonus)"></a>奖金表(bonus)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create table BONUS  </span><br><span class="line">(  </span><br><span class="line">  ENAME VARCHAR(10),  </span><br><span class="line">  JOB   VARCHAR(9),  </span><br><span class="line">  SAL   double(7,2),  </span><br><span class="line">  COMM  double(7,2)  </span><br><span class="line">);  </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">-- DEPT</span><br><span class="line">insert into DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line">values (10, &#x27;ACCOUNTING&#x27;, &#x27;NEW YORK&#x27;);  </span><br><span class="line">insert into DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line">values (20, &#x27;RESEARCH&#x27;, &#x27;DALLAS&#x27;);  </span><br><span class="line">insert into DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line">values (30, &#x27;SALES&#x27;, &#x27;CHICAGO&#x27;);  </span><br><span class="line">insert into DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line">values (40, &#x27;OPERATIONS&#x27;, &#x27;BOSTON&#x27;);  </span><br><span class="line">-- EMP</span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7369, &#x27;SMITH&#x27;, &#x27;CLERK&#x27;, 7902, &#x27;1980-12-17&#x27;, 800, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7499, &#x27;ALLEN&#x27;, &#x27;SALESMAN&#x27;, 7698, &#x27;1981-02-20&#x27;, 1600, 300, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7521, &#x27;WARD&#x27;, &#x27;SALESMAN&#x27;, 7698, &#x27;1981-02-22&#x27;, 1250, 500, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7566, &#x27;JONES&#x27;, &#x27;MANAGER&#x27;, 7839, &#x27;1981-04-02&#x27;, 2975, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7654, &#x27;MARTIN&#x27;, &#x27;SALESMAN&#x27;, 7698, &#x27;1981-09-28&#x27;, 1250, 1400, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7698, &#x27;BLAKE&#x27;, &#x27;MANAGER&#x27;, 7839, &#x27;1981-05-01&#x27;, 2850, null, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7782, &#x27;CLARK&#x27;, &#x27;MANAGER&#x27;, 7839, &#x27;1981-06-09&#x27;, 2450, null, 10);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7788, &#x27;SCOTT&#x27;, &#x27;ANALYST&#x27;, 7566, &#x27;1987-04-19&#x27;, 3000, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7839, &#x27;KING&#x27;, &#x27;PRESIDENT&#x27;, null, &#x27;1981-11-17&#x27;, 5000, null, 10);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7844, &#x27;TURNER&#x27;, &#x27;SALESMAN&#x27;, 7698, &#x27;1981-09-08&#x27;, 1500, 0, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7876, &#x27;ADAMS&#x27;, &#x27;CLERK&#x27;, 7788, &#x27;1987-05-23&#x27;, 1100, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7900, &#x27;JAMES&#x27;, &#x27;CLERK&#x27;, 7698, &#x27;1981-12-03&#x27;, 950, null, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7902, &#x27;FORD&#x27;, &#x27;ANALYST&#x27;, 7566, &#x27;1981-12-03&#x27;, 3000, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7934, &#x27;MILLER&#x27;, &#x27;CLERK&#x27;, 7782, &#x27;1982-01-23&#x27;, 1300, null, 10);  </span><br><span class="line">-- SALGRADE</span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (1, 700, 1200);  </span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (2, 1201, 1400);  </span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (3, 1401, 2000);  </span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (4, 2001, 3000);  </span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (5, 3001, 9999);  </span><br><span class="line"></span><br><span class="line">-- 查看表：</span><br><span class="line">select * from dept; </span><br><span class="line">-- 部门表：dept:department 部分 ，loc - location 位置</span><br><span class="line">select * from emp;</span><br><span class="line">-- 员工表：emp:employee 员工   ,mgr :manager上级领导编号，hiredate 入职日期  firedate 解雇日期 ，common：补助</span><br><span class="line">-- deptno 外键 参考  dept - deptno字段</span><br><span class="line">-- mgr 外键  参考  自身表emp - empno  产生了自关联</span><br><span class="line">select * from salgrade;</span><br><span class="line">-- losal - lowsal</span><br><span class="line">-- hisal - highsal</span><br><span class="line">select * from bonus;</span><br></pre></td></tr></table></figure>

<h3 id="结果-表格形式"><a href="#结果-表格形式" class="headerlink" title="结果(表格形式)"></a>结果(表格形式)</h3><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701143713.png" alt="image-20210701143713377" style="zoom:67%;" />

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701143726.png" alt="image-20210701143726512" style="zoom:67%;" />

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701143737.png" alt="image-20210701143737874" style="zoom:67%;" />

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701143749.png" alt="image-20210701143749663" style="zoom:67%;" />

<h2 id="2-单表查询"><a href="#2-单表查询" class="headerlink" title="2.  单表查询"></a>2.  单表查询</h2><h3 id="2-1-简单的SQL查询"><a href="#2-1-简单的SQL查询" class="headerlink" title="2.1 简单的SQL查询"></a>2.1 简单的SQL查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">-- 对emp表查询：</span><br><span class="line">select * from emp; -- *代表所有数据</span><br><span class="line">-- 显示部分列：</span><br><span class="line">select empno,ename,sal from emp;</span><br><span class="line">-- 显示部分行：where子句</span><br><span class="line">select * from emp where sal &gt; 2000;</span><br><span class="line">-- 显示部分列，部分行：</span><br><span class="line">select empno,ename,job,mgr from emp where sal &gt; 2000;</span><br><span class="line">-- 起别名：</span><br><span class="line">select empno 员工编号,ename 姓名,sal 工资 from emp; -- as 省略，&#x27;&#x27;或者&quot;&quot;省略了</span><br><span class="line">-- as alias 别名</span><br><span class="line">select empno as 员工编号,ename as 姓名,sal as 工资 from emp;</span><br><span class="line">select empno as &#x27;员工编号&#x27;,ename as &quot;姓名&quot;,sal as 工资 from emp;</span><br><span class="line">-- &gt; 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;编号,ename as &quot;姓 名&quot;,sal as 工资 from emp&#x27; at line 1</span><br><span class="line">-- 错误原因：在别名中有特殊符号的时候，&#x27;&#x27;或者&quot;&quot;不可以省略不写</span><br><span class="line">select empno as 员工 编号,ename as &quot;姓 名&quot;,sal as 工资 from emp;</span><br><span class="line">-- 算术运算符：</span><br><span class="line">select empno,ename,sal,sal+1000 as &#x27;涨薪后&#x27;,deptno from emp where sal &lt; 2500;</span><br><span class="line">select empno,ename,sal,comm,sal+comm from emp;  -- ？？？后面再说</span><br><span class="line">-- 去重操作：</span><br><span class="line">select job from emp;</span><br><span class="line">select distinct job from emp;</span><br><span class="line">select job,deptno from emp;</span><br><span class="line">select distinct job,deptno from emp; -- 对后面的所有列组合 去重 ，而不是单独的某一列去重</span><br><span class="line">-- 排序：</span><br><span class="line">select * from emp order by sal; -- 默认情况下是按照升序排列的</span><br><span class="line">select * from emp order by sal asc; -- asc 升序，可以默认不写</span><br><span class="line">select * from emp order by sal desc; -- desc 降序</span><br><span class="line">select * from emp order by sal asc ,deptno desc; -- 在工资升序的情况下，deptno按照降序排列</span><br></pre></td></tr></table></figure>



<h3 id="2-2-where子句"><a href="#2-2-where子句" class="headerlink" title="2.2 where子句"></a>2.2 where子句</h3><p>将过滤条件放在where子句的后面，可以筛选&#x2F;过滤出我们想要的符合条件的数据</p>
<ul>
<li><p>加关系运算符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-- where 子句 + 关系运算符</span><br><span class="line">select * from emp where deptno = 10;</span><br><span class="line">select * from emp where deptno &gt; 10;</span><br><span class="line">select * from emp where deptno &gt;= 10;</span><br><span class="line">select * from emp where deptno &lt; 10;</span><br><span class="line">select * from emp where deptno &lt;= 10;</span><br><span class="line">select * from emp where deptno &lt;&gt; 10;</span><br><span class="line">select * from emp where deptno != 10;</span><br><span class="line">select * from emp where job = &#x27;CLERK&#x27;; </span><br><span class="line">select * from emp where job = &#x27;clerk&#x27;; -- 默认情况下不区分大小写 </span><br><span class="line">select * from emp where binary job = &#x27;clerk&#x27;; -- binary区分大小写</span><br><span class="line">select * from emp where hiredate &lt; &#x27;1981-12-25&#x27;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>加逻辑运算符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- where 子句 + 逻辑运算符：and </span><br><span class="line">select * from emp where sal &gt; 1500 and sal &lt; 3000;  -- (1500,3000)</span><br><span class="line">select * from emp where sal &gt; 1500 &amp;&amp; sal &lt; 3000; </span><br><span class="line">select * from emp where sal &gt; 1500 and sal &lt; 3000 order by sal;</span><br><span class="line">select * from emp where sal between 1500 and 3000; -- [1500,3000]</span><br><span class="line">-- where 子句 + 逻辑运算符：or</span><br><span class="line">select * from emp where deptno = 10 or deptno = 20;</span><br><span class="line">select * from emp where deptno = 10 || deptno = 20;</span><br><span class="line">select * from emp where deptno in (10,20);</span><br><span class="line">select * from emp where job in (&#x27;MANAGER&#x27;,&#x27;CLERK&#x27;,&#x27;ANALYST&#x27;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>加模糊查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- where子句 + 模糊查询：</span><br><span class="line">-- 查询名字中带A的员工  -- %代表任意多个字符 0,1,2，.....</span><br><span class="line">select * from emp where ename like &#x27;%A%&#x27; ;</span><br><span class="line">-- -任意一个字符</span><br><span class="line">select * from emp where ename like &#x27;__A%&#x27; ;</span><br></pre></td></tr></table></figure>
</li>
<li><p>关于null的判断</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 关于null的判断：</span><br><span class="line">select * from emp where comm is null;</span><br><span class="line">select * from emp where comm is not null;</span><br></pre></td></tr></table></figure>
</li>
<li><p>小括号的使用：因为不同运算符的优先级别不同，加括号为了可读性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 小括号的使用  ：因为不同的运算符的优先级别不同，加括号为了可读性</span><br><span class="line">select * from emp where job = &#x27;SALESMAN&#x27; or job = &#x27;CLERK&#x27; and sal &gt;=1500; -- 先and再or  and &gt; or</span><br><span class="line">select * from emp where job = &#x27;SALESMAN&#x27; or (job = &#x27;CLERK&#x27; and sal &gt;=1500); </span><br><span class="line">select * from emp where (job = &#x27;SALESMAN&#x27; or job = &#x27;CLERK&#x27;) and sal &gt;=1500;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-3-函数"><a href="#2-3-函数" class="headerlink" title="2.3 函数"></a>2.3 函数</h3><p><em><strong>除了多行函数（max,min,count,sum,avg），都是单行函数</strong></em></p>
<h4 id="单行函数"><a href="#单行函数" class="headerlink" title="- 单行函数"></a>- 单行函数</h4><h5 id="1-字符串函数"><a href="#1-字符串函数" class="headerlink" title="1. 字符串函数"></a>1. 字符串函数</h5><table>
<thead>
<tr>
<th><strong>函数</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td>CONCAT(str1, str2, ···, strn)</td>
<td>将str1、str2···strn拼接成一个新的字符串</td>
</tr>
<tr>
<td>INSERT(str, index, n,  newstr)</td>
<td>将字符串str从第index位置开始的n个字符替换成字符串newstr</td>
</tr>
<tr>
<td>LENGTH(str)</td>
<td>获取字符串str的长度</td>
</tr>
<tr>
<td>LOWER(str)</td>
<td>将字符串str中的每个字符转换为小写</td>
</tr>
<tr>
<td>UPPER(str)</td>
<td>将字符串str中的每个字符转换为大写</td>
</tr>
<tr>
<td>LEFT(str, n)</td>
<td>获取字符串str最左边的n个字符</td>
</tr>
<tr>
<td>RIGHT(str, n)</td>
<td>获取字符串str最右边的n个字符</td>
</tr>
<tr>
<td>LPAD(str, n, pad)</td>
<td>使用字符串pad在str的最左边进行填充，直到长度为n个字符为止</td>
</tr>
<tr>
<td>RPAD(str, n, pad)</td>
<td>使用字符串pad在str的最右边进行填充，直到长度为n个字符为止</td>
</tr>
<tr>
<td>LTRIM(str)</td>
<td>去除字符串str左侧的空格</td>
</tr>
<tr>
<td>RTRIM(str)</td>
<td>去除字符串str右侧的空格</td>
</tr>
<tr>
<td>TRIM(str)</td>
<td>去除字符串str左右两侧的空格</td>
</tr>
<tr>
<td>REPLACE(str,oldstr,newstr)</td>
<td>用字符串newstr替换字符串str中所有的子字符串oldstr</td>
</tr>
<tr>
<td>REVERSE(str)</td>
<td>将字符串str中的字符逆序</td>
</tr>
<tr>
<td>STRCMP(str1,  str2)</td>
<td>比较字符串str1和str2的大小</td>
</tr>
<tr>
<td>SUBSTRING(str,index,n)</td>
<td>获取从字符串str的index位置开始的n个字符</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 1.字符串函数</span><br><span class="line">select ename,length(ename),substring(ename,2,3) from emp;</span><br><span class="line">-- substring字符串截取，2:从字符下标为2开始，3：截取长度3    （下标从1开始）</span><br></pre></td></tr></table></figure>

<p>显示结果：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210630210116.png" alt="image-20210630210115889" style="zoom:50%;" />



<h5 id="2-数值函数"><a href="#2-数值函数" class="headerlink" title="2. 数值函数"></a>2. 数值函数</h5><table>
<thead>
<tr>
<th align="left"><strong>函数</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left">ABS(num)</td>
<td>返回num的绝对值</td>
</tr>
<tr>
<td align="left">CEIL(num)</td>
<td>返回大于num的最小整数（向上取整）</td>
</tr>
<tr>
<td align="left">FLOOR(num)</td>
<td>返回小于num的最大整数（向下取整）</td>
</tr>
<tr>
<td align="left">MOD(num1, num2)</td>
<td>返回num1&#x2F;num2的余数（取模）</td>
</tr>
<tr>
<td align="left">PI()</td>
<td>返回圆周率的值</td>
</tr>
<tr>
<td align="left">POW(num,n)&#x2F;POWER(num,  n)</td>
<td>返回num的n次方</td>
</tr>
<tr>
<td align="left">RAND(num)</td>
<td>返回0~1之间的随机数</td>
</tr>
<tr>
<td align="left">ROUND(num, n)</td>
<td>返回x四舍五入后的值，该值保留到小数点后n位</td>
</tr>
<tr>
<td align="left">TRUNCATE(num, n)</td>
<td>返回num被舍去至小数点后n位的值</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 2.数值函数</span><br><span class="line">select abs(-5),ceil(5.3),floor(5.9),round(3.14) from dual; -- dual实际就是一个伪表</span><br><span class="line">select abs(-5) 绝对值,ceil(5.3) 向上取整,floor(5.9) 向下取整,round(3.14) 四舍五入;  </span><br><span class="line">-- 如果没有where条件的话，from dual可以省略不写</span><br><span class="line">select ceil(sal) from emp;</span><br><span class="line">select 10/3,10%3,mod(10,3) ;</span><br></pre></td></tr></table></figure>

<p>显示结果：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210630210456.png" alt="image-20210630210456370" style="zoom:50%;" />



<h5 id="3-日期与时间函数"><a href="#3-日期与时间函数" class="headerlink" title="3. 日期与时间函数"></a>3. 日期与时间函数</h5><table>
<thead>
<tr>
<th><strong>函数</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td>CURDATE()</td>
<td>返回当前日期</td>
</tr>
<tr>
<td>CURTIME()</td>
<td>返回当前时间</td>
</tr>
<tr>
<td>NOW()</td>
<td>返回当前日期和时间</td>
</tr>
<tr>
<td>SYSDATE()</td>
<td>返回该函数执行时的日期和时间</td>
</tr>
<tr>
<td>DAYOFYEAR(date)</td>
<td>返回日期date为一年中的第几天</td>
</tr>
<tr>
<td>WEEK(date)&#x2F;WEEKOFYEAR(date)</td>
<td>返回日期date为一年中的第几周</td>
</tr>
<tr>
<td>DATE_FORMAT(date,  format)</td>
<td>返回按字符串format格式化后的日期date</td>
</tr>
<tr>
<td>DATE_ADD(date,  INTERVAL expr unit)    &#x2F;ADDDATE(date,  INTERVAL expr unit)</td>
<td>返回date加上一个时间间隔后的新时间值</td>
</tr>
<tr>
<td>DATE_SUB(date,  INTERVAL expr unit)    &#x2F;SUBDATE(date,  INTERVAL expr unit)</td>
<td>返回date减去一个时间间隔后的新时间值</td>
</tr>
<tr>
<td>DATEDIFF(date1,  date2)</td>
<td>返回起始日期date1与结束日期date2之间的间隔天数</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 3.日期与时间函数 </span><br><span class="line">select * from emp;</span><br><span class="line">select curdate(),curtime() ; -- curdate()年月日 curtime()时分秒</span><br><span class="line">select now(),sysdate(),sleep(3),now(),sysdate() from dual; -- now(),sysdate() 年月日时分秒</span><br><span class="line">insert into emp values (9999,&#x27;lili&#x27;,&#x27;SALASMAN&#x27;,7698,now(),1000,null,30);</span><br><span class="line">-- now()可以表示年月日时分秒，但是插入数据的时候还是要参照表的结构的</span><br><span class="line">desc emp;</span><br></pre></td></tr></table></figure>



<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210630223758.png" alt="image-20210630223758495" style="zoom:50%;" />

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210630223819.png" alt="image-20210630223819827" style="zoom:50%;" />

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210630223829.png" alt="image-20210630223829883" style="zoom:50%;" />

<h5 id="4-流程函数"><a href="#4-流程函数" class="headerlink" title="4. 流程函数"></a>4. 流程函数</h5><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210630224323.png" alt="image-20210630224323874" style="zoom:67%;" />

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">-- 4.流程函数</span><br><span class="line">-- if相关</span><br><span class="line">select empno,ename,sal,if(sal&gt;=2500,&#x27;高薪&#x27;,&#x27;底薪&#x27;) as &#x27;薪资等级&#x27; from emp; -- if-else 双分支结构</span><br><span class="line">select empno,ename,sal,comm,sal+ifnull(comm,0) from emp; -- 如果comm是null，那么取值为0 -- 单分支</span><br><span class="line">select nullif(1,1),nullif(1,2) from dual; --  如果value1等于value2，则返回null，否则返回value1  </span><br><span class="line">-- case相关：</span><br><span class="line">-- case等值判断</span><br><span class="line">select empno,ename,job,</span><br><span class="line">case job </span><br><span class="line"> when &#x27;CLERK&#x27; then &#x27;店员&#x27;</span><br><span class="line"> when &#x27;SALESMAN&#x27;  then &#x27;销售&#x27;</span><br><span class="line"> when &#x27;MANAGER&#x27; then &#x27;经理&#x27;</span><br><span class="line"> else &#x27;其他&#x27;</span><br><span class="line">end &#x27;岗位&#x27;,</span><br><span class="line">sal from emp;</span><br><span class="line">-- case区间判断:</span><br><span class="line">select empno,ename,sal,</span><br><span class="line">case </span><br><span class="line"> when sal&lt;=1000 then &#x27;A&#x27;</span><br><span class="line"> when sal&lt;=2000 then &#x27;B&#x27;</span><br><span class="line"> when sal&lt;=3000 then &#x27;C&#x27;</span><br><span class="line"> else &#x27;D&#x27;</span><br><span class="line">end &#x27;工资等级&#x27;,</span><br><span class="line">deptno from emp;</span><br><span class="line">from emp;</span><br></pre></td></tr></table></figure>



<h5 id="5-JSON函数"><a href="#5-JSON函数" class="headerlink" title="5. JSON函数"></a>5. JSON函数</h5><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210630224430.png" alt="image-20210630224430595" style="zoom:67%;" />



<h5 id="6-其他函数"><a href="#6-其他函数" class="headerlink" title="6. 其他函数"></a>6. 其他函数</h5><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210630224453.png" alt="image-20210630224453894" style="zoom:67%;" />

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> -- 6.其他函数</span><br><span class="line">select database(),user(),version() from dual;</span><br></pre></td></tr></table></figure>



<h4 id="多行函数"><a href="#多行函数" class="headerlink" title="- 多行函数"></a>- 多行函数</h4><p>对一组数据进行运算，针对一组数据（多行记录）只返回一个结果，也称<strong>分组函数</strong></p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210630224611.png" alt="image-20210630224611608" style="zoom: 67%;" />

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-- 多行函数：</span><br><span class="line">select max(sal),min(sal),count(sal),sum(sal),sum(sal)/count(sal),avg(sal) from emp;</span><br><span class="line">select * from emp;</span><br><span class="line">-- 多行函数自动忽略null值</span><br><span class="line">select max(comm),min(comm),count(comm),sum(comm),sum(comm)/count(comm),avg(comm) from emp;</span><br><span class="line">-- max(),min(),count()针对所有类型   sum(),avg() 只针对数值型类型有效</span><br><span class="line">select max(ename),min(ename),count(ename),sum(ename),avg(ename) from emp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- count --计数   </span><br><span class="line">-- 统计表的记录数：方式1：</span><br><span class="line">select * from emp;</span><br><span class="line">select count(ename) from emp;</span><br><span class="line">select count(*) from emp;</span><br><span class="line">-- 统计表的记录数：方式2</span><br><span class="line">select 1 from dual;</span><br><span class="line">select 1 from emp;</span><br><span class="line">select count(1) from emp;</span><br></pre></td></tr></table></figure>



<h3 id="2-4-分组与筛选"><a href="#2-4-分组与筛选" class="headerlink" title="2.4 分组与筛选"></a>2.4 分组与筛选</h3><h4 id="group-by-分组"><a href="#group-by-分组" class="headerlink" title="group by 分组"></a>group by 分组</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select * from emp;</span><br><span class="line">-- 统计各个部门的平均工资 </span><br><span class="line">select deptno,avg(sal) from emp; -- 字段和多行函数不可以同时使用</span><br><span class="line">select deptno,avg(sal) from emp group by deptno; -- 字段和多行函数不可以同时使用,除非这个字段属于分组</span><br><span class="line">select deptno,avg(sal) from emp group by deptno order by deptno desc;</span><br><span class="line">-- 统计各个岗位的平均工资 统计各个岗位的</span><br><span class="line">select job,avg(sal) from emp group by job;</span><br><span class="line">select job,lower(job),avg(sal) from emp group by job;</span><br></pre></td></tr></table></figure>

<h4 id="having-分组后筛选"><a href="#having-分组后筛选" class="headerlink" title="having 分组后筛选"></a>having 分组后筛选</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 统计各个部门的平均工资 ,只显示平均工资2000以上的  - 分组以后进行二次筛选 having</span><br><span class="line">select deptno,avg(sal) from emp group by deptno having avg(sal) &gt; 2000;</span><br><span class="line">select deptno,avg(sal) 平均工资 from emp group by deptno having 平均工资 &gt; 2000;</span><br><span class="line">select deptno,avg(sal) 平均工资 from emp group by deptno having 平均工资 &gt; 2000 order by deptno desc;</span><br></pre></td></tr></table></figure>

<p>where在分组前进行过滤的，having在分组后进行后滤。</p>
<p>对比实例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 对比实例：统计各个岗位的平均工资,除了MANAGER</span><br><span class="line">-- 方法1：</span><br><span class="line">select job,avg(sal) from emp where job != &#x27;MANAGER&#x27; group by job;</span><br><span class="line">-- 方法2：</span><br><span class="line">select job,avg(sal) from emp group by job having job != &#x27;MANAGER&#x27; ;</span><br><span class="line">-- where在分组前进行过滤的，having在分组后进行后滤。</span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><h4 id="1-select语句总结"><a href="#1-select语句总结" class="headerlink" title="[1] select语句总结"></a>[1] select语句总结</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select column, group_function(column) </span><br><span class="line">from table </span><br><span class="line">[where condition] </span><br><span class="line">[group by  group_by_expression] </span><br><span class="line">[having group_condition] </span><br><span class="line">[order by column]; </span><br></pre></td></tr></table></figure>

<p>注意：顺序固定，不可以改变顺序</p>
<h4 id="2-select语句的执行顺序"><a href="#2-select语句的执行顺序" class="headerlink" title="[2] select语句的执行顺序"></a>[2] select语句的执行顺序</h4><p>from — where — group  by —  select — having — order  by</p>
<h4 id="3-单表查询练习"><a href="#3-单表查询练习" class="headerlink" title="[3] 单表查询练习"></a>[3] 单表查询练习</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">-- 单表查询练习：</span><br><span class="line">-- 列出工资最小值小于2000的职位</span><br><span class="line">select job,min(sal)</span><br><span class="line">from emp</span><br><span class="line">group by job</span><br><span class="line">having min(sal) &lt; 2000;</span><br><span class="line">-- 列出平均工资大于1200元的部门和工作搭配组合</span><br><span class="line">select deptno,job,avg(sal)</span><br><span class="line">from emp</span><br><span class="line">group by deptno,job</span><br><span class="line">having avg(sal) &gt; 1200</span><br><span class="line">order by avg(sal);</span><br><span class="line">-- 统计[人数小于4的]部门的平均工资。 </span><br><span class="line">select deptno,count(ename),avg(sal) -- 这里可用 count(1)</span><br><span class="line">from emp</span><br><span class="line">group by deptno</span><br><span class="line">having count(ename) &lt; 4;</span><br><span class="line"></span><br><span class="line">-- 统计各部门的最高工资，排除最高工资小于3000的部门。</span><br><span class="line">select deptno,max(sal)</span><br><span class="line">from emp</span><br><span class="line">group by deptno</span><br><span class="line">having max(sal) &gt;= 3000;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="3-多表查询"><a href="#3-多表查询" class="headerlink" title="3.  多表查询"></a>3.  多表查询</h2><h3 id="3-1-交叉连接-cross-join"><a href="#3-1-交叉连接-cross-join" class="headerlink" title="3.1  交叉连接 cross join"></a>3.1  交叉连接 cross join</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from emp</span><br><span class="line">cross join dept;</span><br></pre></td></tr></table></figure>



<h3 id="3-2-自然连接-natural"><a href="#3-2-自然连接-natural" class="headerlink" title="3.2  自然连接 natural"></a>3.2  自然连接 natural</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">natural join dept;</span><br></pre></td></tr></table></figure>

<p>优点：自动匹配所有的同名列 ，同名列只显示一次，简单</p>
<p>缺点：查询字段的时候，没有指定字段对应的数据库表，效率低</p>
<p><strong>解决——指定表名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select emp.empno,emp.enaem,emp.sal,dept.dname,dept.loc,dept.deptno</span><br><span class="line">from emp</span><br><span class="line">natural join dept;</span><br></pre></td></tr></table></figure>

<p>缺点：表名太长 </p>
<p><strong>解决——起表名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select e.empno,e.ename,e.sal,d.dname,d.loc,d.deptno</span><br><span class="line">from emp e</span><br><span class="line">natural join dept d;</span><br></pre></td></tr></table></figure>

<p>缺点：会自动匹配所有表中同名的字段。有时候我们只需要部分相同的字段</p>
<h3 id="3-3-内连接-inner-join"><a href="#3-3-内连接-inner-join" class="headerlink" title="3.3 内连接 inner join"></a>3.3 内连接 inner join</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp e</span><br><span class="line">inner join dept d </span><br><span class="line">using(deptno); -- 同名字段才有效</span><br></pre></td></tr></table></figure>

<p>缺点：连接的表字段不同时using无法使用。</p>
<p>解决——<strong>使用on子句</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">inner join dept d -- 使用on的时候inner可以省略</span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>





<h3 id="3-4-外连接-outer-join"><a href="#3-4-外连接-outer-join" class="headerlink" title="3.4 外连接  outer  join"></a>3.4 外连接  outer  join</h3><ul>
<li>内连接只显示匹配的数据，例如一个部门没有员工就不会显示</li>
<li><strong>外连接可以显示不匹配的数据</strong></li>
<li>outer都可以省略的</li>
</ul>
<h5 id="左外连接"><a href="#左外连接" class="headerlink" title="左外连接"></a>左外连接</h5><p>左边的那个表的信息，即使不匹配也可以查看出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">left outer join dept d</span><br><span class="line">on e.deptno = d.deptno</span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701170246.png" alt="image-20210701170246009" style="zoom:67%;" />

<h5 id="右外连接"><a href="#右外连接" class="headerlink" title="右外连接"></a>右外连接</h5><p>右边的那个表的信息，即使不匹配也可以查看出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">right outer join dept d</span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701163643.png" alt="image-20210701163643122" style="zoom:67%;" />

<h5 id="全外连接"><a href="#全外连接" class="headerlink" title="全外连接"></a>全外连接</h5><p>这个语法在mysql里面不支持，oracle才支持</p>
<p>为了代替 可以取左外连接和右外连接的并集</p>
<h6 id="并集-union"><a href="#并集-union" class="headerlink" title="并集 union"></a>并集 union</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">left outer join dept d</span><br><span class="line">on e.deptno = d.deptno</span><br><span class="line">union -- 并集，不去重，效率低</span><br><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">right outer join dept d</span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701170831.png" alt="image-20210701170831388" style="zoom:67%;" />

<h6 id="union-all"><a href="#union-all" class="headerlink" title="union all"></a>union all</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">left outer join dept d</span><br><span class="line">on e.deptno = d.deptno</span><br><span class="line">union  all -- 不去重的并集， 效率高</span><br><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">right outer join dept d</span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701171121.png" alt="image-20210701171121236" style="zoom:67%;" />



<h3 id="3-5-三表查询"><a href="#3-5-三表查询" class="headerlink" title="3.5 三表查询"></a>3.5 三表查询</h3><p>案例：查询员工的编号、姓名、薪水、部门编号、部门名称、薪水等级</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">select * from emp;</span><br><span class="line">select * from dept;</span><br><span class="line">select * from salgrade；</span><br><span class="line"></span><br><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">right outer join dept d</span><br><span class="line">on e.deptno = d.deptno;</span><br><span class="line">-- 可以看做就是上面的结果是一张表，然后再和第三张表进行连接</span><br><span class="line">inner join salgrade s</span><br><span class="line">on e.sal between salgrade</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210701184545.png" alt="image-20210701184545238" style="zoom:67%;" />



<h3 id="3-6-自连接查询"><a href="#3-6-自连接查询" class="headerlink" title="3.6 自连接查询"></a>3.6 自连接查询</h3><p>相当于把本身表复制一份，本质与前面的连接没有区别</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-- 查询员工的编号、姓名、上级编号,上级的姓名</span><br><span class="line">select * from emp;</span><br><span class="line">select e1.empno 员工编号,e1.ename 员工姓名,e1.mgr 领导编号,e2.ename 员工领导姓名</span><br><span class="line">from emp e1</span><br><span class="line">inner join emp e2</span><br><span class="line">on e1.mgr = e2.empno;</span><br><span class="line">-- 左外连接：</span><br><span class="line">select e1.empno 员工编号,e1.ename 员工姓名,e1.mgr 领导编号,e2.ename 员工领导姓名</span><br><span class="line">from emp e1</span><br><span class="line">left outer join emp e2</span><br><span class="line">on e1.mgr = e2.empno;</span><br></pre></td></tr></table></figure>

<p>结果</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210702094750.png" alt="image-20210702094750390" style="zoom:67%;" />

<h3 id="补充：92语法的多表查询"><a href="#补充：92语法的多表查询" class="headerlink" title="补充：92语法的多表查询"></a>补充：92语法的多表查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">-- 查询员工的编号，员工姓名，薪水，员工部门编号，部门名称：</span><br><span class="line">select e.empno,e.ename,e.sal,e.deptno,d.dname</span><br><span class="line">from emp e,dept d</span><br><span class="line">-- 相当于99语法中的cross join ,出现笛卡尔积，没有意义</span><br><span class="line">select e.empno,e.ename,e.sal,e.deptno,d.dname</span><br><span class="line">from emp e,dept d</span><br><span class="line">where e.deptno = d.deptno;</span><br><span class="line">-- 相当于99语法中的natural join </span><br><span class="line">-- 查询员工的编号，员工姓名，薪水，员工部门编号，部门名称，查询出工资大于2000的员工</span><br><span class="line">select e.empno,e.ename,e.sal,e.deptno,d.dname</span><br><span class="line">from emp e,dept d</span><br><span class="line">where e.deptno = d.deptno and e.sal &gt; 2000;</span><br><span class="line">-- 查询员工的名字，岗位，上级编号，上级名称（自连接）：</span><br><span class="line">select e1.ename,e1.job,e1.mgr ,e2.ename </span><br><span class="line">from emp e1,emp e2</span><br><span class="line">where e1.mgr = e2.empno;</span><br><span class="line">-- 查询员工的编号、姓名、薪水、部门编号、部门名称、薪水等级</span><br><span class="line">select e.empno,e.ename,e.sal,e.deptno,d.dname,s.grade </span><br><span class="line">from emp e,dept d,salgrade s</span><br><span class="line">where e.deptno = d.deptno and e.sal &gt;= s.losal and e.sal &lt;= s.hisal;</span><br><span class="line">-- 总结：</span><br><span class="line">-- 1.92语法麻烦 </span><br><span class="line">-- 2.92语法中 表的连接条件 和  筛选条件  是放在一起的没有分开</span><br><span class="line">-- 3.99语法中提供了更多的查询连接类型：cross,natural,inner,outer </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="4-不相关子查询"><a href="#4-不相关子查询" class="headerlink" title="4. 不相关子查询"></a>4. 不相关子查询</h2><h3 id="引入-1"><a href="#引入-1" class="headerlink" title="引入"></a>引入</h3><p>要查询所有比“CLARK”工资高的员工的信息</p>
<p>需要两个命令而且第二个命令依托于第一个命令，会相互影响</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 命令一：查询clark的工资</span><br><span class="line">select sal from emp where ename = clark; -- 2450</span><br><span class="line">-- 命令二：查询所有比其工资高的员工信息</span><br><span class="line">select * from emp where sal &gt; 2450;</span><br></pre></td></tr></table></figure>

<p>子查询可以通过一个命令解决问题 !</p>
<h3 id="4-1-单行子查询"><a href="#4-1-单行子查询" class="headerlink" title="4.1  单行子查询"></a>4.1  单行子查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">-- 将上面两个命令合并</span><br><span class="line">-- 查询工资高于平均工资的雇员的名字和工资</span><br><span class="line">select ename,sal</span><br><span class="line">from emp</span><br><span class="line">where sal &gt; (select sal from emp where sal &gt; avg(sal));</span><br><span class="line"> </span><br><span class="line">-- 查询和CLARK同一部门且比他工资低的雇员的名字和工资</span><br><span class="line">select ename,sal</span><br><span class="line">from emp</span><br><span class="line">where deptno = (select deptno from emp where ename=&#x27;CLARK&#x27;) </span><br><span class="line">	  and </span><br><span class="line">	  sal &lt; (select sal from emp where ename=&#x27;CLARK&#x27; );</span><br><span class="line"></span><br><span class="line">-- 查询职务和SCOTT相同，比SCOTT雇佣时间早的雇员信息</span><br><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">where job = (select job from emp where ename=&#x27;SCOTT&#x27;)</span><br><span class="line">	  and</span><br><span class="line">	  hiredate &lt; (select hiredate from emp where ename=&#x27;SCOTT&#x27;);</span><br><span class="line">	  </span><br></pre></td></tr></table></figure>

<h3 id="4-2-多行子查询"><a href="#4-2-多行子查询" class="headerlink" title="4.2  多行子查询"></a>4.2  多行子查询</h3><p>子查询查出来的记录为多条：</p>
<h5 id="实例一"><a href="#实例一" class="headerlink" title="实例一"></a>实例一</h5><ul>
<li>查询部门20中职务同部门10的雇员一样的雇员信息。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 查询雇员信息</span><br><span class="line">select * from emp;</span><br><span class="line">-- 查询部门20中的雇员信息</span><br><span class="line">select * from emp where deptno = 20;-- CLERK,MANAGER,ANALYST</span><br><span class="line">-- 部门10的雇员的职务：</span><br><span class="line">select job from emp where deptno = 10; -- MANAGER,PRESIDENT,CLERK</span><br></pre></td></tr></table></figure>

<p>如果使用单行子查询，就会报错  -&gt;Subquery returns more than 1 row</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from emp </span><br><span class="line">where deptno = 20 </span><br><span class="line">and job in (select job from emp where deptno = 10)</span><br><span class="line">-- &gt; Subquery returns more than 1 row</span><br></pre></td></tr></table></figure>

<p>多行子查询可以解决</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from emp </span><br><span class="line">where deptno = 20 </span><br><span class="line">and job = any(select job from emp where deptno = 10) -- any</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="实例二-1"><a href="#实例二-1" class="headerlink" title="实例二"></a>实例二</h5><ul>
<li><p>查询工资比所有的“SALESMAN”都高的雇员的编号、名字和工资</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 查询雇员的编号、名字和工资</span><br><span class="line">select empno,ename,sal from emp</span><br><span class="line">-- “SALESMAN”的工资：</span><br><span class="line">select sal from emp where job = &#x27;SALESMAN&#x27;</span><br><span class="line">-- 查询工资比所有的“SALESMAN”都高的雇员的编号、名字和工资。</span><br><span class="line">-- 多行子查询：</span><br><span class="line">select empno,ename,sal </span><br><span class="line">from emp </span><br><span class="line">where sal &gt; all(select sal from emp where job = &#x27;SALESMAN&#x27;);</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 单行子查询：</span><br><span class="line">select empno,ename,sal </span><br><span class="line">from emp </span><br><span class="line">where sal &gt; (select max(sal) from emp where job = &#x27;SALESMAN&#x27;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="实例三-1"><a href="#实例三-1" class="headerlink" title="实例三"></a>实例三</h5><ul>
<li>查询工资低于任意一个“CLERK”的工资的雇员信息。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- 查询雇员信息</span><br><span class="line">select * from emp;</span><br><span class="line">-- 查询工资低于任意一个“CLERK”的工资的雇员信息</span><br><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">where sal &lt; any(select sal from emp where job = &#x27;CLERK&#x27;)</span><br><span class="line">and job != &#x27;CLERK&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 单行子查询：</span><br><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">where sal &lt; (select max(sal) from emp where job = &#x27;CLERK&#x27;)</span><br><span class="line">and job != &#x27;CLERK&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="5-相关子查询"><a href="#5-相关子查询" class="headerlink" title="5. 相关子查询"></a>5. 相关子查询</h2><h3 id="引入-2"><a href="#引入-2" class="headerlink" title="引入"></a>引入</h3><ul>
<li><p>不相关的子查询引入：<br>不相关的子查询：子查询可以独立运行，先运行子查询，再运行外查询。<br>相关子查询：子查询不可以独立运行，并且先运行外查询，再运行子查询</p>
</li>
<li><p>不相关的子查询优缺点：<br>好处：简单   功能强大（一些使用不相关子查询不能实现或者实现繁琐的子查询，可以使用相关子查询实现）<br>缺点：稍难理解</p>
</li>
</ul>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><ol>
<li><p>查询各个部门最高工资的员工</p>
<ul>
<li>不相关子查询</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select * from emp where deptno = 10 and sal = (select max(sal) from emp where deptnp = 10)</span><br><span class="line">union</span><br><span class="line">select * from emp where deptno = 20 and sal = (select max(sal) from emp where deptno = 20)</span><br><span class="line">union</span><br><span class="line">select * from emp where deptno = 30 and sal = (select max(sal) from emp where deptno = 30);</span><br></pre></td></tr></table></figure>

<p>太复杂了:unamused:</p>
<ul>
<li>相关子查询</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from emp e where sal = (select max(sal) from emp where deptno = e.deptno)</span><br></pre></td></tr></table></figure>

<p>简单多啦:happy:</p>
</li>
<li><p>查询工高于所在岗位的平均工资的那些员工</p>
<ul>
<li>不相关子查询</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from emp where job = &#x27;&#x27; and sal &gt;= (select avg(sal) from emp where job = &#x27;&#x27;)</span><br><span class="line">union ....</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>相关子查询</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from emp e where sal &gt;= (select avg(sal) from emp where job = e.job);</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="数据库对象"><a href="#数据库对象" class="headerlink" title="数据库对象"></a>数据库对象</h1><h2 id="1-事务"><a href="#1-事务" class="headerlink" title="1. 事务"></a>1. 事务</h2><p><strong>事务（Transaction）</strong>是用来维护数据库完整性的，它能够保证一系列的MySQL操作要么全部执行，要么全不执行。</p>
<p>eg1.<br>转账操作：A账户要转账给B账户，那么A账户上减少的钱数和B账户上增加的钱数必须一致，也就是说A账户的转出操作和B账户的转入操作要么全部执行，要么全不执行；如果其中一个操作出现异常而没有执行的话，就会导致账户A和账户B的转入转出金额不一致的情况，为而事实上这种情况是不允许发生的，所以为了防止这种情况的发生，需要使用事务处理。<br>eg2.<br>在淘宝购物下订单的时候，商家库存要减少，订单增加记录，付款我的账号少100元…操作要么全部执行，要么全不执行</p>
<h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p>事务（Transaction）指的是一个操作序列，该操作序列中的多个操作要么都做，要么都不做，是一个不可分割的工作单位，是数据库环境中的逻辑工作单位，由DBMS（数据库管理系统）中的事务管理子系统负责事务的处理。<br>目前常用的存储引擎有InnoDB（MySQL5.5以后默认的存储引擎）和MyISAM（MySQL5.5之前默认的存储引擎），其中InnoDB支持事务处理机制，而MyISAM不支持。</p>
<h4 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h4><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703110321.png" alt="image-20210703110320474" style="zoom: 50%;" />

<p>事务处理可以确保除非事务性序列内的所有操作都成功完成，否则不会永久更新面向数据的资源。通过将一组相关操作组合为一个要么全部成功要么全部失败的序列，可以简化错误恢复并使应用程序更加可靠。<br>但并不是所有的操作序列都可以称为事务，这是因为一个操作序列要成为事务，必须满足事务的原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）和持久性（Durability）。这四个特性简称为<strong>ACID特性。</strong></p>
<ol>
<li><strong>原子性</strong><br>原子是自然界最小的颗粒，具有不可再分的特性。事务中的所有操作可以看做一个原子，事务是应用中不可再分的最小的逻辑执行体。<br>使用事务对数据进行修改的操作序列，要么全部执行，要么全不执行。通常，某个事务中的操作都具有共同的目标，并且是相互依赖的。如果数据库系统只执行这些操作中的一部分，则可能会破坏事务的总体目标，而原子性消除了系统只处理部分操作的可能性。</li>
<li><strong>一致性</strong><br>一致性是指事务执行的结果必须使数据库从一个一致性状态，变到另一个一致性状态。当数据库中只包含事务成功提交的结果时，数据库处于一致性状态。一致性是通过原子性来保证的。<br>例如：在转账时，只有保证转出和转入的金额一致才能构成事务。也就是说事务发生前和发生后，数据的总额依然匹配。</li>
<li><strong>隔离性</strong><br>隔离性是指各个事务的执行互不干扰，任意一个事务的内部操作对其他并发的事务，都是隔离的。也就是说：并发执行的事务之间既不能看到对方的中间状态，也不能相互影响。<br>例如：在转账时，只有当A账户中的转出和B账户中转入操作都执行成功后才能看到A账户中的金额减少以及B账户中的金额增多。并且其他的事务对于转账操作的事务是不能产生任何影响的。</li>
<li><strong>持久性</strong><br>持久性指事务一旦提交，对数据所做的任何改变，都要记录到永久存储器中，通常是保存进物理数据库，即使数据库出现故障，提交的数据也应该能够恢复。但如果是由于外部原因导致的数据库故障，如硬盘被损坏，那么之前提交的数据则有可能会丢失。</li>
</ol>
<h5 id="实例：使用事务保证转账安全"><a href="#实例：使用事务保证转账安全" class="headerlink" title="实例：使用事务保证转账安全"></a>实例：使用事务保证转账安全</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-- 创建账户表：id\uname\balance</span><br><span class="line">create table account(</span><br><span class="line">        id int primary key auto_increment,</span><br><span class="line">        uname varchar(10) not null,</span><br><span class="line">        balance double</span><br><span class="line">);</span><br><span class="line">-- 查看账户表：</span><br><span class="line">select * from account;</span><br><span class="line">-- 在表中插入数据：</span><br><span class="line">insert into account values (null,&#x27;丽丽&#x27;,2000),(null,&#x27;小刚&#x27;,2000);</span><br><span class="line">-- 丽丽给小刚 转200元：</span><br><span class="line">update account set balance = balance - 200 where id = 1;</span><br><span class="line">update account set balance = balance + 200 where id = 2;</span><br><span class="line">-- 默认一个DML语句是一个事务，所以上面的操作执行了2个事务。</span><br><span class="line">update account set balance = balance - 200 where id = 1;</span><br><span class="line">update account set balance = balance2 + 200 where id = 2;</span><br></pre></td></tr></table></figure>

<p><strong>必须让上面的两个操作控制在一个事务中</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 手动开启事务：</span><br><span class="line">start transaction;</span><br><span class="line">-- 操作：</span><br><span class="line">update account set balance = balance - 200 where id = 1;</span><br><span class="line">update account set balance = balance + 200 where id = 2;</span><br><span class="line">-- 手动回滚：刚才执行的操作全部取消：</span><br><span class="line">rollback;</span><br><span class="line">-- 手动提交：</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>

<p>在<strong>回滚和提交</strong>之前，数据库中的数据都是操作的缓存中的数据，而不是数据库的真实数据</p>
<h3 id="事务并发问题"><a href="#事务并发问题" class="headerlink" title="事务并发问题"></a>事务并发问题</h3><h5 id="脏读（Dirty-read）"><a href="#脏读（Dirty-read）" class="headerlink" title="脏读（Dirty read）"></a>脏读（Dirty read）</h5><p>当一个事务正在访问数据并且对数据进行了修改，而这种修改还没有提交到数据库中，这时另外一个事务也访问了这个数据，然后使用了这个数据。因为这个数据是还没有提交的数据，那么另外一个事务读到的这个数据是“脏数据”，依据“脏数据”所做的操作可能是不正确的。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703111005.png" alt="image-20210703111005503" style="zoom:67%;" />

<h5 id="不可重复读-（Unrepeatableread）"><a href="#不可重复读-（Unrepeatableread）" class="headerlink" title="不可重复读 （Unrepeatableread）"></a>不可重复读 （Unrepeatableread）</h5><p>指在一个事务内多次读同一数据。在这个事务还没有结束时，另一个事务也访问该数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改导致第一个事务两次读取的数据可能不太一样。这就发生了在一个事务内两次读到的数据是不一样的情况，因此称为不可重复读。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703111018.png" alt="image-20210703111018492" style="zoom:67%;" />

<h5 id="幻读-（Phantom-read）"><a href="#幻读-（Phantom-read）" class="headerlink" title="幻读 （Phantom read）"></a>幻读 （Phantom read）</h5><p>幻读与不可重复读类似。它发生在一个事务（T1）读取了几行数据，接着另一个并发事务（T2）插入了一些数据时。在随后的查询中，第一个事务（T1）就会发现多了一些原本不存在的记录，就好像发生了幻觉一样，所以称为幻读。</p>
 <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703111036.png" alt="image-20210703111036154" style="zoom:67%;" />

<p><strong>不可重复度和幻读区别：</strong> </p>
<p>不可重复读的重点是修改，幻读的重点在于新增或者删除。解决不可重复读的问题只需锁住满足条件的行，解决幻读需要锁表 。</p>
<p>例1（同样的条件, 你读取过的数据, 再次读取出来发现值不一样了 ）：事务1中的A先生读取自己的工资为 1000的操作还没完成，事务2中的B先生就修改了A的工资为2000，导 致A再读自己的工资时工资变为 2000；这就是不可重复读。</p>
<p>例2（同样的条件, 第1次和第2次读出来的记录数不一样 ）：假某工资单表中工资大于3000的有4人，事务1读取了所有工资大于3000的人，共查到4条记录，这时事务2 又插入了一条工资大于3000的记录，事务1再次读取时查到的记录就变为了5条，这样就导致了幻读 </p>
<h3 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h3><p>​	事务的隔离级别用于决定如何控制并发用户读写数据的操作。数据库是允许多用户并发访问的，如果多个用户同时开启事务并对同一数据进行读写操作的话，有可能会出现脏读、不可重复读和幻读问题，所以MySQL中提供了四种隔离级别来解决上述问题。</p>
<p>​	从低到高依次为<strong>READ UNCOMMITTED、READ COMMITTED、REPEATABLE READ以及SERIALIZABLE</strong>，隔离级别越低，越能支持高并发的数据库操作。      </p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703142738.png" alt="image-20210703142738514" style="zoom:67%;" />                        

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 查看默认的事务隔离级别  MySQL默认的是repeatable read  </span><br><span class="line">select @@transaction_isolation;  </span><br><span class="line">-- 设置事务的隔离级别   （设置当前会话的隔离级别）</span><br><span class="line">set session transaction isolation level read uncommitted;  </span><br><span class="line">set session transaction isolation level read committed;  </span><br><span class="line">set session transaction isolation level repeatable read;  -- 默认的</span><br><span class="line">set session transaction isolation level serializable;  </span><br><span class="line">start transaction ;</span><br><span class="line">select * from account where id = 1;</span><br></pre></td></tr></table></figure>

<h5 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h5><p>（必须是两个事务都开始以后执行的操作才会影响）</p>
<ul>
<li><p>在read uncommitted的情况下，开始两个事务：</p>
<ul>
<li>事务一</li>
</ul>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703152258.png" alt="image-20210703145526739" style="zoom:67%;" />

<ul>
<li>事务二</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/MySQL/20210703152314.png" alt="image-20210703145443742"></p>
</li>
<li><p>事务一查询操作：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703152514.png" alt="image-20210703152514123" style="zoom:67%;" />


</li>
<li><p>事务二更新操作，且没提交</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703152552.png" alt="image-20210703152552191" style="zoom:67%;" />
</li>
<li><p>事务一再次查询：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703152939.png" alt="image-20210703152939898" style="zoom:67%;" />

<p>读到了在脏数据</p>
</li>
<li><p>如果设置为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set session transaction isolation level read committed;</span><br></pre></td></tr></table></figure>

<p>事务二就不会读到脏数据。</p>
</li>
</ul>
<h2 id="2-视图"><a href="#2-视图" class="headerlink" title="2. 视图"></a>2. 视图</h2><h4 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h4><p>视图（view）是一个从单张或多张基础数据表或其他视图中构建出来的虚拟表。同基础表一样，视图中也包含了一系列带有名称的列和行数据，但是数据库中只是存放视图的定义，也就是动态检索数据的查询语句，而并不存放视图中的数据，这些数据依旧存放于构建视图的基础表中，只有当用户使用视图是才去数据库请求相对应的数据，即视图中的数据是在引用视图时动态生成的。因此视图中的数据发生了变化，视图中相应的数据也会跟着改变。</p>
<p>PS：视图本质上就是：一个查询语句，是一个虚拟的表，不存在的表，你查看视图，其实就是查看视图对应的sql语句。</p>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><p>简化用户操作：视图可以使用户将注意力集中在所关心地数据上，而不需要关心数据表的结构、与其他表的关联条件以及查询条件等。</p>
<p>对机密数据提供安全保护：有了视图，就可以在设计数据库应用系统时，对不同的用户定义不同的视图，避免机密数据（如，敏感字段“salary”）出现在不应该看到这些数据的用户视图上。这样视图就自动提供了对机密数据的安全保护功能</p>
<h4 id="实例一：单表视图"><a href="#实例一：单表视图" class="headerlink" title="实例一：单表视图"></a>实例一：单表视图</h4><ul>
<li><p>创建&#x2F;替换单表视图：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 创建/替换单表视图：</span><br><span class="line">create or replace view myview01</span><br><span class="line">as</span><br><span class="line">select empno,ename,job,deptno </span><br><span class="line">from emp</span><br><span class="line">where deptno = 20</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看视图：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 查看视图：</span><br><span class="line">select * from myview01;</span><br></pre></td></tr></table></figure>
</li>
<li><p>向视图中插入满足条件的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 在视图中插入数据：</span><br><span class="line">insert into myview01 (empno,ename,job,deptno) values (9999,&#x27;lili&#x27;,&#x27;CLERK&#x27;,20);</span><br></pre></td></tr></table></figure>

<p>查看视图：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703161609.png" alt="image-20210703161609044" style="zoom:67%;" />
</li>
<li><p>向视图中插入不满足条件的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into myview01 (empno,ename,job,deptno) values (8888,&#x27;nana&#x27;,&#x27;CLERK&#x27;,30);</span><br></pre></td></tr></table></figure>

<p>查看原来的表，发现成功插进去了</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703161731.png" alt="image-20210703161731377" style="zoom:67%;" />
</li>
<li><p>解决上面问题：</p>
<p>需要加上<strong>check option</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 创建/替换单表视图：</span><br><span class="line">create or replace view myview01</span><br><span class="line">as</span><br><span class="line">select empno,ename,job,deptno </span><br><span class="line">from emp</span><br><span class="line">where deptno = 20</span><br><span class="line">with check option;</span><br></pre></td></tr></table></figure>

<p>这样不满足条件的数据就不会轻易被加进去：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703162005.png" alt="image-20210703162005163" style="zoom:67%;" /></li>
</ul>
<h4 id="实例二：多表视图"><a href="#实例二：多表视图" class="headerlink" title="实例二：多表视图"></a>实例二：多表视图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 创建/替换多表视图：</span><br><span class="line">create or replace view myview02</span><br><span class="line">as </span><br><span class="line">select e.empno,e.ename,e.sal,d.deptno,d.dname</span><br><span class="line">from emp e</span><br><span class="line">join dept d</span><br><span class="line">on e.deptno = d.deptno</span><br><span class="line">where sal &gt; 2000 ;</span><br><span class="line">select * from myview02;</span><br></pre></td></tr></table></figure>

<h4 id="实例三：统计视图"><a href="#实例三：统计视图" class="headerlink" title="实例三：统计视图"></a>实例三：统计视图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 创建统计视图：</span><br><span class="line">create or replace view myview03</span><br><span class="line">as</span><br><span class="line">select e.deptno,d.dname,avg(sal),min(sal),count(1)</span><br><span class="line">from emp e</span><br><span class="line">join dept d</span><br><span class="line">using(deptno)</span><br><span class="line">group by e.deptno ;</span><br><span class="line">select * from myview03;</span><br></pre></td></tr></table></figure>

<h4 id="实例四：基于视图的视图"><a href="#实例四：基于视图的视图" class="headerlink" title="实例四：基于视图的视图"></a>实例四：基于视图的视图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 创建基于视图的视图：</span><br><span class="line">create or replace view myview04</span><br><span class="line">as</span><br><span class="line">select * from myview03 where deptno = 20;</span><br><span class="line">select * from myview04;</span><br></pre></td></tr></table></figure>



<h2 id="3-存储过程"><a href="#3-存储过程" class="headerlink" title="3. 存储过程"></a>3. 存储过程</h2><h4 id="概念-2"><a href="#概念-2" class="headerlink" title="概念"></a>概念</h4><ul>
<li><p>通过前面章节的学习，我们已经知道SQL是一种非常便利的语言。从数据库抽取数据，或者对特定的数据集中更新时，都能通过简洁直观的代码实现。</p>
</li>
<li><p>但是这个所谓的“简洁”也是有限制，SQL基本是一个命令实现一个处理，是所谓的非程序语言。</p>
</li>
<li><p>在不能编写流程的情况下，所有的处理只能通过一个个命令来实现。当然，通过使用连接及子查询，即使使用SQL的单一命令也能实现一些高级的处理，但是，其局限性是显而易见的。例如，在SQL中就很难实现针对不同条件进行不同的处理以及循环等功能。</p>
</li>
<li><p>这个时候就出现了存储过程这个概念，简单地说，存储过程就是数据库中保存(Stored)的一系列SQL命令（Procedure）的集合。也可以将其看作相互之间有关系的SQL命令组织在一起形成的一个小程序。</p>
</li>
</ul>
<h4 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h4><ul>
<li>提高执行性能。存储过程执行效率之所高，在于普通的SQL语句，每次都会对语法分析，编译，执行，而存储过程只是在第一次执行语法分析，编译，执行，以后都是对结果进行调用。</li>
<li>可减轻网络负担。使用存储过程，复杂的数据库操作也可以在数据库服务器中完成。只需要从客户端(或应用程序)传递给数据库必要的参数就行，比起需要多次传递SQL命令本身，这大大减轻了网络负担。</li>
<li>可将数据库的处理黑匣子化。应用程序中完全不用考虑存储过程的内部详细处理，只需要知道调用哪个存储过程就可以了</li>
</ul>
<h4 id="实例-2"><a href="#实例-2" class="headerlink" title="实例"></a>实例</h4><ul>
<li><p>定义一个没有返回值的存储过程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-- 定义一个没有返回值 存储过程</span><br><span class="line">-- 实现：模糊查询操作：</span><br><span class="line">select * from emp where ename like &#x27;%A%&#x27;;</span><br><span class="line">create procedure mypro01(name varchar(10))</span><br><span class="line">begin</span><br><span class="line">        if name is null or name = &quot;&quot; then</span><br><span class="line">                select * from emp; -- 传入null，就查看全表</span><br><span class="line">        else</span><br><span class="line">    select * from emp where ename like concat(&#x27;%&#x27;,name,&#x27;%&#x27;); </span><br><span class="line">        end if;	</span><br><span class="line">end;</span><br><span class="line">-- 删除存储过程：</span><br><span class="line">drop procedure mypro01;</span><br><span class="line">-- 调用存储过程：</span><br><span class="line">call mypro01(null);</span><br><span class="line">call mypro01(&#x27;R&#x27;);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703171452.png" alt="image-20210703171452630" style="zoom: 50%;" />
</li>
<li><p>定义一个有返回值的存储过程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-- 定义一个有返回值的存储过程</span><br><span class="line">-- in 参数前面的in可以不写</span><br><span class="line">-- out </span><br><span class="line">-- found_rows() 是mysql定义的一个函数，作用返回查询结果的条数</span><br><span class="line">-- into </span><br><span class="line">create procedure mypro02 (in name varchar(10),out num int(4))</span><br><span class="line">begin </span><br><span class="line">		if name is null or name = &quot;&quot; then</span><br><span class="line">				select * from emp;</span><br><span class="line">		else </span><br><span class="line">				select * from emp where name like concat(&#x27;%&#x27;,name,&#x27;%&#x27;);</span><br><span class="line">		end if;</span><br><span class="line">		select found_rows() into num;</span><br><span class="line">end;</span><br><span class="line">-- 调用存储过程</span><br><span class="line">call mypro02(null,@num);</span><br><span class="line">select @num;</span><br><span class="line">call mypro02(&#x27;A&#x27;,@aaa); -- 传入的参数名不一定要一样</span><br><span class="line">select @aaa;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="MySQL/20210703191518.png" alt="image-20210703191518417" style="zoom:67%;" /></li>
</ul>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Sonia33</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://soniachen.com/2021/05/07/MySQL/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://soniachen.com/2021/05/07/MySQL/')">MySQL</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://soniachen.com/2021/05/07/MySQL/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=MySQL&amp;url=https://soniachen.com/2021/05/07/MySQL/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://soniachen.com" target="_blank">Sonia33's Blog</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/DataBase/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>DataBase<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/MySQL/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>MySQL<span class="tagsPageCount">2</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2021/06/07/JDBC/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">JDBC</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2021/06/07/JDBC/" title="JDBC"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2021-06-07</div><div class="title">JDBC</div></div></a></div><div><a href="/2022/05/10/mysql8%E9%A1%B9%E7%9B%AE%E8%BF%9E%E6%8E%A5%E5%87%BA%E9%94%99-%E7%AB%AF%E5%8F%A3%E4%B8%BA0/" title="mysql8项目连接出错&amp;端口为0"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-05-10</div><div class="title">mysql8项目连接出错&amp;端口为0</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description"></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%95%E5%85%A5"><span class="toc-number">1.</span> <span class="toc-text">引入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.1.</span> <span class="toc-text">1.数据库基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%95%B0%E6%8D%AE"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 数据库管理系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.4数据库应用程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E5%91%98"><span class="toc-number">1.1.5.</span> <span class="toc-text">1.5 数据库管理员</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-%E6%9C%80%E7%BB%88%E7%94%A8%E6%88%B7"><span class="toc-number">1.1.6.</span> <span class="toc-text">1.6 最终用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.1.7.</span> <span class="toc-text">1.7 数据库系统</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E5%88%97%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.</span> <span class="toc-text">2. 数据库表列类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%95%B4%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 整数类型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="toc-number">2.</span> <span class="toc-text">表的完整性约束</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%9D%9E%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">2.1.</span> <span class="toc-text">1. 非外键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%80%EF%BC%9A%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%BC%A0%E7%94%A8%E6%9D%A5%E5%AD%98%E5%82%A8%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E7%9A%84%E8%A1%A8"><span class="toc-number">2.1.0.0.1.</span> <span class="toc-text">实例一：建立一张用来存储学生信息的表</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%97%E7%BA%A7%E7%BA%A6%E6%9D%9F%E5%92%8C%E8%A1%A8%E7%BA%A7%E7%BA%A6%E6%9D%9F"><span class="toc-number">2.1.0.1.</span> <span class="toc-text">- 列级约束和表级约束</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%BA%8C"><span class="toc-number">2.1.0.1.1.</span> <span class="toc-text">实例二</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8%E4%B9%8B%E5%90%8E%E6%B7%BB%E5%8A%A0%E7%BA%A6%E6%9D%9F"><span class="toc-number">2.1.0.2.</span> <span class="toc-text">- 创建表之后添加约束</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%89"><span class="toc-number">2.1.0.2.1.</span> <span class="toc-text">实例三</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">2.2.</span> <span class="toc-text">2. 外键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E5%9B%9B"><span class="toc-number">2.2.0.0.1.</span> <span class="toc-text">实例四</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%96%E9%94%AE%E7%AD%96%E7%95%A5%EF%BC%9A"><span class="toc-number">2.2.0.1.</span> <span class="toc-text">外键策略：</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%AD%96%E7%95%A5%E4%B8%80%EF%BC%9Ano-action-%E4%B8%8D%E5%85%81%E8%AE%B8%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.0.1.0.1.</span> <span class="toc-text">策略一：no action 不允许操作</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%AD%96%E7%95%A5%E4%BA%8C%EF%BC%9A%E4%BD%BF%E7%94%A8cascade%E7%BA%A7%E8%81%94%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.0.1.0.2.</span> <span class="toc-text">策略二：使用cascade级联操作</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%AD%96%E7%95%A5%E4%B8%89%EF%BC%9Aset-null-%E7%BD%AE%E7%A9%BA%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.0.1.0.3.</span> <span class="toc-text">策略三：set null     置空操作</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DQL%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="toc-number">3.</span> <span class="toc-text">DQL查询操作*</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%B8%B8%E8%A7%81%E8%A1%A8%E7%9A%84%E5%87%86%E5%A4%87"><span class="toc-number">3.1.</span> <span class="toc-text">1. 常见表的准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%83%A8%E9%97%A8%E8%A1%A8-dept"><span class="toc-number">3.1.1.</span> <span class="toc-text">部门表(dept)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E8%A1%A8%EF%BC%88emp"><span class="toc-number">3.1.2.</span> <span class="toc-text">员工表（emp)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%96%AA%E8%B5%84%E7%99%BB%E8%AE%B0%E8%A1%A8-salgrade"><span class="toc-number">3.1.3.</span> <span class="toc-text">薪资登记表(salgrade)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%96%E9%87%91%E8%A1%A8-bonus"><span class="toc-number">3.1.4.</span> <span class="toc-text">奖金表(bonus)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C"><span class="toc-number">3.1.5.</span> <span class="toc-text">操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C-%E8%A1%A8%E6%A0%BC%E5%BD%A2%E5%BC%8F"><span class="toc-number">3.1.6.</span> <span class="toc-text">结果(表格形式)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.2.</span> <span class="toc-text">2.  单表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E7%AE%80%E5%8D%95%E7%9A%84SQL%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.2.1.</span> <span class="toc-text">2.1 简单的SQL查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-where%E5%AD%90%E5%8F%A5"><span class="toc-number">3.2.2.</span> <span class="toc-text">2.2 where子句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.3.</span> <span class="toc-text">2.3 函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.3.1.</span> <span class="toc-text">- 单行函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.3.1.1.</span> <span class="toc-text">1. 字符串函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.3.1.2.</span> <span class="toc-text">2. 数值函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.3.1.3.</span> <span class="toc-text">3. 日期与时间函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E6%B5%81%E7%A8%8B%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.3.1.4.</span> <span class="toc-text">4. 流程函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-JSON%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.3.1.5.</span> <span class="toc-text">5. JSON函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-%E5%85%B6%E4%BB%96%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.3.1.6.</span> <span class="toc-text">6. 其他函数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.3.2.</span> <span class="toc-text">- 多行函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%88%86%E7%BB%84%E4%B8%8E%E7%AD%9B%E9%80%89"><span class="toc-number">3.2.4.</span> <span class="toc-text">2.4 分组与筛选</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#group-by-%E5%88%86%E7%BB%84"><span class="toc-number">3.2.4.1.</span> <span class="toc-text">group by 分组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#having-%E5%88%86%E7%BB%84%E5%90%8E%E7%AD%9B%E9%80%89"><span class="toc-number">3.2.4.2.</span> <span class="toc-text">having 分组后筛选</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">3.2.5.</span> <span class="toc-text">总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-select%E8%AF%AD%E5%8F%A5%E6%80%BB%E7%BB%93"><span class="toc-number">3.2.5.1.</span> <span class="toc-text">[1] select语句总结</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-select%E8%AF%AD%E5%8F%A5%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-number">3.2.5.2.</span> <span class="toc-text">[2] select语句的执行顺序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2%E7%BB%83%E4%B9%A0"><span class="toc-number">3.2.5.3.</span> <span class="toc-text">[3] 单表查询练习</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.</span> <span class="toc-text">3.  多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E4%BA%A4%E5%8F%89%E8%BF%9E%E6%8E%A5-cross-join"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.1  交叉连接 cross join</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5-natural"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.2  自然连接 natural</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%86%85%E8%BF%9E%E6%8E%A5-inner-join"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.3 内连接 inner join</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E5%A4%96%E8%BF%9E%E6%8E%A5-outer-join"><span class="toc-number">3.3.4.</span> <span class="toc-text">3.4 外连接  outer  join</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B7%A6%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.3.4.0.1.</span> <span class="toc-text">左外连接</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.3.4.0.2.</span> <span class="toc-text">右外连接</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A8%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">3.3.4.0.3.</span> <span class="toc-text">全外连接</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%B9%B6%E9%9B%86-union"><span class="toc-number">3.3.4.0.3.1.</span> <span class="toc-text">并集 union</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#union-all"><span class="toc-number">3.3.4.0.3.2.</span> <span class="toc-text">union all</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E4%B8%89%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.5.</span> <span class="toc-text">3.5 三表查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-%E8%87%AA%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.6.</span> <span class="toc-text">3.6 自连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%EF%BC%9A92%E8%AF%AD%E6%B3%95%E7%9A%84%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.7.</span> <span class="toc-text">补充：92语法的多表查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E4%B8%8D%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.4.</span> <span class="toc-text">4. 不相关子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5-1"><span class="toc-number">3.4.1.</span> <span class="toc-text">引入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%8D%95%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.4.2.</span> <span class="toc-text">4.1  单行子查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E5%A4%9A%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.4.3.</span> <span class="toc-text">4.2  多行子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%80"><span class="toc-number">3.4.3.0.1.</span> <span class="toc-text">实例一</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%BA%8C-1"><span class="toc-number">3.4.3.0.2.</span> <span class="toc-text">实例二</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%89-1"><span class="toc-number">3.4.3.0.3.</span> <span class="toc-text">实例三</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.5.</span> <span class="toc-text">5. 相关子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5-2"><span class="toc-number">3.5.1.</span> <span class="toc-text">引入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-number">3.5.2.</span> <span class="toc-text">实例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.</span> <span class="toc-text">数据库对象</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BA%8B%E5%8A%A1"><span class="toc-number">4.1.</span> <span class="toc-text">1. 事务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-number">4.1.0.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E6%80%A7"><span class="toc-number">4.1.0.2.</span> <span class="toc-text">特性</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%EF%BC%9A%E4%BD%BF%E7%94%A8%E4%BA%8B%E5%8A%A1%E4%BF%9D%E8%AF%81%E8%BD%AC%E8%B4%A6%E5%AE%89%E5%85%A8"><span class="toc-number">4.1.0.2.1.</span> <span class="toc-text">实例：使用事务保证转账安全</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98"><span class="toc-number">4.1.1.</span> <span class="toc-text">事务并发问题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%84%8F%E8%AF%BB%EF%BC%88Dirty-read%EF%BC%89"><span class="toc-number">4.1.1.0.1.</span> <span class="toc-text">脏读（Dirty read）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB-%EF%BC%88Unrepeatableread%EF%BC%89"><span class="toc-number">4.1.1.0.2.</span> <span class="toc-text">不可重复读 （Unrepeatableread）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B9%BB%E8%AF%BB-%EF%BC%88Phantom-read%EF%BC%89"><span class="toc-number">4.1.1.0.3.</span> <span class="toc-text">幻读 （Phantom read）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-number">4.1.2.</span> <span class="toc-text">事务隔离级别</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-1"><span class="toc-number">4.1.2.0.1.</span> <span class="toc-text">实例</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%A7%86%E5%9B%BE"><span class="toc-number">4.2.</span> <span class="toc-text">2. 视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-1"><span class="toc-number">4.2.0.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E7%82%B9"><span class="toc-number">4.2.0.2.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%80%EF%BC%9A%E5%8D%95%E8%A1%A8%E8%A7%86%E5%9B%BE"><span class="toc-number">4.2.0.3.</span> <span class="toc-text">实例一：单表视图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%BA%8C%EF%BC%9A%E5%A4%9A%E8%A1%A8%E8%A7%86%E5%9B%BE"><span class="toc-number">4.2.0.4.</span> <span class="toc-text">实例二：多表视图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%89%EF%BC%9A%E7%BB%9F%E8%AE%A1%E8%A7%86%E5%9B%BE"><span class="toc-number">4.2.0.5.</span> <span class="toc-text">实例三：统计视图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E5%9B%9B%EF%BC%9A%E5%9F%BA%E4%BA%8E%E8%A7%86%E5%9B%BE%E7%9A%84%E8%A7%86%E5%9B%BE"><span class="toc-number">4.2.0.6.</span> <span class="toc-text">实例四：基于视图的视图</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">4.3.</span> <span class="toc-text">3. 存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-2"><span class="toc-number">4.3.0.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-1"><span class="toc-number">4.3.0.2.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-2"><span class="toc-number">4.3.0.3.</span> <span class="toc-text">实例</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/17/WEB3%20Day1%20%E2%80%94%E2%80%94%20BlockChain%20Basic%201/" title="WEB3 Day1 —— BlockChain Basic 1">WEB3 Day1 —— BlockChain Basic 1</a><time datetime="2025-06-17T06:26:18.000Z" title="发表于 2025-06-17 14:26:18">2025-06-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/05/16/%E5%88%86%E5%B8%83%E5%BC%8F%E7%AC%94%E8%AE%B0/" title="分布式笔记">分布式笔记</a><time datetime="2022-05-16T02:25:28.000Z" title="发表于 2022-05-16 10:25:28">2022-05-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/05/10/mysql8%E9%A1%B9%E7%9B%AE%E8%BF%9E%E6%8E%A5%E5%87%BA%E9%94%99-%E7%AB%AF%E5%8F%A3%E4%B8%BA0/" title="mysql8项目连接出错&amp;端口为0">mysql8项目连接出错&amp;端口为0</a><time datetime="2022-05-10T06:23:51.000Z" title="发表于 2022-05-10 14:23:51">2022-05-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/05/09/%E5%9B%9B%E6%9C%88%E9%9D%A2%E7%BB%8F/" title="四月面经">四月面经</a><time datetime="2022-05-09T02:01:20.000Z" title="发表于 2022-05-09 10:01:20">2022-05-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/05/06/Hexo-GitHub%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A22/" title="Hexo + GitHub搭建个人博客">Hexo + GitHub搭建个人博客</a><time datetime="2022-05-06T02:24:55.000Z" title="发表于 2022-05-06 10:24:55">2022-05-06</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="Sonia33" target="_blank">Sonia33</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">28</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">14</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/BlockChain/" style="font-size: 0.88rem;">BlockChain<sup>1</sup></a><a href="/tags/CSS/" style="font-size: 0.88rem;">CSS<sup>1</sup></a><a href="/tags/DataBase/" style="font-size: 0.88rem;">DataBase<sup>2</sup></a><a href="/tags/FastDFS/" style="font-size: 0.88rem;">FastDFS<sup>1</sup></a><a href="/tags/Git/" style="font-size: 0.88rem;">Git<sup>1</sup></a><a href="/tags/HTML/" style="font-size: 0.88rem;">HTML<sup>1</sup></a><a href="/tags/IO/" style="font-size: 0.88rem;">IO<sup>1</sup></a><a href="/tags/JDBC/" style="font-size: 0.88rem;">JDBC<sup>1</sup></a><a href="/tags/JQuery/" style="font-size: 0.88rem;">JQuery<sup>1</sup></a><a href="/tags/Java/" style="font-size: 0.88rem;">Java<sup>3</sup></a><a href="/tags/JavaScript/" style="font-size: 0.88rem;">JavaScript<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 0.88rem;">MySQL<sup>2</sup></a><a href="/tags/NoSQL/" style="font-size: 0.88rem;">NoSQL<sup>1</sup></a><a href="/tags/RabbitMQ/" style="font-size: 0.88rem;">RabbitMQ<sup>1</sup></a><a href="/tags/Redis/" style="font-size: 0.88rem;">Redis<sup>1</sup></a><a href="/tags/Zookeeper/" style="font-size: 0.88rem;">Zookeeper<sup>1</sup></a><a href="/tags/hexo/" style="font-size: 0.88rem;">hexo<sup>1</sup></a><a href="/tags/java/" style="font-size: 0.88rem;">java<sup>1</sup></a><a href="/tags/macOS/" style="font-size: 0.88rem;">macOS<sup>2</sup></a><a href="/tags/web/" style="font-size: 0.88rem;">web<sup>1</sup></a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 0.88rem;">分布式<sup>1</sup></a><a href="/tags/%E5%90%8E%E7%AB%AF/" style="font-size: 0.88rem;">后端<sup>1</sup></a><a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 0.88rem;">多线程<sup>1</sup></a><a href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" style="font-size: 0.88rem;">并发编程<sup>1</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 0.88rem;">测试<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 0.88rem;">网络<sup>1</sup></a><a href="/tags/%E8%B8%A9%E9%9B%B7/" style="font-size: 0.88rem;">踩雷<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Sonia33 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>