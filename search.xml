<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Twikoo评论系统的Cloudflare部署方案</title>
      <link href="/2025/06/17/Twikoo%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F%E7%9A%84Cloudflare%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88/"/>
      <url>/2025/06/17/Twikoo%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F%E7%9A%84Cloudflare%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88/</url>
      <cover>https://img.soniachen.com/blog/posts/2025/06/image-20250617191350846.png</cover>
      <date>Tue Jun 17 2025 18:39:18 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>Twikoo评论系统的Cloudflare部署方案</h1><p>Twikoo是一款简洁、安全且免费的静态网站评论系统，在提升网站互动性方面表现出色。通常，Twikoo可部署在诸如腾讯云开发环境、Vercel等平台，但借助Cloudflare进行部署，能极大改善冷启动延迟问题，实现快速加载，为用户带来更流畅的评论体验，同时利用Cloudflare强大的全球网络提升访问速度。以下为详细的Cloudflare部署Twikoo评论系统的步骤与要点。</p><h2 id="一、前期准备">一、前期准备</h2><p>在开始部署前，需提前准备好相关工具与资源：</p><ol><li><strong>Cloudflare账户</strong>：若尚未注册，前往<a href="https://www.cloudflare.com/">Cloudflare官网</a>完成注册流程。</li><li><strong>Node.js环境</strong>：确保本地开发环境安装了Node.js，可通过<a href="https://nodejs.org/">Node.js官网</a>下载并安装对应系统的最新版本，安装完成后，在命令行输入<code>node -v</code>验证是否安装成功及查看版本号。</li><li><strong>文本编辑器</strong>：推荐使用Visual Studio Code、Sublime Text等，方便进行代码编辑与配置文件修改。</li></ol><h2 id="二、安装依赖包">二、安装依赖包</h2><ol><li>首先，创建一个新的项目目录，用于存放Twikoo相关代码与配置文件，在命令行中进入该目录，执行以下命令安装项目依赖：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure><ol start="2"><li>由于Cloudflare Workers的免费套餐对捆绑包大小有严格的1MiB限制，部分与Cloudflare Workers的Node.js兼容性存在问题的包即便安装了也无法使用，为控制捆绑包大小，需手动删除这些包，在命令行中依次执行：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&quot;</span> &gt; node_modules/jsdom/lib/api.js</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&quot;</span> &gt; node_modules/tencentcloud-sdk-nodejs/tencentcloud/index.js</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&quot;</span> &gt; node_modules/nodemailer/lib/nodemailer.js</span><br></pre></td></tr></table></figure><p>上述命令会清空<code>jsdom</code>、<code>tencentcloud-sdk-nodejs</code>、<code>nodemailer</code>这三个包中特定文件的内容，使其不占用捆绑包空间，同时规避兼容性问题。</p><h2 id="三、登录Cloudflare账户">三、登录Cloudflare账户</h2><p>通过Wrangler工具登录Cloudflare账户，Wrangler是Cloudflare提供的用于管理Workers、D1数据库等资源的命令行工具，执行以下命令进行登录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx wrangler login</span><br></pre></td></tr></table></figure><p>运行该命令后，系统会自动打开浏览器，跳转到Cloudflare的授权页面，按照提示完成授权操作，授权成功后，Wrangler便与你的Cloudflare账户建立连接，后续可通过它对Cloudflare资源进行操作。</p><h2 id="四、创建Cloudflare-D1数据库并设置架构">四、创建Cloudflare D1数据库并设置架构</h2><ol><li>使用Wrangler创建名为<code>twikoo</code>的D1数据库，在命令行执行：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx wrangler d1 create twikoo</span><br></pre></td></tr></table></figure><p>执行此命令后，终端会输出数据库的相关信息，其中<code>database_name</code>和<code>database_id</code>这两行信息至关重要，需将其复制下来，用于后续配置。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;d1_databases&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;binding&quot;: &quot;DB&quot;,</span><br><span class="line">      &quot;database_name&quot;: &quot;twikoo&quot;,</span><br><span class="line">      &quot;database_id&quot;: &quot;56def18d-b46a-42c8-bc99-0214e58f9a54&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>打开项目目录下的<code>wrangler.toml</code>文件（若不存在，可手动创建），将刚刚复制的<code>database_name</code>和<code>database_id</code>粘贴进去，替换原有的对应值，使项目与创建的D1数据库建立关联。</li><li>为D1数据库设置架构，Twikoo项目中包含定义数据库表结构和初始数据的<code>schema.sql</code>文件，执行以下命令，将该架构应用到Cloudflare D1数据库：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx wrangler d1 execute twikoo --remote --file=./schema.sql</span><br></pre></td></tr></table></figure><p>此命令会远程连接到之前创建的<code>twikoo</code>数据库，并依据<code>schema.sql</code>文件的内容创建相应的表结构及可能的初始数据，确保数据库满足Twikoo评论系统的存储需求。</p><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617190614918.png" alt="image-20250617190614918" style="zoom:33%;" /><h2 id="五、创建Cloudflare-R2存储">五、创建Cloudflare R2存储</h2><p>Cloudflare R2可用于存储Twikoo评论系统相关的文件，如上传的图片等（尽管当前部署方案中对R2的使用存在一定限制，但创建步骤仍需完成），通过以下命令创建名为<code>twikoo</code>的R2存储桶：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx wrangler r2 bucket create twikoo</span><br></pre></td></tr></table></figure><p>创建完成后，找到<code>wrangler.toml</code>文件中<code>r2_public_url</code>字段，将其值更新为新创建的R2存储桶的域名，确保项目能正确访问R2存储资源。</p><p>[vars]<br>R2_PUBLIC_URL = “<a href="https://twikoo.soniachen.com">https://twikoo.soniachen.com</a>”</p><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617191350846.png" alt="image-20250617191350846" style="zoom:33%;" /><h2 id="六、部署Cloudflare-Worker">六、部署Cloudflare Worker</h2><p>完成上述配置后，即可将Twikoo评论系统部署到Cloudflare Workers，执行以下命令进行部署：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx wrangler deploy --minify</span><br></pre></td></tr></table></figure><p><code>--minify</code>参数用于对代码进行压缩，以进一步减小捆绑包大小，提升部署效率与性能。部署过程可能需要一些时间，完成后，命令行中会输出类似<code>https://twikoo-cloudflare.&lt;your username&gt;.workers.dev</code>的访问地址。若部署成功，在浏览器中访问该地址，应能看到类似于<code>&#123;&quot;code&quot;: 100, &quot;message&quot;: &quot;twikoo云函数运行正常，请参考https://twikoo.js.org/frontend.html完成前端的配置&quot;, &quot;version&quot;: &quot;1.6.33&quot;&#125;</code>的提示信息，这表明Twikoo的后端服务已在Cloudflare上成功部署。</p><h2 id="七、前端配置">七、前端配置</h2><ol><li>在博客或网站的前端代码中，找到需要添加评论功能的页面。若使用Twikoo官方提供的前端初始化代码，需将其中的<code>envId</code>字段值设置为第六步中得到的Cloudflare Worker访问地址（包含<code>https://</code>前缀）。例如：</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">twikoo.<span class="title function_">init</span>(&#123;</span><br><span class="line">    <span class="attr">envId</span>: <span class="string">&quot;https://twikoo-cloudflare.&lt;your username&gt;.workers.dev&quot;</span>,</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&quot;#tcomment&quot;</span>,</span><br><span class="line">    <span class="comment">// region: &#x27;ap-guangzhou&#x27;, // 环境地域，默认为ap-shanghai，如果您的环境地域不是上海，需传此参数</span></span><br><span class="line">    <span class="comment">// path: &#x27;window.location.pathname&#x27;, // 用于区分不同文章的自定义js路径，如果您的文章路径不是location.pathname，需传此参数</span></span><br><span class="line">    <span class="comment">// lang: &#x27;zh-CN&#x27;, // 用于手动设定评论区语言，支持的语言列表https://github.com/imaegoo/twikoo/blob/dev/src/js/utils/i18n/index.js</span></span><br><span class="line">    <span class="comment">// onCommentLoaded: function () &#123;</span></span><br><span class="line">    <span class="comment">//     console.log(&quot;评论加载或评论成功&quot;);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ol start="2"><li>确保前端页面包含用于显示评论区的HTML元素，其<code>id</code>需与上述代码中<code>el</code>字段指定的值一致（如<code>&lt;div id=&quot;tcomment&quot;&gt;&lt;/div&gt;</code>），这样Twikoo前端脚本才能正确渲染评论区。</li></ol><img src="/Users/tinachan/Library/Application%20Support/typora-user-images/image-20250617192932097.png" alt="image-20250617192932097" style="zoom:50%;" /><h2 id="八、配置邮件通知（可选）">八、配置邮件通知（可选）</h2><p>Twikoo支持在有新评论时发送邮件通知管理员，由于<code>nodemailer</code>包的兼容性问题，在Cloudflare Workers环境中，无法直接通过SMTP集成发送邮件，而是通过SendGrid的HTTPS API实现邮件通知功能，具体步骤如下：</p><ol><li>注册一个可用的SendGrid账户（SendGrid提供免费套餐，每天可发送多达100封邮件）或Mailchannels账户（每月免费3000封邮件），并在账户设置中创建一个API Key，用于后续验证身份。</li><li>在Twikoo的配置中设置相关邮件参数，找到配置文件中与邮件通知相关的部分，设置以下字段：</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sender_email</span>: <span class="string">&quot;发件人邮箱地址&quot;</span>, <span class="comment">// 需在SendGrid中进行验证</span></span><br><span class="line"><span class="attr">sender_name</span>: <span class="string">&quot;显示的发件人名称&quot;</span>,</span><br><span class="line"><span class="attr">smtp_service</span>: <span class="string">&quot;sendgrid&quot;</span>,</span><br><span class="line"><span class="attr">smtp_user</span>: <span class="string">&quot;提供任意非空值&quot;</span>,</span><br><span class="line"><span class="attr">smtp_pass</span>: <span class="string">&quot;之前创建的SendGrid API Key&quot;</span>,</span><br></pre></td></tr></table></figure><p>此外，还可根据需求设置其他配置值，以自定义通知邮件的外观和内容。完成设置后，在配置页面点击“发送测试邮件”按钮，检查邮件通知功能是否正常工作，同时需确保邮件提供商不会将收到的通知邮件归类为垃圾邮件。</p><h2 id="九、常见问题及解决方法">九、常见问题及解决方法</h2><ol><li><strong>捆绑包大小超限</strong>：若在部署时遇到捆绑包大小超过Cloudflare Workers免费套餐1MiB限制的问题，除了前文提到的删除特定包文件内容外，还可检查项目中是否引入了不必要的大型依赖，精简代码，减少不必要的资源加载。</li><li><strong>数据库连接问题</strong>：若出现无法连接到Cloudflare D1数据库的情况，首先确认<code>wrangler.toml</code>文件中<code>database_name</code>和<code>database_id</code>是否填写正确，其次检查网络连接是否正常，确保能访问Cloudflare的服务。</li><li><strong>前端评论区无法显示</strong>：前端评论区无法正常显示时，检查浏览器控制台是否有报错信息，可能是<code>envId</code>配置错误、前端脚本加载失败或HTML元素<code>id</code>不匹配等原因导致，根据具体错误提示进行排查修复。</li></ol><p>通过以上详细的Cloudflare部署方案，可将Twikoo评论系统高效地集成到网站中，利用Cloudflare的优质服务提升评论系统的性能与稳定性，为网站访客打造良好的互动交流环境。</p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> CloudFlare </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WEB3 Day2 —— BlockChain Basic 2</title>
      <link href="/2025/06/17/WEB3%20Day2%20%E2%80%94%E2%80%94%20BlockChain%20Basic%202/"/>
      <url>/2025/06/17/WEB3%20Day2%20%E2%80%94%E2%80%94%20BlockChain%20Basic%202/</url>
      <cover>https://img.soniachen.com/blog/posts/2025/06/image-20250617173555637.png</cover>
      <date>Tue Jun 17 2025 17:39:18 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>WBE3 DAY2 —— BlockChain Basics 2</h1><h2 id="Layer1">Layer1</h2><p>​blockChain的base layer，例如bitcoin、BNB chain、Solana,and Avalanche.</p><h2 id="Layer2">Layer2</h2><p>构建在L1区块链外部但是也与之连接的任何应用application。有各种类型，比如for example ChainLink(去中心化预言机网络) ，以及像The Graph(事件索引网络)。</p><h3 id="RollUp">RollUp</h3><p>是L2的扩容解决方案，通过将多笔交易打包成一笔来增加以太坊上的交易数量，从而降低gas费</p><h4 id="1-optimistic-rollups">1 optimistic rollups</h4><p>默认链下交易是有效的，操作者回提出rollup链的有效状态，在挑战期间内，其他的操作者可以通过计算欺诈证明来质疑潜在的欺诈交易。</p><h4 id="2-zero-knowledge-rollups">2 zero-knowledge rollups</h4><p>零知识证明， 使用有效性证明来验证交易的批次。 zk证明即有效性证明，</p><h4 id="3-witness">3 witness</h4><p>验证者通过检查zk证明来验证输出是否和预期匹配。 而这整个证明者(prover)用来展示输入满足zk证明中的数学方程的方案就是见证(witness).</p><h3 id="RollUp-stage-Rollup-发展阶段">RollUp stage (Rollup 发展阶段)</h3><h4 id="Stage-0">Stage 0</h4><p>在这个初始的阶段，RollUp的治理主要由<strong>运营方和安全委员会</strong>掌控，确保关键决策并且有可信的团体去专门监督（中心化的），此阶段的用户拥有退出机制，可以在七天内离开rollup，但是通常需要实体和运营方的操作进行结合。</p><h4 id="Stage-1">Stage 1</h4><p>中心化的治理演化为智能合约管理，当然安全委员会<strong>同时</strong>发挥作用。</p><p><strong>证明系统</strong>完全开始运作，支持<strong>去中心化</strong>的有效证明。</p><p><strong>退出机制</strong>也得到改进，用户可独立退出而无需运营方协调。</p><h4 id="Stage-2">Stage 2</h4><p>通过<strong>完全</strong>由智能合约管理的治理机制实现<strong>完全去中心化</strong>。</p><p><strong>无需</strong>运营方和安全委员会干预。</p><p>证明系统是无许可的，退出机制也完全去中心化。</p><h4 id="ZKSync-Risk-Analysis-风险分析">ZKSync Risk Analysis[风险分析]</h4><p><a href="https://l2beat.com/scaling/summary">https://l2beat.com/scaling/summary</a>  L2Beat摘要中可以查看各Rollup所处的stage</p><p>Risks那一列的饼图可以体现当前阶段的一些风险，例如ZkSync Era专属页面中：</p><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617173334249.png" alt="image-20250617173334249" style="zoom:33%;" /><ul><li><p><strong>Data Availability</strong>: refers to the ability to reconstruct the L2 state from L1 data, ensuring that anyone can verify and rebuild the L2 state if necessary.</p><p>能够从L1的数据中重建L2状态</p></li><li><p><strong>State Validation</strong>: involves verifying the legitimacy of a set of bundled transactions. For ZK Sync, this is done using zero-knowledge proofs through an algorithm known as PLONK (Permutations over Lagrange-bases for Oecumenical Noninteractive arguments of Knowledge).</p><p>涉及验证一组打包交易的合法性。</p></li><li><p><strong>Sequencer Failure</strong>: describes the ability to process transactions even if the sequencer is down. In ZK Sync, transactions can still be submitted to L1, though not necessarily enforced immediately.</p><p>排序器故障，描述了即使排序器宕机还能够处理交易的能力，这里黄色区块表示，在ZKsync中，交易仍然可以提交到L1，但不一定能够强制执行。</p><blockquote><p>排序器：是负责对打包的用户交易进行排序的操作方（运营商）</p><p>The sequencer is the operator responsible for <em>ordering</em> user transactions and often <em>batching</em> them before committing them to Layer 1.</p></blockquote></li><li><p><strong>Proposer Failure</strong>: describes the ability to process transactions even if the proposer is down. In this case, ZK Sync will halt all withdrawals and transactions executions.</p><p>提议者宕机但是可以处理交易的能力。在Zksync中回暂停所有的提款和交易执行。</p></li><li><p><strong>Exit Window</strong>: In the current ZK Sync stage, there is no window for exit during unwanted upgrades.</p><p>红色区块表示Zksync在非预期的升级时不存在退出窗口期。</p></li></ul><h2 id="First-Transaction-On-ZKSync">First Transaction On ZKSync</h2><p>chainList 官网搜索ZKsync sepolia</p><p><a href="https://chainlist.org/?search=zksync+sepolia&amp;testnets=true">https://chainlist.org/?search=zksync+sepolia&amp;testnets=true</a></p><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617173444316.png" alt="image-20250617173444316" style="zoom:50%;" /><p>进行connect</p><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617173504740.png" alt="image-20250617173504740" style="zoom: 25%;" /><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617173525324.png" alt="image-20250617173525324" style="zoom:25%;" /><p>在<a href="https://explorer.zksync.io/">zkSync官网的block explorer</a> 中，可搜索到自己的账户，查看交易详情</p><h3 id="如何获取测试网络的基金？">如何获取测试网络的基金？</h3><blockquote><p>📒 NOTE</p><p>Network Fauncets</p></blockquote><p>这里可以通过brige桥接源链和目标链来进行，也有两种方式，一种是lock和unlock 另一种是烧毁和铸造；</p><p>可能会有安全问题，但是基于ZkSync使用过程的经验来说，是比较安全的。</p><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617173555637.png" alt="image-20250617173555637" style="zoom:50%;" /><p>了解原理之后，我们在<a href="https://cloud.google.com/application/web3/faucet/ethereum/sepolia">推荐的fauncet</a>里获取我们的fund</p><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617173615481.png" alt="image-20250617173615481" style="zoom: 33%;" /><p>这里我recive失败了，重新找了其他funsets ，可以用回tenderly试试看</p><h2 id="Solidity">Solidity</h2><h3 id="Remix-IDE">Remix IDE</h3><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617173639681.png" alt="image-20250617173639681" style="zoom: 33%;" /><h3 id="first-solidity-program">first solidity program</h3><p>simpleStorge.sol</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity 0.8.19; // chose our solidity version </span><br><span class="line"></span><br><span class="line">contract SimpleStorage &#123;</span><br><span class="line">    uint256 public myFavoriteNumber; // 初始值就是0 而且是internal 也就是内部不可见的</span><br><span class="line"></span><br><span class="line">    function store(uint256 favoriteNumber) public &#123;</span><br><span class="line">        myFavoriteNumber = favoriteNumber;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Deployed contracts are the same as modifying the blockchain. Whenever we modify anything on the blockchain, it is actually done by sending a transaction. Therefore, deploying contracts will cost a gas fee.</p></blockquote><p>返回体函数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// view 可读不可写 pure 不可读不可写</span><br><span class="line">  function recive() public view returns (uint256) &#123;</span><br><span class="line">      return myFavoriteNumber;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>数组与结构</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">  // 数组</span><br><span class="line">  uint256[] public myFavoriteNumbers;</span><br><span class="line"></span><br><span class="line">  // 结构</span><br><span class="line">  struct Person &#123;</span><br><span class="line">      uint256 personNumber;</span><br><span class="line">      string name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Person public newPerson = Person(1, &#x27;jack&#x27;);</span><br><span class="line"></span><br><span class="line">  Person public myPerson;</span><br><span class="line"></span><br><span class="line">// 数组加结构</span><br><span class="line">  Person[] public myPersonArray;</span><br><span class="line"></span><br><span class="line">  function setPerson(string memory name, uint256 person_number) public &#123;</span><br><span class="line">      myPersonArray.push(Person(person_number,name));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity 0.8.19; // stating our version </span><br><span class="line"></span><br><span class="line">contract SimpleStorage &#123;</span><br><span class="line">    uint256 public myFavoriteNumber; // 初始值就是0 而且是internal 也就是内部不可见的</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // 数组</span><br><span class="line">    uint256[] public myFavoriteNumbers;</span><br><span class="line"></span><br><span class="line">    // 结构</span><br><span class="line">    struct Person &#123;</span><br><span class="line">        uint256 personNumber;</span><br><span class="line">        string name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Person public newPerson = Person(1, &#x27;jack&#x27;);</span><br><span class="line"></span><br><span class="line">    Person public myPerson;</span><br><span class="line"></span><br><span class="line">    Person[] public myPersonArray;</span><br><span class="line"></span><br><span class="line">    function setPerson(string memory name, uint256 person_number) public &#123;</span><br><span class="line">        myPerson = Person(person_number, name);</span><br><span class="line">        myPersonArray.push(myPerson);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function store(uint256 favoriteNumber) public &#123;// 存储</span><br><span class="line">        myFavoriteNumber = favoriteNumber;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // view 可读不可写 pure 不可读不可写</span><br><span class="line">    function recive() public view returns (uint256) &#123;</span><br><span class="line">        return myFavoriteNumber;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BlockChain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>从0到1:用Git+CloudFlare+PicGo+Typora+Hexo搭建个人博客全流程</title>
      <link href="/2025/06/17/%E4%BB%8E0%E5%88%B01-%E7%94%A8Git-CloudFlare-PicGo-Typora-Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E5%85%A8%E6%B5%81%E7%A8%8B/"/>
      <url>/2025/06/17/%E4%BB%8E0%E5%88%B01-%E7%94%A8Git-CloudFlare-PicGo-Typora-Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E5%85%A8%E6%B5%81%E7%A8%8B/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=98cfb754-85f9-1744-2519-49aeddb6743f</cover>
      <date>Tue Jun 17 2025 16:16:23 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>从 0 到 1：用 Git、CloudFlare、PicGo、Typora、Hexo 搭建个人博客全流程</h1><h2 id="一、前言">一、前言</h2><p>22年，我用 Hexo + Next 主题搭起第一个个人博客。三年后，随着图床需求升级、对博客风格有了新想法，我决定重构 —— 替换图床工具、更换主题，用 Git、CloudFlare、PicGo、Typora 配合 Hexo 重新搭建。这篇文章复盘从旧版迭代到全新上线的全过程，既是对自己折腾经历的记录，也希望给想优化博客的朋友一份实操参考。</p><h2 id="二、环境准备与工具选型">二、环境准备与工具选型</h2><h3 id="（一）核心工具简介">（一）核心工具简介</h3><ol><li><strong>Git</strong>：分布式版本控制系统，负责博客代码的版本管理与远程仓库同步，让博客部署、内容更新更高效。</li><li><strong>CloudFlare</strong>：提供 CDN 加速、DNS 解析、安全防护等功能，让博客访问更快、更稳定，还能隐藏真实服务器 IP 。</li><li><strong>PicGo</strong>：图床上传工具，写博客时本地图片能一键上传到图床，解决文章中图片存储与引用问题。</li><li><strong>Typora</strong>：简洁高效的 Markdown 编辑器，实时预览、语法简洁，专注内容创作。</li><li><strong>Hexo</strong>：静态博客生成框架，基于 Node.js，支持 Markdown 写作，能快速生成美观博客站点，部署灵活。</li></ol><h3 id="（二）环境安装">（二）环境安装</h3><ol><li><strong>Git 安装</strong>：<br>官网（<a href="https://git-scm.com/">https://git-scm.com/</a> ）下载对应系统版本，安装后通过 <code>git --version</code> 验证，看到版本号即成功。<br>配置用户信息：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;你的用户名&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;你的邮箱&quot;</span></span><br></pre></td></tr></table></figure></li><li><strong>Node.js 与 Hexo 安装</strong>（Hexo 依赖 Node.js ）：<br>Node.js 官网（<a href="https://nodejs.org/">https://nodejs.org/</a> ）下载 LTS 版本，安装后用 <code>node -v</code>、<code>npm -v</code> 验证。<br>全局安装 Hexo：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>验证 Hexo 安装：<code>hexo -v</code> 显示版本信息则成功。</li><li><strong>Typora 安装</strong>：官网（<a href="https://typora.io/">https://typora.io/</a> ）下载对应系统版本，按提示安装即可，简洁直观。</li><li><strong>PicGo 安装</strong>：官网（<a href="https://picgo.github.io/PicGo-Doc/">https://picgo.github.io/PicGo-Doc/</a> ）或应用商店下载，支持多平台，安装后配置图床（如 GitHub 图床、七牛云等，我用 GitHub 图床时需配置仓库、Token 等 ）。</li></ol><h2 id="三、Hexo-初始化与博客基础搭建">三、Hexo 初始化与博客基础搭建</h2><h3 id="（一）初始化-Hexo-项目">（一）初始化 Hexo 项目</h3><ol><li>创建博客目录（如 <code>my-blog</code> ），进入目录：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> my-blog &amp;&amp; <span class="built_in">cd</span> my-blog</span><br></pre></td></tr></table></figure></li><li>初始化 Hexo：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>执行后，目录会生成 Hexo 基础文件结构，包含 <code>_config.yml</code>（配置文件 ）、<code>source</code>（存放文章、资源 ）、<code>themes</code>（主题目录 ）等。</li></ol><h3 id="（二）主题选择与配置">（二）主题选择与配置</h3><ol><li><strong>主题下载</strong>：Hexo 官网（<a href="https://hexo.io/themes/">https://hexo.io/themes/</a> ）选心仪主题，比如我用的 <code>anzhiyu</code> 主题，克隆到 <code>themes</code> 目录：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/Anzhiyu/hexo-theme-anzhiyu.git themes/anzhiyu</span><br></pre></td></tr></table></figure></li><li><strong>主题配置</strong>：复制主题目录下的 <code>_config.yml</code> 到博客根目录，重命名为 <code>_config.anzhiyu.yml</code> ，修改基础配置（如站点标题、描述、头像、导航菜单等 ），让博客符合需求。</li></ol><h3 id="（三）本地预览博客">（三）本地预览博客</h3><p>执行以下命令，启动本地服务器：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br></pre></td></tr></table></figure><ul><li><code>hexo clean</code>：清理之前生成的静态文件。</li><li><code>hexo g</code>（<code>hexo generate</code> ）：生成静态博客文件到 <code>public</code> 目录。</li><li><code>hexo s</code>（<code>hexo server</code> ）：启动本地服务器，浏览器访问 <code>http://localhost:4000</code> ，就能看到初始博客页面。</li></ul><h2 id="四、内容创作与管理（Typora-PicGo-S3插件-CloudFlareR2存储桶-）">四、内容创作与管理（Typora + PicGo [S3插件] + CloudFlareR2存储桶 ）</h2><h3 id="一、Cloudflare-R2-存储桶创建与基础配置">一、Cloudflare R2 存储桶创建与基础配置</h3><h4 id="（一）登录-Cloudflare-控制台">（一）登录 Cloudflare 控制台</h4><ol><li>访问 <a href="https://dash.cloudflare.com">Cloudflare Dashboard</a> 并登录账户（若无账户需先注册）。</li><li>点击左侧菜单中的 <strong>R2</strong> 选项（若未显示，点击“更多产品”查找）。</li></ol><h4 id="（二）创建存储桶">（二）创建存储桶</h4><ol><li><p>点击 <strong>创建存储桶</strong> 按钮，进入创建流程：</p><ul><li><strong>存储桶名称</strong>：自定义（如 <code>blog-images</code>），需全局唯一（建议包含个人标识）。</li><li><strong>区域</strong>：选择 <code>自动</code>（Auto）以获得最佳分布，或手动指定区域（如 <code>亚洲 - 新加坡</code>）。</li><li><strong>访问控制</strong>：勾选 <strong>公开访问</strong>（Public access），允许匿名读取图片（若仅个人使用可跳过）。</li><li><strong>加密</strong>：默认启用服务器端加密（SSE），无需修改。</li></ul></li><li><p>点击 <strong>创建存储桶</strong>，等待约 10 秒完成创建。</p></li></ol><h4 id="（三）获取-API-访问凭证">（三）获取 API 访问凭证</h4><ol><li><p>进入 <strong>存储桶详情页</strong> → <strong>权限</strong> 标签页：</p><ul><li>点击 <strong>创建访问密钥</strong> 按钮（若提示需要创建密钥对，点击“创建”）。</li><li>记录生成的 <strong>Access Key ID</strong> 和 <strong>Secret Access Key</strong>（仅显示一次，需立即保存到安全位置）。</li></ul></li><li><p>复制存储桶端点（Endpoint）：</p><ul><li>存储桶详情页 → <strong>概述</strong> 标签页，找到 <strong>外部访问</strong> 中的端点地址（格式为 <code>https://&lt;账户ID&gt;.r2.cloudflarestorage.com</code>）。</li></ul></li></ol><h3 id="二、PicGo-配置-S3-插件对接-R2">二、PicGo 配置 S3 插件对接 R2</h3><h4 id="（一）安装-S3-插件">（一）安装 S3 插件</h4><ol><li>打开 PicGo 软件 → <strong>插件管理</strong> → 搜索 <code>s3</code> 并安装 <strong>PicGo-S3-Plugin</strong>（若已安装可跳过）。</li></ol><h4 id="（二）配置插件参数">（二）配置插件参数</h4><ol><li><p>进入 PicGo <strong>图床设置</strong> → 选择 <strong>S3</strong> 插件：</p><ul><li><strong>Bucket</strong>：填写创建的存储桶名称（如 <code>blog-images</code>）。</li><li><strong>Region</strong>：填 <code>auto</code>（R2 不区分传统区域）。</li><li><strong>Access Key ID</strong>：粘贴 Cloudflare 生成的 Access Key。</li><li><strong>Secret Access Key</strong>：粘贴对应的 Secret Key。</li><li><strong>Endpoint</strong>：粘贴存储桶端点（如 <code>https://abc123.r2.cloudflarestorage.com</code>）。</li><li><strong>Path</strong>：自定义图片存储路径前缀（如 <code>blog/</code>，可留空）。</li><li><strong>Custom Domain</strong>：填写自定义域名（如 <code>img.soniachen.com</code>，后续配置）。</li><li><strong>SSL</strong>：勾选（启用 HTTPS 访问）。</li></ul></li><li><p>点击 <strong>设为默认图床</strong>，并点击 <strong>确定</strong> 保存配置。</p></li></ol><h4 id="（三）测试上传">（三）测试上传</h4><ol><li>在 PicGo 主界面点击 <strong>上传图片</strong>，选择本地图片：<ul><li>若上传成功，下方会显示图片 URL（如 <code>https://img.soniachen.com/blog/test.jpg</code>）。</li></ul></li></ol><h3 id="三、绑定自定义域名（CDN-加速）">三、绑定自定义域名（CDN 加速）</h3><h4 id="（一）添加域名到-Cloudflare">（一）添加域名到 Cloudflare</h4><ol><li>登录 Cloudflare 控制台 → <strong>域名</strong> → <strong>添加域名</strong>：<ul><li>输入自定义域名（如 <code>img.soniachen.com</code>），点击 <strong>继续</strong>。</li><li>等待 Cloudflare 扫描 DNS 记录（约 1 - 5 分钟）。</li></ul></li></ol><h4 id="（二）配置-DNS-解析">（二）配置 DNS 解析</h4><ol><li>在域名管理界面 → <strong>DNS</strong> 标签页：<ul><li>添加一条 <strong>CNAME</strong> 记录：<ul><li><strong>名称</strong>：填 <code>@</code> 或 <code>img</code>（根据域名结构）。</li><li><strong>目标</strong>：填存储桶端点（如 <code>abc123.r2.cloudflarestorage.com</code>）。</li><li><strong>代理状态</strong>：选择 <strong>DNS Only</strong>（仅解析，不启用 CDN）或 <strong>Proxied</strong>（启用 CDN 加速）。</li></ul></li></ul></li></ol><h4 id="（三）配置-R2-自定义域名">（三）配置 R2 自定义域名</h4><ol><li>回到 R2 存储桶 → <strong>域名</strong> 标签页：<ul><li>点击 <strong>添加自定义域名</strong>，输入已添加到 Cloudflare 的域名（如 <code>img.soniachen.com</code>）。</li><li>Cloudflare 会自动生成 SSL 证书（等待约 10 分钟生效）。</li></ul></li></ol><h3 id="四、Hexo-集成-R2-图床（可选）">四、Hexo 集成 R2 图床（可选）</h3><h4 id="（一）安装-Hexo-插件">（一）安装 Hexo 插件</h4><ol><li>在 Hexo 项目根目录执行：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-s3-image --save</span><br></pre></td></tr></table></figure></li></ol><h4 id="（二）配置插件">（二）配置插件</h4><ol><li>修改 <code>_config.yml</code> 添加以下配置：<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">s3_image:</span></span><br><span class="line">  <span class="attr">bucket:</span> <span class="string">blog-images</span>          <span class="comment"># 存储桶名称</span></span><br><span class="line">  <span class="attr">region:</span> <span class="string">auto</span>                 <span class="comment"># 区域</span></span><br><span class="line">  <span class="attr">accessKeyId:</span> <span class="string">your-access-key</span> <span class="comment"># 替换为实际 Access Key</span></span><br><span class="line">  <span class="attr">secretAccessKey:</span> <span class="string">your-secret-key</span> <span class="comment"># 替换为实际 Secret Key</span></span><br><span class="line">  <span class="attr">endpoint:</span> <span class="string">https://abc123.r2.cloudflarestorage.com</span> <span class="comment"># 端点</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">blog/</span>                  <span class="comment"># 存储路径</span></span><br><span class="line">  <span class="attr">customUrl:</span> <span class="string">https://img.soniachen.com</span> <span class="comment"># 自定义域名</span></span><br><span class="line">  <span class="attr">public:</span> <span class="literal">true</span>                 <span class="comment"># 公开访问</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="（三）使用方式">（三）使用方式</h4><ol><li>在 Markdown 中插入图片时，直接使用本地路径：<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">示例图片</span>](<span class="link">/img/test.jpg</span>)</span><br></pre></td></tr></table></figure></li><li>Hexo 生成时会自动上传图片到 R2，并替换为在线链接。</li></ol><h3 id="五、常见问题与解决方案">五、常见问题与解决方案</h3><h4 id="（一）403-Forbidden-错误">（一）403 Forbidden 错误</h4><ul><li><strong>原因</strong>：存储桶未启用公开访问或访问密钥错误。</li><li><strong>解决</strong>：<ol><li>存储桶 → <strong>权限</strong> → 确保 <strong>公开访问</strong> 已启用。</li><li>重新核对 Access Key 和 Secret Key 是否正确。</li></ol></li></ul><h4 id="（二）图片链接返回-404">（二）图片链接返回 404</h4><ul><li><strong>原因</strong>：域名解析错误或路径配置错误。</li><li><strong>解决</strong>：<ol><li>检查 DNS 解析是否生效（可通过 <code>ping img.soniachen.com</code> 验证）。</li><li>确认 PicGo 中 <code>Custom Domain</code> 与 Cloudflare 域名一致。</li></ol></li></ul><h4 id="（三）上传失败（网络错误）">（三）上传失败（网络错误）</h4><ul><li><strong>原因</strong>：Endpoint 填写错误或网络阻断。</li><li><strong>解决</strong>：<ol><li>存储桶详情页复制端点，确保无多余字符（如末尾空格）。</li><li>尝试更换网络环境（如关闭 VPN）。</li></ol></li></ul><h3 id="六、进阶优化：缓存与安全">六、进阶优化：缓存与安全</h3><h4 id="（一）设置缓存策略">（一）设置缓存策略</h4><ol><li>Cloudflare 域名 → <strong>规则</strong> → <strong>页面规则</strong>：<ul><li>添加规则 <code>https://img.soniachen.com/*</code>，设置 <strong>缓存级别</strong> 为 <strong>缓存所有</strong>，<strong>TTL</strong> 为 1 天（根据需求调整）。</li></ul></li></ol><h4 id="（二）启用防盗链">（二）启用防盗链</h4><ol><li>存储桶 → <strong>权限</strong> → <strong>添加 Origin Access</strong>：<ul><li>配置允许访问的域名（如 <code>soniachen.com</code>），拒绝其他域名盗用图片。</li></ul></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/opt/homebrew/bin/node /opt/homebrew/bin/picgo upload</span><br></pre></td></tr></table></figure><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617162011339.png" alt="image-20250617162011339" style="zoom:50%;" /><h2 id="五、博客部署（Git-GitHub-Pages-CloudFlare-）">五、博客部署（Git + GitHub Pages + CloudFlare ）</h2><h3 id="（一）GitHub-仓库准备">（一）GitHub 仓库准备</h3><ol><li>GitHub 新建仓库，命名规则：若为用户/组织页，仓库名填 <code>你的GitHub用户名.github.io</code>（如 <code>soniachan33.github.io</code> ）；若为项目页，仓库名自定义（后续需配置路径 ）。</li><li>仓库创建后，复制仓库的 Git 地址（SSH 或 HTTPS 形式 ）。</li></ol><h3 id="（二）Hexo-部署配置">（二）Hexo 部署配置</h3><p>修改博客根目录 <code>_config.yml</code> 的 <code>deploy</code> 配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:你的GitHub用户名/你的仓库名.git</span>  <span class="comment"># 替换为实际仓库地址</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span>  <span class="comment"># 部署分支，GitHub Pages 常用 main 或 gh-pages</span></span><br></pre></td></tr></table></figure><p>安装 <code>hexo-deployer-git</code> 插件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><h3 id="（三）部署到-GitHub-Pages">（三）部署到 GitHub Pages</h3><p>执行部署命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure><p>Hexo 会把生成的静态文件（<code>public</code> 目录内容 ）推送到 GitHub 仓库对应分支，稍等片刻，访问 <code>https://你的GitHub用户名.github.io</code>（或项目页地址 ），能看到线上博客。</p><h3 id="（四）CloudFlare-加速与配置">（四）CloudFlare 加速与配置</h3><ol><li><strong>添加站点</strong>：CloudFlare 官网（<a href="https://www.cloudflare.com/">https://www.cloudflare.com/</a> ）注册登录，添加站点（输入博客域名，若用 GitHub Pages 默认域名可跳过，若自定义域名需提前备案、解析 ）。</li><li><strong>DNS 解析设置</strong>：添加 DNS 记录，将域名解析到 GitHub Pages 对应的 IP（或直接解析到 <code>你的GitHub用户名.github.io</code>  ），让 CloudFlare 接管 DNS 解析。</li><li><strong>CDN 与安全配置</strong>：开启 CDN 加速，优化缓存、压缩等设置；启用安全防护（如 DDoS 防护、防火墙规则 ），提升博客访问速度与安全性。</li><li><strong>自定义域名（可选）</strong>：若用自定义域名（如 <code>soniachen.com</code>  ），在 GitHub Pages 仓库设置中填自定义域名，同时在 CloudFlare 配置域名解析、SSL 证书（推荐开启 Full 或 Strict 模式 ），确保 <code>HTTPS</code> 访问正常。</li></ol><h2 id="六、博客优化与维护">六、博客优化与维护</h2><h3 id="（一）SEO-优化">（一）SEO 优化</h3><ol><li><strong>站点地图（Sitemap ）</strong>：安装 <code>hexo-generator-sitemap</code> 插件，生成站点地图：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-sitemap --save</span><br></pre></td></tr></table></figure>修改 <code>_config.yml</code> 配置：<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sitemap:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">sitemap.xml</span></span><br></pre></td></tr></table></figure>部署后，通过 <code>https://你的域名/sitemap.xml</code> 访问，提交给百度、必应、谷歌等搜索引擎，助力收录。</li><li><strong>Meta 标签与关键词</strong>：在主题配置或文章 Front-matter 中，设置标题、描述、关键词，让搜索引擎更好理解内容，提升搜索排名。</li></ol><h3 id="（二）持续更新与备份">（二）持续更新与备份</h3><ol><li><strong>内容更新</strong>：用 Typora 写新文章，存到 <code>source/_posts</code> 目录，执行 <code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code> 部署，持续输出优质内容。</li><li><strong>版本备份</strong>：借助 Git，定期提交代码到 GitHub 仓库，记录博客配置、文章修改历史，方便回退与协同。</li></ol><h2 id="七、遇到的问题与解决（结合之前的疑问）">七、遇到的问题与解决（结合之前的疑问）</h2><h3 id="（一）GitHub-Pages-部署后-404">（一）GitHub Pages 部署后 404</h3><ul><li><strong>原因</strong>：部署分支与 GitHub Pages 设置不一致、<code>root</code> 配置错误、<code>CNAME</code> 文件丢失等。</li><li><strong>解决</strong>：确保 <code>_config.yml</code> 中 <code>deploy</code> 分支正确，用户页 <code>root</code> 设为 <code>/</code> ；在 Hexo 项目 <code>source</code> 目录添加 <code>CNAME</code> 文件（填自定义域名 ），重新部署。</li></ul><h3 id="（二）CloudFlare-部署后域名配置清空">（二）CloudFlare 部署后域名配置清空</h3><ul><li><strong>原因</strong>：Hexo 部署覆盖 GitHub Pages 分支内容，<code>CNAME</code> 文件未同步。</li><li><strong>解决</strong>：在 Hexo 项目 <code>source</code> 目录添加 <code>CNAME</code> 文件，内容填自定义域名，部署时同步到 GitHub 仓库，CloudFlare 配置就会保留。</li></ul><h3 id="（三）必应收录验证问题">（三）必应收录验证问题</h3><ul><li><strong>方法</strong>：通过 XML 文件（下载 <code>BingSiteAuth.xml</code> 放 Hexo <code>source</code> 目录，部署后验证 ）、HTML Meta 标记（添加到博客首页 <code>&lt;head&gt;</code>  ）、DNS CNAME 记录（域名解析后台添加 ）完成验证，提交站点地图，让博客在必应搜索可见。</li></ul><h2 id="八、总结">八、总结</h2><p>从工具安装、Hexo 初始化，到内容创作、部署上线，再到用 CloudFlare 加速、优化 SEO ，整个流程虽有波折，但一步步搭建出专属博客，成就感满满。这五个工具相互配合，让博客从本地走向公网，成为展示自我的窗口。未来，继续用它们更新内容、优化体验，让博客持续生长～</p><p><strong>附录</strong>：关键命令与配置汇总，方便速查：</p><ul><li>Hexo 常用命令：<code>hexo clean</code>、<code>hexo g</code>、<code>hexo s</code>、<code>hexo d</code> 。</li><li>Git 配置与部署：<code>git config</code>、<code>hexo-deployer-git</code> 插件配置。</li><li>CloudFlare 核心操作：DNS 解析、CDN 加速、SSL 配置。</li><li>PicGo + Typora 图床写作：Typora 上传图片设置、PicGo 图床配置。</li></ul><p>希望这篇复盘能帮到想搭建博客的你，一起用技术记录生活、分享世界～</p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> Git </tag>
            
            <tag> CloudFlare </tag>
            
            <tag> Typora </tag>
            
            <tag> PicGo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WEB3 Day1 —— BlockChain Basic 1</title>
      <link href="/2025/06/17/WEB3%20Day1%20%E2%80%94%E2%80%94%20BlockChain%20Basic%201/"/>
      <url>/2025/06/17/WEB3%20Day1%20%E2%80%94%E2%80%94%20BlockChain%20Basic%201/</url>
      <cover>https://img.soniachen.com/blog/posts/2025/06/image-20250617143925337-20250617172413705.png</cover>
      <date>Tue Jun 17 2025 14:26:18 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>WEB3 Day1 —— BlockChain Basic 1</h1><h2 id="转型方向">转型方向</h2><p>从 Java 开发转型至智能合约开发。</p><h2 id="学习资源">学习资源</h2><h3 id="学习视频">学习视频</h3><p>推荐 patrick collins 【Cyfrin】的<a href="https://www.youtube.com/watch?v=M576WGiDBdQ&amp;t=1231s">教学视频</a> 。</p><p>同时，<a href="https://updraft.cyfrin.io/courses/blockchain-basics/basics/l1s-l2s-and-rollups">Cyfrin Updraft 官网</a>提供了文字笔记和视频课程。不过，某些翻译插件的双语字幕不支持该网站，因此我选择在 YouTube 上观看完整视频，并且将两者结合起来学习。</p><h3 id="翻译插件推荐">翻译插件推荐</h3><p>这里推荐一款翻译插件——<a href="https://immersivetranslate.com/zh-Hans/">沉浸式翻译</a></p><h2 id="创建自己的钱包">创建自己的钱包</h2><h3 id="安装-MetaMask-插件">安装 MetaMask 插件</h3><p>首先，进入 <a href="https://metamask.io/">MetaMask 官网</a>，将其作为 Chrome 浏览器插件添加到浏览器中。</p><h3 id="创建钱包">创建钱包</h3><p>创建自己的钱包后，会得到三个关键信息：私钥（private key）、助记词（Mnemonic Key）和公钥地址（public Address）。其中，私钥和助记词极其重要，务必安全保存！因为拥有私钥就可以直接访问你的钱包账户，所以千万不能有侥幸心理。建议将助记词记录在纸上，而不是存储在电脑里，如果能记在大脑中（如使用记忆宫殿的方法）则是最安全的。三者的重要性排序为：【Mnemonic &gt; Private Key &gt; public Address】。</p><p>相关图示如下：<br><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617143925337-20250617172413705.png" alt="image-20250617143925337" style="zoom: 33%;" /><br><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617143938391-20250617172413858.png" alt="image-20250617143938391" style="zoom:25%;" /></p><h3 id="模拟交易">模拟交易</h3><h4 id="创建虚拟测试网络">创建虚拟测试网络</h4><p>登录 Tenderly 测试网站（<a href="https://tenderly.co/?mtm_campaign=partner&amp;mtm_kwd=cyfrin">https://tenderly.co/?mtm_campaign=partner&amp;mtm_kwd=cyfrin</a> ），通过该链接注册并创建账户是免费的。在网站左侧点击“virtual TestNets”，创建虚拟测试网络。<br><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617143945197-20250617172414056.png" alt="image-20250617143945197" style="zoom:33%;" /></p><h4 id="网络设置">网络设置</h4><p>进行简单设置，无特定要求。设置完成后，会创建一个模拟区块链，接下来可以将其添加到 MetaMask 中。<br><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617143952962-20250617172414269.png" alt="image-20250617143952962" style="zoom:50%;" /></p><h4 id="手动添加网络问题处理">手动添加网络问题处理</h4><p>在连接后，可能会遇到 MetaMask 中未显示创建的虚拟网络的问题，此时需要手动添加。注意，原系统默认的 chainId（11155111）无法修改，因此需要重新创建一个链，并在创建时在“custom”处修改自己的 ID。<br><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617144007052-20250617172414606.png" alt="image-20250617144007052" style="zoom: 33%;" /><br>有其他开发者也遇到了同样的问题，可参考：<a href="https://github.com/Cyfrin/foundry-full-course-cu/discussions/4066?sort=old">https://github.com/Cyfrin/foundry-full-course-cu/discussions/4066?sort=old</a></p><h4 id="注资操作">注资操作</h4><p>完成上述步骤后，进行注资。<br><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617144013149-20250617172414727.png" alt="image-20250617144013149" style="zoom:33%;" /></p><h4 id="查看注资结果">查看注资结果</h4><p>注资完成后，等待几分钟，就可以在自定义虚拟网络中看到资金到账啦，仿佛瞬间“暴富”（当然这只是模拟）。<br><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617144019117-20250617172414877.png" alt="image-20250617144019117" style="zoom:33%;" /></p><h4 id="账户间转账">账户间转账</h4><p>在模拟网络中，从一个账户向另一个账户转账非常简单，直接进行发送操作即可。<br><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617144024781-20250617172415010.png" alt="image-20250617144024781" style="zoom:33%;" /><br><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617144053479-20250617172415108.png" alt="image-20250617144053479" style="zoom:33%;" /></p><p>另外，Tenderly 与 Cypher 有合作，账户可以续期。<br><img src="https://img.soniachen.com/blog/posts/2025/06/image-20250617144034552-20250617172415354.png" alt="image-20250617144034552" style="zoom:33%;" /></p><h2 id="区块链数据结构">区块链数据结构</h2><p>可以通过 BlockChain Demo 网站（<a href="https://andersbrownworth.com/blockchain/block">https://andersbrownworth.com/blockchain/block</a> ）来帮助理解区块链的底层数据结构。</p><h2 id="交易费用相关概念">交易费用相关概念</h2><h3 id="交易费用（Transaction-Fee）">交易费用（Transaction Fee）</h3><p>交易费用是支付给区块生产者处理交易的奖励金额，通常通过以太币或者 Gwei 支付。</p><h3 id="燃气价格（Gas-Price）">燃气价格（Gas Price）</h3><p>同样以以太币或者 Gwei 来定义，燃气价格是交易中指定的每单位燃气（Gas）的成本。价格越高，交易被打包进区块的机会就越大，它用于设定交易中每单位燃气的成本。</p><h3 id="燃气（Gas）">燃气（Gas）</h3><p>不要将燃气与燃气价格混淆。燃气指的是执行交易所需要的工作量，而燃气价格则是每单位工作量的成本。</p><p>交易费用的计算公式为：</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Transaction fee =  gasPrice * gasUsed</span><br></pre></td></tr></table></figure><p>简单来说，当大量用户进行交易时，特定区块的空间竞争会变得激烈，此时提高燃气价格可以在拥堵时限制交易，并优先处理部分交易。</p>]]></content>
      
      
      <categories>
          
          <category> Web3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BlockChain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redis与MQ在项目中的运用</title>
      <link href="/2025/04/06/Redis%E3%80%81MQ%E7%9A%84%E9%A1%B9%E7%9B%AE%E8%BF%90%E7%94%A8/"/>
      <url>/2025/04/06/Redis%E3%80%81MQ%E7%9A%84%E9%A1%B9%E7%9B%AE%E8%BF%90%E7%94%A8/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=b15e63ac-5ac8-34e2-d202-7d887db5d05f</cover>
      <date>Sun Apr 06 2025 20:31:00 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>1、Redis与MQ在项目中的运用！</h1><h2 id="Redis应用场景-缓存系统">Redis应用场景-缓存系统</h2><img src="https://img.soniachen.com/blog/posts/2025/06/362bab478a0645a89abb3d5d08bc06ee.png" alt="image.png" style="zoom: 50%;" /><p>Redis最主要的还是做缓存，一般的方案下就是把热点数据（访问频次高）的数据放入Redis缓存，用Redis的高性能去避免MySQL数据的。这种方案一般的做法都会有兜底方案，就是数据在Redis中没有话，还是会去访问MySQL然后再把数据同步到Redis缓存。</p><h2 id="Redis应用场景-排行榜、计数器">Redis应用场景-排行榜、计数器</h2><p>1、Redis提供的incr方法做计数器（点赞、关注数之类）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import redis.clients.jedis.Jedis;</span><br><span class="line"></span><br><span class="line">public class RedisCounter &#123;</span><br><span class="line">    private Jedis jedis;</span><br><span class="line"></span><br><span class="line">    public RedisCounter() &#123;</span><br><span class="line">        // 连接到 Redis</span><br><span class="line">        this.jedis = new Jedis(&quot;localhost&quot;, 6379);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 用户点赞</span><br><span class="line">    public void likePost(String postId) &#123;</span><br><span class="line">        jedis.incr(&quot;post:&quot; + postId + &quot;:likes&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 用户关注</span><br><span class="line">    public void followUser(String userId) &#123;</span><br><span class="line">        jedis.incr(&quot;user:&quot; + userId + &quot;:followers&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        RedisCounter counter = new RedisCounter();</span><br><span class="line">  </span><br><span class="line">        // 示例：用户点赞</span><br><span class="line">        counter.likePost(&quot;post1&quot;);</span><br><span class="line">        counter.likePost(&quot;post1&quot;);</span><br><span class="line">  </span><br><span class="line">        // 示例：用户关注</span><br><span class="line">        counter.followUser(&quot;user1&quot;);</span><br><span class="line">  </span><br><span class="line">        // 输出点赞数和关注者数</span><br><span class="line">        System.out.println(&quot;Post1 Likes: &quot; + counter.jedis.get(&quot;post:post1:likes&quot;));</span><br><span class="line">        System.out.println(&quot;User1 Followers: &quot; + counter.jedis.get(&quot;user:user1:followers&quot;));</span><br><span class="line">  </span><br><span class="line">        // 关闭连接</span><br><span class="line">        counter.jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、Redis提供的有序集合(sorted set)可以用来创建排行榜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import redis.clients.jedis.Jedis;</span><br><span class="line">import java.util.Set;</span><br><span class="line"></span><br><span class="line">public class RedisLeaderboard &#123;</span><br><span class="line">    private Jedis jedis;</span><br><span class="line"></span><br><span class="line">    public RedisLeaderboard() &#123;</span><br><span class="line">        // 连接到 Redis</span><br><span class="line">        this.jedis = new Jedis(&quot;localhost&quot;, 6379);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 用户点赞时更新排行榜</span><br><span class="line">    public void likePost(String postId, String userId) &#123;</span><br><span class="line">        // 假设每个点赞增加用户的分数</span><br><span class="line">        jedis.zincrby(&quot;post_rank&quot;, 1, userId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 获取前 N 名用户</span><br><span class="line">    public Set&lt;String&gt; getTopUsers(int n) &#123;</span><br><span class="line">        return jedis.zrevrange(&quot;post_rank&quot;, 0, n - 1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        RedisLeaderboard leaderboard = new RedisLeaderboard();</span><br><span class="line">  </span><br><span class="line">        // 示例：用户点赞</span><br><span class="line">        leaderboard.likePost(&quot;post1&quot;, &quot;user1&quot;);</span><br><span class="line">        leaderboard.likePost(&quot;post1&quot;, &quot;user2&quot;);</span><br><span class="line">        leaderboard.likePost(&quot;post1&quot;, &quot;user1&quot;);  // user1 再次点赞</span><br><span class="line"></span><br><span class="line">        // 获取前 2 名用户</span><br><span class="line">        Set&lt;String&gt; topUsers = leaderboard.getTopUsers(2);</span><br><span class="line">        System.out.println(&quot;Top Users: &quot; + topUsers);</span><br><span class="line">  </span><br><span class="line">        // 关闭连接</span><br><span class="line">        leaderboard.jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Redis应用场景-共享session">Redis应用场景-共享session</h2><p>多台应用服务器可以将用户的session存储在Redis中（缓存+过期机制）</p><h2 id="Redis应用场景-分布式锁">Redis应用场景-分布式锁</h2><p>Redisson的API介绍：</p><p><a href="https://github.com/redisson/redisson/wiki/8.-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%92%8C%E5%90%8C%E6%AD%A5%E5%99%A8#84-%E7%BA%A2%E9%94%81redlock">https://github.com/redisson/redisson/wiki/8.-分布式锁和同步器#84-红锁redlock</a></p><h3 id="分布式锁加入过期时间-加入看门狗">分布式锁加入过期时间+加入看门狗</h3><p>加锁时，先设置一个过期时间，然后我们开启一个「守护线程」，定时去检测这个锁的失效时间，如果锁快要过期了，操作共享资源还未完成，那么就自动对锁进行「续期」，重新设置过期时间。</p><p>这个守护线程我们一般也把它叫做「看门狗」线程。</p><img src="https://img.soniachen.com/blog/posts/2025/06/a6cb1c776db74c2bbd5bdcdc4f9b576a.png" alt="image.png" style="zoom:60%;" /><h2 id="Redis应用场景-布隆过滤器">Redis应用场景-布隆过滤器</h2><p><strong>1970 年布隆提出了一种布隆过滤器的算法，用来判断一个元素是否在一个集合中。这种算法由一个二进制数组和一个 Hash 算法组成。</strong></p><p>本质上布隆过滤器是一种数据结构，比较巧妙的概率型数据结构（probabilistic data structure），特点是高效地插入和查询，可以用来告诉你 “某样东西一定不存在或者可能存在”。</p><p>相比于传统的 List、Set、Map 等数据结构，它更高效、占用空间更少，但是缺点是其返回的结果是概率性的，而不是确切的。</p><p>实际上，布隆过滤器广泛应用于网页黑名单系统、垃圾邮件过滤系统、爬虫网址判重系统等，Google 著名的分布式数据库 Bigtable 使用了布隆过滤器来查找不存在的行或列，以减少磁盘查找的IO次数，Google Chrome浏览器使用了布隆过滤器加速安全浏览服务。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/5983/1663252342001/801f60ff2d28436faaaab3007dd7d893.png" alt=""></p><h5 id="布隆过滤器的误判问题">布隆过滤器的误判问题</h5><p>Ø通过hash计算在数组上不一定在集合</p><p>Ø本质是hash冲突</p><p>Ø通过hash计算不在数组的一定不在集合（误判）</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/5983/1663252342001/d31bbeaf5a8742d2b15ce65bbc5a4537.png" alt=""></p><p><strong>优化方案</strong></p><p>增大数组(预估适合值)</p><p>增加hash函数</p><h2 id="Redis应用场景-Bitmap海量用户存储">Redis应用场景-Bitmap海量用户存储</h2><h3 id="1、目前有10亿数量的自然数，乱序排列，需要对其排序。限制条件-在32位机器上面完成，内存限制为-2G。如何完成？">1、目前有10亿数量的自然数，乱序排列，需要对其排序。限制条件-在32位机器上面完成，内存限制为 2G。如何完成？</h3><ul><li>使用一个大小为 1,000,000,000 的 Bitmap（每个自然数对应一个位）。</li><li>将每个自然数的位设置为 1，表示该数存在。</li><li>然后，可以遍历 Bitmap，按顺序输出所有存在的自然数。</li></ul><p>由于内存限制为 2G，一个大小为 1,000,000,000 的 Bitmap 在 Redis 中大约占用 119.2 MB 的内存</p><h3 id="2、如何快速在亿级黑名单中快速定位URL地址是否在黑名单中？-每条URL平均64字节">2、如何快速在亿级黑名单中快速定位URL地址是否在黑名单中？(每条URL平均64字节)</h3><p>把URL做Hash值计算，然后将其映射到 Bitmap。</p><ul><li>计算 URL 的哈希值，并将对应的位设置为 1。</li></ul><ul><li>检查 URL 是否在黑名单中，只需查看对应的位是否为 1。</li></ul><h3 id="3、需要进行用户登陆行为分析，来确定用户的活跃情况？">3、需要进行用户登陆行为分析，来确定用户的活跃情况？</h3><p>可以使用 Bitmap 来记录用户的登录状态，用户 ID 作为位的索引。</p><ul><li>每次用户登录时，将对应的位设置为 1。</li><li>可以通过位计数来获取活跃用户的数量。</li></ul><h2 id="Redis应用场景-GEO地图">Redis应用场景-GEO地图</h2><h3 id="GEO">GEO</h3><p>Redis 3.2版本提供了GEO(地理信息定位)功能，支持存储地理位置信息用来实现诸如附近位置、摇一摇这类依赖于地理位置信息的功能。</p><p>地图元素的位置数据使用二维的经纬度表示，经度范围(-180, 180]，纬度范围(-90,90]，纬度正负以赤道为界，北正南负，经度正负以本初子午线(英国格林尼治天文台) 为界，东正西负。</p><p>业界比较通用的地理位置距离排序算法是GeoHash 算法，Redis 也使用GeoHash算法。GeoHash算法将二维的经纬度数据映射到一维的整数，这样所有的元素都将在挂载到一条线上，距离靠近的二维坐标映射到一维后的点之间距离也会很接近。当我们想要计算「附近的人时」，首先将目标位置映射到这条线上，然后在这个一维的线上获取附近的点就行了。</p><p>在 Redis 里面，经纬度使用 52 位的整数进行编码，放进了 zset 里面，zset 的 value 是元素的 key，score 是 GeoHash 的 52 位整数值。</p><h4 id="操作命令">操作命令</h4><h5 id="增加地理位置信息">增加地理位置信息</h5><p>geoadd key longitude latitude member [longitude latitude member …J</p><p>longitude、latitude、member分别是该地理位置的经度、纬度、成员，例如下面有5个城市的经纬度。</p><p>城市            经度             纬度             成员</p><p>北京            116.28          39.55            beijing</p><p>天津            117.12          39.08            tianjin</p><p>石家庄        114.29          38.02            shijiazhuang</p><p>唐山            118.01          39.38            tangshan</p><p>保定            115.29          38.51            baoding</p><p>cities:locations是上面5个城市地理位置信息的集合，现向其添加北京的地理位置信息:</p><p>geoadd cities :locations 116.28 39.55 beijing</p><p>返回结果代表添加成功的个数，如果cities:locations没有包含beijing,那么返回结果为1，如果已经存在则返回0。</p><p>如果需要更新地理位置信息，仍然可以使用geoadd命令，虽然返回结果为0。geoadd命令可以同时添加多个地理位置信息:</p><p>geoadd cities:locations 117.12 39.08 tianjin 114.29 38.02shijiazhuang 118.01 39.38 tangshan 115.29 38.51 baoding</p><h5 id="获取地理位置信息">获取地理位置信息</h5><p>geopos key member [member …]下面操作会获取天津的经维度:</p><p>geopos cities:locations tianjin1)1)“117.12000042200088501”</p><h5 id="获取两个地理位置的距离。">获取两个地理位置的距离。</h5><p>geodist key member1 member2 [unit]</p><p><strong>其中unit代表返回结果的单位，包含以下四种:</strong></p><p>m (meters)代表米。</p><p>km (kilometers)代表公里。</p><p>mi (miles)代表英里。</p><p>ft(feet)代表尺。</p><p>下面操作用于计算天津到北京的距离，并以公里为单位:</p><p>geodist cities : locations tianjin beijing km</p><h5 id="获取指定位置范围内的地理信息位置集合">获取指定位置范围内的地理信息位置集合</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">georadius key longitude latitude radius m|km|ft|mi [withcoord][withdist]</span><br><span class="line">[withhash][COUNT count] [ascldesc] [store key] [storedist key]</span><br><span class="line">georadiusbymember key member radius m|km|ft|mi  [withcoord][withdist]</span><br><span class="line">[withhash] [COUNT count][ascldesc] [store key] [storedist key]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>georadius和georadiusbymember两个命令的作用是一样的，都是以一个地理位置为中心算出指定半径内的其他地理信息位置，不同的是georadius命令的中心位置给出了具体的经纬度，georadiusbymember只需给出成员即可。其中radius  m | km |ft |mi是必需参数，指定了半径(带单位)。</p><p>这两个命令有很多可选参数，如下所示:</p><p>withcoord:返回结果中包含经纬度。</p><p>withdist:返回结果中包含离中心节点位置的距离。</p><p>withhash:返回结果中包含geohash，有关geohash后面介绍。</p><p>COUNT count:指定返回结果的数量。</p><p>asc l desc:返回结果按照离中心节点的距离做升序或者降序。</p><p>store key:将返回结果的地理位置信息保存到指定键。</p><p>storedist key:将返回结果离中心节点的距离保存到指定键。</p><p>下面操作计算五座城市中,距离北京150公里以内的城市:</p><p>georadiusbymember cities:locations beijing 150 km</p><h5 id="获取geohash">获取geohash</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">geohash key member [member ...]</span><br></pre></td></tr></table></figure><p>Redis使用geohash将二维经纬度转换为一维字符串，下面操作会返回beijing的geohash值。</p><p>geohash cities: locations beijing</p><p>字符串越长,表示的位置更精确，geohash长度为9时,精度在2米左右，geohash长度为8时,精度在20米左右。</p><p>两个字符串越相似,它们之间的距离越近,Redis 利用字符串前缀匹配算法实现相关的命令。</p><p>geohash编码和经纬度是可以相互转换的。</p><h5 id="删除地理位置信息">删除地理位置信息</h5><p>zrem key member</p><p>GEO没有提供删除成员的命令，但是因为GEO的底层实现是zset，所以可以借用zrem命令实现对地理位置信息的删除。</p><h2 id="MQ应用场景-异步解耦">MQ应用场景-异步解耦</h2><p><img src="https://img.soniachen.com/blog/posts/2025/06/O1CN01klyp4H1mjTCx7pkYe_!!6000000004990-0-tps-1134-910.jpg" alt=""></p><p>1、灵活适应业务的快速增长：通过MQ的异步化设计，可以灵活高效的适应因业务快速发展而带来的变化，如新增业务系统。</p><p>2、高可用松耦合架构设计：通过上、下游业务系统的松耦合设计，即便下游子系统（如物流、积分等）出现不可用甚至宕机，都不会影响到核心交易系统的正常运转</p><h2 id="MQ应用场景-削峰填谷">MQ应用场景-削峰填谷</h2><p><img src="https://img.soniachen.com/blog/posts/2025/06/O1CN01D381dH1juyJ4kXzXh_!!6000000004609-0-tps-1134-910.jpg" alt=""></p><p>秒杀、抢红包、企业开门红等大型活动时皆会带来较高的流量脉冲，或因没做相应的保护而导致系统超负荷甚至崩溃，或因限制太过导致请求大量失败而影响用户体验。用MQ的削峰填谷是解决该问题的有效方式。</p><p>1、超高流量脉冲处理能力：MQ 超高性能的消息处理能力可以承接流量脉冲而不被击垮，在确保系统可用性同时，因快速有效的请求响应而提升用户的体验</p><p>2、海量消息堆积能力：确保下游业务在安全水位内平滑稳定的运行，避免超高流量的冲击</p><p>3、合理的成本控制：削峰填谷可控制下游业务系统的集群规模，从而降低投入成本</p><h2 id="RocketMQ应用场景-分布式事务消息">RocketMQ应用场景-分布式事务消息</h2><p><img src="https://img.soniachen.com/blog/posts/2025/06/TB1i2jrnRjTBKNjSZFwXXcG4XXa-1530-1140.png" alt=""></p><p>**传统事务：**多个系统或者应用组件之间的业务处理会耦合到一个大事务中，响应时间长，业务链路长从而影响系统的整体性能和可用性，甚至引起系统崩溃</p><p>**RocketMQ分布式事务：**将核心链路业务与可异步化处理的分支链路进行拆分，将大事务拆分成小事务，减少系统间的交互，既高效又可靠；RocketMQ 的可靠传输与多副本技术能确保消息不丢失。</p><h2 id="RocketMQ-Kafka-流式数据处理">RocketMQ/Kafka-流式数据处理</h2><p><img src="https://img.soniachen.com/blog/posts/2025/06/TB1rW7JXogQMeJjy0FfXXbddXXa-1530-1140.png" alt=""></p><p>数据在&quot;流动&quot;中产生价值，传统数据分析大多是基于批量计算模型，而无法做到实时的数据分析，利用 RocketMQ /Kafka与流式计算引擎相结合，可以很方便的实现将业务数据进行实时分析。</p><h2 id="RocketMQ-Kafka-分布式模缓存同步">RocketMQ/Kafka-分布式模缓存同步</h2><p><img src="https://img.soniachen.com/blog/posts/2025/06/TB1ki7KXgMPMeJjy1XdXXasrXXa-1530-1140.png" alt=""></p><p>大型项目做了分布式缓存（分会场），各个分会场琳琅满目的商品需要实时感知价格变化，大量并发访问数据库导致会场页面响应时间长，集中式缓存因为带宽瓶颈限制商品变更的访问流量，通过 RocketMQ 构建分布式缓存，实时通知商品数据的变化。</p><p>大促众多分会场，多缓存的架构设计，满足对商品变更的大量访问需求。</p><h1>2、为什么选用Redis缓存，MQ如何进行技术选型！</h1><p>Redis有丰富的功能，不单纯是一个缓存。如果是对比的话，MongoDB的话缺乏Redis的功能，同时稳定性和版本的延续性对比Redis也要差不少。</p><p>MQ的话：<br>RabbitMQ吞吐量最少。RabbitMQ的语言兼容性最好（多语言API做的很好，C、Python等等语言都支持），</p><p>RocketMQ的话，适合电商（有丰富的电商的场景）、比如延时消息之类的。（语言对接只有Java好对接点）</p><p>Kafka适合于大数据系统对接，有很多大数据组件比如Flink都有比较好的Kafka对接API之类的（多语言API做的不错，C、Python等等语言都支持。</p><p>站在存储的角度，RocketMQ和Kafka天生持久化，RabbitMQ的话需要配置（配置持久化性能会有下降）。同时RabbitMQ需要去了解AMQP模型，RokcetMQ和Kafka模型简单。RabbitMQ消费是删除消息，RocketMQ和Kafka都是消费偏移量管理，适合于存储消息，做消息回溯之类的。</p><h1>3、MCA项目中Redis与MQ的运用</h1><p>这些具体内容我讲了一个大概，需要看视频内容。</p><h2 id="1、合家云社区物业管理平台-Redis">1、合家云社区物业管理平台:Redis</h2><h2 id="2、烽火云短信平台-Redis、RabbitMQ">2、烽火云短信平台:Redis、RabbitMQ</h2><h2 id="3、从0到1手敲代码实现商城项目：Redis、RocketMQ">3、从0到1手敲代码实现商城项目：Redis、RocketMQ</h2><h2 id="4、马士兵严选课程-IM通信中台：Redis、RocketMQ">4、马士兵严选课程-IM通信中台：Redis、RocketMQ</h2><h2 id="5、飞滴出行网约车项目：Redis、RocketMQ">5、飞滴出行网约车项目：Redis、RocketMQ</h2><h2 id="6、音乐数据中心综合数仓项目：Redis、Kafka">6、音乐数据中心综合数仓项目：Redis、Kafka</h2>]]></content>
      
      
      <categories>
          
          <category> 项目 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> MQ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微服务技术栈</title>
      <link href="/2024/09/10/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%8A%80%E6%9C%AF%E6%A0%88-SpringCloud/"/>
      <url>/2024/09/10/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%8A%80%E6%9C%AF%E6%A0%88-SpringCloud/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=a105cad2-3930-4199-e589-1910bddfde32</cover>
      <date>Tue Sep 10 2024 14:26:18 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1><strong>一、微服务架构介绍</strong></h1><h2 id="1-1-架构演变">1.1 架构演变</h2><blockquote><p><strong>单体架构：</strong> All in One，所有的功能模块都在一个工程里。</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/374f9e8ea3e642838ee5e2c7e9b66a41.png" alt="image.png"></p><p><strong>SOA架构：</strong> 这个架构当不当正不正，对于现在来说，有点老，甚至需要ESB，WebService之类的，基本不会使用了。</p><p><strong>微服务架构：</strong>  微服务架构思想是马丁福勒提出的</p><p><a href="https://martinfowler.com/articles/microservices.html">https://martinfowler.com/articles/microservices.html</a></p><p>他的核心思想是这一段话：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In short, the microservice architectural style 1 is an approach to developing a single application as a suite of small services, each running in its own process and communicating with lightweight mechanisms, often an HTTP resource API. These services are built around business capabilities and independently deployable by fully automated deployment machinery. There is a bare minimum of centralized management of these services, which may be written in different programming languages and use different data storage technologies.</span><br><span class="line"></span><br><span class="line">简而言之，微服务架构风格1是一种将单个应用程序开发为一套小型服务的方法，每个服务都在自己的进程中运行，并与轻量级机制（通常是HTTP资源API）通信。这些服务围绕业务能力构建，并可通过全自动部署机制独立部署。这些服务的集中管理最低限度，这些服务可能用不同的编程语言编写，并使用不同的数据存储技术。</span><br></pre></td></tr></table></figure><p>将上述内容稍微整理：</p><ul><li>微服务架构是一个软件架构风格，他不是标准。</li><li>将一个单体架构的产品拆分成多个服务，多个服务组成了完成的产品功能。</li><li>每个服务是可以完全独立部署的，互不影响。</li><li>可以采用HTTP这种轻量级的方式实现服务之间的交互。</li><li>在拆分服务时，一般是按照产品的业务领域去划分不同的服务，也可以针对单个功能做成一个服务。</li><li>采用DevOps的方式去做自动化部署。 （后面会学）</li><li>支持采用不用的语言去构建一个完整的产品。</li></ul><p><img src="https://img.soniachen.com/blog/posts/2025/06/f8eb541f60a24967b24a0fcdcd5ac240.png" alt="image.png"></p><p><img src="https://img.soniachen.com/blog/posts/2025/06/286d41b410c84b85a717f16b76a61284.png" alt="image.png"></p><p>微服务架构：是架构思想。</p><p>微服务：拆分出来的微小的服务，比如上图中的商品服务就是一个微服务。</p><p>微服务框架：对微服务的架构思想落地的一些技术。</p></blockquote><h2 id="1-2-SpringCloud生态">1.2 SpringCloud生态</h2><blockquote><p>官方地址： <a href="https://spring.io/projects/spring-cloud">https://spring.io/projects/spring-cloud</a></p><p>咱们要学习SpringCloud生态里的几个技术：</p><ul><li>SpringCloud Alibaba： Nacos</li><li>SpringCloud：OpenFeign</li><li>SpringCloud Alibaba：Sentinel</li><li>SpringCloud：Gateway</li><li><strong>链路追踪：Sleuth + Zipkin  -  SkyWalking（不玩）</strong></li></ul><p><img src="https://img.soniachen.com/blog/posts/2025/06/08081e25a8b844bea6663bc1497b5009.png" alt="image.png"></p><p><strong>Ps：这里只关注应用，底层源码之类的内容，这里不涉及。</strong></p></blockquote><h1>二、Nacos注册中心</h1><h2 id="2-1-注册中心">2.1 注册中心</h2><blockquote><p>当订单服务需要访问库存服务时，不知道库存服务的地址信息。利用注册中心，在服务启动时，将服务的基本信息都注册到Nacos中，当需要访问某一个服务之前，可以去Nacos中获取到对应的服务信息，就可以直接去访问啦~~~</p><p>如果让订单服务单独存储库存服务的基本信息，会导致耦合问题，如果库存服务的地址改变了，订单服务也需要变化，如果库存服务追加了集群的节点或者减少了集群的节点，订单服务都需要做维护，耦合性太高。</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/3a607132146547579f90f8db2b940c10.png" alt="image.png"></p></blockquote><h2 id="2-2-Nacos安装">2.2 Nacos安装</h2><blockquote><p>Nacos可以Windows下简单的玩，也可以在Linux里安装。</p><p>直接去官方下载即可。</p><p>本地环境要求，java -version要么是JDK8，要么是JDK11</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/57d464304a38460aa2e4f1daaa1b4518.png" alt="image.png">1</p><p><a href="https://download.nacos.io/nacos-server/nacos-server-2.5.1.zip?spm=5238cd80.2ef5001f.0.0.3f613b7cKzonbx&amp;file=nacos-server-2.5.1.zip">https://download.nacos.io/nacos-server/nacos-server-2.5.1.zip?spm=5238cd80.2ef5001f.0.0.3f613b7cKzonbx&amp;file=nacos-server-2.5.1.zip</a></p><p><strong>点击即可直接下载（最好去官网）。</strong></p><p><img src="https://img.soniachen.com/blog/posts/2025/06/50028280050a48c3afca88986bb2fc18.png" alt="image.png"></p><p>打开cmd准备启动Nacos服务</p><p>然后到bin目录下准备启动</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/ef013c66e8f84a54b5ccf6e6261c5664.png" alt="image.png">启动成功要看到这个日志</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/9f76aa77d2684bc9ab177b0712200975.png" alt="image.png"></p><p>启动成功后，直接访问Nacos提供的图形化界面</p><p><a href="http://localhost:8848/nacos">http://localhost:8848/nacos</a></p><p><img src="https://img.soniachen.com/blog/posts/2025/06/a37fffd20043410a820a1fd39538e1f2.png" alt="image.png"></p></blockquote><h2 id="2-3-Nacos初体验（注册中心）">2.3 Nacos初体验（注册中心）</h2><h3 id="2-3-1-构建父工程并管理版本">2.3.1 构建父工程并管理版本</h3><blockquote><p>在玩Nacos的客户端操作前，优先了解一下常识性内容。</p><p>SpringCloud是建立在SpringBoot基础上的。</p><p>其次，SpringBoot版本，SpringCloud版本，SpringCloudAlibaba的版本都是有对应的。</p><p>版本对应可以查看这个地址：</p><p><a href="https://github.com/alibaba/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E">https://github.com/alibaba/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E</a></p><p>版本不同，在使用的一些细节上可能会出现一些不一样的地方，所以最好跟我的版本保持统一！</p><p>SpringBoot咱们先不玩3.x，依然是以2.x为核心。</p><p>构建一个普通的Maven工程，在pom.xml中做四个事情。</p><ul><li>将当前工程的packaging设置为pom类型。</li><li>声明好SpringBoot的parent，并制定好版本</li><li>声明SpringCloud的版本</li><li>声明SpringCloudAlibaba的版本</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mashibing<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springcloud<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>2021.0.4<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-cloud-alibaba.version</span>&gt;</span>2021.0.4.0<span class="tag">&lt;/<span class="name">spring-cloud-alibaba.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-cloud-alibaba.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></blockquote><h3 id="2-3-2-准备库存服务">2.3.2 准备库存服务</h3><blockquote><p>这里需要完成几个操作。</p><p>1、构建好子工程……</p><p>2、导入依赖……</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3、准备启动类，并添加注解……</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mashibing;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StockStarterApp</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(StockStarterApp.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4、准备yml文件，配置Nacos信息……</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">stock</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8848</span></span><br></pre></td></tr></table></figure><p>5、启动测试……</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/cf33bd2671f34b52b7710c031cd9687b.png" alt="image.png"></p></blockquote><h3 id="2-3-3-准备订单服务">2.3.3 准备订单服务</h3><blockquote><p>操作方式跟库存服务的套路没区别。</p><p>yml文件略微调整</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">order</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8848</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><p>启动并测试</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/915bc496b4ba4c7188afa229937a58b3.png" alt="image.png"></p></blockquote><h3 id="2-3-4-库存服务提供接口">2.3.4 库存服务提供接口</h3><blockquote><p>在stock服务中提供一个可以对外访问的接口</p><p>写完记得测试一下，可以访问。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mashibing.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StockController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/stock/test&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;stock test!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img.soniachen.com/blog/posts/2025/06/81949c73624345e2926ee009c0d961c4.png" alt="image.png"></p></blockquote><h3 id="2-3-5-订单服务准备接口访问库存服务">2.3.5 订单服务准备接口访问库存服务</h3><blockquote><p>正常准备OrderController，并且在启动类中构建好RestTemplate对象，在OrderController中访问库存服务提供的接口。  <strong>现在是直接写死的状态，没利用Nacos。</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mashibing.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// restTemplate是启动类里构建的！</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/order/test&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//1、 直接访问库存服务的/stock/test接口，获取数据</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> restTemplate.getForObject(<span class="string">&quot;http://localhost:8080/stock/test&quot;</span>, String.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、 响应数据</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Order Test get &quot;</span> + result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img.soniachen.com/blog/posts/2025/06/06e113dba0954c2a8a9be06e176b5975.png" alt="image.png"></p><hr><p>在确保写死的状态下，可以正常的获取到库存服务提供的接口后，咱们开始利用Nacos去获取服务的地址信息。</p><p>只需要在配置RestTemplate中，额外追加一个依赖</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@LoadBalanced</span></span><br><span class="line"><span class="keyword">public</span> RestTemplate <span class="title function_">restTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再将基于restTemplate对象访问的地址路径中的ip:port换成服务名。</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/3d9e8e55cd6946d1a8b596347f54aa30.png" alt="image.png"></p><p>希望的效果是，在restTemplate访问时，将stock服务名从Nacos中解析为具体的ip和端口。But事与愿违，报错了。</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/5b2ef5be9059474ea573b3df7fe06b01.png" alt="image.png"></p><p>原因是因为现在玩的版本比较高，默认已经不用Ribbon，需要导入loadbalancer的依赖，就可以解决。</p><p>在order服务中，追加一个依赖。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-loadbalancer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>再次访问，得到具体的结果</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/625445e2eb7d4cbe8e754ca18087987a.png" alt="image.png"></p></blockquote><h2 id="2-4-命名空间和分组（了解）">2.4 命名空间和分组（了解）</h2><blockquote><p>咱们在默认操作时，连接是的Nacos中的public命名空间以及DEFAULT_GROUP分组下的服务信息。</p><p>咱们可以在yml文件中指定要，当前服务需要连接哪个命名空间以及分组。</p></blockquote><hr><blockquote><p>优先构建一个命名空间，然后指定order服务连接的命名空间</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/f0f1b752e40844efa88fcc301e7fc209.png" alt="image.png"></p><p>修改完毕后，因为之前的stock服务依然注册在public命名空间下，所以order服务去dev命名空间去找stock服务必然找不到，So，报了这个错误</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/6ecec72f503843cd817412406df02642.png" alt="image.png"></p></blockquote><hr><blockquote><p>将order服务中的注册与发现的分组设置的PDD_GROUP，再次去找Nacos实现注册与发现时，就会只找PDD_GROUP下的内容</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/c09281b64edc4d3aa537ed40a77de81d.png" alt="image.png"></p><p>再次去找stock服务时，发现找不到，那就对了，因为咱们配置了分组的信息，所以他会去PDD_GROUP去找对应的stock服务。</p><p><img src="https://img.soniachen.com/blog/posts/2025/06/42732a8eff1f4668bc410ae0a72025b6.png" alt="image.png"></p></blockquote><h2 id="2-5-负载均衡（了解）">2.5 负载均衡（了解）</h2><blockquote><p><img src="https://img.soniachen.com/blog/posts/2025/06/d70d40d37f4a49d78104436efbf79876.png" alt="image.png"><br>负载均衡的操作不是Nacos去做的。而是Nacos依赖 <strong>Ribbon或者Loadbalancer</strong> 。</p><p><strong>（低版本默认引入Ribbon，当前版本需要手动引入Loadbalancer）</strong></p><p>默认情况就是轮询的机制，你一个，我一个，你一个，我一个，你一个，我一个……</p><p>不需要做任何额外的配置，默认机制即可，虽然也有权重之类的操作，基本不用。</p><p>稍微修改了一下代码，方便查看具体的效果，将stock服务的test接口返回的结果追加上对应的端口号。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mashibing.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StockController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;server.port&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String serverPort;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/stock/test&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;stock test!&quot;</span> + serverPort;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第一次启动发现错误，找不到引入的 <strong>@Value(“${server.port}”)</strong> ，原因是配置文件没写。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/760d7c17c6224933b53e0922396d4d8c.png" alt="image.png"></p><p>追加上对应的配置，就完事了。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/b10d0d49c4844a2bbe8cdf48d90a490a.png" alt="image.png"></p><p>优先启动了8080的Stock。</p><p>紧接着为了查看集群的效果，基于IDEA的配置，再次启动一个Stock服务，但是因为IDEA版本原因，需要设置一下多环境信息才ok。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/a9a0a5c61b554fe290095d1ef4a53962.png" alt="image.png"></p><p>然后在IDEA中追加启动项，启动配置好的这个8081的Stock服务</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/05f9484a228f4477a4098b46179ccbcb.png" alt="image.png"></p><p>启动成功后，可以在Nacos中看到具体的集群信息</p><p>Ps：记住，集群的服务名必须保持一致，你写成不一样的，那就是俩服务了。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/7bd2a0cc4ff14843ae5d7a82d2561de8.png" alt="image.png"></p><p>再去访问的时候，他就是默认轮询的效果了！</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/a4dc6af57d6c444f8a92a74d76ad5eb4.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/85a3329633224a82a30e86f3206fc7e7.png" alt="image.png"></p></blockquote><h1>三、Nacos配置中心</h1><h2 id="3-1-配置中心">3.1 配置中心</h2><blockquote><p>之前咱们的配置信息都是放在项目工程里的application.yml文件中。</p><p>但是后期服务可能会涉及到集群部署，并且部署在不同的服务器中。如果没有一个统一管理这些配置的方案，需要去多个地方维护这些配置信息。</p><p>项目在开发到发布交付的过程中，涉及很多环境开发环境，测试环境，预生产环境，生产环境，环境很多，需要提供多种环境下的配置文件。</p><p>项目中如果配置文件发生修改，一般是需要重启项目才能生效的，但是配置中心是可以实现动态刷新配置的功能，修改玩配置文件，可以立即生效，不需要重启。</p><p>其次就是配置文件现在的形式就是本地的一个文本文件，谁都能看，谁都能改，权限不好控制。配置中心就会提供这种权限的控制。</p><p>针对历史版本的记录，希望可以看到配置文件每次更改的变化，以及历史版本记录，也可以方便做一个回滚的操作。</p><p>总结下来就几点：</p><ul><li>集中式管理配置文件的地方</li><li>环境隔离</li><li>配置动态刷新</li><li>权限的控制</li><li>历史版本记录</li></ul></blockquote><h2 id="3-2-Nacos初体验（配置中心）">3.2 Nacos初体验（配置中心）</h2><blockquote><p>现在的目的是将order服务中的server.port=80的配置扔到Nacos服务中管理。希望Order服务启动后，可以去找对应地址的Nacos中的某个DataId的配置文件，达到启动后，依然占用80端口。</p><p><strong>分成这几步完成上述操作：</strong></p><p><strong>1、导入依赖</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2、在Nacos服务上编写配置文件</strong></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/7d65825d1e644d4d8bda60d0a3ecb936.png" alt="image.png"><br><strong>3、Order的配置文件中指定好Nacos地址以及加载哪个配置文件</strong></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="comment"># 服务名</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">order</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="comment"># 环境名</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">study</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8848</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="comment"># nacos地址</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8848</span></span><br><span class="line">        <span class="comment"># 文件后缀</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yml</span></span><br><span class="line"><span class="comment">#  order-study.yml</span></span><br><span class="line"><span class="comment">#  $&#123;spring.application.name&#125; - $&#123;spring.profiles.active&#125; . $&#123;spring.cloud.nacos.config.file-extension&#125;</span></span><br></pre></td></tr></table></figure><p><strong>4、将application.yml修改为bootstrap.yml</strong></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/21bdc67488b9487d82e727c223bc6f2b.png" alt="image.png"></p><p><strong>5、因为版本关系，需要追加上一个依赖。</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>6、测试，启动后查看日志信息</strong></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/9645abdaced9445f8fa2a0c11ec1bcd7.png" alt="image.png"></p></blockquote><h2 id="3-3-命名空间和分组（了解）">3.3 命名空间和分组（了解）</h2><blockquote><p>这里跟注册中心的思路是完全一样的，没啥变化</p><p>优先准备一个dev命名空间下的DEV_GROUP分组的配置文件。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/96fb0592bae74854998339f41144d2e9.png" alt="image.png"></p><p>配置文件的编写方式</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="comment"># 服务名</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">order</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="comment"># 环境名</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8848</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="comment"># nacos地址</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8848</span></span><br><span class="line">        <span class="comment"># 文件后缀</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yml</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">06173ada-fb39-47b3-8551-7265a5177770</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">DEV_GROUP</span></span><br></pre></td></tr></table></figure></blockquote><h2 id="3-4-配置动态刷新">3.4 配置动态刷新</h2><blockquote><p>配置的动态刷新的目的是为了实现当程序读取Nacos中的配置文件的内容时，如果Nacos中修改了某个key对应的value，项目不需要重启就可以立即生效。</p><p>准备一个环境，提供一个Controller接口，获取Nacos配置中的某个key的value，并且测试效果。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取Nacos配置文件中的info</span></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;info:empty&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String info;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/order/info&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">info</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> info;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/1a2aeed96f484f8c8fcf6423bbef07e3.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/d2c9a173d98a406fb9f753ff88912b8c.png" alt="image.png"></p></blockquote><hr><blockquote><p>现在为了实现动态刷新的效果，咱们只需要做一个事情。</p><p>在引入Nacos配置文件的类上，追加一个注解即可</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RefreshScope</span></span><br></pre></td></tr></table></figure><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/8e6e99c8bf3d495a883dad52a41790c6.png" alt="image.png"></p></blockquote><h1>四、OpenFeign</h1><h2 id="4-1-OpenFeign介绍">4.1 OpenFeign介绍</h2><blockquote><p>OpenFeign是RPC框架的一种，OpenFeign不是Alibaba的组件，属于SpringCloud。</p><p>Alibaba内部提供的是Dubbo的RPC框架，作用都是一样的。</p><ul><li>Dubbo走的是自己的Dubbo协议。</li><li>OpenFeign采用的是HTTP协议。</li></ul><p>OpenFeign的主要目的就是为了 <strong>简化Java项目中编译HTTP请求的过程</strong> ，并且让代码 <strong>具备更好的可维护性</strong> 。</p><p>OpenFeign他也 <strong>整合Sentinel，Nacos，Hystrix，LoadBalancer等</strong> ，这些OpenFeign都是可以0成本整合的。</p><p>OpenFeign是 <strong>基于接口（interface）封装</strong> ，实现代理对象去访问的，跟之前的单体项目的编写思路是一样的。</p></blockquote><h2 id="4-2-OpenFeign的初体验">4.2 OpenFeign的初体验</h2><blockquote><p>按照官方文档的方式一步一步走。</p><p><strong>1、导入依赖</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2、启动类追加注解</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableFeignClients</span></span><br></pre></td></tr></table></figure><p><strong>3、编写OpenFeign的Client接口。（映射到对应服务的接口上）</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mashibing.client;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.FeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FeignClient(&quot;stock&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">StockClient</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这里的内容，如果可以，最好去对应的Controller位置复制</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/stock/test&quot;)</span></span><br><span class="line">    String <span class="title function_">test</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>4、测试，在order服务中编写测试接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RefreshScope</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderController</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StockClient stockClient;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 基于OpenFeign，尝试访问Stock服务</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/order/feign&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">feign</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> stockClient.test();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/91fb4e69c034418e8f02514584ed9ccd.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/09449f3029a1439a8dcf8c5eb53945af.png" alt="image.png"></p></blockquote><h2 id="4-3-OpenFeign配置">4.3 OpenFeign配置</h2><h3 id="4-3-1-OpenFeign的超时配置">4.3.1 OpenFeign的超时配置</h3><blockquote><p>通过官方文档可以得知，OpenFeign的超时配置就2个东西</p><ul><li><code>connectTimeout</code> prevents blocking the caller due to the long server processing time.</li><li><code>readTimeout</code> is applied from the time of connection establishment and is triggered when returning the response takes too long.</li></ul><p>connectTimeout：关注的不多，更多的是客户端和服务端建立TCP连接的超时时间。</p><p>readTimeout：这个配置的会比较多，他是从请求发出到响应的超时时间</p><p>将Stock服务中的接口休眠一段时间，来测试达到超时时间后的效果</p><p>Order服务的配置：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">config:</span></span><br><span class="line">      <span class="attr">stock:</span>  <span class="comment"># 服务名</span></span><br><span class="line">        <span class="attr">readTimeout:</span> <span class="number">1000</span>    <span class="comment"># 响应时间1s，没响应直接报错</span></span><br></pre></td></tr></table></figure><p>当超时后，抛出的错误。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/a8f173f789a041dca9e3dd382fbdd881.png" alt="image.png"></p><p><strong>Ps：这里区分版本，之前的版本，OpenFeign的超时时间是1s，现在默认情况下，5s都没超时！</strong></p><p><strong>也可能存在一个情况，第一次请求的时候，会初始化，速度可能会比较慢。</strong></p><p>其次，OpenFeign也提供了全局（默认、缺省）的配置方式</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">config:</span></span><br><span class="line">      <span class="attr">default:</span>  <span class="comment"># 默认的配置，优先级低</span></span><br><span class="line">        <span class="attr">read-timeout:</span> <span class="number">2000</span></span><br><span class="line">      <span class="attr">stock:</span>  <span class="comment"># 细粒度针对服务的配置，优先级高</span></span><br><span class="line">        <span class="attr">readTimeout:</span> <span class="number">6000</span></span><br></pre></td></tr></table></figure></blockquote><h3 id="4-3-2-OpenFeign的底层技术">4.3.2 OpenFeign的底层技术</h3><blockquote><p>默认情况下，咱们当前版本的OpenFeign底层使用的HttpClient4。</p><p>咱们可以通过配置去选择使用okHttp或者是HC5（HttpClient5）</p><p>咱们是三选一：okHttp，HttpClient4，HC5。</p><p>区别的话，浅聊一下：</p><ul><li>协议的支持：okHttp，HC5对协议支持的更好。</li><li>性能：相对来说，其实大差不差，但是还是okHttp，HC5的性能更好。</li><li>代码简洁度：其实咱们用了OpenFeign就无所谓了。</li><li>异步的支持：都支持！</li><li>okHttp是Square维护的，而HttpClient，HC5是Apache的。</li></ul><p>默认采用的是HttpClient4：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">httpclient:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span>   <span class="comment"># 默认使用的HttpClient</span></span><br></pre></td></tr></table></figure><p>将配置更改为使用HC5</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">httpclient:</span></span><br><span class="line">    <span class="attr">hc5:</span></span><br><span class="line">      <span class="attr">enabled:</span> <span class="literal">true</span>   <span class="comment"># 就会采用HC5的方式访问目标服务</span></span><br></pre></td></tr></table></figure><p>将配置修改为okHttp</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">okhttp:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></blockquote><h1>五、Sentinel</h1><h2 id="5-1-Sentinel介绍">5.1 Sentinel介绍</h2><blockquote><p>Sentinel帮助咱们解决的问题核心方向有两个：</p><ul><li><strong>流量控制：</strong> 可以实现限流的功能，同时也丰富了限流的机制，还提供了达到限制的阈值后，如何处理后续的请求。</li><li><strong>断路器、熔断：</strong> 本质是帮助咱们去解决一些服务雪崩的问题，同时咱们可以主动的指定好降级方法，返回对应的托底数据。</li></ul><p>可以去官网看一下。</p><p><a href="https://sentinelguard.io/zh-cn/index.html">https://sentinelguard.io/zh-cn/index.html</a></p><p>官方文档的介绍，可以看这个</p><p><a href="https://sentinelguard.io/zh-cn/docs/introduction.html">https://sentinelguard.io/zh-cn/docs/introduction.html</a></p></blockquote><h2 id="5-2-Sentinel安装">5.2 Sentinel安装</h2><blockquote><p>Sentinel依然是用Java语言编写的，咱们安装Sentinel，其实本质就是下载一个jar包，然后用java -jar运行起来就可以登录到图形化界面。</p><p>依然去官方看文档安装。查看后，是在github上去下载对应的release版本</p><p><a href="https://github.com/alibaba/Sentinel/tags">https://github.com/alibaba/Sentinel/tags</a></p><p><strong>下载完毕之后，在确定好你的JDK环境没问题的情况下，并且JDK版本最好是1.8</strong></p><p><strong>暂时别弄17和21之类的版本，最高为师能接受JDK11。</strong></p><p><strong>同时也要确认好，当前系统的都8080端口没被占用，Sentinel默认占用8080。</strong></p><p>然后就可以在cmd窗口中，基于</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java <span class="literal">-jar</span> sentinel<span class="literal">-dashboard-1</span>.<span class="number">8.7</span></span><br></pre></td></tr></table></figure><p>启动Sentinel项目。</p><p><strong>Ps：因为Windows启动程序可能会存在一些小问题，比如我刚才，在启动后，需要按一下Ctrl + C让程序继续加载，才可以正常的访问到Sentinel的官方。</strong></p><p>直接访问： <a href="http://localhost:8080/">http://localhost:8080/</a></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/2a4749321bac40c099ffc9a2aba2880b.png" alt="image.png"></p><p><strong>默认的用户名和密码都是 sentinel  （都是小写）</strong></p><p>进入后，看到这个就是安装成功</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/b10b9a0ec8d64d54b55ba934fde70320.png" alt="image.png"></p></blockquote><h2 id="5-3-Sentinel初体验">5.3 Sentinel初体验</h2><blockquote><p>1、导入依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-sentinel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2、编写配置连接Sentinel的dashboard</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">sentinel:</span></span><br><span class="line">      <span class="attr">transport:</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">8719</span></span><br><span class="line">        <span class="attr">dashboard:</span> <span class="string">localhost:8080</span></span><br></pre></td></tr></table></figure><p>3、启动项目后访问任何接口，不访问，dashboard上看不到</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/8b7c626b926a497bb056b1042306d6a1.png" alt="image.png"></p><p>4、Sentinel的dashboard上查看服务</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/04b01a2efa324238a93e18b6ca897c75.png" alt="image.png"></p></blockquote><h2 id="5-4-流控规则">5.4 流控规则</h2><blockquote><p>这里主要的操作就是点来点去。</p><p>在设置流控规则时，发现需要设置一个资源名，咱们有两个方式可以选择</p><ul><li><p>默认的资源名就是这个资源地址。</p></li><li><p>可以在Controller接口（方法）追加@SentinelResource的注解，指定资源名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@GetMapping(&quot;/order/info&quot;)</span><br><span class="line">@SentinelResource(value = &quot;info&quot;)</span><br><span class="line">public String info() &#123;</span><br><span class="line">    return info;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></blockquote><hr><h3 id="5-4-1-QPS限制">5.4.1 QPS限制</h3><h4 id="5-4-1-1-直接-快速失败">5.4.1.1 直接-快速失败</h4><blockquote><p><strong>阈值类型：QPS               单体阈值：1</strong></p><p><strong>流控模式：直接</strong></p><p><strong>流控效果：快速失败</strong></p><p>只要每秒超过2个请求，第二个请求就会触发快速失败，直接报错~</p></blockquote><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/a21baf974ef2402b97b11b66adc86378.png" alt="image.png"><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/c489603170e243cf948bdc25b23aadf4.png" alt="image.png"></p><h4 id="5-4-1-2-直接-WarmUp">5.4.1.2 直接-WarmUp</h4><blockquote><p><strong>阈值类型：QPS               单体阈值：10</strong></p><p><strong>流控模式：直接</strong></p><p><strong>流控效果：WarmUp</strong></p><p>接口并不会一开始就支撑10的QPS，慢慢的，经过一段时间，才会将QPS限制开放到10。</p></blockquote><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/89540f18ec834b0490d1c60defc03a3b.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/209ac1c4ee65423bb34de74920b97a79.png" alt="image.png"></p><h4 id="5-4-1-3-直接-排队等待">5.4.1.3 直接-排队等待</h4><blockquote><p><strong>阈值类型：QPS               单体阈值：2</strong></p><p><strong>流控模式：直接</strong></p><p><strong>流控效果：排队等待</strong></p><p>QPS限制为2的时候，他会匀速的每个500ms，放一个请求进去。</p></blockquote><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/95039968590345a5a2f89956886145ae.png" alt="image.png"><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/988f73b9c1884d8d9309879fe0796b28.png" alt="image.png"></p><h4 id="5-4-1-4-关联-快速失败">5.4.1.4 关联-快速失败</h4><blockquote><p><strong>阈值类型：QPS               单体阈值：2</strong></p><p><strong>流控模式：关联</strong></p><p><strong>流控效果：快速失败</strong></p><p>首先需要准备两个资源查看效果</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/order/info&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;info&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">info</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> info;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/order/add&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;add&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;add&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>给info资源设置QPS限制为1，关联的是add资源。 当频繁的访问add资源后，info就会被限制。</p></blockquote><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/c564ee78b7134fe8b71a2ff66d5acc65.png" alt="image.png"><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/d951c083d5a8426f9e5db3e940bab0d4.png" alt="image.png"></p><h4 id="5-4-1-5-链路-快速失败">5.4.1.5 链路-快速失败</h4><blockquote><p><strong>阈值类型：QPS               单体阈值：1</strong></p><p><strong>流控模式：链路</strong></p><p><strong>流控效果：快速失败</strong></p><p>需要准备三个资源，其中两个资源作为入口，另外一个资源作为公共资源被访问</p><p><strong>Ps：Controller中的方法默认就是资源，其次其他基于Spring管理的方法也可以作为资源，只是必须要追加上Sentinel的注解才可以。</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> OrderService orderService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/order/aaa&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;aaa&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">aaa</span><span class="params">()</span> &#123;</span><br><span class="line">    orderService.common();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;aaa&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@GetMapping(&quot;/order/bbb&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;bbb&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">bbb</span><span class="params">()</span> &#123;</span><br><span class="line">    orderService.common();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;bbb&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ====================公共资源=======================</span></span><br><span class="line"><span class="keyword">package</span> com.mashibing.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.csp.sentinel.annotation.SentinelResource;</span><br><span class="line"><span class="keyword">import</span> com.mashibing.service.OrderService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@SentinelResource(&quot;common&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">common</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>发现设置好之后，资源的入口是统一的，就是 <strong>sentinel_spring_web_context，导致咱们现在没有办法针对某个入口单独做链路的限制</strong></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/23e03f63b425471aabd3314f1f7896b4.png" alt="image.png"></p><p>可以通过配置，将统一入口管理的模式关闭掉。就可以将每个Controller资源作为一个入口。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">sentinel:</span></span><br><span class="line">      <span class="attr">web-context-unify:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>追加完毕后，重新启动项目，查看簇点链路。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/1959d3729ca9410c8f03feef64665a51.png" alt="image.png">controller中已经有入口资源顶头了，可以开始配置链路的效果了。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/b7e83353cdeb47e7a561a0849929903e.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/35a62db47a494c74b5d9bd6c5b654e3d.png" alt="image.png">具体解决问题的issue地址：</p><p><a href="https://github.com/alibaba/Sentinel/issues/1213">https://github.com/alibaba/Sentinel/issues/1213</a></p></blockquote><h3 id="5-4-2-并发线程数">5.4.2 并发线程数</h3><blockquote><p>因为流控里的QPS限制聊的模式基本都点到了。</p><p>这里的并发线程数看个效果即可。</p><p><strong>阈值类型：并发线程数               单体阈值：1</strong></p><p><strong>流控模式：直接</strong></p><p>这个资源内部只能有一个线程在处理，如果另外一个线程来了，需要排队等待。</p><p>为了查看效果，将代码的处理时间延长</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/order/info&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;info&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">info</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// ============并发线程数==============</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> info;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/0efadf130ef044d8875b7bb684a1b7f8.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/764f98d24ebe4a6dae60374c2513bf4a.png" alt="image.png"></p><h2 id="5-5-熔断降级">5.5 熔断降级</h2><h3 id="5-5-1-熔断降级介绍">5.5.1 熔断降级介绍</h3><blockquote><p>服务雪崩：因为某一个服务出现问题，导致其他服务，甚至整个系统崩溃的情况，就可以称为服务雪崩</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/ee53cb8d384e4718b1738e0a1291cad6.png" alt="image.png"></p><p>为了解决这个服务雪崩的问题，可以上熔断、降级来解决这种服务雪崩问题</p><p><strong>降级：针对一些资源，提供一个降级的方法，当这个资源出现了一些问题时，可以快速失败，去执行降级方法，返回托底数据。</strong></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/d564d2f62a3341b193822c77002ee8ab.png" alt="image.png"></p><p><strong>熔断：就是针对某个资源提供断路器，有Closed，Open，Half Open状态。</strong></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/aa99318477e94a79924a5b2a8931f58d.png" alt="image.png"></p><p><strong>Ps：熔断和降级不是一个东西，熔断是触发降级的手段之一。</strong></p></blockquote><h3 id="5-5-2-熔断规则">5.5.2 熔断规则</h3><blockquote><p>Sentinel提供的熔断规则有三种</p><ul><li><p>慢调用比例：</p><ul><li>请求的响应时间，大于500ms，就被统计为慢调用。</li><li>在10s内，请求数量达到4个，开始统计熔断的阈值。</li><li>如果慢调用统计达到了请求量的50%，就会将断路器设置为Open状态，持续10s。</li><li>10s后，将断路器设置为Half Open状态，并放一个请求进来。<ul><li>这个请求是慢调用，那就回到Open状态。</li><li>如果小于慢调用，设置为Closed状态。<img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/573cc8ae2318482cbe809568c54de1d8.png" alt="image.png"></li></ul></li></ul></li><li><p>异常比例：</p><ul><li>资源访问出现异常，就认定是异常。</li><li>在10s内，请求数量达到4个，开始统计熔断的阈值。</li><li>如果异常统计达到了请求量的50%，就会将断路器设置为Open状态，持续10s。</li><li>10s后，将断路器设置为Half Open状态，并放一个请求进来。<ul><li>这个请求出现异常，那就回到Open状态。</li><li>如果没异常，设置为Closed状态。<img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/25c4eff218a04c7980269926fd1ef70e.png" alt="image.png"></li></ul></li></ul></li><li><p>异常数：</p><ul><li>资源访问出现异常，就认定是异常。</li><li>在10s内，请求数量达到4个，开始统计熔断的阈值。</li><li>如果异常统计达到了2个，就会将断路器设置为Open状态，持续10s。</li><li>10s后，将断路器设置为Half Open状态，并放一个请求进来。<ul><li>这个请求出现异常，那就回到Open状态。</li><li>如果没异常，设置为Closed状态。<img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/a5cac238dfcd4d0d8558cba5f4f4d624.png" alt="image.png"></li></ul></li></ul></li></ul></blockquote><hr><blockquote><p>1、提供一套测试熔断效果资源，提供一个Controller</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// =================================熔断降级===========================</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/order/circuitbreaker&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;circuitbreaker&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">circuitbreaker</span><span class="params">(String value)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line"> <span class="keyword">switch</span> (value)&#123;</span><br><span class="line">     <span class="keyword">case</span> <span class="string">&quot;1&quot;</span>:</span><br><span class="line">         Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">         <span class="keyword">break</span>;</span><br><span class="line">     <span class="keyword">case</span> <span class="string">&quot;2&quot;</span>:</span><br><span class="line">         <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> <span class="string">&quot;circuitbreaker - success!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、启动项目开始测试！</p><p><strong>看视频查看测试效果！！！！！</strong></p></blockquote><h3 id="5-5-3-降级方法">5.5.3 降级方法</h3><h4 id="5-5-3-1-blockHandler">5.5.3.1 blockHandler</h4><blockquote><p>Sentinel中提供的降级处理是基于@SentinelResource注解来实现的。</p><p>@SentinelResource是基于AOP去实现的，So，需要让方法的访问修饰符是public。</p><p>@SentinelResource注解的属性内容比较多，咱一个一个看</p><ul><li><strong>blockHandler：</strong><ul><li><p>blockHandler是专门处理BlockException的降级方法，指定降级方法名。</p></li><li><p>降级方法需要public修饰</p></li><li><p>返回类型，方法参数要匹配，方法参数最后可以追加BlockException</p></li><li><p>降级方法跟原方法在一个类里</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@GetMapping(&quot;/order/sentinel&quot;)</span><br><span class="line">@SentinelResource(value = &quot;sentinel&quot;,blockHandler = &quot;sentinelBlock&quot;)</span><br><span class="line">public String sentinel(@RequestParam String value) throws InterruptedException &#123;</span><br><span class="line">    // 业务代码………………</span><br><span class="line">    return &quot;sentinel - success!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line">// 是sentinel方法的降级方法，可以在方法逻辑中返回托底数据</span><br><span class="line">public String sentinelBlock(String value, BlockException exception)&#123;</span><br><span class="line">    String message = null;</span><br><span class="line">    if (exception instanceof FlowException)&#123;</span><br><span class="line">        message = &quot;流量控制！&quot;;</span><br><span class="line">    &#125;else if (exception instanceof DegradeException)&#123;</span><br><span class="line">        message = &quot;熔断控制&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    return &quot;failed  msg = &quot; + message.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><strong>BlockHandlerClass：</strong><ul><li><p>这个属性和BlockHandler配合使用，可以将降级方法声明在其他类里</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@GetMapping(&quot;/order/sentinel&quot;)</span><br><span class="line">@SentinelResource(value = &quot;sentinel&quot;,blockHandlerClass = OrderControllerBlock.class,blockHandler = &quot;sentinelBlock&quot;)</span><br><span class="line">public String sentinel(@RequestParam String value) throws InterruptedException &#123;</span><br><span class="line">    // 业务代码………………</span><br><span class="line">    return &quot;sentinel - success!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">// ========================================================</span><br><span class="line">public class OrderControllerBlock &#123;</span><br><span class="line">   </span><br><span class="line">    public static String sentinelBlock(String value, BlockException exception)&#123;</span><br><span class="line">        String message = null;</span><br><span class="line">        if (exception instanceof FlowException)&#123;</span><br><span class="line">            message = &quot;流量控制！&quot;;</span><br><span class="line">        &#125;else if (exception instanceof DegradeException)&#123;</span><br><span class="line">            message = &quot;熔断控制&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">   </span><br><span class="line">        return &quot;failed  msg = &quot; + message.toString();</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><p><strong>BlockException：对应着Sentinel中的几种限制的方式：</strong></p><ul><li><strong>FlowException：流控</strong></li><li><strong>DegradeException：熔断</strong></li><li><strong>ParamFlowException：热点</strong></li><li><strong>SystemBlockException：系统</strong></li><li><strong>AuthorityException：权限</strong></li></ul></blockquote><hr><h4 id="5-5-3-2-fallback">5.5.3.2 fallback</h4><blockquote><p>fallback的使用跟blockHandler就是一模一样，但是blockHandler只处理BlockException。而fallback直接处理Throwable。</p><ul><li>fallback：指定降级方法名称</li><li>fallbackClass：指定降级方法所在的Class</li></ul><p><strong>Ps：若 blockHandler 和 fallback 都进行了配置，则被限流降级而抛出 <code>BlockException</code> 时只会进入 <code>blockHandler</code> 处理逻辑。</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/order/sentinel&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;sentinel&quot;,fallback = &quot;sentinelFallback&quot;,blockHandler = &quot;sentinelBlock&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">sentinel</span><span class="params">(<span class="meta">@RequestParam</span> String value)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="keyword">switch</span> (value)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;1&quot;</span>:</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;2&quot;</span>:</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;sentinel - success!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">sentinelFallback</span><span class="params">(String value,Throwable ex)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;failed&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是sentinel方法的降级方法，可以在方法逻辑中返回托底数据</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">sentinelBlock</span><span class="params">(String value, BlockException exception)</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (exception <span class="keyword">instanceof</span> FlowException)&#123;</span><br><span class="line">        message = <span class="string">&quot;流量控制！&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (exception <span class="keyword">instanceof</span> DegradeException)&#123;</span><br><span class="line">        message = <span class="string">&quot;熔断控制&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;failed  msg = &quot;</span> + message.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><hr><h4 id="5-5-3-3-defaultFallback-exceptionsToIgnore">5.5.3.3 defaultFallback&amp;exceptionsToIgnore</h4><blockquote><p>fallback只能针对单个资源去玩，defaultFallback可以针对全局。</p><ul><li>defaultFallback：指定默认的降级方法名称<ul><li>返回结果依然要统一</li><li>参数列表要为空，可以额外追加一个Throwable</li></ul></li><li>fallbackClass：指定降级方法所在的Class</li></ul><p>exceptionsToIgnore是针对fallback的，可以忽略掉一些异常不走降级方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/order/sentinel&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;sentinel&quot;,defaultFallback = &quot;defaultFallback&quot;,exceptionsToIgnore = &#123;ArithmeticException.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">sentinel</span><span class="params">(<span class="meta">@RequestParam</span> String value)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="keyword">switch</span> (value)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;1&quot;</span>:</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;2&quot;</span>:</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;sentinel - success!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//==================默认的fallback=======================</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">defaultFallback</span><span class="params">(Throwable ex)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;failed msg = &quot;</span> + ex.getMessage();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><h2 id="5-6-热点规则（了解）">5.6 热点规则（了解）</h2><blockquote><p>热点规则也属于流控的范畴。</p><p>因为流控规则是针对整个资源直接做一些限制。</p><p>而热点规则可以针对某一个字段中的参数做一些更细粒度化的流控。</p><p>Sentinel可以根据资源内传入的指定参数，来做热点参数的限流，Sentinel会帮你统计单位时间内这个参数值请求的次数 <strong>（利用LRU + 滑动时间窗口）</strong> ，再利用 <strong>令牌桶</strong> 来实现具体的限流操作。</p><p>为了查看效果，需要提供一个资源，接收俩个参数~</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//==================热点规则=======================</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/order/hot&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;hot&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">hot</span><span class="params">(String userId,Integer type)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;userId:&quot;</span> + userId + <span class="string">&quot;,type:&quot;</span> + type;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><hr><blockquote><p>根据上述编写的资源，根据userId作为限流的参数。</p><p>当userId值传递的一样时，Sentinel会统计好次数，基于QPS的方式做限制。</p><p>在 <strong>统计窗口时长</strong> 时 ，当然 <strong>热点参数值</strong> 最多可以请求 <strong>单击阈值</strong> 次，超过了就异常！</p></blockquote><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/f4052d20aa9743fd95d8e609b4346814.png" alt="image.png"></p><hr><blockquote><p>可以针对参数的具体值，再做更细粒度化的限制！</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/e9f9527343904ff99d9a236ae4ec1621.png" alt="image.png"></p></blockquote><hr><blockquote><p>测试了一波Sentinel热点规则对于接受参数的形式</p><ul><li>默认资源内基于单个类型的参数接收是没问题的，包括@RequestParam，@PathVariable</li><li>默认如果采用对象的形式接收参数，热点规则没法生效……</li></ul></blockquote><h2 id="5-7-授权规则（了解）">5.7 授权规则（了解）</h2><blockquote><p>所谓的授权规则，其实就是针对某一个资源的调用方的身份做验证。</p><p>可以指定黑、白名单（指定一个），只要满足要求才会放行请求，否则会被拦截。</p><p>优先准备一个资源来测试。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//==================授权规则=======================</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/order/author&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;author&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">author</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;author!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>设置好黑白名单后，发现无法生效。</p><p>当然服务资源在做黑白明显的限制规则时，Sentinel会基于拦截器内部调用RequestOriginParser的实现类去获取请求来源的具体身份信息。因为没有默认实现的，在这种情况下，他返回的都是空串。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/1b2e76913e304fb491937a81e8d61c3f.png" alt="image.png"></p><p>那咱们需要主动实现一个RequestOriginParser实现类，直接基于请求头获取origin中的信息作为调用方的身份。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mashibing.author;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.csp.sentinel.adapter.spring.webmvc.callback.RequestOriginParser;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SentinelOriginParser</span> <span class="keyword">implements</span> <span class="title class_">RequestOriginParser</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">parseOrigin</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">origin</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;origin&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> origin;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编写后之后，在postman中发送请求，在请求头中追加了origin信息，携带上了身份，然后实现了授权的规则校验。</p><p>获取调用方身份是基于SentinelOriginParser拿到的，而校验的方式就是基于indexOf查看Sentinel中设置的授权的黑白名单身份是否包含了SentinelOriginParser获取的信息。</p></blockquote><h2 id="5-8-系统规则（了解）">5.8 系统规则（了解）</h2><blockquote><p>系统规则不是针对某一个资源去做限制，而是针对整个服务的所有资源统一的做一些限制。</p><p>系统规则的目的是让整个系统保持可用，并且不会因为某一些资源的激增流量导致整个系统被压垮。</p><p>系统规则支持以下的模式：</p><ul><li><strong>Load 自适应</strong> （仅对 Linux/Unix-like 机器生效）：系统的 load1 作为启发指标，进行自适应系统保护。当系统 load1 超过设定的启发值，且系统当前的并发线程数超过估算的系统容量时才会触发系统保护（BBR 阶段）。系统容量由系统的 <code>maxQps * minRt</code> 估算得出。设定参考值一般是 <code>CPU cores * 2.5</code>。</li><li><strong>CPU usage</strong> （1.5.0+ 版本）：当系统 CPU 使用率超过阈值即触发系统保护（取值范围 0.0-1.0），比较灵敏。</li><li><strong>平均 RT</strong> ：当单台机器上所有入口流量的平均 RT 达到阈值即触发系统保护，单位是毫秒。</li><li><strong>并发线程数</strong> ：当单台机器上所有入口流量的并发线程数达到阈值即触发系统保护。</li><li><strong>入口 QPS</strong> ：当单台机器上所有入口流量的 QPS 达到阈值即触发系统保护。5.9 Sentinel持久化</li></ul></blockquote><h2 id="5-9-动态规则、持久化">5.9 动态规则、持久化</h2><blockquote><p>在Sentinel的图形化界面中配置的各种规则，都是存储在内存里的，之前配置的各种规则就全么得了。</p><p>不可能每次项目重启后，都去重新指定这些规则，成本太高了。</p><p>Sentinel也支持将一些规则持久化到某个DataSource。DataSource的种类很多。大概分为了两种</p><ul><li>拉模式：客户端主动去查看是否变化，缺点是无法及时获取变更。</li><li>推模式：DataSource主动去通知客户端变化的内容，有更好的实时性和一致性保证。</li></ul><p>其中Nacos就是推模式的一种实现，直接基于Nacos来持久化Sentinel中的规则。</p></blockquote><hr><blockquote><p>实现步骤：</p><p>1、导入依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.csp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sentinel-datasource-nacos<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2、编写配置</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">sentinel:</span></span><br><span class="line">      <span class="attr">datasource:</span></span><br><span class="line">        <span class="attr">flow:</span></span><br><span class="line">          <span class="attr">nacos:</span></span><br><span class="line">            <span class="attr">server-addr:</span> <span class="string">$&#123;spring.cloud.nacos.config.server-addr&#125;</span></span><br><span class="line">            <span class="attr">group-id:</span> <span class="string">SENTINEL_GROUP</span></span><br><span class="line">            <span class="attr">data-id:</span> <span class="string">$&#123;spring.application.name&#125;-flow.json</span></span><br><span class="line">            <span class="attr">data-type:</span> <span class="string">json</span></span><br><span class="line">            <span class="attr">rule-type:</span> <span class="string">flow</span></span><br></pre></td></tr></table></figure><p>3、Nacos中构建配置，编写规则，想编写这个内容</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/2108e7e7b55f4ef688d3917940131ec0.png" alt="image.png"></p><p>Nacos的配置</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/8f1678597bff436d9cd50ad745893866.png" alt="image.png"></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;info&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;limitApp&quot;</span><span class="punctuation">:</span> <span class="string">&quot;default&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;grade&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;count&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;strategy&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;controlBehavior&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure></blockquote><hr><blockquote><p>配置熔断规则的套路</p><p>1、依赖导入</p><p>…………</p><p>2、yml配置</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">sentinel:</span></span><br><span class="line">      <span class="attr">datasource:</span></span><br><span class="line">        <span class="attr">degrade:</span></span><br><span class="line">          <span class="attr">nacos:</span></span><br><span class="line">            <span class="attr">server-addr:</span> <span class="string">$&#123;spring.cloud.nacos.config.server-addr&#125;</span></span><br><span class="line">            <span class="attr">group-id:</span> <span class="string">SENTINEL_GROUP</span></span><br><span class="line">            <span class="attr">data-id:</span> <span class="string">$&#123;spring.application.name&#125;-degrade.json</span></span><br><span class="line">            <span class="attr">data-type:</span> <span class="string">json</span></span><br><span class="line">            <span class="attr">rule-type:</span> <span class="string">degrade</span></span><br></pre></td></tr></table></figure><p>3、Nacos的配置</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/9a2b346d2e974d76844d9568b602ac89.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/57c4a091f4ac4a5d85ecc311a323388c.png" alt="image.png"></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;info&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;grade&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;count&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;timeWindow&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;minRequestAmount&quot;</span><span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;statIntervalMs&quot;</span><span class="punctuation">:</span> <span class="number">10000</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure></blockquote><h2 id="5-10-OpenFeign整合Sentinel">5.10 OpenFeign整合Sentinel</h2><blockquote><p>OpenFeign整合Sentinel的目的其实就是针对基于OpenFeign去访问其他服务时，如果出来了任何的问题，不要抛出异常，而是走降级方法，返回托底数据。</p><p>1、需要编写配置文件，开启OpenFeign跟Sentinel的整合</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">circuitbreaker:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>2、构建Feign接口的实现类，重写Feign接口的方法（重写的方法就是降级方法）</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mashibing.client.fallback;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mashibing.client.StockClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StockClientFallback</span> <span class="keyword">implements</span> <span class="title class_">StockClient</span> &#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;test的降级方法，服务器正忙，请稍后再试！！&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3、在Feign接口中指定@FeignClient的fallback属性</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(value = &quot;stock&quot;,fallback = StockClientFallback.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">StockClient</span> &#123;</span><br></pre></td></tr></table></figure><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/2746/1742210442039/e288e468159d400bbde24ae6581bd691.png" alt="image.png"></p><p>有同学会有疑问，这样OpenFeign不就有俩实现类在Spring容器中了么？ Spring怎么知道到底注入哪一个。其实OpenFeign是基于@FeignClient中的primary属性，指定了Feign接口的代理对象作为咱们注入的主要对象。</p><p>至于FallbackFactory就不实现了，大概知道可以利用fallback或者fallbackFactory两种形式，不过都是基于构建Feign接口实现类去玩的。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> SpringCloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sentinel </tag>
            
            <tag> Nacos </tag>
            
            <tag> OpenFeign </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>缓存和分布式锁</title>
      <link href="/2024/06/17/%E7%BC%93%E5%AD%98%E5%92%8C%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81_/"/>
      <url>/2024/06/17/%E7%BC%93%E5%AD%98%E5%92%8C%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81_/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=32d07949-ffc4-965c-a206-45fa6fe52830</cover>
      <date>Mon Jun 17 2024 14:26:18 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>缓存和分布式锁</h1><h1>一、缓存</h1><h2 id="1-什么是缓存">1. 什么是缓存</h2><p>  缓存的作用是减低对数据源的访问频率。从而提高我们系统的性能。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/f7b9a0b66af14121aadeb50bffd8e36c.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/cb0dbab831954c11bd7e3873914f7150.png" alt="image.png"></p><p>缓存的流程图</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/cba94b3b543247feb6d8099a6ccc5d2f.png" alt="image.png"></p><h2 id="2-缓存的分类">2.缓存的分类</h2><h3 id="2-1-本地缓存">2.1 本地缓存</h3><p>  其实就是把缓存数据存储在内存中(Map <code>&lt;String,Object&gt;</code>).在单体架构中肯定没有问题。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/8b6494222e834cc895c5934b15836c95.png" alt="image.png"></p><p>单体架构下的缓存处理</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/fc2ef64e7b734fa6b4702420be0d5a36.png" alt="image.png"></p><h3 id="2-2-分布式缓存">2.2 分布式缓存</h3><p>  在分布式环境下，我们原来的本地缓存就不是太使用了，原因是：</p><ul><li>缓存数据冗余</li><li>缓存效率不高</li></ul><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/7465ee4dee6b4d0c9f4b61ba93dbfa87.png" alt="image.png"></p><p>  分布式缓存的结构图</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/b252ba1016044eca891ab5b3bdf9d1e0.png" alt="image.png"></p><h2 id="3-整合Redis">3.整合Redis</h2><p>  要整合Redis那么我们在SpringBoot项目中首页来添加对应的依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>  然后我们需要添加对应的配置信息</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/753f65df9029411a8145b2477d1e58d3.png" alt="image.png"></p><p>测试操作Redis的数据</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">StringRedisTemplate stringRedisTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testStringRedisTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">// 获取操作String类型的Options对象</span></span><br><span class="line">    ValueOperations&lt;String, String&gt; ops = stringRedisTemplate.opsForValue();</span><br><span class="line">    <span class="comment">// 插入数据</span></span><br><span class="line">    ops.set(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;bobo&quot;</span>+ UUID.randomUUID());</span><br><span class="line">    <span class="comment">// 获取存储的信息</span></span><br><span class="line">    System.out.println(<span class="string">&quot;刚刚保存的值：&quot;</span>+ops.get(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查看可以通过Redis的客户端连接查看</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/1b678ea26d684404a93217b8bb781164.png" alt="image.png"></p><p>也可以通过工具查看</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/33e044f827f0470bb9f3a27308f77118.png" alt="image.png"></p><h2 id="4-改造三级分类">4.改造三级分类</h2><p>  在首页查询二级和三级分类数据的时候我们可以通过Redis来缓存存储对应的数据，来提升检索的效率。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, List&lt;Catalog2VO&gt;&gt; <span class="title function_">getCatelog2JSON</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 从Redis中获取分类的信息</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">catalogJSON</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(<span class="string">&quot;catalogJSON&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(catalogJSON))&#123;</span><br><span class="line">            <span class="comment">// 缓存中没有数据，需要从数据库中查询</span></span><br><span class="line">            Map&lt;String, List&lt;Catalog2VO&gt;&gt; catelog2JSONForDb = getCatelog2JSONForDb();</span><br><span class="line">            <span class="comment">// 从数据库中查询到的数据，我们需要给缓存中也存储一份</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> JSON.toJSONString(catelog2JSONForDb);</span><br><span class="line">            stringRedisTemplate.opsForValue().set(<span class="string">&quot;catalogJSON&quot;</span>,json);</span><br><span class="line">            <span class="keyword">return</span> catelog2JSONForDb;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 表示缓存命中了数据，那么从缓存中获取信息，然后返回</span></span><br><span class="line">        Map&lt;String, List&lt;Catalog2VO&gt;&gt; stringListMap = JSON.parseObject(catalogJSON, <span class="keyword">new</span> <span class="title class_">TypeReference</span>&lt;Map&lt;String, List&lt;Catalog2VO&gt;&gt;&gt;()&#123;&#125;);</span><br><span class="line">        <span class="keyword">return</span> stringListMap;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>  然后对三级分类的数据做压力测试</p><table><thead><tr><th>压力测试内容</th><th>压力测试的线程数</th><th>吞吐量/s</th><th>90%响应时间</th><th>99%响应时间</th></tr></thead><tbody><tr><td>Nginx</td><td>50</td><td>7,385</td><td>10</td><td>70</td></tr><tr><td>Gateway</td><td>50</td><td>23,170</td><td>3</td><td>14</td></tr><tr><td>单独测试服务</td><td>50</td><td>23,160</td><td>3</td><td>7</td></tr><tr><td>Gateway+服务</td><td>50</td><td>8,461</td><td>12</td><td>46</td></tr><tr><td>Nginx+Gateway</td><td>50</td><td></td><td></td><td></td></tr><tr><td>Nginx+Gateway+服务</td><td>50</td><td>2,816</td><td>27</td><td>42</td></tr><tr><td>一级菜单</td><td>50</td><td>1,321</td><td>48</td><td>74</td></tr><tr><td>三级分类压测</td><td>50</td><td>12</td><td>4000</td><td>4000</td></tr><tr><td>三级分类压测(业务优化后)</td><td>50</td><td>448</td><td>113</td><td>227</td></tr><tr><td>三级分类压测(Redis缓存)</td><td>50</td><td>1163</td><td>49</td><td>59</td></tr></tbody></table><p>  通过对比可以看到Redis缓存加入后的性能提升的效果还是非常明显的。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/29d741c218ec440e9df345b92f03ca69.png" alt="image.png"></p><h2 id="5-缓存穿透">5.缓存穿透</h2><p>  指查询一个一定不存在的数据，由于缓存是不命中，将去查询数据库，但是数据库也无此记录，我们没有将这次查询的null写入缓存，这将导致这个不存在的数据每次请求都要到存储层去查询，失去了缓存的意义.</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/dca9e58ad48f41cca7dfbfee4e25275c.png" alt="image.png"></p><p>利用不存在的数据进行攻击，数据库瞬时压力增大，最终导致崩溃,解决方案也比较简单，直接把null结果缓存，并加入短暂的过期时间</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/afd4d9ca881948b9b8f78a5667fb4771.png" alt="image.png"></p><h2 id="6-缓存雪崩">6.缓存雪崩</h2><p>  缓存雪崩是指在我们设置缓存时key采用了相同的过期时间，导致缓存在某一时刻同时失效，请求全部转发到DB，DB瞬时压力过重雪崩。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/a60f00c6642a4027889d8f3bba9b6a02.png" alt="image.png"></p><p>解决方案：原有的失效时间基础上增加一个随机值，比如1-5分钟随机，这样每一个缓存的过期时间的重复率就会降低，就很难引发集体失效的事件。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/a48b2bce1ed049db9eda217396345759.png" alt="image.png"></p><h2 id="7-缓存击穿">7.缓存击穿</h2><p>  对于一些设置了过期时间的key，如果这些key可能会在某些时间点被超高并发地访问，是一种非常“热点”的数据。如果这个key在大量请求同时进来前正好失效，那么所有对这个key的数据查询都落到db，我们称为缓存击穿。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/e17782f1bcde4c839989a5906aef9e35.png" alt="image.png"></p><p>解决方案：加锁， 并发只让一个去查，其他人等待，查到以后释放锁，其他人获取到锁，先查缓存，就会有数据，不用去db。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/4f7f4bb074874ae6a6366315cb804e2e.png" alt="image.png"></p><p>但是当我们压力测试的时候，输出的结果有点出乎我们的意料</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/faf97a0b64ae45d986f6f96151cc6adf.png" alt="image.png"></p><p>做了两次的查询，原因是释放锁和查询结果缓存的时序问题</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/d25221e899c649ae822d6f9811c0f5e3.png" alt="image.png"></p><p>我们只需要调整下释放锁和结果缓存的时序问题就可以了</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/931fa32bb41841aba9a33da4ca522160.png" alt="image.png"></p><p>然后就是完整的代码处理</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询出所有的二级和三级分类的数据</span></span><br><span class="line"><span class="comment">     * 并封装为Map&lt;String, Catalog2VO&gt;对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, List&lt;Catalog2VO&gt;&gt; <span class="title function_">getCatelog2JSON</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;catalogJSON&quot;</span>;</span><br><span class="line">        <span class="comment">// 从Redis中获取分类的信息</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">catalogJSON</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(key);</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(catalogJSON))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;缓存没有命中.....&quot;</span>);</span><br><span class="line">            <span class="comment">// 缓存中没有数据，需要从数据库中查询</span></span><br><span class="line">            Map&lt;String, List&lt;Catalog2VO&gt;&gt; catelog2JSONForDb = getCatelog2JSONForDb();</span><br><span class="line">            <span class="keyword">if</span>(catelog2JSONForDb == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="comment">// 那就说明数据库中也不存在  防止缓存穿透</span></span><br><span class="line">                stringRedisTemplate.opsForValue().set(key,<span class="string">&quot;1&quot;</span>,<span class="number">5</span>, TimeUnit.SECONDS);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">// 从数据库中查询到的数据，我们需要给缓存中也存储一份</span></span><br><span class="line">                <span class="comment">// 防止缓存雪崩</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> JSON.toJSONString(catelog2JSONForDb);</span><br><span class="line">                stringRedisTemplate.opsForValue().set(<span class="string">&quot;catalogJSON&quot;</span>,json,<span class="number">10</span>,TimeUnit.MINUTES);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> catelog2JSONForDb;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;缓存命中了....&quot;</span>);</span><br><span class="line">        <span class="comment">// 表示缓存命中了数据，那么从缓存中获取信息，然后返回</span></span><br><span class="line">        Map&lt;String, List&lt;Catalog2VO&gt;&gt; stringListMap = JSON.parseObject(catalogJSON, <span class="keyword">new</span> <span class="title class_">TypeReference</span>&lt;Map&lt;String, List&lt;Catalog2VO&gt;&gt;&gt;() &#123;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> stringListMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 从数据库查询的结果</span></span><br><span class="line"><span class="comment">     * 查询出所有的二级和三级分类的数据</span></span><br><span class="line"><span class="comment">     * 并封装为Map&lt;String, Catalog2VO&gt;对象</span></span><br><span class="line"><span class="comment">     * 在SpringBoot中，默认的情况下是单例</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, List&lt;Catalog2VO&gt;&gt; <span class="title function_">getCatelog2JSONForDb</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">keys</span> <span class="operator">=</span> <span class="string">&quot;catalogJSON&quot;</span>;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="built_in">this</span>)&#123;</span><br><span class="line">            <span class="comment">/*if(cache.containsKey(&quot;getCatelog2JSON&quot;))&#123;</span></span><br><span class="line"><span class="comment">                // 直接从缓存中获取</span></span><br><span class="line"><span class="comment">                return cache.get(&quot;getCatelog2JSON&quot;);</span></span><br><span class="line"><span class="comment">            &#125;*/</span></span><br><span class="line">            <span class="comment">// 先去缓存中查询有没有数据，如果有就返回，否则查询数据库</span></span><br><span class="line">            <span class="comment">// 从Redis中获取分类的信息</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">catalogJSON</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(keys);</span><br><span class="line">            <span class="keyword">if</span>(!StringUtils.isEmpty(catalogJSON))&#123;</span><br><span class="line">                <span class="comment">// 说明缓存命中</span></span><br><span class="line">                <span class="comment">// 表示缓存命中了数据，那么从缓存中获取信息，然后返回</span></span><br><span class="line">                Map&lt;String, List&lt;Catalog2VO&gt;&gt; stringListMap = JSON.parseObject(catalogJSON, <span class="keyword">new</span> <span class="title class_">TypeReference</span>&lt;Map&lt;String, List&lt;Catalog2VO&gt;&gt;&gt;() &#123;</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="keyword">return</span> stringListMap;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;-----------》查询数据库操作&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取所有的分类数据</span></span><br><span class="line">            List&lt;CategoryEntity&gt; list = baseMapper.selectList(<span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;CategoryEntity&gt;());</span><br><span class="line">            <span class="comment">// 获取所有的一级分类的数据</span></span><br><span class="line">            List&lt;CategoryEntity&gt; leve1Category = <span class="built_in">this</span>.queryByParenCid(list,<span class="number">0l</span>);</span><br><span class="line">            <span class="comment">// 把一级分类的数据转换为Map容器 key就是一级分类的编号， value就是一级分类对应的二级分类的数据</span></span><br><span class="line">            Map&lt;String, List&lt;Catalog2VO&gt;&gt; map = leve1Category.stream().collect(Collectors.toMap(</span><br><span class="line">                    key -&gt; key.getCatId().toString()</span><br><span class="line">                    , value -&gt; &#123;</span><br><span class="line">                        <span class="comment">// 根据一级分类的编号，查询出对应的二级分类的数据</span></span><br><span class="line">                        List&lt;CategoryEntity&gt; l2Catalogs = <span class="built_in">this</span>.queryByParenCid(list,value.getCatId());</span><br><span class="line">                        List&lt;Catalog2VO&gt; Catalog2VOs =<span class="literal">null</span>;</span><br><span class="line">                        <span class="keyword">if</span>(l2Catalogs != <span class="literal">null</span>)&#123;</span><br><span class="line">                            Catalog2VOs = l2Catalogs.stream().map(l2 -&gt; &#123;</span><br><span class="line">                                <span class="comment">// 需要把查询出来的二级分类的数据填充到对应的Catelog2VO中</span></span><br><span class="line">                                <span class="type">Catalog2VO</span> <span class="variable">catalog2VO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Catalog2VO</span>(l2.getParentCid().toString(), <span class="literal">null</span>, l2.getCatId().toString(), l2.getName());</span><br><span class="line">                                <span class="comment">// 根据二级分类的数据找到对应的三级分类的信息</span></span><br><span class="line">                                List&lt;CategoryEntity&gt; l3Catelogs = <span class="built_in">this</span>.queryByParenCid(list,l2.getCatId());</span><br><span class="line">                                <span class="keyword">if</span>(l3Catelogs != <span class="literal">null</span>)&#123;</span><br><span class="line">                                    <span class="comment">// 获取到的二级分类对应的三级分类的数据</span></span><br><span class="line">                                    List&lt;Catalog2VO.Catalog3VO&gt; catalog3VOS = l3Catelogs.stream().map(l3 -&gt; &#123;</span><br><span class="line">                                        Catalog2VO.<span class="type">Catalog3VO</span> <span class="variable">catalog3VO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Catalog2VO</span>.Catalog3VO(l3.getParentCid().toString(), l3.getCatId().toString(), l3.getName());</span><br><span class="line">                                        <span class="keyword">return</span> catalog3VO;</span><br><span class="line">                                    &#125;).collect(Collectors.toList());</span><br><span class="line">                                    <span class="comment">// 三级分类关联二级分类</span></span><br><span class="line">                                    catalog2VO.setCatalog3List(catalog3VOS);</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">return</span> catalog2VO;</span><br><span class="line">                            &#125;).collect(Collectors.toList());</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">return</span> Catalog2VOs;</span><br><span class="line">                    &#125;</span><br><span class="line">            ));</span><br><span class="line">            <span class="comment">// 从数据库中获取到了对应的信息 然后在缓存中也存储一份信息</span></span><br><span class="line">            <span class="comment">//cache.put(&quot;getCatelog2JSON&quot;,map);</span></span><br><span class="line">            <span class="comment">// 表示缓存命中了数据，那么从缓存中获取信息，然后返回</span></span><br><span class="line">            <span class="keyword">if</span>(map == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="comment">// 那就说明数据库中也不存在  防止缓存穿透</span></span><br><span class="line">                stringRedisTemplate.opsForValue().set(keys,<span class="string">&quot;1&quot;</span>,<span class="number">5</span>, TimeUnit.SECONDS);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">// 从数据库中查询到的数据，我们需要给缓存中也存储一份</span></span><br><span class="line">                <span class="comment">// 防止缓存雪崩</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> JSON.toJSONString(map);</span><br><span class="line">                stringRedisTemplate.opsForValue().set(<span class="string">&quot;catalogJSON&quot;</span>,json,<span class="number">10</span>,TimeUnit.MINUTES);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> map;</span><br><span class="line">        &#125; &#125;</span><br></pre></td></tr></table></figure><h2 id="8-本地锁的局限">8.本地锁的局限</h2><p>  本地锁在分布式环境下，是没有办法锁住其他节点的操作的，这种情况肯定是有问题的</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/0d462603f2e9461bafbf3bbdb6ed79ca.png" alt="image.png"></p><p>针对本地锁的问题，我们需要通过分布式锁来解决，那么是不是意味着本身锁在分布式场景下就不需要了呢？</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/d3707cdc47ed4941b6b00b49711937ce.png" alt="image.png"></p><p>  显然不是这样的，因为如果分布式环境下的每个节点不控制请求的数量，那么分布式锁的压力会非常大，这时我们需要本地锁来控制每个节点的同步，来降低分布式锁的压力，所以实际开发中我们都是本地锁和分布式锁结合使用的。</p><h1>二、分布式锁</h1><h2 id="1-分布式锁的原理">1.分布式锁的原理</h2><p>  分布式锁或者本地锁的本质其实是一样的，都是将并行的操作转换为了串行的操作</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/62602c5ee39246acbdfb2f9990197e02.png" alt="image.png"></p><h2 id="2-分布式锁的常用解决方案">2.分布式锁的常用解决方案</h2><h3 id="2-1-数据库">2.1 数据库</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">可以利用MySQL隔离性：唯一索引</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">use test;</span><br><span class="line"><span class="keyword">CREATE TABLE</span> `DistributedLock` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;主键&#x27;</span>,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;锁名&#x27;</span>,</span><br><span class="line">  `<span class="keyword">desc</span>` <span class="type">varchar</span>(<span class="number">1024</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;备注信息&#x27;</span>,</span><br><span class="line">  `update_time` <span class="type">timestamp</span> <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;保存数据时间，自动生成&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uidx_name` (`name`) </span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;锁定中的方法&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>数据库中的每一条记录就是一把锁，利用的mysql唯一索引的排他性</span><br><span class="line"></span><br><span class="line">lock(name,<span class="keyword">desc</span>)&#123;</span><br><span class="line">    <span class="keyword">insert into</span> DistributedLock(`name`,`<span class="keyword">desc</span>`) <span class="keyword">values</span> (#&#123;name&#125;,#&#123;<span class="keyword">desc</span>&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unlock(name)&#123;</span><br><span class="line">    <span class="keyword">delete</span> <span class="keyword">from</span> DistributedLock <span class="keyword">where</span> name <span class="operator">=</span> #&#123;name&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以利用拍他说来实现 select … where …  for update;</p><p>乐观锁：乐观的任务数据不会出现数据安全问题，如果出现了就重试一次</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ...,version;</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">table</span> <span class="keyword">set</span> version<span class="operator">+</span><span class="number">1</span> <span class="keyword">where</span> version <span class="operator">=</span> xxx</span><br></pre></td></tr></table></figure><h3 id="2-2-Redis">2.2 Redis</h3><p>setNX:</p><p>setNX(key,value) :如果key不存在那么就添加key的值，否则添加失败，Redisson</p><h3 id="2-3Zookeeper">2.3Zookeeper</h3><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/7daa3aeb84844f40ac2ca74ef1f08d52.png" alt="image.png"></p><h2 id="3-Redis实现分布式锁">3.Redis实现分布式锁</h2><p>  在Redis中是通过setNX指令来实现锁的抢占，那么利用这个命令实现分布式锁的基础代码为：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Map&lt;String, List&lt;Catalog2VO&gt;&gt; <span class="title function_">getCatelog2JSONDbWithRedisLock</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">keys</span> <span class="operator">=</span> <span class="string">&quot;catalogJSON&quot;</span>;</span><br><span class="line">    <span class="comment">// 加锁</span></span><br><span class="line">    <span class="type">Boolean</span> <span class="variable">lock</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().setIfAbsent(<span class="string">&quot;lock&quot;</span>, <span class="string">&quot;1111&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(lock)&#123;</span><br><span class="line">        <span class="comment">// 加锁成功</span></span><br><span class="line">        Map&lt;String, List&lt;Catalog2VO&gt;&gt; data = getDataForDB(keys);</span><br><span class="line">        <span class="comment">// 从数据库中获取数据成功后，我们应该要释放锁</span></span><br><span class="line">        stringRedisTemplate.delete(<span class="string">&quot;lock&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// 加锁失败</span></span><br><span class="line">        <span class="comment">// 休眠+重试</span></span><br><span class="line">        <span class="comment">// Thread.sleep(1000);</span></span><br><span class="line">        <span class="keyword">return</span> getCatelog2JSONDbWithRedisLock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  上面的代码其实是存在一些问题的，首先如果getDataForDB(keys)这个方法如果出现的异常，那么我们就不会删除该key也就是不会释放锁，从而造成了死锁，针对这个问题，我们可以通过设置过期时间来解决，具体代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Map&lt;String, List&lt;Catalog2VO&gt;&gt; <span class="title function_">getCatelog2JSONDbWithRedisLock</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">keys</span> <span class="operator">=</span> <span class="string">&quot;catalogJSON&quot;</span>;</span><br><span class="line">    <span class="comment">// 加锁</span></span><br><span class="line">    <span class="type">Boolean</span> <span class="variable">lock</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().setIfAbsent(<span class="string">&quot;lock&quot;</span>, <span class="string">&quot;1111&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(lock)&#123;</span><br><span class="line">        <span class="comment">// 给对应的key设置过期时间</span></span><br><span class="line">        stringRedisTemplate.expire(<span class="string">&quot;lock&quot;</span>,<span class="number">20</span>,TimeUnit.SECONDS);</span><br><span class="line">        <span class="comment">// 加锁成功</span></span><br><span class="line">        Map&lt;String, List&lt;Catalog2VO&gt;&gt; data = getDataForDB(keys);</span><br><span class="line">        <span class="comment">// 从数据库中获取数据成功后，我们应该要释放锁</span></span><br><span class="line">        stringRedisTemplate.delete(<span class="string">&quot;lock&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// 加锁失败</span></span><br><span class="line">        <span class="comment">// 休眠+重试</span></span><br><span class="line">        <span class="comment">// Thread.sleep(1000);</span></span><br><span class="line">        <span class="keyword">return</span> getCatelog2JSONDbWithRedisLock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  上面虽然解决了getDataForDB方法出现异常的问题，但是如果在expire方法执行之前就中断呢？这样也会出现我们介绍的死锁的问题，那这个问题怎么办？这时我们就希望setNx和设置过期时间的操作能够保证原子性。</p><p>这时我们就可以在setIfAbsent方法中同时指定过期时间，保证这个原子性的行为</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Map&lt;String, List&lt;Catalog2VO&gt;&gt; <span class="title function_">getCatelog2JSONDbWithRedisLock</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">keys</span> <span class="operator">=</span> <span class="string">&quot;catalogJSON&quot;</span>;</span><br><span class="line">    <span class="comment">// 加锁 在执行插入操作的同时设置了过期时间</span></span><br><span class="line">    <span class="type">Boolean</span> <span class="variable">lock</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().setIfAbsent(<span class="string">&quot;lock&quot;</span>, <span class="string">&quot;1111&quot;</span>,<span class="number">30</span>,TimeUnit.SECONDS);</span><br><span class="line">    <span class="keyword">if</span>(lock)&#123;</span><br><span class="line">        <span class="comment">// 给对应的key设置过期时间</span></span><br><span class="line">        stringRedisTemplate.expire(<span class="string">&quot;lock&quot;</span>,<span class="number">20</span>,TimeUnit.SECONDS);</span><br><span class="line">        <span class="comment">// 加锁成功</span></span><br><span class="line">        Map&lt;String, List&lt;Catalog2VO&gt;&gt; data = getDataForDB(keys);</span><br><span class="line">        <span class="comment">// 从数据库中获取数据成功后，我们应该要释放锁</span></span><br><span class="line">        stringRedisTemplate.delete(<span class="string">&quot;lock&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// 加锁失败</span></span><br><span class="line">        <span class="comment">// 休眠+重试</span></span><br><span class="line">        <span class="comment">// Thread.sleep(1000);</span></span><br><span class="line">        <span class="keyword">return</span> getCatelog2JSONDbWithRedisLock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  如果获取锁的业务执行时间比较长，超过了我们设置的过期时间，那么就有可能业务还没执行完，锁就释放了，然后另一个请求进来了，并创建了key，这时原来的业务处理完成后，再去删除key的时候，那么就有可能删除别人的key，这时怎么办?针对这种情况我们可以查询的锁的信息通过UUID来区分，具体的代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Map&lt;String, List&lt;Catalog2VO&gt;&gt; <span class="title function_">getCatelog2JSONDbWithRedisLock</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">keys</span> <span class="operator">=</span> <span class="string">&quot;catalogJSON&quot;</span>;</span><br><span class="line">        <span class="comment">// 加锁 在执行插入操作的同时设置了过期时间</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">uuid</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line">        <span class="type">Boolean</span> <span class="variable">lock</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().setIfAbsent(<span class="string">&quot;lock&quot;</span>, uuid,<span class="number">30</span>,TimeUnit.SECONDS);</span><br><span class="line">        <span class="keyword">if</span>(lock)&#123;</span><br><span class="line">            <span class="comment">// 给对应的key设置过期时间</span></span><br><span class="line">            stringRedisTemplate.expire(<span class="string">&quot;lock&quot;</span>,<span class="number">20</span>,TimeUnit.SECONDS);</span><br><span class="line">            <span class="comment">// 加锁成功</span></span><br><span class="line">            Map&lt;String, List&lt;Catalog2VO&gt;&gt; data = getDataForDB(keys);</span><br><span class="line">            <span class="comment">// 获取当前key对应的值</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">val</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(<span class="string">&quot;lock&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(uuid.equals(val))&#123;</span><br><span class="line">                <span class="comment">// 说明这把锁是自己的</span></span><br><span class="line">                <span class="comment">// 从数据库中获取数据成功后，我们应该要释放锁</span></span><br><span class="line">                stringRedisTemplate.delete(<span class="string">&quot;lock&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">// 加锁失败</span></span><br><span class="line">            <span class="comment">// 休眠+重试</span></span><br><span class="line">            <span class="comment">// Thread.sleep(1000);</span></span><br><span class="line">            <span class="keyword">return</span> getCatelog2JSONDbWithRedisLock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>  上面查询key的值和删除key其实不是一个原子性操作，这就会出现我查询出来key之后，时间过期了，然后key被删除了，然后其他的请求创建了一个新的key，然后原来的执行删除了这个key，又出现了删除别人key的情况。这时我们需要保证查询和删除是一个原子性行为。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Map&lt;String, List&lt;Catalog2VO&gt;&gt; <span class="title function_">getCatelog2JSONDbWithRedisLock</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">keys</span> <span class="operator">=</span> <span class="string">&quot;catalogJSON&quot;</span>;</span><br><span class="line">        <span class="comment">// 加锁 在执行插入操作的同时设置了过期时间</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">uuid</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line">        <span class="type">Boolean</span> <span class="variable">lock</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().setIfAbsent(<span class="string">&quot;lock&quot;</span>, uuid,<span class="number">300</span>,TimeUnit.SECONDS);</span><br><span class="line">        <span class="keyword">if</span>(lock)&#123;</span><br><span class="line">            Map&lt;String, List&lt;Catalog2VO&gt;&gt; data = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// 加锁成功</span></span><br><span class="line">                data = getDataForDB(keys);</span><br><span class="line">            &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">srcipts</span> <span class="operator">=</span> <span class="string">&quot;if redis.call(&#x27;get&#x27;,KEYS[1]) == ARGV[1]  then return redis.call(&#x27;del&#x27;,KEYS[1]) else  return 0 end &quot;</span>;</span><br><span class="line">                <span class="comment">// 通过Redis的lua脚本实现 查询和删除操作的原子性</span></span><br><span class="line">                stringRedisTemplate.execute(<span class="keyword">new</span> <span class="title class_">DefaultRedisScript</span>&lt;Integer&gt;(srcipts,Integer.class)</span><br><span class="line">                        ,Arrays.asList(<span class="string">&quot;lock&quot;</span>),uuid);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">// 加锁失败</span></span><br><span class="line">            <span class="comment">// 休眠+重试</span></span><br><span class="line">            <span class="comment">// Thread.sleep(1000);</span></span><br><span class="line">            <span class="keyword">return</span> getCatelog2JSONDbWithRedisLock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><a href="https://space.bilibili.com/435498550">https://space.bilibili.com/435498550</a> 分布式锁的实现</p><h2 id="4-Redisson分布式锁">4.Redisson分布式锁</h2><h3 id="4-1-Redisson的整合">4.1 Redisson的整合</h3><p>添加对应的依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.redisson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>redisson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.16.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>添加对应的配置类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyRedisConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedissonClient <span class="title function_">redissonClient</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Config</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Config</span>();</span><br><span class="line">        <span class="comment">// 配置连接的信息</span></span><br><span class="line">        config.useSingleServer()</span><br><span class="line">                .setAddress(<span class="string">&quot;redis://192.168.56.100:6379&quot;</span>);</span><br><span class="line">        <span class="type">RedissonClient</span> <span class="variable">redissonClient</span> <span class="operator">=</span> Redisson.create(config);</span><br><span class="line">        <span class="keyword">return</span>  redissonClient;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-2-可重入锁">4.2 可重入锁</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 1.锁会自动续期，如果业务时间超长，运行期间Redisson会自动给锁重新添加30s，不用担心业务时间，锁自动过去而造成的数据安全问题</span></span><br><span class="line"><span class="comment">     * 2.加锁的业务只要执行完成， 那么就不会给当前的锁续期，即使我们不去主动的释放锁，锁在默认30s之后也会自动的删除</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">RLock</span> <span class="variable">myLock</span> <span class="operator">=</span> redissonClient.getLock(<span class="string">&quot;myLock&quot;</span>);</span><br><span class="line">        <span class="comment">// 加锁</span></span><br><span class="line">        myLock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;加锁成功...业务处理.....&quot;</span> + Thread.currentThread().getName());</span><br><span class="line">            Thread.sleep(<span class="number">30000</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;释放锁成功...&quot;</span> +  Thread.currentThread().getName());</span><br><span class="line">            <span class="comment">// 释放锁</span></span><br><span class="line">            myLock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="4-3-读写锁">4.3 读写锁</h3><p>  根据业务操作我们可以分为读写操作，读操作其实不会影响数据，那么如果还对读操作做串行处理，效率会很低，这时我们可以通过读写锁来解决这个问题，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/writer&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">writerValue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">RReadWriteLock</span> <span class="variable">readWriteLock</span> <span class="operator">=</span> redissonClient.getReadWriteLock(<span class="string">&quot;rw-lock&quot;</span>);</span><br><span class="line">        <span class="comment">// 加写锁</span></span><br><span class="line">        <span class="type">RLock</span> <span class="variable">rLock</span> <span class="operator">=</span> readWriteLock.writeLock();</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        rLock.lock(); <span class="comment">// 加写锁</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            s = UUID.randomUUID().toString();</span><br><span class="line">            stringRedisTemplate.opsForValue().set(<span class="string">&quot;msg&quot;</span>,s);</span><br><span class="line">            Thread.sleep(<span class="number">30000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            rLock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/reader&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">readValue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">RReadWriteLock</span> <span class="variable">readWriteLock</span> <span class="operator">=</span> redissonClient.getReadWriteLock(<span class="string">&quot;rw-lock&quot;</span>);</span><br><span class="line">        <span class="comment">// 加读锁</span></span><br><span class="line">        <span class="type">RLock</span> <span class="variable">rLock</span> <span class="operator">=</span> readWriteLock.readLock();</span><br><span class="line">        rLock.lock();</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            s = stringRedisTemplate.opsForValue().get(<span class="string">&quot;msg&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            rLock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>在读写锁中，只有读读的行为是共享锁，相互之间不影响，只要有写的行为存在，那么就是一个互斥锁(排他锁)</p><h3 id="4-4-闭锁">4.4 闭锁</h3><p>基于Redisson的Redisson分布式闭锁（<a href="http://static.javadoc.io/org.redisson/redisson/3.10.0/org/redisson/api/RCountDownLatch.html">CountDownLatch</a>）Java对象 <code>RCountDownLatch</code>采用了与 <code>java.util.concurrent.CountDownLatch</code>相似的接口和用法；</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/lockDoor&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">lockDoor</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">RCountDownLatch</span> <span class="variable">door</span> <span class="operator">=</span> redissonClient.getCountDownLatch(<span class="string">&quot;door&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        door.trySetCount(<span class="number">5</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            door.await(); <span class="comment">// 等待数量降低到0</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;关门熄灯...&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/goHome/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">goHome</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span>&#123;</span><br><span class="line">        <span class="type">RCountDownLatch</span> <span class="variable">door</span> <span class="operator">=</span> redissonClient.getCountDownLatch(<span class="string">&quot;door&quot;</span>);</span><br><span class="line">        door.countDown(); <span class="comment">// 递减的操作</span></span><br><span class="line">        <span class="keyword">return</span> id + <span class="string">&quot;下班走人&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="4-5-信号量-Semaphore">4.5 信号量(Semaphore)</h3><p>基于Redis的Redisson的分布式信号量（<a href="http://static.javadoc.io/org.redisson/redisson/3.10.0/org/redisson/api/RSemaphore.html">Semaphore</a>）Java对象</p><p><code>RSemaphore</code>采用了与 <code>java.util.concurrent.Semaphore</code>相似的接口和用法。同时还提供了<a href="http://static.javadoc.io/org.redisson/redisson/3.10.0/org/redisson/api/RSemaphoreAsync.html">异步（Async）</a>、<a href="http://static.javadoc.io/org.redisson/redisson/3.10.0/org/redisson/api/RSemaphoreReactive.html">反射式（Reactive）</a>和<a href="http://static.javadoc.io/org.redisson/redisson/3.10.0/org/redisson/api/RSemaphoreRx.html">RxJava2标准</a>的接口。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/park&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">park</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">RSemaphore</span> <span class="variable">park</span> <span class="operator">=</span> redissonClient.getSemaphore(<span class="string">&quot;park&quot;</span>);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// park.acquire(); // 获取信号 阻塞到获取成功</span></span><br><span class="line">            b = park.tryAcquire();<span class="comment">// 返回获取成功还是失败</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;停车是否成功:&quot;</span> + b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/release&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">release</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">RSemaphore</span> <span class="variable">park</span> <span class="operator">=</span> redissonClient.getSemaphore(<span class="string">&quot;park&quot;</span>);</span><br><span class="line">        park.release();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;释放了一个车位&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="4-6-缓存数据一致性问题">4.6 缓存数据一致性问题</h3><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/2ab29d3241704c48a77981b80538d037.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/572fcf3f04e1424eb951a40dc7f829fd.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/2e3b5c9978f245119dce2840b1363964.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/1462/1647243560000/224bafb6fb644d3db088c61b5338548f.png" alt="image.png"></p><p>针对于上的两种解决方案我们怎么选择？</p><ol><li>缓存的所有数据我们都加上过期时间，数据过期之后主动触发更新操作</li><li>使用读写锁来处理，读读的操作是不相互影响的</li><li>读写锁</li></ol><p>无论是双写模式还是失效模式，都会导致缓存的不一致问题。即多个实例同时更新会出事。怎么办？</p><ol><li>如果是用户纬度数据（订单数据、用户数据），这种并发几率非常小，不用考虑这个问题，缓存数据加<br>上过期时间，每隔一段时间触发读的主动更新即可</li><li>如果是菜单，商品介绍等基础数据，也可以去使用canal订阅binlog的方式。</li><li>缓存数据+过期时间也足够解决大部分业务对于缓存的要求。</li><li>通过加锁保证并发读写，写写的时候按顺序排好队。读读无所谓。所以适合使用读写锁。（业务不关心<br>脏数据，允许临时脏数据可忽略）</li></ol><p>总结：</p><ul><li>我们能放入缓存的数据本就不应该是实时性、一致性要求超高的。所以缓存数据的时候加上过期时间，保证每天拿到当前最新数据即可。</li><li>我们不应该过度设计，增加系统的复杂性</li><li>遇到实时性、一致性要求高的数据，就应该查数据库，即使慢点。</li></ul><h1>三、SpringCache</h1><p>SpringCache的不足：</p><p>1).读模式</p><ul><li>缓存穿透：查询一个null的数据。可以解决 cache-null-values=true</li><li>缓存击穿:大量并发进来同时查询一个正好过期的数据。解决方案：分布式锁 sync=true 本地锁</li><li>缓存雪崩：大量的key同一个时间点失效。解决方案：添加过期时间 time-to-live=60000 指定过期时间</li></ul><p>2).写模式</p><ul><li>读写锁</li><li>引入canal，监控binlog日志文件来同步更新数据</li><li>读多写多，直接去数据库中读取数据即可</li></ul><p>总结：</p><ul><li>常规数据(读多写少)：而且对及时性和数据的一致性要求不高的情况，我们完全可以使用SpringCache</li><li>特殊情况：特殊情况特殊处理。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 分布式锁 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 缓存 </tag>
            
            <tag> 分布式锁 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sentinel</title>
      <link href="/2024/03/17/23-Sentinel/"/>
      <url>/2024/03/17/23-Sentinel/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=617ce318-a961-4920-2a16-a2eefd8f8be3</cover>
      <date>Sun Mar 17 2024 14:26:18 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>Sentinel</h1><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/dd1bac7295f04f1d9339c3fd9d46984e.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/9835188751fa4996bbe38864a0b839fa.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/6efeb6700b8545e6927441d5809d5c72.png" alt="image.png"></p><h1>一、熔断、降级、限流</h1><h2 id="1-熔断">1.熔断</h2><p>  <strong>服务熔断</strong>的作用类似于我们家用的保险丝，当某服务出现不可用或响应超时的情况时，为了防止整个系统出现雪崩，<strong>暂时停止</strong>对该服务的调用。</p><p><strong>停止</strong>是说，当前服务一旦对下游服务进行熔断，当请求到达时，当前服务不再对下游服务进行调用，而是使用设定好的策略(如构建默认值)直接返回。</p><p><strong>暂时</strong>是说，熔断后，并不会一直不再调用下游服务，而是以一定的策略(如每分钟调用 10 次，若均返回成功，则增大调用量)试探调用下游服务，当下游服务恢复可用时，自动停止熔断。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/487dc0237f5e4bb180af0e9b9bd6175e.png" alt="image.png"></p><h2 id="2-降级">2.降级</h2><p>  <strong>降级</strong>是指当自身服务压力增大时，采取一些手段，增强自身服务的处理能力，以保障服务的持续可用。比如，下线非核心服务以保证核心服务的稳定、降低实时性、降低数据一致性。</p><p>  为了预防某些功能出现负荷过载或者响应慢的情况，在其内部暂时舍弃一些非核心接口和数据的请求（如评论、积分），而直接返回一个提前准备好的 fallback(退路) 错误处理信息。释放CPU和内存资源，以保证整个系统的稳定性和可用性。</p><h2 id="3-限流">3.限流</h2><p>  <strong>限流</strong>是指上游服务对本服务请求 QPS 超过阙值时，通过一定的策略(如延迟处理、拒绝处理)对上游服务的请求量进行限制，以保证本服务不被压垮，从而持续提供稳定服务。常见的限流算法有滑动窗口、令牌桶、漏桶等。</p><h1>二、Sentinel</h1><h2 id="1-其他组件对比">1.其他组件对比</h2><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/a2c2950056424a4ab23ca48557c4b95b.png" alt="image.png"></p><h2 id="2-Sentinel介绍">2.Sentinel介绍</h2><p>  随着微服务的流行，服务和服务之间的稳定性变得越来越重要。Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</p><p>Sentinel 的历史：</p><ul><li>2012 年，Sentinel 诞生，主要功能为入口流量控制。</li><li>2013-2017 年，Sentinel 在阿里巴巴集团内部迅速发展，成为基础技术模块，覆盖了所有的核心场景。Sentinel 也因此积累了大量的流量归整场景以及生产实践。</li><li>2018 年，Sentinel 开源，并持续演进。</li><li>2019 年，Sentinel 朝着多语言扩展的方向不断探索，推出 C++ 原生版本，同时针对 Service Mesh 场景也推出了 Envoy 集群流量控制支持，以解决 Service Mesh 架构下多语言限流的问题。</li><li>2020 年，推出 Sentinel Go 版本，继续朝着云原生方向演进。</li></ul><p>Sentinel 分为两个部分:</p><ul><li>核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</li><li>控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</li></ul><p>Sentinel 可以简单的分为 Sentinel 核心库和 Dashboard。核心库不依赖 Dashboard，但是结合 Dashboard 可以取得最好的效果。</p><h2 id="3-基本概念及作用">3. 基本概念及作用</h2><p>基本概念：</p><p><strong>资源</strong>：是 Sentinel 的关键概念。它可以是 Java 应用程序中的任何内容，例如，由应用程序提供的服务，或由应用程序调用的其它应用提供的服务，甚至可以是一段代码。在接下来的文档中，我们都会用资源来描述代码块。</p><p>只要通过 Sentinel API 定义的代码，就是资源，能够被 Sentinel 保护起来。大部分情况下，可以使用方法签名，URL，甚至服务名称作为资源名来标示资源。</p><p><strong>规则</strong>：围绕资源的实时状态设定的规则，可以包括流量控制规则、熔断降级规则以及系统保护规则。所有规则可以动态实时调整。</p><p>主要作用：</p><ol><li>流量控制</li><li>熔断降级</li><li>系统负载保护</li></ol><p>我们说的资源，可以是任何东西，服务，服务里的方法，甚至是一段代码。使用 Sentinel 来进行资源保护，主要分为几个步骤:</p><ol><li>定义资源</li><li>定义规则</li><li>检验规则是否生效</li></ol><p>先把可能需要保护的资源定义好，之后再配置规则。也可以理解为，只要有了资源，我们就可以在任何时候灵活地定义各种流量控制规则。在编码的时候，只需要考虑这个代码是否需要保护，如果需要保护，就将之定义为一个资源。</p><h2 id="4-Sentinel应用">4.Sentinel应用</h2><p><strong>官方文档：</strong><a href="https://github.com/alibaba/spring-cloud-alibaba/wiki/Sentinel">https://github.com/alibaba/spring-cloud-alibaba/wiki/Sentinel</a></p><h3 id="4-1-Sentinel控制台搭建">4.1 Sentinel控制台搭建</h3><p>下载对应的jar包：<a href="https://github.com/alibaba/Sentinel/releases">https://github.com/alibaba/Sentinel/releases</a> 下载适合自己的版本</p><p>通过命令行启动：</p><p>java -Dserver.port=8080 -Dcsp.sentinel.dashboard.server=localhost:8080 -Dproject.name=sentinel-dashboard -jar sentinel-dashboard.jar</p><p>启动后需要输入账号密码:sentinel sentinel</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/49fcf9e0c3e14906a8690251cc56f12e.png" alt="image.png"></p><p>登录成功后看到的页面</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/5c2a2831d1d640e4a5b58afaf19ce8d8.png" alt="image.png"></p><h3 id="4-2-服务监控">4.2 服务监控</h3><p>  如果我们需要把自己的服务被Sentinel监控，那么我们需要添加对应的依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-sentinel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>然后需要添加对应的属性信息</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/cd7d243a9e794fca924cf92767743750.png" alt="image.png"></p><p>然后我们访问请求后，在控制台就可以看到对应的监控信息了</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/3480d38e5b884feb9124c9a5f70db2d5.png" alt="image.png"></p><p>然后我们可以指定简单的限流规则</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/9b3e31c7c62d44b88e1f33b7b059dd55.png" alt="image.png"></p><p>表示1秒中内只能有一个QPS。超过就限流</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/41b4ee67dcd94f97b418f1cd6995220e.png" alt="image.png"></p><p>测试我们发送请求快一点就会出现限流的处理</p><h3 id="4-3-实时监控">4.3 实时监控</h3><p>  实时监控这块需要引入Acuator</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>endpoint端点：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/138b9b5bd9c84fafac3a5d59f237aa03.png" alt="image.png"></p><h3 id="4-4-限流信息自定义">4.4 限流信息自定义</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SentinelUrlBlockHandler</span> <span class="keyword">implements</span> <span class="title class_">BlockExceptionHandler</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, BlockException e)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">R</span> <span class="variable">r</span> <span class="operator">=</span> R.error(<span class="number">500</span>,<span class="string">&quot;访问太快，稍后再试!&quot;</span>);</span><br><span class="line">        httpServletResponse.setContentType(<span class="string">&quot;application/json;charset=UTF-8&quot;</span>);</span><br><span class="line">        httpServletResponse.getWriter().write(JSON.toJSONString(r));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/787a38ef6ed74a0487d3840dd5726728.png" alt="image.png"></p><h2 id="5-sentinel容器安装">5.sentinel容器安装</h2><p>  直接在windows中安装Sentinel启动管理还是不太方便，所以我们还是把Sentinel安装在Docker容器中</p><p>拉取对应的镜像文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull bladex/sentinel-dashboard:1.7.2</span><br></pre></td></tr></table></figure><p>启动容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name sentinel  -d -p 8858:8858 -d  bladex/sentinel-dashboard:tagname</span><br></pre></td></tr></table></figure><p>开机自启动</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker update --restart=always sentinel</span><br></pre></td></tr></table></figure><p>访问：</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/e9bba308a5d4472785b22127b1dada1c.png" alt="image.png"></p><p>对应的客户端的使用：需要调整的配置信息</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/38651d4f76e54bd3897612cce72307fa.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/8a693edbfea74beebbdce1452e98ad2e.png" alt="image.png"></p><h2 id="6-Sentinel监控所有服务">6.Sentinel监控所有服务</h2><p>  我们需要对每一个服务都添加Sentinel的配置。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/0b0803d77df441cb9987f1a65292801c.png" alt="image.png"></p><h2 id="7-熔断降级">7.熔断降级</h2><p><a href="https://github.com/alibaba/spring-cloud-alibaba/wiki/Sentinel">https://github.com/alibaba/spring-cloud-alibaba/wiki/Sentinel</a></p><p>1.添加对应的配置</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/b6c715d576f44450a1820104f904a680.png" alt="image.png"></p><p>2.添加托底的方法</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/228cbe69f66744ebb9c91a0a360675f2.png" alt="image.png"></p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/179aa155093f4ba98b74d9acd5833e9a.png" alt="image.png"></p><p>手动配置：客户端的Sentinel版本需要和服务器的版本要保持一致。</p><p><img src="https://fynotefile.oss-cn-zhangjiakou.aliyuncs.com/fynote/fyfile/1462/1657258557058/e78b5c9f98b446108c53d1239b82166d.png" alt="image.png"></p><h2 id="8-自定义资源">8.自定义资源</h2><p><a href="https://github.com/alibaba/Sentinel/wiki/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8#%E5%AE%9A%E4%B9%89%E8%B5%84%E6%BA%90">https://github.com/alibaba/Sentinel/wiki/如何使用#定义资源</a></p>]]></content>
      
      
      <categories>
          
          <category> SpringCloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sentinel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>分布式笔记【RabbitMQ+Zookeeper+FastDFS】</title>
      <link href="/2022/05/16/%E5%88%86%E5%B8%83%E5%BC%8F%E7%AC%94%E8%AE%B0/"/>
      <url>/2022/05/16/%E5%88%86%E5%B8%83%E5%BC%8F%E7%AC%94%E8%AE%B0/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=23d0c7fe-5849-cec9-df4f-9c8d41c7e0ea</cover>
      <date>Mon May 16 2022 10:25:28 GMT+0800</date>
      
        <content type="html"><![CDATA[<h2 id="分布式-更新ing">分布式(更新ing)</h2><p>分布式项目的整合：</p><p><a href="https://www.processon.com/view/link/6281b28c0e3e746f2b12d0ee">https://www.processon.com/view/link/6281b28c0e3e746f2b12d0ee</a></p><span id="more"></span><pre><code>分布式架构会把一个项目按照特定要求（多按照模块或功能）拆分成多个项目，每个项目分别部署到不同的服务器上。</code></pre><h3 id="RMI">RMI</h3><p>运程方法调用</p><img src="分布式笔记/image-20220516101255871.png" alt="image-20220516101255871" style="zoom:67%;" /><h4 id="API">API</h4><h5 id="Remote">Remote</h5><p>​远程调用接口</p><h5 id="RemoteException">RemoteException</h5><p>​承了Remote接口的接口中，如果方法是允许被远程调用的，需要抛出此异常。</p><h5 id="UnicastRemoteObject">UnicastRemoteObject</h5><p>​java.rmi.server.UnicastRemoteObject<br>​此类实现了Remote接口和Serializable接口。<br>​自定义接口实现类除了实现自定义接口还需要继承此类。</p><h5 id="LocateRegistry">LocateRegistry</h5><p>​java.rmi.registry.LocateRegistry<br>​可以通过LocateRegistry在本机上创建Registry，通过特定的端口就可以访问这个Registry。</p><h5 id="Naming">Naming</h5><p>​java.rmi.Naming<br>​Naming定义了发布内容可访问RMI名称。也是通过Naming获取到指定的远程方法。</p><h3 id="zookeeper注册中心">zookeeper注册中心</h3><img src="分布式笔记/image-20220516101724270.png" alt="image-20220516101724270" style="zoom:67%;" /><h4 id="客户端常用命令">客户端常用命令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ls [-s][-R] /path</span><br><span class="line">查看列表</span><br><span class="line">get [-s] /path</span><br><span class="line">查看内容</span><br><span class="line">create /path [data]</span><br><span class="line">创建指定路径信息</span><br><span class="line">set /path data</span><br><span class="line">设置节点内容</span><br><span class="line">delete /path</span><br><span class="line">删除节点</span><br></pre></td></tr></table></figure><h4 id="注册内容">注册内容</h4><p>创建/demo<br>2     添加依赖<br>3     编写代码<br>创建zk对象获取连接<br>new watcher()内部重写process()<br>发布任务create()<br>ZooDefs.Ids.OPEN_ACL_UNSAFE<br>表示权限<br>CreateMode.PERSISTENT_SEQUENTIAL<br>永久存储，文件内容编号递增<br>4     查看上传数据</p><h4 id="查看内容">查看内容</h4><p>​创建zk对象获取连接<br>​new watcher()内部重写process()<br>​获取列表<br>​zookeeper.getChildren(“/demo”, false)<br>​zookeeper.getData(“/demo/” + child, false, null);</p><p>RPC实现(RMI+Zookeeper)</p><h3 id="Dubbo">Dubbo</h3><img src="分布式笔记/image-20220516101839047.png" alt="image-20220516101839047" style="zoom:67%;" /><p>​分布式服务框架<br>​负载均衡<br>​负载均衡是在集群前提下，当访问整个集群时，集群中每个节点被访问次数或频率的规则。<br>​设置<br>​@Reference 客户端<br>​注入的是分布式中的远程服务对象<br>​@Reference(loadbalance = “roundrobin”)<br>​调用的服务采用的负载均衡算法<br>​@Service服务端<br>​@Service(loadbalance = “random”)<br>​当前服务采用的负载均衡算法<br>​@Service(weight = 4)<br>​设置权重<br>​内置策略<br>​Random<br>​随机。随机访问集群中节点。访问概率和权重有关。<br>​RoundRobin<br>​轮询。访问频率和权重有关。<br>​性能好的服务器权重应该高一些。<br>​LeastActive<br>​活跃数相同的随机,活跃数高的放前面。<br>​ConsistentHash<br>​hash 相同参数发送到同一个提供者<br>​完整项目<br>​provider<br>​dubbo.protocal.port<br>​需要设置端口</p><h3 id="RabbitMQ">RabbitMQ</h3><img src="分布式笔记/image-20220516101905531.png" alt="image-20220516101905531" style="zoom:67%;" /><p>​由Erlang语言编写的基于AMQP的消息中间件。<br>​消息中间件作为分布式系统重要组件之一，可以解决应用耦合，异步消息，流量削峰等问题。<br>​账号管理<br>​1 创建账户<br>​./rabbitmqctl add_user username password<br>​2 给用户授予管理员角色</p><p>./rabbitmqctl set_user_tags mashibing administrator</p><p>​3 给用户授权<br>​./rabbitmqctl set_permissions -p “/” mashibing “.<em>&quot; &quot;.</em>” “.*”<br>​4 登录<br>​交换机<br>​direct 默认<br>​fanout 广播<br>​FanoutExchage<br>​Binding<br>​绑定交换器和队列<br>​BindingBuilder<br>​Bind构造器<br>​amq.fanout<br>​内置fanout交换器名称<br>​topic主题<br>​运行RoutingKey包含匹配规则<br>​binding方法里面第二个参数<br>​BindingBuilder.bind(topicQueue).to(topicExchange).with(“com.a”);<br>​Header首部</p><h3 id="FastDFS">FastDFS</h3><p>​分布式文件系统<br>​架构<br>​角色<br>​client<br>​Tracker Server<br>​跟踪服务器<br>​调度 负载均衡、记录集群状态信息、连接client和storage的枢纽<br>​Storage Server<br>​存储服务器<br>​文件和文件属性存储的地方<br>​文件上传流程<br>​1.  客户端访问Tracker<br>​2.  Tracker 返回Storage的ip和端口<br>​3.  客户端直接访问Storage，把文件内容和元数据发送过去。<br>​4.  Storage返回文件存储id。包含了组名和文件名</p><h3 id="Nginx">Nginx</h3><p>​反向代理服务<br>​代理方式<br>​正向<br>​架设在客户机和目标主机之间<br>​代理客户端，服务端不知道实际发起请求的客户端；<br>​反向<br>​架设在服务器端；<br>​代理服务端，客户端不知道实际提供服务的服务端；<br>​作用<br>​HTTP协议代理<br>​  搭建虚拟主机<br>​负载均衡</p>]]></content>
      
      
      <categories>
          
          <category> 分布式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 分布式 </tag>
            
            <tag> RabbitMQ </tag>
            
            <tag> Zookeeper </tag>
            
            <tag> FastDFS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql8项目连接出错&amp;端口为0</title>
      <link href="/2022/05/10/mysql8%E9%A1%B9%E7%9B%AE%E8%BF%9E%E6%8E%A5%E5%87%BA%E9%94%99-%E7%AB%AF%E5%8F%A3%E4%B8%BA0/"/>
      <url>/2022/05/10/mysql8%E9%A1%B9%E7%9B%AE%E8%BF%9E%E6%8E%A5%E5%87%BA%E9%94%99-%E7%AB%AF%E5%8F%A3%E4%B8%BA0/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=188a4221-b287-fe29-0c78-c7a775fc5da9</cover>
      <date>Tue May 10 2022 14:23:51 GMT+0800</date>
      
        <content type="html"><![CDATA[<h2 id="MySQL8端口为0">MySQL8端口为0</h2><p>今天连接数据库的时候，密码正确，配置也没毛病，但是就是连不上</p><span id="more"></span><img src="mysql8项目连接出错-端口为0/image-20220510141117583.png" alt="image-20220510141117583" style="zoom:67%;" /><p>于是去查了查端口</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global variables like &#x27;port&#x27;;</span><br></pre></td></tr></table></figure><p>显示</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+---------------+-------+</span><br><span class="line">| Variable_name | Value |</span><br><span class="line">+---------------+-------+</span><br><span class="line">| port          | 0     |</span><br><span class="line">+---------------+-------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>竟然不是3306</p><p>去网上查资料发现可能是之前某些操作让skip-networking打开了</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SHOW VARIABLES LIKE <span class="string">&quot;skip_networking&quot;</span>;</span></span><br><span class="line">+-----------------+-------+</span><br><span class="line">| Variable_name   | Value |</span><br><span class="line">+-----------------+-------+</span><br><span class="line">| skip_networking | ON    |</span><br><span class="line">+-----------------+-------+</span><br><span class="line">1 row in set (0.01 sec)</span><br></pre></td></tr></table></figure><p>查了果然</p><h3 id="解决办法">解决办法</h3><p>需要将my.cnf中的skip_networking注释掉</p><p>还是不行！！！</p><p>最终 我还是重装了mysql5</p><h4 id="重装过程">重装过程</h4><p>卸载原来的mysql8 删干净点 我主要删了下面这些</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo rm /usr/local/mysql</span><br><span class="line">sudo rm -rf /Library/StartupItems/M</span><br><span class="line">sudo rm -rf /Library/PreferencePanes/My*</span><br><span class="line">sudo rm -rf /Library/Receipts/mysql</span><br><span class="line">sudo rm -rf /var/db/receipts/com.mysql.</span><br><span class="line">sudo rm /tmp/mysql.sock</span><br><span class="line">sudo rm /tmp/mysql.sock.lock</span><br><span class="line">sudo rm /tmp/mysqlx.sock.lock</span><br><span class="line">sudo rm /tmp/mysqlx.sock</span><br></pre></td></tr></table></figure><p>安装地址<a href="https://downloads.mysql.com/archives/community/">https://downloads.mysql.com/archives/community/</a></p><img src="mysql8项目连接出错-端口为0/image-20220510141312668.png" alt="image-20220510141312668" style="zoom: 50%;" /><p>然后注意安装完毕开启mysql服务</p><p>在系统偏好里面</p><img src="mysql8项目连接出错-端口为0/image-20220510141750537.png" alt="image-20220510141750537" style="zoom: 50%;" /><img src="mysql8项目连接出错-端口为0/image-20220510141819985.png" alt="image-20220510141819985" style="zoom: 50%;" /><p>然后在iterm里面先要设置mysql命令行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alias mysql=/usr/local/mysql/bin/mysql</span><br><span class="line">alias mysqladmin=/usr/local/mysql/bin/mysqladmin</span><br></pre></td></tr></table></figure><p>设置新密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqladmin -u root -p password 你的密码</span><br></pre></td></tr></table></figure><p>然后输入初始密码，应为mysql5.7会在通知栏里面把初始的密码发送给你</p><p>这样就修改完了。</p><p>查看数据库端口：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">show global variables like <span class="string">&#x27;port&#x27;</span>;</span></span><br><span class="line">+---------------+-------+</span><br><span class="line">| Variable_name | Value |</span><br><span class="line">+---------------+-------+</span><br><span class="line">| port          | 3306  |</span><br><span class="line">+---------------+-------+</span><br><span class="line">1 row in set (0.01 sec)</span><br></pre></td></tr></table></figure><p>!!!端口终于对了，打开项目连接数据库终于没有出错了！！！</p>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> macOS </tag>
            
            <tag> 踩雷 </tag>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>四月面经</title>
      <link href="/2022/05/09/%E5%9B%9B%E6%9C%88%E9%9D%A2%E7%BB%8F/"/>
      <url>/2022/05/09/%E5%9B%9B%E6%9C%88%E9%9D%A2%E7%BB%8F/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=747b0e17-2fde-54b4-c9a2-9c3003c1d895</cover>
      <date>Mon May 09 2022 10:01:20 GMT+0800</date>
      
        <content type="html"><![CDATA[<p>这次春招拖到四月才面…先已收到兴业数金、华为、平安的offer，签了平安。</p><p>总结几篇我认为有必要记录的面经：字节、华为（有时间就更新）</p><span id="more"></span><h2 id="字节面经">字节面经</h2><p><strong>第一次面字节 真的很紧张 其他面试也就经历过一两轮 面试小白真的害怕 没想到字节一面没有很刁钻也不会很难 都是简单的八股 <a href="">算法</a>也是简单dp</strong></p><ol><li><p>自我介绍</p></li><li><p>hashmap put() 工作流程 （讲了一下源码）</p></li><li><p>concurrenthashmap怎么做到并发安全（简单讲了1.7/8 的锁实现）</p></li><li><p>面试官从上面引出CAS 叫我描述一下（乐观、预值、新值、底层原理）</p></li><li><p>java的其他锁（巴拉巴拉讲了sych、AQS框架下的几个锁）</p></li><li><p>ThreadLocal什么时候使用（说了下底层、声明式事务保证同一个connection）</p></li><li><p>垃圾回收（算法、回收器都简单讲了讲）</p></li><li><p>网络http头有哪些字段、长连接短连接、状态码、https原理、hash不可逆（http请求头这里我真的弱，具体就私钥公钥，CA证书这里讲的还可以😭 然后还把hash说成可逆😭</p></li><li><p>TCP三次、四次；timewait状态只有客户端吗？（还好猜对了，timewait只是针对一个发起者）、可靠性怎么理解</p></li><li><p>I/O多路复用，哪些地方用到了（select poll epoll ，redis）</p></li><li><p>掩码、网络地址转换（网络真的我软肋 后面要恶补呜呜</p></li><li><p>堆 和建堆过程、 排序有哪些、快排过程</p></li><li><p>算法：最小路径和，要求返回路径（返回路径这里我死脑阔 可以for循环dp就返回的 我在那duo键盘duo半天去搞了一个dfs去原矩阵找😓 最后面试官看出来我想干啥 就提示了一下 我就是一整个恍然大悟）</p></li></ol><p><strong>反问</strong></p><p>因为面试经验很少，就问了面试官可不可以说一下我需要注意的点，面试官说很多时候知识比技巧更重要吧，很实诚就给我讲面试要把知识掌握全面，就比如我网络http这方面就需要加强。</p><h4 id="总结">总结</h4><p>整体还是网络方面出问题，感觉面试官很耐心听我扯，没有像之前面的某公司老打断我，真的挺温柔的；然后我觉得后期应该多深入一下知识，把问题说得更加全面，一方面留好印象，一方面就可以让面试官少问点，少暴露自己的缺点，网络方面补一补</p><p>---------</p><p>二面 4.25</p><p>自我介绍之后挑了一个项目讲，通过项目问了一些扩展的点 在mybatis一些语句的细节上没有答出来 大概是35min左右就面完了 面试官很温柔 但是因为细节 我觉得多半寄了</p><hr><p>后续打电话捞我去面试说是重庆和北京的岗位，我因为已经签了，不想去卷，放弃了</p><h2 id="华为面经-已offer">华为面经(已offer)</h2><p>大概流程</p><img src="四月面经/image-20220515102055742.png" alt="image-20220515102055742" style="zoom:67%;" /><h3 id="机考">机考</h3><p>总共三道算法，第一题就是简单的字符串转换器，第二题忘了，第三题是一个路径题，应该会用到图</p><p>第一题过了百分之80% 第三题 过了15%</p><p>总分一百分以上就过了，这个比较好过</p><h3 id="性格测评">性格测评</h3><p>听说华为的性格测评还刷了很多人，反正秘诀我认为就是实话实说，然后在30分钟左右做完。</p><h3 id="专业面试1-4-16">专业面试1 4.16</h3><p>本来学的后端开发，然后报的是软件测试的岗位，以为面试会问很多测试方面知识，准备了很多，结果华为注重的大多是学校里的经历和获奖以及成绩。</p><ol><li>自我介绍完毕后简单问了一下比赛和成绩。</li><li>问学了哪些课程，然后根据我说的课程问了些基础</li><li>数据结构问了：排序、有哪些结构分别讲讲（说了说链表、图、栈、队列）</li><li>计算机网路问了：http、RIP协议（不擅长的千万不要说出来！！我可能是因为这科拉胯了我的综测我一直记恨在心，没多想结果就说出口了）</li><li>软件工程问了： 直接讲学了什么（我大概把程序从需求设计到实现然后再小心机的把测试部分讲了讲）</li></ol><p>还有细碎问题忘了</p><h3 id="主管面4-18">主管面4.18</h3><p>主要就是聊天，然后问问对华为公司的了解，是否定居成都，然后想不想转岗，我都按着求稳来答的，也问了问在校成绩。</p><p>4.18面结束以后就审批等了很久，然后hr人非常好，一直持续跟进，</p><h3 id="5-9-拒绝offer">5.9 拒绝offer</h3><p>在5.6说我的offer稳了，综合考虑薪资待遇和工作环境，我认为我可能不适合测试岗，并且华为的环境我有所耳闻，如果9116，我受不了，前两年都需要时间去学习，而不是全部都栽进工作。</p>]]></content>
      
      
      <categories>
          
          <category> 面经 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 后端 </tag>
            
            <tag> 测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo + GitHub搭建个人博客</title>
      <link href="/2022/05/06/Hexo-GitHub%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A22/"/>
      <url>/2022/05/06/Hexo-GitHub%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A22/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=99093162-647e-3f37-35ac-8663d0e2b5c1</cover>
      <date>Fri May 06 2022 10:24:55 GMT+0800</date>
      
        <content type="html"><![CDATA[<h2 id="安装hexo">安装hexo</h2><h3 id="1-前提准备：">1.前提准备：</h3><ul><li><p>安装git</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install git</span><br></pre></td></tr></table></figure><span id="more"></span><p>验证</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git --version </span><br></pre></td></tr></table></figure></li><li><p>安装node.js</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install node</span><br></pre></td></tr></table></figure></li></ul><h3 id="2-安装">2.安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><h3 id="3-创建博客文件夹并初始化">3.创建博客文件夹并初始化</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><h3 id="4-本地启动">4.本地启动</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>访问本地链接：<a href="">http://localhost:4000/</a></p><p>显示如下页面，表示安装成功</p><img src="Hexo-GitHub搭建个人博客2/image-20220506213244777.png" alt="image-20220506213244777" style="zoom:33%;" /><h2 id="安装next主题">安装next主题</h2><p>hexo官网主题：<a href="">https://hexo.io/themes/</a></p><p>这里以next为例</p><h3 id="1-在创建文件夹下安装主题">1.在创建文件夹下安装主题</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/theme-next/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure><h3 id="2-修改文件夹下的-config-yml文件">2.修改文件夹下的_config.yml文件</h3><img src="Hexo-GitHub搭建个人博客2/image-20220504215029708.png" alt="image-20220504215029708" style="zoom: 25%;" /><p>修改theme为next</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">next</span></span><br></pre></td></tr></table></figure><p>再次访问页面：</p><img src="Hexo-GitHub搭建个人博客2/image-20220504215421643.png" alt="image-20220504215421643" style="zoom: 33%;" /><p>表示next主题安装成功</p><h2 id="部署到github仓库">部署到github仓库</h2><h3 id="1-创建仓库">1.创建仓库</h3><p>仓库名<strong><a href="http://xn--xxx-x58d286gfsg.github.io">严格按xxx.github.io</a></strong>来（xxx为github用户名 且 小写！</p><img src="Hexo-GitHub搭建个人博客2/image-20220505154551563.png" alt="image-20220505154551563" style="zoom:33%;" /><h3 id="2-配置SSH">2.配置SSH</h3><p>如果已经配置过就跳过。</p><p>生成SSH key</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C 你的邮箱</span><br></pre></td></tr></table></figure><p>这个邮箱是github绑定的邮箱</p><p>然后登陆github，在Settings里面的SSH and GPG keys里面添加new SSH key</p><img src="Hexo-GitHub搭建个人博客2/image-20220504220404992.png" alt="image-20220504220404992" style="zoom: 33%;" /><p>验证是否成功</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><img src="Hexo-GitHub搭建个人博客2/image-20220504221105797.png" alt="image-20220504221105797" style="zoom: 50%;" /><h3 id="3-部署到github">3.部署到github</h3><p>安装git部署插件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>打开_config.yml文件，地步修改部署配置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:youname/youname.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><p>保存后终端执行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>在浏览器输入xxx.github.io就可以看到自己的一个博客了</p><h2 id="常用的hexo命令">常用的hexo命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo -g #安装Hexo</span><br><span class="line">npm update hexo -g #升级</span><br><span class="line">hexo init #初始化博客</span><br><span class="line"></span><br><span class="line">命令简写</span><br><span class="line">hexo n “我的博客” == hexo new “我的博客” #新建文章</span><br><span class="line">hexo g == hexo generate #生成</span><br><span class="line">hexo s == hexo server #启动服务预览</span><br><span class="line">hexo d == hexo deploy #部署</span><br><span class="line"></span><br><span class="line">hexo server #Hexo会监视文件变动并自动更新，无须重启服务器</span><br><span class="line">hexo server -s #静态模式</span><br><span class="line">hexo server -p 5000 #更改端口</span><br><span class="line">hexo server -i 192.168.1.1 #自定义 IP</span><br><span class="line">hexo clean #清除缓存，若是网页正常情况下可以忽略这条命令</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络IO</title>
      <link href="/2022/03/10/%E7%BD%91%E7%BB%9CIO/"/>
      <url>/2022/03/10/%E7%BD%91%E7%BB%9CIO/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=394a4765-a230-18bc-c02e-42baad06fe85</cover>
      <date>Thu Mar 10 2022 22:34:41 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>网络</h1><h2 id="TCP">TCP</h2><img src="https://img.soniachen.com/blog/posts/2025/06/image-20220318165203569.png" alt="image-20220318165203569" style="zoom:33%;" /><span id="more"></span><p>是一个基于字节流的一个传输层的通信协议，在发送数据之前双方是需要建立一个连接的，这个所谓的连接就是双方都保存一个对方的ip地址还有端口等信息，然后TCP其实是一个字节流，头部就保存了这些信息，进行连接的时候有三个阶段：建立连接、传输数据、关闭连接，三次握手来建立，四次挥手来关闭，其中交换的报文都是tcp的头部。</p><h3 id="三次握手">三次握手</h3><p>三次握手是一个在内核发生的一个行为，基于TCP协议，，首先呢，客户端应用启动以后，服务端进入listen状态，为了未来收到数据包做准备，然后在这个状态下内核进行了三次握手，</p><ol><li>首先第一次是客户端向服务端发送带有SYN，代表发送连接的标识，的一个报文，自己进入一个SYN-SENT状态，然后服务器接收进入SYN-RECV状态</li><li>第二次是服务器发送带有SYN+ACK的报文，ACK是确认序号有效的标识，客户端接收进入established状态；</li><li>然后就是最后一次握手 因为服务端还需要知道自己发送和对方接收是否成功，所以客户端发送带有ACK标识的报文，服务端接收到才进入establised状态，以上三次握手就进行完毕</li></ol><img src="https://img.soniachen.com/blog/posts/2025/06/image-20220318122004676.png" alt="image-20220318122004676" style="zoom:50%;" /><p>然后在这里以后应用要进行接收，就得将连接的socket放入accept队列，需要IO模型，调用server.accept() 如果队列里面有就取出来传到应用里，这里就有两种模型分别是阻塞等待返回的BIO和无阻塞轮询返回的NIO；还有一种模型是多路复用器，调用select,poll,epoll，但是它只是做一个和内核调用来知道队列里面是否有事件，然后再去有效性地进行一个accep()方法的调用</p><h3 id="四次分手">四次分手</h3><img src="https://img.soniachen.com/blog/posts/2025/06/image-20220318142304657.png" alt="image-20220318142304657" style="zoom:50%;" /><p>客户端完成数据传输，要准备释放连接的时候：</p><ol><li><p>进行第一次挥手，发一个带FIN（代表释放连接的标识）的报文给服务端然后进入FIN_WAIT1状态，服务接收到以后进入一个CLOSE-WAIT状态；</p></li><li><p>第二次挥手就是，服务器端向客户端发带ACK标识的报文，客户端接收后又进入FIN-WAIT状态，等待服务端将数据处理完毕收尾；</p></li><li><p>第三次服务端再去发送一个带FIN和ACK的报文，之前不一起发是因为服务端接收以后需要将数据发送进行完毕,在一个CLOSE-WAIT状态，搞定以后再发，客户端接收后进入TIME_WAIT状态；</p></li><li><p>然后就是第四次，客户端发送一个带ACK的报文给服务端，这里客户端的TIME-wait状态不能直接结束需要等待两倍报文寿命时间，再去closed，为什么是两倍报文寿命的时间是因为又肯呢个会出现服务器丢包的问题，但是服务端没接收到就会继续发送FIN，客户端要等待这么一个一去一回的时间来确认服务端没有再发送FIN，也就是确认服务端是否接收到，再去关闭，服务端接收到就会进入closed状态；</p><p>以上就是我了解的四次挥手过程。</p></li></ol><h3 id="与UDP的区别">与UDP的区别</h3><p>udp  是用户数据协议，tcp是传输控制协议， 我就从这几个方面进行比较吧，首先一个是udp是无连接的，tcp是基于连接的， 第二个方面是他们的传输方式，udp 是报文， tcp是一个字节流，第三个是他们连接方式，udp是一对一一对多，多对多多对一的通信，而tcp只能是一对一，从这就可以看出第四方面他们的可靠性和安全性tcp明显是要高一些，也导致tcp首部要传输的信息很多，开销大，适用的场景就是文件传输，udp就可以在实时应用比如视频会议电话等场景用。</p><h3 id="粘包">粘包</h3><p>TCP协议是面向连接的可靠性协议。说它可靠并不表示数据信息一定会被对端接受，而是在传输失败后会放弃重传机制并中断连接来通知用户。它提供的只是数据可靠性的传输和故障通知。</p><p>TCP是数据流传输，数据流是只有起点和终点的字节数据序列，只有输入流和输出流。根本不存在“包”的概念。粘包的包是应用层的包，应用层协议规定了包的结构和大小，本质上就是一段数据报文。比如一段http请求，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//http 请求</span></span><br><span class="line">GET /hello.txt HTTP/<span class="number">1.1</span></span><br><span class="line">User-Agent: curl/<span class="number">7.16</span><span class="number">.3</span> libcurl/<span class="number">7.16</span><span class="number">.3</span> OpenSSL/<span class="number">0.9</span>.<span class="number">7l</span> zlib/<span class="number">1.2</span><span class="number">.3</span></span><br><span class="line">Host: www.example.com</span><br><span class="line">Accept-Language: en, mi</span><br></pre></td></tr></table></figure><h4 id="TCP粘包的原因">TCP粘包的原因</h4><p>首先粘包的情况可能是recv-buffer这个缓冲区里有a包的一部分，或者a包和b包的一部分都有，原因从<strong>发送端</strong>来讲可能是send发送数据的时候因为还没收到接收端的ACK，就暂时将数据填充到缓冲区中等待，<strong>接收端</strong>方面就可能是因为处理数据不及时，数据都堆在缓冲区，致使ab包相连。</p><h4 id="如何解决粘包呢？">如何解决粘包呢？</h4><ol><li>固定包长度。每个包的大小都是一样的。</li><li>在包中给定包大小。例如：（固定前4个字节为包大小）</li><li>设置特定的结束标志。</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">struct Message &#123;undefined</span><br><span class="line">    <span class="type">int</span> packSize;</span><br><span class="line">    <span class="type">int</span> type;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">100</span>];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>http协议就是使用了上述的2，3方法。http使用&quot;\r\n&quot;为结束标识。</p><p>当为post请求时则有content-Length标识请求体长度。</p><h2 id="Connection-refused">Connection refused</h2><p>可能是一个网络问题，还有可能就是内核建立连接发给程序的时候，那个accept队列阻塞了。</p><p>因为是内核帮助建立连接，程序必须通过listen里面的accept接收队列来进行一个等待程序的接收，有一个大小限制的backlog，如果队列满了可能就会造成一个报错， 是内核和程序之间发生的一个卡。</p><h2 id="Session-Cookie-Token">Session , Cookie, Token</h2><p><img src="https://img.soniachen.com/blog/posts/2025/06/image-20220318165316329.png" alt="image-20220318165316329"></p><p>因为http协议本身是一个无状态也就是浏览器没办法判断用户身份，然后cookie提供了暂时保存用户信息的一个作用，它其实是一个服务器放在浏览器上面的一个key-value形式的一个小文件，如果服务器需要保存用户状态，就通过response给客户端颁发一个cookie，下次浏览器再请求的时候再将cookie提交，服务器检查来进行辨认。</p><p>而session呢，是域对象之一，是会话过程中服务器分的一块储存空间，但也是依赖着cookie实现的，浏览器会在cookie里面设置sessionid， 服务器根据sessionid取出session中存储的信息。</p><p>两者区别呢就是存储空间的限制，session是没有限制的，cookie是有限制的，然后就是存储的位置，cookie是在浏览器上，session是在服务器端，这样安全性也就可以看出来cookie的不高，另一方面占用资源 session也会更多更加降低性能。</p><p>而token呢，是因为客户端如果频繁向服务端请求数据，服务端频繁的去数据库查询会有很多压力，使用token呢，就会降低服务器压力，减少频繁访问数据库，增强健壮性，token是服务端产生的字符串，作为一个客户端请求的令牌，第一次登陆就生成给客户端，以后客户端就拿这个token来请求数据，不用用户名和密码。 和session的区别就是session存储在服务器端，而token是在浏览器端，并且还提供认证功能，安全性比session好，不会让服务器压力很大，适用于项目级的前后端分离项目，session只能在服务器和客户端在同一台机器的场景使用。</p><h2 id="HTTP">HTTP</h2><h3 id="常用HTTP状态码：">常用HTTP状态码：</h3><table><thead><tr><th>2XX</th><th>成功（这系列表明请求被正常处理了）</th></tr></thead><tbody><tr><td>200</td><td>OK，表示从客户端发来的请求在服务器端被正确处理</td></tr><tr><td>204</td><td>No   content，表示请求成功，但响应报文不含实体的主体部分</td></tr><tr><td>206</td><td>Partial   Content  ，进行范围请求成功</td></tr><tr><td>3XX</td><td>重定向  （表明浏览器要执行特殊处理）</td></tr><tr><td>301</td><td>moved permanently，永久  性重定向，表示资源已被分配了新的 URL</td></tr><tr><td>302</td><td>found，临时性重定向，表示资源临时被分配了新的   URL</td></tr><tr><td>303</td><td>see   other，表示资源存在着另一个 URL，  应使用   GET 方法获取资源  （对于  301/302/  303响应，几乎所有浏览器都会删除报文主体并  自动用  GET重新请求）</td></tr><tr><td>304</td><td>not   modified ，表示服务器允许访问资源，但请求未满足条件的情况（与重定向无关）</td></tr><tr><td>307</td><td>temporary   redirect，临时重定  向，和302 含义类似，但是期望客户端保持请求方法不变向新的地址发出请求</td></tr><tr><td>4XX</td><td>客户端错误</td></tr><tr><td>400</td><td>bad   request，请求报文存在语法错误</td></tr><tr><td>401</td><td>unauthorized，表示发送的请求需要有通过   HTTP 认证的认证信息</td></tr><tr><td>403</td><td>forbidden  ，表示对请求资源的访问被服务器拒绝，可在实体主体部分返回原因描述</td></tr><tr><td>404</td><td>not   found，表示在服务器上没有找到请求的资源</td></tr><tr><td>5XX</td><td>服务器错误</td></tr><tr><td>500</td><td>internal   sever   error，表  示服务器端在执行请求时发生了错误</td></tr><tr><td>501</td><td>Not   Implemented，表示服务器不支持当前请求所需要的某个功能</td></tr><tr><td>503</td><td>service unavailable，表明服务器暂时处于超负载或正在停机维护，无法处理请求</td></tr></tbody></table><h3 id="HTTP1和HTTP2">HTTP1和HTTP2</h3><p>HTTP2 可以提高了网页的性能。</p><p>在 HTTP1 中浏览器限制了同一个域名下的请求数量（Chrome 下一般是六</p><p>个），当在请求很多资源的时候，由于队头阻塞当浏览器达到  大请求数量时，剩余的资源需等待当前的六个请求完成后才能发起请求。</p><p>HTTP2 中引入了多路复用的技术，这个技术可以只通过一个 TCP 连接就可以传输所有的请求数据。多路复用可以绕过浏览器限制同一个域名下的请求数量的问题，进而提高了网页的性能。</p><h3 id="HTTPS">HTTPS</h3><p>HTTP 是一个在计算机世界里专门在两点之间传输文字、图片、音频、视频等超文本数据的约定和规范</p><table><thead><tr><th>区别</th><th>HTTP</th><th>HTTPS</th></tr></thead><tbody><tr><td>协议</td><td>运行在   TCP 之上，明文传输，客户端与服务器端都无法验证对方的身份</td><td>身披 SSL(   Secure   Socket   Layer  )外壳的   HTTP，运行于 SSL 上，SSL 运行于   TCP 之  上，  是添加了加密和认证机制的   HTTP。</td></tr><tr><td>端口</td><td>80</td><td>443</td></tr><tr><td>资源消耗</td><td>较少</td><td>由于加解密处理，会消耗更  多的 CPU 和内存资源</td></tr><tr><td>开销</td><td>无需证书</td><td>需要证书，而证书一般需要向认证机构购买</td></tr><tr><td>加密机制</td><td>无</td><td>共享密钥加密和公开密钥加密并用的混合加密机制</td></tr><tr><td>安全性</td><td>弱</td><td>由于加密机制，安全性强</td></tr></tbody></table><h2 id="get和post的区别">==get和post的区别==</h2><img src="https://img.soniachen.com/blog/posts/2025/06/image-20220318165233672.png" alt="image-20220318165233672" style="zoom:50%;" /><ul><li>GET在浏览器回退时是无害的，而POST会再次提交请求。</li><li>GET产生的URL地址可以被Bookmark，而POST不可以。</li><li>GET请求会被浏览器主动cache，而POST不会，除非手动设置。</li><li>GET请求只能进行url编码，而POST支持多种编码方式。</li><li>GET请求参数会被完整保留在浏览器历史记录里，而POST中的参数不会被保留。</li><li>GET请求在URL中传送的参数是有长度限制的，而POST则没有。对参数的数据类型GET只接受ASCII字符，而POST即可是字符也可是字节。</li><li>GET比POST更不安全，因为参数直接暴露在URL上，所以不能用来传递敏感信息。</li><li>GET参数通过URL传递，POST放在Request body中。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络 </tag>
            
            <tag> IO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>算法高频题总结</title>
      <link href="/2022/02/23/%E7%AE%97%E6%B3%95%E9%AB%98%E9%A2%91%E9%A2%98%E6%80%BB%E7%BB%93/"/>
      <url>/2022/02/23/%E7%AE%97%E6%B3%95%E9%AB%98%E9%A2%91%E9%A2%98%E6%80%BB%E7%BB%93/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=b55d8eca-b906-d6ff-c135-b95458b05c7c</cover>
      <date>Wed Feb 23 2022 10:24:18 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>高频题</h1><h2 id="三数之和">三数之和</h2><p><a href="##%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C##">两数之和</a>为基础</p><blockquote><p>给你一个包含 n 个整数的数组 nums，判断 nums 中是否存在三个元素 a，b，c ，使得 a + b + c = 0 ？请你找出所有和为 0 且不重复的三元组。</p><p>注意：答案中不可以包含重复的三元组。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 先将数组排序</span></span><br><span class="line">  <span class="comment">// 2 从后往前遍历最后一个数 找对应的二元组：二元组 + arr[i] = 0</span></span><br><span class="line">  <span class="comment">// 2.1 保证不重复</span></span><br><span class="line">  <span class="comment">// 2.2 找出前面部分满足条件的二元组</span></span><br><span class="line">  <span class="comment">// 2.3 遍历将arr[i]添加在后面</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">threeSum</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">      <span class="comment">// 1</span></span><br><span class="line">      Arrays.sort(nums);</span><br><span class="line">      <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> nums.length;</span><br><span class="line">      List&lt;List&lt;Integer&gt;&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">      <span class="comment">// 2</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> N - <span class="number">1</span>; i &gt; <span class="number">1</span>; i--) &#123; <span class="comment">// 三元组最后一个数，是arr[i]   之前....二元组 + arr[i]</span></span><br><span class="line">          <span class="comment">// 2.1</span></span><br><span class="line">          <span class="keyword">if</span> (i == N - <span class="number">1</span> || nums[i] != nums[i + <span class="number">1</span>]) &#123;</span><br><span class="line">              <span class="comment">// 2.2</span></span><br><span class="line">              List&lt;List&lt;Integer&gt;&gt; nexts = twoSum(nums, i - <span class="number">1</span>, -nums[i]);</span><br><span class="line">              <span class="comment">// 2.3</span></span><br><span class="line">              <span class="keyword">for</span> (List&lt;Integer&gt; cur : nexts) &#123;</span><br><span class="line">                  cur.add(nums[i]);</span><br><span class="line">                  ans.add(cur);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> ans;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// nums[0...end]这个范围上，有多少个不同二元组，相加==target，全返回</span></span><br><span class="line">  <span class="comment">// &#123;-1,5&#125;     K = 4</span></span><br><span class="line">  <span class="comment">// &#123;1, 3&#125;</span></span><br><span class="line">  <span class="comment">// 1 两个指针</span></span><br><span class="line">  <span class="comment">// 2 两数相加大于目标值就右缩;小于就左缩;等于就添加在结果集里面（先加左再加右）</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">twoSum</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> end, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">      <span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">      <span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> end;</span><br><span class="line">      List&lt;List&lt;Integer&gt;&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">      <span class="keyword">while</span> (L &lt; R) &#123;</span><br><span class="line">          <span class="keyword">if</span> (nums[L] + nums[R] &gt; target) &#123;</span><br><span class="line">              R--;</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[L] + nums[R] &lt; target) &#123;</span><br><span class="line">              L++;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123; <span class="comment">// nums[L] + nums[R] == target</span></span><br><span class="line">              <span class="keyword">if</span> (L == <span class="number">0</span> || nums[L - <span class="number">1</span>] != nums[L]) &#123;</span><br><span class="line">                  List&lt;Integer&gt; cur = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">                  cur.add(nums[L]);</span><br><span class="line">                  cur.add(nums[R]);</span><br><span class="line">                  ans.add(cur);</span><br><span class="line">              &#125;</span><br><span class="line">              L++;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> ans;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="两数之和">两数之和</h2><blockquote><p>给定一个整数数组 <code>nums</code> 和一个整数目标值 <code>target</code>，请你在该数组中找出 <strong>和为目标值</strong> <em><code>target</code></em> 的那 <strong>两个</strong> 整数，并返回它们的数组下标。</p></blockquote><p>1 使用hashmap 结构 map.put(nums[i], i)</p><p>2 遍历一遍 如果查询到map里面有与解 就返回i和mapget的value</p><p>3 最后如果没有找到就返回new int[0]</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] twoSum(<span class="type">int</span>[] nums, <span class="type">int</span> target) &#123;</span><br><span class="line">        HashMap&lt;Integer, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i ++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(map.containsKey(target - nums[i]))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;i, map.get(target - nums[i])&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">            map.put(nums[i], i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="搜索旋转排序数组（面试）">搜索旋转排序数组（面试）</h2><p><strong>使用二分查找</strong></p><blockquote><p>整数数组nums按升序排列，数组中的值互不相同。</p><p>arr，原本是有序数组，旋转过，而且左部分长度不知道.(以某一个下标为轴旋转 例如， <code>[0,1,2,4,5,6,7]</code> 在下标 <code>3</code> 处经旋转后可能变为 <code>[4,5,6,7,0,1,2]</code> 。)</p><p>题目需要在arr里面找到target</p></blockquote><p><strong>思路</strong>：</p><ol><li><code>L = M = R</code> 是最差的情况 不知道断点</li><li><code>L != M == R</code>/ <code>L == M != R</code>/ <code>L != M != R</code> 只要三个数不全部一样就可以进行<strong>二分</strong></li></ol><img src="算法高频题总结/image-20220508120620575.png" alt="image-20220508120620575" style="zoom: 33%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">search</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> nums.length;</span><br><span class="line"><span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> N - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (L &lt;= R) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">M</span> <span class="operator">=</span> (L + R) / <span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span> (nums[M] == target) &#123;</span><br><span class="line"><span class="keyword">return</span> M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// nums[M] != target</span></span><br><span class="line"><span class="comment">// 1 左 中 右 相等 -- 》不能二分</span></span><br><span class="line"><span class="keyword">if</span> (nums[L] == nums[M] &amp;&amp; nums[M] == nums[R]) &#123;</span><br><span class="line"><span class="comment">// 左中一直相等 L ++</span></span><br><span class="line"><span class="keyword">while</span> (L != M &amp;&amp; nums[L] == nums[M]) &#123;</span><br><span class="line">L++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1.1 左中直到重合都相等</span></span><br><span class="line"><span class="keyword">if</span> (L == M) &#123;</span><br><span class="line">L = M + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">continue</span>;<span class="comment">// 回到循环开始重新来</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1.2 或者是 到不相等地方 继续2</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2 左中右不都相等 --&gt; 代表可以二分</span></span><br><span class="line"><span class="keyword">if</span> (nums[L] != nums[M]) &#123; <span class="comment">// 2.1 [L] != [M] ?= [R]</span></span><br><span class="line"><span class="keyword">if</span> (nums[L] &lt; nums[M]) &#123;<span class="comment">// 2.1.1 L &lt; M 左边一定有序</span></span><br><span class="line"><span class="keyword">if</span> (nums[L] &lt;= target &amp;&amp; target &lt; nums[M]) &#123;</span><br><span class="line">R = M - <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">L = M + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123; <span class="comment">// 2.1.2 L &gt; M 左边一定有断点 右边有序</span></span><br><span class="line"><span class="keyword">if</span> (nums[M] &lt; target &amp;&amp; target &lt;= nums[R]) &#123;</span><br><span class="line">L = M + <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">R = M - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;<span class="comment">// 2.2 [L] ?= [M] != [R]</span></span><br><span class="line"><span class="keyword">if</span> (nums[M] &lt; nums[R]) &#123;<span class="comment">// 2.2.1 M &lt; R</span></span><br><span class="line"><span class="keyword">if</span> (nums[M] &lt; target &amp;&amp; target &lt;= nums[R]) &#123;</span><br><span class="line">L = M + <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">R = M - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123; <span class="comment">// 2.1.2 M &gt; R</span></span><br><span class="line"><span class="keyword">if</span> (nums[L] &lt;= target &amp;&amp; target &lt; nums[M]) &#123;</span><br><span class="line">R = M - <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">L = M + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="合并两个有序数组">合并两个有序数组</h2><blockquote><p>给你两个有序数组 nums1 和 nums2，另有两个整数 m 和 n ，分别表示 nums1 和 nums2 中的<code>元素数目</code>。进行合并。</p><p>注意：最终，合并后数组不应由函数返回，而是存储在数组 nums1 中。nums1 的初始长度为 m + n，其中前 m 个元素表示应合并的元素，后 n 个元素为 0 ，应忽略。nums2 的长度为 n 。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">merge</span><span class="params">(<span class="type">int</span>[] nums1, <span class="type">int</span> m, <span class="type">int</span>[] nums2, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> nums1.length;</span><br><span class="line">       <span class="keyword">while</span>(m &gt; <span class="number">0</span> &amp;&amp; n &gt; <span class="number">0</span>) &#123; <span class="comment">// 相等的时候先拷贝长数组的  尽可能让空间早释放</span></span><br><span class="line">            <span class="keyword">if</span>(nums1[m - <span class="number">1</span>] &gt;= nums2[n -<span class="number">1</span>])&#123;</span><br><span class="line">                nums1[--index] = nums1[--m];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                nums1[--index] = nums2[--n];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;   </span><br><span class="line">        <span class="keyword">while</span>(n &gt; <span class="number">0</span>) &#123;<span class="comment">// m都被填完 就把nums2剩下的n填进nums1</span></span><br><span class="line">            nums1[--index] = nums2[--n];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="螺旋矩阵">螺旋矩阵</h2><blockquote><p>给你一个 <code>m</code> 行 <code>n</code> 列的矩阵 <code>matrix</code> ，请按照 <strong>顺时针螺旋顺序</strong> ，返回矩阵中的所有元素。</p></blockquote><img src="算法高频题总结/image-20220508120715738.png" alt="image-20220508120715738" style="zoom:50%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">spiralOrder</span><span class="params">(<span class="type">int</span>[][] matrix)</span> &#123;</span><br><span class="line">List&lt;Integer&gt; order = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">if</span> (matrix == <span class="literal">null</span> || matrix.length == <span class="number">0</span> || matrix[<span class="number">0</span>].length == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> order;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">top</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="comment">// 易错点一：注意right和bottom别写反了。</span></span><br><span class="line"><span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> matrix[<span class="number">0</span>].length - <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">bottom</span> <span class="operator">=</span> matrix.length - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (left &lt;= right &amp;&amp; top &lt;= bottom) &#123;</span><br><span class="line"><span class="comment">// 上层：从左到右，行不变，列变。</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> left; i &lt;= right; i++) &#123;</span><br><span class="line">order.add(matrix[top][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 右层：从上到下，行变，列不变。</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> top + <span class="number">1</span>; i &lt;= bottom; i++) &#123;</span><br><span class="line">order.add(matrix[i][right]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 易错点二：注意针对行列不相等时，下面两个循环要满足right &gt; left &amp;&amp; bottom &gt; top条件 ⚠️</span></span><br><span class="line"><span class="keyword">if</span> (right &gt; left &amp;&amp; bottom &gt; top) &#123;</span><br><span class="line"><span class="comment">// 下层：从右向左，行不变，列变。</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> right - <span class="number">1</span>; i &gt;= left; i--) &#123;</span><br><span class="line">order.add(matrix[bottom][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 左层：从下到上，行变，列不变。</span></span><br><span class="line"><span class="comment">// 易错点三：此处只需要 i&gt;top, i不能=top</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> bottom - <span class="number">1</span>; i &gt; top; i--) &#123;</span><br><span class="line">order.add(matrix[i][left]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">left++;</span><br><span class="line">top++;</span><br><span class="line">right--;</span><br><span class="line">bottom--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> order;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="字符串相加">字符串相加</h2><blockquote><p>给定两个字符串形式的非负整数 num1 和num2 ，计算它们的和并同样以字符串形式返回。</p><p>你不能使用任何內建的用于处理大整数的库（比如 BigInteger）， 也不能直接将输入的字符串转换为整数形式。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">addStrings2</span><span class="params">(String num1, String num2)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> num1.length() - <span class="number">1</span>, j = num2.length() - <span class="number">1</span>, add = <span class="number">0</span>;</span><br><span class="line"><span class="type">StringBuffer</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line"><span class="keyword">while</span> (i &gt;= <span class="number">0</span> || j &gt;= <span class="number">0</span> || add != <span class="number">0</span>) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> i &gt;= <span class="number">0</span> ? num1.charAt(i) - <span class="string">&#x27;0&#x27;</span> : <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">y</span> <span class="operator">=</span> j &gt;= <span class="number">0</span> ? num2.charAt(j) - <span class="string">&#x27;0&#x27;</span> : <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> x + y + add;</span><br><span class="line">ans.append(result % <span class="number">10</span>);</span><br><span class="line">add = result / <span class="number">10</span>;</span><br><span class="line">i--;</span><br><span class="line">j--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 计算完以后的答案需要翻转过来</span></span><br><span class="line">ans.reverse();</span><br><span class="line"><span class="keyword">return</span> ans.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="二分查找">二分查找</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">search</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(L &lt; R)&#123; <span class="comment">// ⚠️ 没有相等</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> (L + R) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(target &lt; nums[mid])&#123;</span><br><span class="line">                R = mid - <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(target &gt; nums[mid])&#123;</span><br><span class="line">                L = mid + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> mid;</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (nums[L] == target) ? L : -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="在排序数组中找到元素第一个和最后一个位置">在排序数组中找到元素第一个和最后一个位置</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 在排序数组中查找元素的第一个和最后一个位置</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> chs</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Fre_044_FindFirstAndLastPositionOfElementInSortedArray</span> &#123;</span><br><span class="line"><span class="comment">// 借助二分 《找到数组中比它小的最右的数 (lessMostRight</span></span><br><span class="line"><span class="comment">// 如果该位置右边!=target说明数组没有这个数</span></span><br><span class="line"><span class="comment">// 如果是 那么左边界找到 右边界就是《找到比ta+1小的最右的数》 (lessMostRight</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[] searchRange(<span class="type">int</span>[] nums, <span class="type">int</span> target) &#123;</span><br><span class="line"><span class="keyword">if</span> (nums == <span class="literal">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[] &#123; -<span class="number">1</span>, -<span class="number">1</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> lessMostRight(nums, target) + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (L == nums.length || nums[L] != target) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[] &#123; -<span class="number">1</span>, -<span class="number">1</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[] &#123; L, lessMostRight(nums, target + <span class="number">1</span>) &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 利用二分 </span></span><br><span class="line"><span class="comment">// 1 一个指针 M</span></span><br><span class="line"><span class="comment">// 2 ans存放结果</span></span><br><span class="line"><span class="comment">// 3 arr[M] 小于就去右边找 大于就去左边找</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">lessMostRight</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> num)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> arr.length - <span class="number">1</span>;</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="type">int</span> <span class="variable">M</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="comment">// 2 </span></span><br><span class="line"><span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="keyword">while</span> (L &lt;= R) &#123;</span><br><span class="line">M = L + ((R - L) &gt;&gt; <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (arr[M] &lt; num) &#123;</span><br><span class="line">ans = M;</span><br><span class="line">L = M + <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">R = M - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="字符串转化整数">字符串转化整数</h2><p>注意有很多特殊情况</p><blockquote><p>1.需要删除无用的前导空格</p><p>2.检查下一个字符为正还是负</p><p>3.只读一开始是数字的部分</p><img src="算法高频题总结/image-20220212174954825.png" alt="image-20220212174954825" style="zoom:50%;" /><img src="算法高频题总结/image-20220212174938284.png" alt="image-20220212174938284" style="zoom:50%;" /><p>4.超出范围的数字返回边界</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1. 主函数myAtoi():</span><br><span class="line">     1 除去空格和后面非数字的部分( 前后都要判空)【removeHeadZero()】</span><br><span class="line">     2 判断该部分是否是有效数字【isValid()】</span><br><span class="line">     3 转为负数形式（转回不会溢出，负数范围大些） posi(标志正负)</span><br><span class="line">     4 res是最负的情况 (用了负数就只用可以装下，如果用整数转，最小就没法装)</span><br><span class="line">2. removeHeadZero():</span><br><span class="line">     1 是否有符号</span><br><span class="line">     2 s标志第一个不是零的位置</span><br><span class="line">     3 e标志数字部分后面的非数字部分的开头</span><br><span class="line">     4 返回截取的带符号整数部分</span><br><span class="line">3. isVaild():    判断带符号整数部分是否有效</span><br><span class="line">     1 开头在remove部分没有判断，只要开头不是数字和符号都返回无效</span><br><span class="line">     2 只有符号也无效</span><br><span class="line">     3 夹杂着非数字字符也无效</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Fre_072_StringToInteger</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">myAtoi</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="comment">// 1 除去空格和后面不是数字的部分</span></span><br><span class="line">        <span class="keyword">if</span>(s == <span class="literal">null</span> || s.equals(<span class="string">&quot;&quot;</span>))&#123;<span class="comment">// ⚠️</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        s = removeHeadZero(s.trim());</span><br><span class="line">        <span class="keyword">if</span>(s == <span class="literal">null</span> || s.equals(<span class="string">&quot;&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2 判断这部分是不是有效数字</span></span><br><span class="line">        <span class="type">char</span>[] str = s.toCharArray();</span><br><span class="line">        <span class="keyword">if</span>(!isValid(str))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3 转为负数形式 为了防止溢出 posi(标志正负) ⚠️不要搞反了</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">posi</span> <span class="operator">=</span> str[<span class="number">0</span>] == <span class="string">&#x27;-&#x27;</span> ? <span class="literal">false</span> : <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// 后面会有*10的操作 需要先判断会不会溢出</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">minq</span> <span class="operator">=</span> Integer.MIN_VALUE / <span class="number">10</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">minp</span> <span class="operator">=</span> Integer.MIN_VALUE % <span class="number">10</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">cur</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> (str[<span class="number">0</span>] == <span class="string">&#x27;-&#x27;</span> || str[<span class="number">0</span>] == <span class="string">&#x27;+&#x27;</span>) ? <span class="number">1</span> : <span class="number">0</span>; i &lt; str.length; i++)&#123;</span><br><span class="line">            cur = <span class="string">&#x27;0&#x27;</span> - str[i]; <span class="comment">// 转为负数</span></span><br><span class="line">            <span class="comment">// 在乘十之前判断是否会溢出</span></span><br><span class="line">            <span class="keyword">if</span>(res &lt; minq || (res == minq &amp;&amp; cur &lt; minp))&#123;</span><br><span class="line">                <span class="keyword">return</span> posi ? Integer.MAX_VALUE : Integer.MIN_VALUE; </span><br><span class="line">            &#125;</span><br><span class="line">            res = res * <span class="number">10</span> + cur;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4 res是最负情况（也就是本来是最大的+1）</span></span><br><span class="line">        <span class="keyword">if</span>(posi &amp;&amp; (res == Integer.MIN_VALUE))&#123;</span><br><span class="line">            <span class="keyword">return</span> Integer.MAX_VALUE; <span class="comment">// 返回边界</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> posi ? -res : res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">removeHeadZero</span><span class="params">(String s)</span>&#123;</span><br><span class="line">        <span class="comment">// 1 是否有符号</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">r</span> <span class="operator">=</span> (s.startsWith(<span class="string">&quot;+&quot;</span>) || s.startsWith(<span class="string">&quot;-&quot;</span>)); <span class="comment">// ⚠️ 不能用charat</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2 标志第一个不是零的位置</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> r ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(; start&lt; s.length(); start++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s.charAt(start) != <span class="string">&#x27;0&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3 找到数字部分后面的非数组部分开头 倒着遍历</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">e</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> s.length() - <span class="number">1</span>; i &gt;= (r ? <span class="number">1</span> : <span class="number">0</span>); i--)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s.charAt(i) &lt; <span class="string">&#x27;0&#x27;</span>  || s.charAt(i) &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">                e = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4 返回截取的带符号的整数部分</span></span><br><span class="line">        <span class="keyword">return</span> (r ? String.valueOf(s.charAt(<span class="number">0</span>)): <span class="string">&quot;&quot;</span>) + s.substring(start, e == -<span class="number">1</span> ? s.length() : e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断是否是有效的数字</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isValid</span><span class="params">(<span class="type">char</span>[] str)</span> &#123;</span><br><span class="line">        <span class="comment">// 1 如果开头不是数组</span></span><br><span class="line">        <span class="keyword">if</span>(str[<span class="number">0</span>] != <span class="string">&#x27;-&#x27;</span> &amp;&amp; str[<span class="number">0</span>] != <span class="string">&#x27;+&#x27;</span> &amp;&amp; (str[<span class="number">0</span>] &lt; <span class="string">&#x27;0&#x27;</span> || str[<span class="number">0</span>] &gt; <span class="string">&#x27;9&#x27;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2 只有符号也无效</span></span><br><span class="line">        <span class="keyword">if</span>((str[<span class="number">0</span>] == <span class="string">&#x27;-&#x27;</span> || str[<span class="number">0</span>] == <span class="string">&#x27;+&#x27;</span>) &amp;&amp; str.length == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 3 夹杂着非数字字符 无效</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; str.length; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(str[i] &lt;<span class="string">&#x27;0&#x27;</span> || str[i] &gt; <span class="string">&#x27;9&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="下一个排列">下一个排列</h2><blockquote><p>给你一个整数数组 nums ，找出 nums 的字典序中的下一个排列。</p><p>例如，arr = [1,2,3] 的下一个排列是 [1,3,2] 。<br>类似地，arr = [2,3,1] 的下一个排列是 [3,1,2] 。<br>而 arr = [3,2,1] 的下一个排列是 [1,2,3] ，因为 [3,2,1] 不存在一个字典序更大的排列。</p><p>必须 原地 修改，只允许使用额外常数空间。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">nextPermutation</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">       <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> nums.length - <span class="number">2</span>;</span><br><span class="line">       <span class="comment">// 1 倒着找升序对 [ i , i+ 1]</span></span><br><span class="line">       <span class="keyword">while</span>(i &gt;= <span class="number">0</span> &amp;&amp; nums[i] &gt;= nums[i + <span class="number">1</span>]) &#123;</span><br><span class="line">           i--;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// 2 从end -&gt; i+1 倒着找比i大的数</span></span><br><span class="line">       <span class="keyword">if</span>(i &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">           <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> nums.length - <span class="number">1</span>;</span><br><span class="line">           <span class="keyword">while</span>(nums[i] &gt;= nums[j])&#123;</span><br><span class="line">               j--;</span><br><span class="line">           &#125;</span><br><span class="line">           swap(nums, i, j);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// 3 将数组i+1以后的反转</span></span><br><span class="line">       <span class="comment">// 因为有两种情况：1） i&lt; 0 说明本身就是字典序最大，直接翻转 2）[i+1, end]是降序需要翻转</span></span><br><span class="line">       reverse(nums, i + <span class="number">1</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">reverse</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> i)</span>&#123;</span><br><span class="line">       <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> i;</span><br><span class="line">       <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span>  nums.length - <span class="number">1</span>;</span><br><span class="line">       <span class="keyword">while</span>(left &lt; right)&#123;</span><br><span class="line">           swap(nums, left, right);</span><br><span class="line">           left++;</span><br><span class="line">           right--;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> i, <span class="type">int</span> j)</span>&#123;</span><br><span class="line">       <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> nums[i];</span><br><span class="line">       nums[i] = nums[j];</span><br><span class="line">       nums[j] = tmp;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="合并区间">合并区间</h2><blockquote><p>以数组 intervals 表示若干个区间的集合，其中单个区间为 intervals[i] = [starti, endi] 。请你合并所有重叠的区间，并返回 一个不重叠的区间数组，该数组需恰好覆盖输入中的所有区间 。</p></blockquote><ol><li>s 和 e 记录上一个区间的边界</li><li>然后复用interval数组来存储，最后复制数组size部分</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[][] merge(<span class="type">int</span>[][] intervals) &#123;</span><br><span class="line">        <span class="keyword">if</span> (intervals.length == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">// 先按照区间的左边界来排序</span></span><br><span class="line">Arrays.sort(intervals, (a, b) -&gt; a[<span class="number">0</span>] - b[<span class="number">0</span>]);</span><br><span class="line"><span class="type">int</span> <span class="variable">s</span> <span class="operator">=</span> intervals[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line"><span class="type">int</span> <span class="variable">e</span> <span class="operator">=</span> intervals[<span class="number">0</span>][<span class="number">1</span>];<span class="comment">// </span></span><br><span class="line"><span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 然后复用interval数组来存储，最后复制数组size部分</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; intervals.length; i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (intervals[i][<span class="number">0</span>] &gt; e) &#123;<span class="comment">// 如果当前左边界大于e 说明没有覆盖 </span></span><br><span class="line">intervals[size][<span class="number">0</span>] = s;<span class="comment">// 可以更新size部分的s和e 然后size++</span></span><br><span class="line">intervals[size++][<span class="number">1</span>] = e;</span><br><span class="line">s = intervals[i][<span class="number">0</span>];</span><br><span class="line">e = intervals[i][<span class="number">1</span>];<span class="comment">// s e 更新为当前的左右边界</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">e = Math.max(e, intervals[i][<span class="number">1</span>]); <span class="comment">// 如果当前左边界小于或者等于 说明两个区间可以覆盖 先将e更新为这两个区间的最大右区间</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">intervals[size][<span class="number">0</span>] = s; <span class="comment">// 最后还有一次size处的更新</span></span><br><span class="line">intervals[size++][<span class="number">1</span>] = e;</span><br><span class="line"><span class="keyword">return</span> Arrays.copyOf(intervals, size);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="x的平方根">x的平方根</h2><p>==二分查找==</p><blockquote><p>给你一个非负整数 x ，计算并返回 x 的 算术平方根 。</p><p>由于返回类型是整数，结果只保留 整数部分 ，小数部分将被 舍去 。</p><p>注意：不允许使用任何内置指数函数和算符，例如 pow(x, 0.5) 或者 x ** 0.5 。</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 使用 二分 &lt;=就更新ans和L 到右边就更新R</span><br><span class="line">2. 注意数据类型时long主要是为了两个整型相乘不会溢出</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// x一定非负，输入可以保证</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">mySqrt</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// x &gt;= 3</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">long</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">long</span> <span class="variable">R</span> <span class="operator">=</span> x;</span><br><span class="line">        <span class="type">long</span> <span class="variable">M</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (L &lt;= R) &#123;</span><br><span class="line">            M = (L + R) / <span class="number">2</span>;</span><br><span class="line">            <span class="comment">// 因为两个整数相乘可能会溢出</span></span><br><span class="line">            <span class="keyword">if</span> (M * M &lt;= x) &#123;</span><br><span class="line">                ans = M;</span><br><span class="line">                L = M + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                R = M - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (<span class="type">int</span>) ans;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>扩展：求出小数点后k位 其实思路与一样 只是换成double类型并且需要转换数格式</p><h2 id="缺失的正数">缺失的正数</h2><blockquote><p>给你一个未排序的整数数组，请你找出没有出现的最小的正整数 时间复杂度o(n)</p></blockquote><p>除了打标记以外，我们还可以使用置换的方法，将给定的数组「恢复」成下面的形式：</p><pre><code>如果数组中包含 x∈[1,N]x \in [1, N]x∈[1,N]，那么恢复后，数组的第 x−1x - 1x−1 个元素为 xxx。</code></pre><p>在恢复后，数组应当有 [1, 2, …, N] 的形式，但其中有若干个位置上的数是错误的，每一个错误的位置就代表了一个缺失的正数。以题目中的示例二 [3, 4, -1, 1] 为例，恢复后的数组应当为 [1, -1, 3, 4]，我们就可以知道缺失的数为 2。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">firstMissingPositive</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">while</span> (nums[i] &gt; <span class="number">0</span> &amp;&amp; nums[i] &lt;= n &amp;&amp; nums[nums[i] - <span class="number">1</span>] != nums[i]) &#123; </span><br><span class="line">              <span class="comment">// ⚠️交换的条件---nums[i]∈[1,N] 且 nums[i]和本来应该在的位置的值nums[nums[i]-1]不相等</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> nums[nums[i] - <span class="number">1</span>];</span><br><span class="line">                nums[nums[i] - <span class="number">1</span>] = nums[i];</span><br><span class="line">                nums[i] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[i] != i + <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> i + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="用rand7-生成rand10">用rand7()生成rand10()</h2><blockquote><p>用一个不等概率返回0和1的函数, 怎么加工一个函数0和1等概率返回</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">rand10</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">int</span> ans= <span class="number">0</span>;</span><br><span class="line">       <span class="keyword">do</span>&#123;</span><br><span class="line">           ans = f2();</span><br><span class="line">       &#125;<span class="keyword">while</span>(ans &gt;<span class="number">9</span>);</span><br><span class="line">       <span class="keyword">return</span> ans + <span class="number">1</span> ;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">f</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">int</span> ans= <span class="number">0</span>;</span><br><span class="line">       <span class="keyword">do</span>&#123;</span><br><span class="line">           ans = rand7();</span><br><span class="line">       &#125;<span class="keyword">while</span>(ans == <span class="number">4</span>);</span><br><span class="line">       <span class="keyword">return</span> ans &lt; <span class="number">4</span>? <span class="number">0</span>:<span class="number">1</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// 0000~1111 0~15</span></span><br><span class="line">   <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">f2</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> (f() &lt;&lt; <span class="number">3</span>) + (f() &lt;&lt; <span class="number">2</span>) + (f() &lt;&lt; <span class="number">1</span> )+ f();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="找到两个有序数组的中位数-⚠️-两个有序数组第k小">找到两个有序数组的中位数(⚠️)/两个有序数组第k小</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">double</span> <span class="title function_">findMedianSortedArrays</span><span class="params">(<span class="type">int</span>[] nums1, <span class="type">int</span>[] nums2)</span> &#123;</span><br><span class="line">        <span class="comment">//这里就主要处理 两个为空 一个为空 全不为空的三个情况</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> nums1.length + nums2.length;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">e</span> <span class="operator">=</span> (size &amp; <span class="number">1</span>) == <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(nums1.length == <span class="number">0</span> &amp;&amp; nums2.length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums1.length == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!e)&#123;</span><br><span class="line">                <span class="keyword">return</span> nums2[size/ <span class="number">2</span>];                   </span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> (<span class="type">double</span>)(nums2[ size / <span class="number">2</span>- <span class="number">1</span>] + nums2[size / <span class="number">2</span> ])/<span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums2.length == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!e)&#123;</span><br><span class="line">                <span class="keyword">return</span> nums1[size/ <span class="number">2</span>];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> (<span class="type">double</span>)(nums1[size / <span class="number">2</span> - <span class="number">1</span>] + nums1[size / <span class="number">2</span>])/<span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(!e)&#123;</span><br><span class="line">                <span class="keyword">return</span> findKthNum(nums1, nums2, size / <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> (<span class="type">double</span>)(findKthNum(nums1, nums2, size/<span class="number">2</span>)+findKthNum(nums1, nums2, size/<span class="number">2</span> +<span class="number">1</span>))/<span class="number">2D</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//原型</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getUpMedian</span><span class="params">(<span class="type">int</span>[] arr1, <span class="type">int</span> s1,<span class="type">int</span> e1,<span class="type">int</span>[] arr2, <span class="type">int</span> s2, <span class="type">int</span> e2)</span>&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mid1</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mid2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(s1 &lt; e1)&#123;</span><br><span class="line">            <span class="comment">//mid</span></span><br><span class="line">            mid1 = (e1 + s1) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            mid2 = (e2 + s2) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(arr1[mid1] == arr2[mid2] ) <span class="keyword">return</span> arr1[mid1];</span><br><span class="line">            <span class="comment">//奇数</span></span><br><span class="line">            <span class="keyword">if</span>(((e1 - s1 + <span class="number">1</span>) &amp; <span class="number">1</span>) == <span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(arr1[mid1] &lt; arr2[mid2])&#123;</span><br><span class="line">                    <span class="keyword">if</span>(arr1[mid1] &gt;= arr2[mid2 - <span class="number">1</span>]) <span class="keyword">return</span> arr1[mid1];</span><br><span class="line">                    s1 = mid1 + <span class="number">1</span>;</span><br><span class="line">                    e2 = mid2 - <span class="number">1</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">if</span>(arr2[mid2] &gt;= arr1[mid1 - <span class="number">1</span>]) <span class="keyword">return</span> arr2[mid2];</span><br><span class="line">                    s2 = mid2 + <span class="number">1</span>;</span><br><span class="line">                    e1 = mid1 - <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//偶数</span></span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(arr1[mid1] &gt; arr2[mid2])&#123;</span><br><span class="line">                    e1 = mid1;</span><br><span class="line">                    s2 = mid2 + <span class="number">1</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    e2 = mid2;</span><br><span class="line">                    s1 = mid1 + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//最后跳出循环 都只剩一个数</span></span><br><span class="line">        <span class="keyword">return</span> Math.min(arr1[s1], arr2[s2]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//处理长度不同 返回Kth的情况</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">findKthNum</span><span class="params">(<span class="type">int</span>[] arr1, <span class="type">int</span>[] arr2, <span class="type">int</span> k)</span>&#123;</span><br><span class="line">        <span class="type">int</span>[] longs = arr1.length &gt;= arr2.length ? arr1 : arr2;</span><br><span class="line">        <span class="type">int</span>[] shorts = arr1.length &lt; arr2.length ? arr1 : arr2;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> longs.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">s</span> <span class="operator">=</span> shorts.length;</span><br><span class="line">        <span class="comment">//1</span></span><br><span class="line">        <span class="keyword">if</span>(k &lt;= s)&#123;</span><br><span class="line">            <span class="keyword">return</span> getUpMedian(longs, <span class="number">0</span>, k - <span class="number">1</span>, shorts, <span class="number">0</span>, k - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//2</span></span><br><span class="line">        <span class="keyword">if</span>(k &gt; l)&#123;</span><br><span class="line">            <span class="keyword">if</span>(longs[k - s - <span class="number">1</span>] &gt;= shorts[s - <span class="number">1</span>])&#123;</span><br><span class="line">                <span class="keyword">return</span> longs[k - s -<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(shorts[k - l - <span class="number">1</span>] &gt;= longs[l - <span class="number">1</span>])&#123;</span><br><span class="line">                <span class="keyword">return</span> shorts[k - l - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> getUpMedian(longs, k - s, l - <span class="number">1</span>, shorts, k - l, s - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3</span></span><br><span class="line">        <span class="keyword">if</span>(longs[k - s - <span class="number">1</span>] &gt;= shorts[s - <span class="number">1</span>])&#123;</span><br><span class="line">            <span class="keyword">return</span> longs[k - s - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> getUpMedian(longs, k - s, k - <span class="number">1</span>,shorts, <span class="number">0</span> ,s - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="翻转字符串中的单词">翻转字符串中的单词</h2><blockquote><p>给你一个字符串 s ，逐个翻转字符串中的所有 单词 。</p><p>单词 是由非空格字符组成的字符串。s 中使用至少一个空格将字符串中的 单词 分隔开。</p><p>请你返回一个翻转 s 中单词顺序并用单个空格相连的字符串。</p><p>说明：</p><p>输入字符串 s 可以在前面、后面或者单词间包含多余的空格。<br>翻转后单词间应当仅用一个空格分隔。<br>翻转后的字符串中不应包含额外的空格。</p><p>示例 1：</p><p>输入：s = “the sky is blue”<br>输出：“blue is sky the”</p><p>示例 2：</p><p>输入：s = &quot;  hello world  &quot;<br>输出：“world hello”<br>解释：输入字符串可以在前面或者后面包含多余的空格，但是翻转后的字符不能包括。</p></blockquote><h3 id="思路">思路:</h3><ol><li><strong>去除多余的空白：</strong><br><strong>(1去掉字符串开头的空白字符</strong><br><strong>(2去掉字符串末尾的空白字符</strong><br><strong>(3将字符串间多余的空白字符去除</strong></li><li><strong>翻转字符串：</strong></li><li><strong>翻转每一个单词：</strong><br><strong>(1 遍历sb 使用start 和 end来抓单词</strong><br><strong>(2 翻转单词</strong><br><strong>(3 更新start，去找下一个单词</strong></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 去除多余的空白</span></span><br><span class="line">    <span class="comment">// 2 翻转字符串</span></span><br><span class="line">    <span class="comment">// 3 翻转每一个单词</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">reverseWords</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="comment">// 1</span></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> trimSpaces(s);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2</span></span><br><span class="line">        reverse(sb, <span class="number">0</span>, sb.length() - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3</span></span><br><span class="line">        reverseEachWord(sb);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1 去掉字符串开头的空白字符</span></span><br><span class="line">    <span class="comment">// 2 去掉字符串末尾的空白字符</span></span><br><span class="line">    <span class="comment">// 3 将字符串间多余的空白字符去除</span></span><br><span class="line">    <span class="keyword">public</span> StringBuilder <span class="title function_">trimSpaces</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>, right = s.length() - <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// 1 </span></span><br><span class="line">        <span class="keyword">while</span> (left &lt;= right &amp;&amp; s.charAt(left) == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">            ++left;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2</span></span><br><span class="line">        <span class="keyword">while</span> (left &lt;= right &amp;&amp; s.charAt(right) == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">            --right;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3</span></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> s.charAt(left);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (c != <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">                sb.append(c);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sb.charAt(sb.length() - <span class="number">1</span>) != <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">                sb.append(c);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ++left;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 翻转任意字符</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reverse</span><span class="params">(StringBuilder sb, <span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">tmp</span> <span class="operator">=</span> sb.charAt(left);</span><br><span class="line">            sb.setCharAt(left++, sb.charAt(right));</span><br><span class="line">            sb.setCharAt(right--, tmp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reverseEachWord</span><span class="params">(StringBuilder sb)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> sb.length();</span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> <span class="number">0</span>, end = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1 遍历sb 使用start 和 end来抓单词</span></span><br><span class="line">        <span class="comment">// 2 翻转单词</span></span><br><span class="line">        <span class="comment">// 3 更新start，去找下一个单词</span></span><br><span class="line">        <span class="keyword">while</span> (start &lt; n) &#123;</span><br><span class="line">            <span class="comment">// 1</span></span><br><span class="line">            <span class="keyword">while</span> (end &lt; n &amp;&amp; sb.charAt(end) != <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">                ++end;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 2</span></span><br><span class="line">            reverse(sb, start, end - <span class="number">1</span>);</span><br><span class="line">            <span class="comment">// 3</span></span><br><span class="line">            start = end + <span class="number">1</span>;</span><br><span class="line">            ++end;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="字符串相乘">字符串相乘</h2><blockquote><p>给定两个以字符串形式表示的非负整数 num1 和 num2，返回 num1 和 num2 的乘积，它们的乘积也表示为字符串形式。</p><p>注意：不能使用任何内置的 BigInteger 库或直接将输入转换为整数。</p><p>示例 1:</p><p>输入: num1 = “2”, num2 = “3”<br>输出: “6”</p><p>示例 2:</p><p>输入: num1 = “123”, num2 = “456”<br>输出: “56088”</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">multiply</span><span class="params">(String num1, String num2)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (num1.equals(<span class="string">&quot;0&quot;</span>) || num2.equals(<span class="string">&quot;0&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;0&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> num1.length(), n = num2.length();</span><br><span class="line">        <span class="type">int</span>[] ansArr = <span class="keyword">new</span> <span class="title class_">int</span>[m + n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> m - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> num1.charAt(i) - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> n - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">y</span> <span class="operator">=</span> num2.charAt(j) - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                ansArr[i + j + <span class="number">1</span>] += x * y;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> m + n - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">            ansArr[i - <span class="number">1</span>] += ansArr[i] /<span class="number">10</span>;</span><br><span class="line">            ansArr[i] %= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> ansArr[<span class="number">0</span>] == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="keyword">while</span> (index &lt; m + n) &#123;</span><br><span class="line">            ans.append(ansArr[index]);</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans.toString();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="删除数组中的重复项">删除数组中的重复项</h2><p>任何删除重复的都可以用快慢指针</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除有序数组中的重复项</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> chs</span></span><br><span class="line"><span class="comment"> * 任何删除重复的都可以用快慢指针</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Fre_017_RemoveDuplicatesFromSortedArray</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">removeDuplicates</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (nums == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (nums.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> nums.length;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="variable">done</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (nums[i] != nums[done]) &#123;</span><br><span class="line">nums[++done] = nums[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> done + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="去除重复字母">去除重复字母</h2><p>贪心➕单调栈？</p><blockquote><p>给你一个字符串 s ，请你去除字符串中重复的字母，使得每个字母只出现一次。需保证 返回结果的字典序最小（要求不能打乱其他字符的相对位置）。</p><p>示例 1：</p><p>输入：s = “bcabc”<br>输出：“abc”</p><p>示例 2：</p><p>输入：s = “cbacdcbc”<br>输出：“acdb”</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">removeDuplicateLetters</span><span class="params">(String s)</span> &#123;</span><br><span class="line">       <span class="type">boolean</span>[] vis = <span class="keyword">new</span> <span class="title class_">boolean</span>[<span class="number">26</span>];</span><br><span class="line">       <span class="type">int</span>[] num = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">26</span>];</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class="line">           num[s.charAt(i) - <span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class="line">           <span class="type">char</span> <span class="variable">ch</span> <span class="operator">=</span> s.charAt(i);</span><br><span class="line">           <span class="keyword">if</span> (!vis[ch - <span class="string">&#x27;a&#x27;</span>]) &#123;</span><br><span class="line">               <span class="keyword">while</span> (sb.length() &gt; <span class="number">0</span> &amp;&amp; sb.charAt(sb.length() - <span class="number">1</span>) &gt; ch) &#123;</span><br><span class="line">                   <span class="keyword">if</span> (num[sb.charAt(sb.length() - <span class="number">1</span>) - <span class="string">&#x27;a&#x27;</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                       vis[sb.charAt(sb.length() - <span class="number">1</span>) - <span class="string">&#x27;a&#x27;</span>] = <span class="literal">false</span>;</span><br><span class="line">                       sb.deleteCharAt(sb.length() - <span class="number">1</span>);</span><br><span class="line">                   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                       <span class="keyword">break</span>;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">               vis[ch - <span class="string">&#x27;a&#x27;</span>] = <span class="literal">true</span>;</span><br><span class="line">               sb.append(ch);</span><br><span class="line">           &#125;</span><br><span class="line">           num[ch - <span class="string">&#x27;a&#x27;</span>] -= <span class="number">1</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> sb.toString();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="单词搜索">单词搜索</h2><blockquote><p>给定一个 n × n 的二维矩阵 matrix 表示一个图像。请你将图像顺时针旋转 90 度。</p><p>你必须在 原地 旋转图像，这意味着你需要直接修改输入的二维矩阵。请不要 使用另一个矩阵来旋转图像。</p><img src="算法高频题总结/image-20220228230315689.png" alt="image-20220228230315689" style="zoom:33%;" /></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rotate</span><span class="params">(<span class="type">int</span>[][] matrix)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> matrix.length - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">d</span> <span class="operator">=</span> matrix[<span class="number">0</span>].length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(a &lt; c) &#123;</span><br><span class="line">            rotateEdge(matrix, a++, b++, c--, d--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">rotateEdge</span><span class="params">(<span class="type">int</span>[][] m, <span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c, <span class="type">int</span> d)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; d - b; i++) &#123;</span><br><span class="line">            tmp = m[a][b + i];</span><br><span class="line">            m[a][b + i] = m[c - i][b];</span><br><span class="line">            m[c - i][b] = m[c][d - i];</span><br><span class="line">            m[c][d - i] = m[a + i][d];</span><br><span class="line">            m[a + i][d] = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="多数元素">多数元素</h2><blockquote><p>给定一个大小为 n 的数组，找到其中的多数元素。多数元素是指在数组中出现次数 大于 ⌊ n/2 ⌋ 的元素。</p><p>你可以假设数组是非空的，并且给定的数组总是存在多数元素。</p><p><strong>是一个超级水王问题</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1遍历 使用 candidate和HP 来一次删除两个不同的数</span><br><span class="line">2到最后 HP 不为0 则说明可能有水王 是当前的candidate</span><br><span class="line">3再遍历一次找candi 如果 HP&gt; n/2 说明就是水王 </span><br></pre></td></tr></table></figure><img src="算法高频题总结/image-20220228231911847.png" alt="image-20220228231911847" style="zoom:50%;" /></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">majorityElement</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(nums == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">candi</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">HP</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span>  <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(HP == <span class="number">0</span>) &#123;</span><br><span class="line">                candi = nums[i];</span><br><span class="line">                HP++;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>( nums[i] != candi) &#123;</span><br><span class="line">                HP--;</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                HP++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(HP == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        HP = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n ; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i] == candi) &#123;</span><br><span class="line">                HP++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(HP &gt; n / <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> candi;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>1 链表</h1><h2 id="1-反转链表">1 反转链表</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">reverseList</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">      <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line">      <span class="keyword">while</span>(cur != <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="type">ListNode</span> <span class="variable">next</span> <span class="operator">=</span> cur.next;</span><br><span class="line">          cur.next = pre;</span><br><span class="line">          pre = cur;</span><br><span class="line">          cur = next;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> pre;<span class="comment">// ！返回的是pre</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="反转链表二">反转链表二</h3><blockquote><p>就是反转链表中间一截</p></blockquote><p>// 第 1 步：从虚拟头节点走 left - 1 步，来到 left 节点的前一个节点</p><p>// 第 2 步：从 pre 再走 right - left + 1 步，来到 right 节点</p><p>// 第 3 步：切断出一个子链表（截取链表）先标记再切断</p><p>// 第 4 步：[同反转链表](##1 反转链表##)，反转链表的子区间</p><p>// 第 5 步：接回到原来的链表中</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">reverseBetween</span><span class="params">(ListNode head, <span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">        <span class="comment">//1 需要一个虚拟头</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">dummyNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(-<span class="number">1</span>);</span><br><span class="line">        dummyNode.next = head;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2 先找到反转部分的left前面pre</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> dummyNode;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; left - <span class="number">1</span>;i++) &#123;</span><br><span class="line">            pre = pre.next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2 从pre再走right - left + 1步 来到right节点</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">rNode</span> <span class="operator">=</span> pre;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; right - left + <span class="number">1</span>;i++) &#123;</span><br><span class="line">            rNode = rNode.next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3 切断这部分的链表</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">lNode</span> <span class="operator">=</span> pre.next;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">end</span> <span class="operator">=</span> rNode.next;</span><br><span class="line">        pre.next = <span class="literal">null</span>;</span><br><span class="line">        rNode.next = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4 反转区间内的链表</span></span><br><span class="line">        reverseLinkedList(lNode);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5 接回去</span></span><br><span class="line">        pre.next = rNode;<span class="comment">// ⚠️接回去的时候已经是反过来了</span></span><br><span class="line">        lNode.next = end;</span><br><span class="line">        <span class="keyword">return</span> dummyNode.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">reverseLinkedList</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">next</span> <span class="operator">=</span> cur.next;</span><br><span class="line">            cur.next = pre;</span><br><span class="line">            pre = cur;</span><br><span class="line">            cur = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="2-LRU缓存机制">2 LRU缓存机制</h2><blockquote><p>请你设计并实现一个满足  LRU (最近最少使用) 缓存 约束的数据结构。<br>实现 LRUCache 类：</p><p>LRUCache(int capacity) 以 正整数 作为容量 capacity 初始化 LRU 缓存<br>int get(int key) 如果关键字 key 存在于缓存中，则返回关键字的值，否则返回 -1 。<br>void put(int key, int value) 如果关键字 key 已经存在，则变更其数据值 value ；如果不存在，则向缓存中插入该组 key-value 。如果插入操作导致关键字数量超过 capacity ，则应该 逐出 最久未使用的关键字。</p><p>函数 get 和 put 必0须以 O(1) 的平均时间复杂度运行。</p></blockquote><img src="算法高频题总结/image-20220508120449144.png" alt="image-20220508120449144" style="zoom:50%;" /><h4 id="1-总的缓存结构-和方法调用">1) 总的缓存结构 和方法调用</h4><h5 id="构造方法">构造方法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> MyCache&lt;Integer, Integer&gt; cache;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Fre_278_LRUCache</span><span class="params">(<span class="type">int</span> capacity)</span>&#123;</span><br><span class="line">cache = <span class="keyword">new</span> <span class="title class_">MyCache</span>&lt;&gt;(capacity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="1-get">1 get()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">get</span><span class="params">(<span class="type">int</span> key)</span> &#123;</span><br><span class="line"><span class="type">Integer</span> <span class="variable">ans</span> <span class="operator">=</span> cache.get(key);</span><br><span class="line"><span class="keyword">return</span> ans == <span class="literal">null</span> ? -<span class="number">1</span> : ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-put">2 put()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(<span class="type">int</span> key, <span class="type">int</span> value)</span> &#123;</span><br><span class="line">cache.set(key, value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2）MyCache">2）MyCache</h4><h5 id="构造方法-2"><strong>构造方法</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyCache</span>&lt;K, V&gt; &#123;</span><br><span class="line"><span class="keyword">private</span> HashMap&lt;K, Node&lt;K, V&gt;&gt; keyNodeMap;</span><br><span class="line"><span class="keyword">private</span> NodeDoubleLinkedList&lt;K, V&gt; nodeList;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> capacity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">MyCache</span><span class="params">(<span class="type">int</span> cap)</span> &#123;</span><br><span class="line">keyNodeMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;K, Node&lt;K, V&gt;&gt;();</span><br><span class="line">nodeList = <span class="keyword">new</span> <span class="title class_">NodeDoubleLinkedList</span>&lt;K, V&gt;();</span><br><span class="line">capacity = cap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="1-V-get-K-key-通过key返回value-需要将node放到尾部">1 V get(K key) 通过key返回value 需要将node放到尾部</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> V <span class="title function_">get</span><span class="params">(K key)</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(keyNodeMap.containsKey(key)) &#123;</span><br><span class="line">Node&lt;K, V&gt; res = keyNodeMap.get(key);</span><br><span class="line">nodeList.moveNodeToTail(res);</span><br><span class="line"><span class="keyword">return</span> res.value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-void-set-K-key-V-value-更新与新增：放到尾部，超出内存就删除最长时间没有操作的">2  void set(K key, V value) 更新与新增：放到尾部，超出内存就删除最长时间没有操作的</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (keyNodeMap.containsKey(key)) &#123;</span><br><span class="line">Node&lt;K, V&gt; node = keyNodeMap.get(key);</span><br><span class="line">node.value = value;</span><br><span class="line">nodeList.moveNodeToTail(node);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Node&lt;K, V&gt; newNode = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;K, V&gt;(key, value);</span><br><span class="line">keyNodeMap.put(key, newNode);</span><br><span class="line">nodeList.addNode(newNode);</span><br><span class="line"><span class="keyword">if</span> (keyNodeMap.size() == capacity + <span class="number">1</span>) &#123;</span><br><span class="line">removeMostUnusedCache();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="3-void-removeMostUnusedCache-删去最长时间没有操作的缓存-；在两个结构里面都删除">3 void removeMostUnusedCache() 删去最长时间没有操作的缓存 ；在两个结构里面都删除</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">removeMostUnusedCache</span><span class="params">()</span> &#123;</span><br><span class="line">Node&lt;K, V&gt; removeNode = nodeList.removeHead();</span><br><span class="line">keyNodeMap.remove(removeNode.key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-双向链表结构">3) 双向链表结构</h4><p><strong>基于LRU机制的双向链表结构</strong><br>private Node&lt;K, V&gt; head;<br>private Node&lt;K, V&gt; tail;</p><p><strong>构造方法</strong>：将头尾置为空</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public NodeDoubleLinkedList()&#123;</span><br><span class="line">head = null;</span><br><span class="line">tail = null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="1-addNode-来新节点，挂到尾巴上">1 addNode() : 来新节点，挂到尾巴上</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addNode</span><span class="params">(Node&lt;K, V&gt; newNode)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(newNode == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(head ==  <span class="literal">null</span>) &#123;</span><br><span class="line">head = newNode;</span><br><span class="line">tail = newNode;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">tail.next = newNode;</span><br><span class="line">newNode.last = tail;</span><br><span class="line">tail = newNode;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-moveToTail-（修改过的节点，要保证node在表中）更新到尾部">2 moveToTail() : （修改过的节点，要保证node在表中）更新到尾部</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveNodeToTail</span><span class="params">(Node&lt;K, V&gt; node)</span> &#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="3-removeHead-将头节点移走，返回新的头节点">3 removeHead() : 将头节点移走，返回新的头节点</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">NodeDoubleLinkedList</span>&lt;K, V&gt; &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Node&lt;K, V&gt; <span class="title function_">removeHead</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (head == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line">Node&lt;K, V&gt; res = head;</span><br><span class="line"><span class="keyword">if</span> (head == tail) &#123;</span><br><span class="line">head = <span class="literal">null</span>;</span><br><span class="line">tail = <span class="literal">null</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">head = res.next;</span><br><span class="line">res.next = <span class="literal">null</span>;</span><br><span class="line">head.last = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-K个一组翻转链表">3 K个一组翻转链表</h2><p>1 先将第一组k凑齐 并且反转<br>2 再记录上一组的结尾节点<br>3 循环（当结尾.next != null)</p><p>(1)更新start   (2)更新end <strong>注意判空！！</strong></p><p>（3） 反转 ：end 变头</p><p>(4） 上一组结尾连接到现在的开头end (5)更新lastEnd</p><img src="算法高频题总结/image-20220107164908659.png" alt="image-20220107164908659" style="zoom:33%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">reverseKGroup</span><span class="params">(ListNode head, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">       <span class="comment">// 1</span></span><br><span class="line">       <span class="type">ListNode</span> <span class="variable">start</span> <span class="operator">=</span> head;</span><br><span class="line">       <span class="type">ListNode</span> <span class="variable">end</span> <span class="operator">=</span> getKEnd(start, k);</span><br><span class="line">       <span class="keyword">if</span> (end == <span class="literal">null</span>) &#123;</span><br><span class="line">           <span class="keyword">return</span> head;</span><br><span class="line">       &#125;</span><br><span class="line">       head = end;</span><br><span class="line">       reverse(start, end);</span><br><span class="line">       <span class="comment">// 2</span></span><br><span class="line">       <span class="type">ListNode</span> <span class="variable">lastEnd</span> <span class="operator">=</span> start;</span><br><span class="line">       <span class="comment">// 3</span></span><br><span class="line">       <span class="keyword">while</span> (lastEnd.next != <span class="literal">null</span>) &#123;</span><br><span class="line">           <span class="comment">// 1)</span></span><br><span class="line">           start = lastEnd.next;</span><br><span class="line">           <span class="comment">// 2)</span></span><br><span class="line">           end = getKEnd(start, k);</span><br><span class="line">           <span class="keyword">if</span> (end == <span class="literal">null</span>) &#123;<span class="comment">// ⚠️(注意判空！！！)</span></span><br><span class="line">               <span class="keyword">return</span> head;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="comment">// 3)</span></span><br><span class="line">           reverse(start, end);</span><br><span class="line">           <span class="comment">// 4)</span></span><br><span class="line">           lastEnd.next = end;</span><br><span class="line">           <span class="comment">// 5)</span></span><br><span class="line">           lastEnd = start;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> head;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> ListNode <span class="title function_">getKEnd</span><span class="params">(ListNode start, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">       <span class="keyword">while</span> (--k != <span class="number">0</span> &amp;&amp; start != <span class="literal">null</span>) &#123;</span><br><span class="line">           start = start.next;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> start;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// 反转 </span></span><br><span class="line">   <span class="comment">// 1 end 往后移</span></span><br><span class="line">   <span class="comment">// 2 三个指针进行反转</span></span><br><span class="line">   <span class="comment">// 3 start反转后是结尾要连接到end</span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">reverse</span><span class="params">(ListNode start, ListNode end)</span> &#123;</span><br><span class="line">       <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">       end = end.next;<span class="comment">//⚠️(注意要移动end指针)</span></span><br><span class="line">       <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">       <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> start;</span><br><span class="line">       <span class="type">ListNode</span> <span class="variable">next</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">       <span class="keyword">while</span> (cur != end) &#123;</span><br><span class="line">           next = cur.next;</span><br><span class="line">           cur.next = pre;</span><br><span class="line">           pre = cur;</span><br><span class="line">           cur = next;</span><br><span class="line">       &#125;</span><br><span class="line">       start.next = end;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="4-合并两个有序链表">4 合并两个有序链表</h2><ol><li>先抓小头head</li><li>cur2抓大头 cur1 = head.next pre = head</li><li>比较 c1 c2 谁小pre的next就指向谁 并且cur pre 后移</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">mergeTwoLists</span><span class="params">(ListNode l1, ListNode l2)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(l1 == <span class="literal">null</span> || l2 ==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> l1 == <span class="literal">null</span> ? l2 : l1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//抓大头</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">head</span> <span class="operator">=</span> l1.val &lt;= l2.val ? l1 : l2;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">cur1</span> <span class="operator">=</span> head.next;</span><br><span class="line">        <span class="comment">//抓小头</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">cur2</span> <span class="operator">=</span> head == l1 ? l2 : l1;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">while</span>(cur1 != <span class="literal">null</span> &amp;&amp; cur2 != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cur1.val &lt;= cur2.val)&#123;</span><br><span class="line">                pre.next = cur1;</span><br><span class="line">                cur1 = cur1.next;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                pre.next = cur2;</span><br><span class="line">                cur2 = cur2.next;</span><br><span class="line">            &#125;</span><br><span class="line">            pre = pre.next;</span><br><span class="line">        &#125;</span><br><span class="line">        pre.next = cur1 != <span class="literal">null</span> ? cur1 :cur2;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="合并k个链表">合并k个链表</h3><blockquote><p>给你一个链表数组，每个链表都已经按升序排列。</p><p>请你将所有链表合并到一个升序链表中，返回合并后的链表。</p><img src="算法高频题总结/image-20220216171223838.png" alt="image-20220216171223838" style="zoom:50%; float:left;"/></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LianBiao_MergeMoreList</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//对数器 ⚠️</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ListNodeComparator</span> <span class="keyword">implements</span> <span class="title class_">Comparator</span>&lt;ListNode&gt; &#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(ListNode arg0, ListNode arg1)</span> &#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"><span class="keyword">return</span> arg0.val - arg1.val;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">mergeKLists</span><span class="params">(ListNode[] lists)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (lists == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1 定义一个对数器的小根堆</span></span><br><span class="line">PriorityQueue&lt;ListNode&gt; heap = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">ListNodeComparator</span>());</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"><span class="comment">// 2 将每一条的head放在堆中</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; lists.length; i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (lists[i] != <span class="literal">null</span>) &#123;<span class="comment">// !!! </span></span><br><span class="line">heap.add(lists[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">if</span>(heap.isEmpty())&#123; <span class="comment">// ⚠️</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// 3 抓出head 将该条后面一个节点放入堆</span></span><br><span class="line"><span class="type">ListNode</span> <span class="variable">head</span> <span class="operator">=</span> heap.poll();</span><br><span class="line"><span class="keyword">if</span> (head.next != <span class="literal">null</span>) &#123;<span class="comment">// !!!</span></span><br><span class="line">heap.add(head.next);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> head;<span class="comment">// 指针</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 4 重复弹出连接结果表 再见弹出的下一个放入堆中</span></span><br><span class="line"><span class="keyword">while</span> (!heap.isEmpty()) &#123;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> heap.poll();</span><br><span class="line">pre.next = cur;</span><br><span class="line">pre = cur;</span><br><span class="line"><span class="keyword">if</span> (cur.next != <span class="literal">null</span>) &#123;<span class="comment">// !!!</span></span><br><span class="line">heap.add(cur.next);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="5-相交链表">5 相交链表</h2><p>需要分有环和无环两种情况 [如何辨别有无环](##6 环形链表##)</p><h3 id="无环链表相交">无环链表相交</h3><img src="算法高频题总结/image-20220206111837413.png" alt="image-20220206111837413" style="zoom:50%;" /><blockquote><p>给你两个单链表的头节点 <code>headA</code> 和 <code>headB</code> ，请你找出并返回两个单链表相交的起始节点。如果两个链表不存在相交节点，返回 <code>null</code> 。</p></blockquote><ol><li>需要两个指针；</li><li>先用n记录两个链表长度大小以便分清楚谁长谁短，n长度差记得取绝对值；</li><li>长的走n步到和短的一样长的起点；</li><li>两个指针一起走到相等的地方 就是交点 返回；</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">getNoLoop</span><span class="params">(ListNode headA, ListNode headB)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(headA == <span class="literal">null</span> || headB == <span class="literal">null</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">ListNode</span> <span class="variable">cur1</span> <span class="operator">=</span> headA;</span><br><span class="line">  <span class="type">ListNode</span> <span class="variable">cur2</span> <span class="operator">=</span> headB;</span><br><span class="line">  <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(cur1 != <span class="literal">null</span>)&#123;</span><br><span class="line">  n++;</span><br><span class="line">  cur1 = cur1.next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(cur2 != <span class="literal">null</span>)&#123;</span><br><span class="line">  n--;</span><br><span class="line">  cur2 = cur2.next;</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="keyword">if</span>(cur1 != cur2)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  cur1 = n &gt; <span class="number">0</span> ? headA : headB;<span class="comment">//cur1指向长的头</span></span><br><span class="line">  cur2 = (cur1 == headA) ? headB : headA;<span class="comment">//cur2指向短头</span></span><br><span class="line">  <span class="comment">//将两个链表长度差取绝对值</span></span><br><span class="line">  n = Math.abs(n);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//将指向长链表的指针cur1往下移动n,到达和短链表cur2指针与相交点相同距离的位置</span></span><br><span class="line">  <span class="keyword">while</span>(n != <span class="number">0</span>)&#123;</span><br><span class="line">  n--;</span><br><span class="line">  cur1 = cur1.next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//两个指针向下 相遇点便是相交点</span></span><br><span class="line">  <span class="keyword">while</span>(cur1 != cur2)&#123;</span><br><span class="line">  cur1 = cur1.next;</span><br><span class="line">  cur2 = cur2.next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> cur1;</span><br><span class="line">         </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="有环链表相交">有环链表相交</h3><p>有环的链表比较复杂 有三种情况</p><p>1 两个入环节点相同 即相交在入环前 (loop1 =loop2)</p><p>2 两个相交在环内相交 有两个相交点</p><p>3 两个不相交</p><img src="算法高频题总结/image-20220207095236631.png" alt="image-20220207095236631" style="zoom:50%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">bothLoop</span><span class="params">(ListNode headA,ListNode loop1,ListNode headB, ListNode loop2)</span>&#123;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">cur1</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">cur2</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(loop1 == loop2)&#123;<span class="comment">//2 </span></span><br><span class="line"><span class="comment">//方法与两个无环链表方法一样只不过把loop1/2看作结尾</span></span><br><span class="line">cur1 = headA;</span><br><span class="line">cur2 = headB;</span><br><span class="line"><span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(cur1 != loop1)&#123;</span><br><span class="line">  n++;</span><br><span class="line">  cur1 = cur1.next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(cur2 != loop2)&#123;</span><br><span class="line">  n--;</span><br><span class="line">  cur2 = cur2.next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(cur1 != cur2)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  cur1 = n &gt; <span class="number">0</span> ? headA : headB;</span><br><span class="line">  cur2 = (cur1 == headA) ? headB : headA;</span><br><span class="line">  n = Math.abs(n);</span><br><span class="line">  <span class="keyword">while</span>(n != <span class="number">0</span>)&#123;</span><br><span class="line">  n--;</span><br><span class="line">  cur1 = cur1.next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(cur1 != cur2)&#123;</span><br><span class="line">  cur1 = cur1.next;</span><br><span class="line">  cur2 = cur2.next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> cur1;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">//loop1往后移动 如果在遇到自己之前遇到了loop2就是情况3</span></span><br><span class="line">cur1 = loop1.next;</span><br><span class="line"><span class="keyword">while</span>(cur1 != loop1)&#123;</span><br><span class="line"><span class="keyword">if</span>(cur1 == loop2)&#123;</span><br><span class="line"><span class="keyword">return</span> loop1;<span class="comment">//3</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;<span class="comment">//1</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-环形链表">6 环形链表</h2><blockquote><p>返回入环节点，没有环就返回null；</p></blockquote><p>1.先将从头节点快慢指针开始往后，如果两个指针相遇那一定有环，期间如果快指针到null，可以直接判断无环。</p><p>2.如果要找到入环节点，就将fast指针指向head，slow不动，然后让两个指针都只移动一步，最后一定会在入环处相遇。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">hasCycle</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">null</span> || head.next == <span class="literal">null</span> || head.next.next == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">slow</span> <span class="operator">=</span> head.next;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">fast</span> <span class="operator">=</span> head.next.next;</span><br><span class="line">        <span class="keyword">while</span>(slow != fast)&#123;</span><br><span class="line">            <span class="keyword">if</span>(fast.next ==  <span class="literal">null</span> || fast.next.next == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            fast = fast.next.next;</span><br><span class="line">            slow = slow.next;</span><br><span class="line">        &#125;</span><br><span class="line">        fast = head;</span><br><span class="line">        <span class="keyword">while</span>(slow != fast)&#123;</span><br><span class="line">            fast = fast.next;</span><br><span class="line">            slow = slow.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> slow;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="7-重排链表">7 重排链表</h2><blockquote><p>给定一个单链表 L 的头节点 head ，单链表 L 表示为：</p><p>L0 → L1 → … → Ln - 1 → Ln</p><p>请将其重新排列后变为：</p><p>L0 → Ln → L1 → Ln - 1 → L2 → Ln - 2 → …</p><p>不能只是单纯的改变节点内部的值，而是需要实际的进行节点交换。</p></blockquote><ol><li>找到原表的中点<ol><li>快慢指针从head开走</li><li>fast.next == null || fast.next.next = null 返回慢指针</li></ol></li><li>将右半端反转：[反转链表](##1 反转链表##)</li><li>将左右端合并</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reorderList</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reorderList</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">null</span>) &#123; <span class="comment">// ⚠️判空</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">mid</span> <span class="operator">=</span> middleNode(head);</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">l1</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">l2</span> <span class="operator">=</span> mid.next;</span><br><span class="line">        mid.next =<span class="literal">null</span>; <span class="comment">// ⚠️分离</span></span><br><span class="line">        l2 = reverse(l2);</span><br><span class="line">        mergeList(l1, l2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">middleNode</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">fast</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">slow</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">while</span>(fast.next != <span class="literal">null</span> &amp;&amp; fast.next.next != <span class="literal">null</span>) &#123;</span><br><span class="line">            fast = fast.next.next;</span><br><span class="line">            slow = slow.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> slow;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">reverse</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">while</span>(cur != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">next</span> <span class="operator">=</span> cur.next;</span><br><span class="line">            cur.next = pre;</span><br><span class="line">            pre = cur;</span><br><span class="line">            cur = next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pre; <span class="comment">// ⚠️返回的是pre</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 合并过程就是使用两个指针来标志两个的下一个</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mergeList</span><span class="params">(ListNode l1, ListNode l2)</span> &#123;</span><br><span class="line">        ListNode l1_next;</span><br><span class="line">        ListNode l2_next;</span><br><span class="line">        <span class="keyword">while</span>(l1 != <span class="literal">null</span> &amp;&amp; l2 != <span class="literal">null</span>) &#123;</span><br><span class="line">            l1_next = l1.next;</span><br><span class="line">            l2_next = l2.next;</span><br><span class="line"></span><br><span class="line">            l1.next = l2;</span><br><span class="line">            l1 = l1_next;</span><br><span class="line"></span><br><span class="line">            l2.next = l1;</span><br><span class="line">            l2 = l2_next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-删除链表重复节点">8 删除链表重复节点</h2><p>设置虚拟节点</p><p>往后遍历  （条件：cur的下一个和下下个都是空）<br>2.1如果当前两个节点值相等就将当前cur.next的值保存在x;</p><p>​循环（第一个节点后面的节点是否有重复的）cur.next指向不等于该x值的节点<br>​    2.2 不相等就直接next</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">deleteDuplicates</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line"> <span class="keyword">if</span>(head == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">dummy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">0</span>, head);</span><br><span class="line"></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> dummy;</span><br><span class="line">        <span class="keyword">while</span>(cur.next != <span class="literal">null</span> &amp;&amp; cur.next.next != <span class="literal">null</span>)&#123; <span class="comment">// 当前节点下一个和下下个不为空</span></span><br><span class="line">            <span class="keyword">if</span>(cur.next.val == cur.next.next.val)&#123; <span class="comment">// 两个节点相等</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> cur.next.val; </span><br><span class="line">                <span class="keyword">while</span>(cur.next != <span class="literal">null</span> &amp;&amp; cur.next.val == x)&#123; <span class="comment">// 遍历第一个节点后面的节点是否有重复的 </span></span><br><span class="line">                    cur.next = cur.next.next;<span class="comment">// 有就直接讲指针指向下下个</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">// 两个节点不相等 指针后移</span></span><br><span class="line">                cur = cur.next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dummy.next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="9-排序链表">9 排序链表</h2><blockquote><p>就是给链表排序</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">sortList</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line"><span class="comment">// 1 遍历一遍链表的长度</span></span><br><span class="line"><span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line"><span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123;</span><br><span class="line">N++;</span><br><span class="line">cur = cur.next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2 len是每次分组节点数 一直乘二</span></span><br><span class="line"><span class="type">ListNode</span> <span class="variable">h</span> <span class="operator">=</span> head;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">teamFirst</span> <span class="operator">=</span> head;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> <span class="number">1</span>; len &lt; N; len &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">while</span> (teamFirst != <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="comment">// 3 F就是将五个参数处理返回方便利用</span></span><br><span class="line"><span class="comment">// 左组从哪到哪   ls le</span></span><br><span class="line"><span class="comment">// 右组从哪到哪   rs re</span></span><br><span class="line"><span class="comment">// 左 右  next</span></span><br><span class="line">ListNode[] f1 = f(teamFirst, len);</span><br><span class="line"><span class="comment">// ls...le  rs...re -&gt; merge去</span></span><br><span class="line"><span class="comment">// 整体的头、整体的尾</span></span><br><span class="line">ListNode[] f2 = merge(f1[<span class="number">0</span>], f1[<span class="number">1</span>], f1[<span class="number">2</span>], f1[<span class="number">3</span>]);</span><br><span class="line"><span class="keyword">if</span> (h == teamFirst) &#123;</span><br><span class="line">h = f2[<span class="number">0</span>];</span><br><span class="line">pre = f2[<span class="number">1</span>];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">pre.next = f2[<span class="number">0</span>];</span><br><span class="line">pre = f2[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">teamFirst = f1[<span class="number">4</span>];<span class="comment">// next</span></span><br><span class="line">&#125;</span><br><span class="line">teamFirst = h;</span><br><span class="line">pre = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListNode[] f(ListNode teamFirst, <span class="type">int</span> len) &#123;</span><br><span class="line"><span class="comment">// 返回五个参数</span></span><br><span class="line"><span class="type">ListNode</span> <span class="variable">ls</span> <span class="operator">=</span> teamFirst;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">le</span> <span class="operator">=</span> teamFirst;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">re</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">next</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">pass</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (teamFirst != <span class="literal">null</span>) &#123;</span><br><span class="line">pass++;</span><br><span class="line"><span class="keyword">if</span> (pass &lt;= len) &#123;</span><br><span class="line">le = teamFirst;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pass == len + <span class="number">1</span>) &#123;</span><br><span class="line">rs = teamFirst;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pass &gt; len) &#123;</span><br><span class="line">re = teamFirst;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pass == (len &lt;&lt; <span class="number">1</span>)) &#123;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">teamFirst = teamFirst.next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 左边结尾断开</span></span><br><span class="line">le.next = <span class="literal">null</span>;</span><br><span class="line"><span class="comment">// 记录右边结尾的next并断开结尾断开 </span></span><br><span class="line"><span class="keyword">if</span> (re != <span class="literal">null</span>) &#123;</span><br><span class="line">next = re.next;</span><br><span class="line">re.next = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>[] &#123; ls, le, rs, re, next &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ListNode[] merge(ListNode ls, ListNode le, ListNode rs, ListNode re) &#123;</span><br><span class="line"><span class="keyword">if</span> (rs == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>[] &#123; ls, le &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">head</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">tail</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">while</span> (ls != le.next &amp;&amp; rs != re.next) &#123;</span><br><span class="line"><span class="keyword">if</span> (ls.val &lt;= rs.val) &#123;</span><br><span class="line">cur = ls;</span><br><span class="line">ls = ls.next;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">cur = rs;</span><br><span class="line">rs = rs.next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pre == <span class="literal">null</span>) &#123;</span><br><span class="line">head = cur;</span><br><span class="line">pre = cur;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">pre.next = cur;</span><br><span class="line">pre = cur;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (ls != le.next) &#123;</span><br><span class="line"><span class="keyword">while</span> (ls != le.next) &#123;</span><br><span class="line">pre.next = ls;</span><br><span class="line">pre = ls;</span><br><span class="line">tail = ls;</span><br><span class="line">ls = ls.next;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">while</span> (rs != re.next) &#123;</span><br><span class="line">pre.next = rs;</span><br><span class="line">pre = rs;</span><br><span class="line">tail = rs;</span><br><span class="line">rs = rs.next;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>[] &#123; head, tail &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="10-两数相加">10 两数相加</h2><blockquote><p>给你两个 非空 的链表，表示两个非负的整数。它们每位数字都是按照 逆序 的方式存储的，并且每个节点只能存储 一位 数字。</p><p>请你将两个数相加，并以相同形式返回一个表示和的链表。</p><p>你可以假设除了数字 0 之外，这两个数都不会以 0 开头。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">addTwoNumbers</span><span class="params">(ListNode l1, ListNode l2)</span> &#123;</span><br><span class="line"><span class="comment">//两个链表分长短</span></span><br><span class="line"><span class="comment">//分为三个阶段 ：1 长短都还有节点 2 短没有节点 长有节点 3 长也走到没节点</span></span><br><span class="line"><span class="type">ListNode</span> <span class="variable">l</span> <span class="operator">=</span> listLength(l1) &gt; listLength(l2) ? l1 : l2;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">s</span> <span class="operator">=</span> (l == l1) ? l2 : l1;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">curl</span> <span class="operator">=</span> l;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">curs</span> <span class="operator">=</span> s;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">carry</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">curNum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">last</span> <span class="operator">=</span> curl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//1 </span></span><br><span class="line"><span class="keyword">while</span>(curs != <span class="literal">null</span>)&#123;</span><br><span class="line">curNum = curs.val + curl.val + carry;</span><br><span class="line">carry = curNum / <span class="number">10</span>;</span><br><span class="line">curl.val = curNum % <span class="number">10</span>;</span><br><span class="line">last = curl;<span class="comment">//last一直在抓住最后一个节点</span></span><br><span class="line">curl = curl.next;</span><br><span class="line">curs = curs.next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2 </span></span><br><span class="line"><span class="keyword">while</span>(curl != <span class="literal">null</span>)&#123;</span><br><span class="line">curNum =  curl.val + carry;</span><br><span class="line">carry = curNum / <span class="number">10</span>;</span><br><span class="line">curl.val = curNum % <span class="number">10</span>;</span><br><span class="line">last = curl;<span class="comment">//last一直在抓住最后一个节点</span></span><br><span class="line">curl = curl.next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//3 到</span></span><br><span class="line"><span class="keyword">if</span>(carry != <span class="number">0</span>)&#123;</span><br><span class="line">last.next = <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">listLength</span><span class="params">(ListNode l)</span>&#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(l != <span class="literal">null</span>)&#123;</span><br><span class="line">length++;</span><br><span class="line">l = l.next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="11-链表中倒数第k个节点">11 链表中倒数第k个节点</h2><blockquote><p>输入一个链表，输出该链表中倒数第k个节点。为了符合大多数人的习惯，本题从1开始计数，即链表的尾节点是倒数第1个节点。</p><p>例如，一个链表有 <code>6</code> 个节点，从头节点开始，它们的值依次是 <code>1、2、3、4、5、6</code>。这个链表的倒数第 <code>3</code> 个节点是值为 <code>4</code> 的节点。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Fre_070_removeNthFromEnd</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> ListNode <span class="title function_">getKthFromEnd</span><span class="params">(ListNode head, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">slow</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">fast</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">while</span>(k - <span class="number">1</span> != <span class="number">0</span>)&#123;</span><br><span class="line">            fast = fast.next;</span><br><span class="line">            k--;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(fast.next != <span class="literal">null</span>) &#123;</span><br><span class="line">            slow = slow.next;</span><br><span class="line">            fast = fast.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> slow;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="12-删除链表倒数第k个节点">12 删除链表倒数第k个节点</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">removeNthFromEnd</span><span class="params">(ListNode head, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">       <span class="type">ListNode</span> <span class="variable">dummy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(-<span class="number">1</span>);</span><br><span class="line">       dummy.next = head;</span><br><span class="line">  <span class="comment">// 1 用两个指针截出n+1长度</span></span><br><span class="line">       <span class="type">ListNode</span> <span class="variable">slow</span> <span class="operator">=</span> dummy;</span><br><span class="line">       <span class="type">ListNode</span> <span class="variable">fast</span> <span class="operator">=</span> head;</span><br><span class="line">       <span class="keyword">for</span>(;n&gt;<span class="number">0</span>;n--)&#123;</span><br><span class="line">           fast=fast.next;</span><br><span class="line">       &#125;</span><br><span class="line">  <span class="comment">// 2 两个指针一直往后直到fast到结尾</span></span><br><span class="line">       <span class="keyword">while</span>(fast != <span class="literal">null</span>)&#123;</span><br><span class="line">           fast = fast.next;</span><br><span class="line">           slow = slow.next;</span><br><span class="line">       &#125;</span><br><span class="line">  <span class="comment">// 3 slow在目标的前面一位 直接将next指针指向下下位 </span></span><br><span class="line">       slow.next = slow.next.next;</span><br><span class="line">       <span class="keyword">return</span> dummy.next;<span class="comment">// 使用虚拟节点以防删除的是头节点</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="13-回文链表">13 回文链表</h2><p>需要convert 和 然后判断对称 然后再convert恢复回去</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isPalindrome</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">slow</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">fast</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">while</span>(fast.next != <span class="literal">null</span> &amp;&amp; fast.next.next != <span class="literal">null</span>)&#123;</span><br><span class="line">            slow = slow.next;</span><br><span class="line">            fast = fast.next.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 1 现在slow就走到了中间（偶数是上中）</span></span><br><span class="line">        <span class="comment">// 2 将后半部分convert</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">l1</span> <span class="operator">=</span> <span class="literal">null</span>; <span class="comment">//pre</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">l2</span> <span class="operator">=</span> slow.next;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">l3</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">while</span>(l2 != <span class="literal">null</span>)&#123;</span><br><span class="line">            l3 = l2.next;</span><br><span class="line">            l2.next = l1;</span><br><span class="line">            l1 = l2;</span><br><span class="line">            l2 = l3;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3 后面部分已经翻转 现在对比两部分是否对称</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">        l2 = head;</span><br><span class="line">        l3 = l1;</span><br><span class="line">        <span class="keyword">while</span>(l3 != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(l2.val != l3.val)&#123; <span class="comment">// ⚠️比较val</span></span><br><span class="line">                ans = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            l2 = l2.next;</span><br><span class="line">            l3 = l3.next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4 把后半部分又恢复原样</span></span><br><span class="line">        l2 = <span class="literal">null</span>;<span class="comment">// pre</span></span><br><span class="line">        l3 = <span class="literal">null</span>;<span class="comment">// next</span></span><br><span class="line">        <span class="keyword">while</span>(l1 != <span class="literal">null</span>)&#123;</span><br><span class="line">            l3 = l1.next;</span><br><span class="line">            l1.next = l2;</span><br><span class="line">            l2 = l1;</span><br><span class="line">            l1 = l3;</span><br><span class="line">        &#125;</span><br><span class="line">        slow.next = l2;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="14-删除排序链表中的重复元素">14 删除排序链表中的重复元素</h2><blockquote><p>给定一个已排序的链表的头 <code>head</code> ， <em>删除所有重复的元素，使每个元素只出现一次</em> 。返回 <em>已排序的链表</em> 。</p></blockquote><p>删除重复元素 留下一个<br>直接快慢指针</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">deleteDuplicates</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">       <span class="keyword">if</span>(head == <span class="literal">null</span>)&#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="type">ListNode</span> <span class="variable">ans</span> <span class="operator">=</span> head;</span><br><span class="line">       <span class="type">ListNode</span> <span class="variable">left</span> <span class="operator">=</span> head;</span><br><span class="line">       <span class="type">ListNode</span> <span class="variable">right</span> <span class="operator">=</span> head.next;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">while</span>( right != <span class="literal">null</span>) &#123;</span><br><span class="line">           <span class="type">ListNode</span> <span class="variable">next</span> <span class="operator">=</span> right.next;</span><br><span class="line">           <span class="keyword">if</span>(left.val == right.val) &#123;</span><br><span class="line">               left.next = next;</span><br><span class="line">               right.next = <span class="literal">null</span>;</span><br><span class="line">           &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">               left =  right;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           right = next;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> ans;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="15-复制带有随机指针的链表">15 复制带有随机指针的链表</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 深度复制带有rand的链表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LiaoBiao_copyListWithRandom</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> value;</span><br><span class="line"><span class="keyword">public</span> Node next;</span><br><span class="line"><span class="keyword">public</span> Node rand;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> data)</span> &#123;</span><br><span class="line">value = data;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 最优解：人工构造关系</span></span><br><span class="line"><span class="comment"> * 1 每一个节点后面加一个克隆节点</span></span><br><span class="line"><span class="comment"> * 2 遍历关系 （同时复制rand</span></span><br><span class="line"><span class="comment"> * 3 遍历分离（同时复制next</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title function_">copyListWithRandom</span><span class="params">(Node head)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(head == <span class="literal">null</span>)&#123; <span class="keyword">return</span> <span class="literal">null</span>; &#125;</span><br><span class="line">    <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="type">Node</span> <span class="variable">next</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">while</span>(cur != <span class="literal">null</span>)&#123;</span><br><span class="line">    next = cur.next;</span><br><span class="line">    cur.next = <span class="keyword">new</span> <span class="title class_">Node</span>(cur.value);</span><br><span class="line">    cur.next.next = next;</span><br><span class="line">    cur = next;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    cur = head;</span><br><span class="line">    <span class="type">Node</span> <span class="variable">curCopy</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">while</span>(cur != <span class="literal">null</span>)&#123;</span><br><span class="line">    next = cur.next.next;</span><br><span class="line">    curCopy = cur.next;</span><br><span class="line">    curCopy.rand = cur.rand != <span class="literal">null</span> ? cur.rand.next : <span class="literal">null</span>;</span><br><span class="line">    cur = next;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    cur = head;</span><br><span class="line">    <span class="type">Node</span> <span class="variable">res</span> <span class="operator">=</span> head.next;</span><br><span class="line">    <span class="comment">// 3</span></span><br><span class="line">    <span class="keyword">while</span>(cur != <span class="literal">null</span>)&#123;</span><br><span class="line">    next = cur.next.next;</span><br><span class="line">    curCopy = cur.next;</span><br><span class="line">    curCopy.next = cur.next != <span class="literal">null</span> ? cur.next.next : <span class="literal">null</span>;</span><br><span class="line">    cur = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 使用hashMap一一对应关系</span></span><br><span class="line"><span class="comment">     * 1 遍历第一遍一一对应</span></span><br><span class="line"><span class="comment">     * 2 遍历第二遍复制关系</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> head</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title function_">copyListWithRandom2</span><span class="params">(Node head)</span>&#123;</span><br><span class="line">HashMap&lt;Node, Node&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line"><span class="comment">// 1 </span></span><br><span class="line"><span class="keyword">while</span>(cur != <span class="literal">null</span>)&#123;</span><br><span class="line">map.put(cur, <span class="keyword">new</span> <span class="title class_">Node</span>(cur.value));</span><br><span class="line">cur = cur.next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cur = head;</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="keyword">while</span>(cur != <span class="literal">null</span>)&#123;</span><br><span class="line">map.get(cur).next = map.get(cur.next);</span><br><span class="line">map.get(cur).rand = map.get(cur.rand);</span><br><span class="line">cur = cur.next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> map.get(head);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>2 动态规划</h1><p>具体步骤 可以参考[零钱兑换](###2 返回凑齐的所有方法数)</p><h2 id="基础问题-背包问题">基础问题 背包问题</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 传入货物的重量和价值 不能超过bag背包容量，返回最大价值</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> chs</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DP2_knapsack</span> &#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 暴力递归</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">maxValue</span><span class="params">(<span class="type">int</span>[] w, <span class="type">int</span>[] v, <span class="type">int</span> bag)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (w == <span class="literal">null</span> || v == <span class="literal">null</span> || w.length == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> process(w, v, <span class="number">0</span>, bag);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">process</span><span class="params">(<span class="type">int</span>[] w, <span class="type">int</span>[] v, <span class="type">int</span> i, <span class="type">int</span> rest)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (rest &lt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (i == w.length) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 加上i</span></span><br><span class="line"><span class="type">int</span> <span class="variable">p1</span> <span class="operator">=</span> process(w, v, i + <span class="number">1</span>, rest - w[i]);</span><br><span class="line"><span class="comment">// 没加</span></span><br><span class="line"><span class="type">int</span> <span class="variable">p2</span> <span class="operator">=</span> process(w, v, i + <span class="number">1</span>, rest);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (p1 != -<span class="number">1</span>) &#123;</span><br><span class="line">p1 += v[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> Math.max(p1, p2);</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 动态规划版</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">dp</span><span class="params">(<span class="type">int</span>[] w, <span class="type">int</span>[] v, <span class="type">int</span> bag)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (w == <span class="literal">null</span> || v == <span class="literal">null</span> || w.length != v.length || w.length == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> w.length;</span><br><span class="line"><span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[N + <span class="number">1</span>][bag + <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt;= bag; j ++)&#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(j - w[i] &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">ans = dp[i + <span class="number">1</span>][j - w[i]] + v[i];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">ans = dp[i + <span class="number">1</span>][j];</span><br><span class="line">&#125;</span><br><span class="line">dp[i][j] = Math.max(dp[i+<span class="number">1</span>][j], ans);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dp[<span class="number">0</span>][bag];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="1-最大子数组和">1. 最大子数组和</h2><h3 id="用贪心">用贪心</h3><p>只需要一个pre反复更新记录以i为底的最大累加和，然后max存最大的</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用两个变量存</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">maxSubArray4</span><span class="params">(<span class="type">int</span>[] nums)</span>&#123;</span><br><span class="line"><span class="keyword">if</span> (nums.length == <span class="number">0</span> || nums == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> nums[<span class="number">0</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++)&#123;</span><br><span class="line">pre = Math.max(pre + nums[i], nums[i]);</span><br><span class="line">max = Math.max(pre, max);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">return</span> max;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="如果需要返回该子数组">如果需要返回该子数组</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> nums[<span class="number">0</span>], l = <span class="number">0</span>, r = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.size(); i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (nums[i - <span class="number">1</span>] &lt; <span class="number">0</span>) &#123;</span><br><span class="line">l = i;</span><br><span class="line">&#125;</span><br><span class="line">nums[i] += max(<span class="number">0</span>, nums[i - <span class="number">1</span>]);</span><br><span class="line"><span class="keyword">if</span> (res &lt; nums[i]) &#123;</span><br><span class="line">r = i;</span><br><span class="line">res = nums[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-买卖股票的最佳时机-maxProfit">2. 买卖股票的最佳时机 maxProfit</h2><h3 id="1-从头至尾买一次一股-返回最大利润">(1) 从头至尾买一次一股 返回最大利润:</h3><p>遍历一遍 min标记， max最大利润更新 就是找到最低点和最高点</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxProfit</span><span class="params">(<span class="type">int</span> prices[])</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">minprice</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line">        <span class="type">int</span> <span class="variable">maxprofit</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; prices.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (prices[i] &lt; minprice) &#123;</span><br><span class="line">                minprice = prices[i];</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (prices[i] - minprice &gt; maxprofit) &#123;</span><br><span class="line">                maxprofit = prices[i] - minprice;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> maxprofit;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-买一股但是可以买无限次">(2) 买一股但是可以买无限次</h3><p>遍历累加所有的爬坡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一股随便买</span></span><br><span class="line"><span class="comment">// 相当于在每次爬坡前后买卖 将所有爬坡累加就行</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">maxProfit2</span><span class="params">(<span class="type">int</span>[] prices)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (prices == <span class="literal">null</span> || prices.length == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; prices.length; i++)&#123;</span><br><span class="line">ans += prices[i] - prices[i - <span class="number">1</span>] &gt;= <span class="number">0</span> ? prices[i] - prices[i - <span class="number">1</span>] : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-最长回文子串">3. 最长回文子串</h2><h3 id="1-动态规划O-N-2">(1) 动态规划O(N^2)</h3><img src="算法高频题总结/image-20220114215749989.png" alt="image-20220114215749989" style="zoom: 33%;" /><img src="算法高频题总结/image-20220114215821577.png" alt="image-20220114215821577" style="zoom: 33%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 自己改动态规划</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> s</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">longestPalindrome33</span><span class="params">(String s)</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> (s.length() &lt; <span class="number">2</span>) &#123;</span><br><span class="line">           <span class="keyword">return</span> s;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="type">char</span>[] str = s.toCharArray();</span><br><span class="line">       <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> str.length;</span><br><span class="line">       <span class="type">boolean</span>[][] dp = <span class="keyword">new</span> <span class="title class_">boolean</span>[N][N];</span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">           dp[i][i] = <span class="literal">true</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//边填dp 边抓最长和该最长开始节点</span></span><br><span class="line">       <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">       <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//按对角线遍历 </span></span><br><span class="line">      <span class="comment">// 最外循环不是dp的坐标</span></span><br><span class="line">      <span class="comment">// i代表了n - len 每个循环行是不变的 </span></span><br><span class="line">      <span class="comment">// j是横坐标L</span></span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> N - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--)&#123;</span><br><span class="line">           <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>; L &lt; i; L++)&#123;</span><br><span class="line">               <span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> L + N - i;</span><br><span class="line">               <span class="keyword">if</span>(str[L] == str[R])&#123;</span><br><span class="line">                   <span class="keyword">if</span>(R - L &lt; <span class="number">3</span>)&#123;</span><br><span class="line">                       dp[L][R] = <span class="literal">true</span>;</span><br><span class="line">                   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                       dp[L][R] = dp[L + <span class="number">1</span>][R - <span class="number">1</span>];</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">               <span class="keyword">if</span>(dp[L][R] &amp;&amp; R - L + <span class="number">1</span> &gt; max)&#123;</span><br><span class="line">                   max = R - L + <span class="number">1</span>;</span><br><span class="line">                   index = L;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> s.substring(index, index + max);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h3 id="2-Manacher">(2) Manacher!</h3><p>面试讲一讲</p><p>假设字符串str长度为N，想返回最长回文子串的长度</p><p>时间复杂度O(N)</p><h4 id="Manacher算法核心">Manacher算法核心</h4><p>1）理解回文半径数组<br>2）理解所有中心的回文最右边界R，和取得R时的中心点C<br>3）理解 L…(i’)…C…(i)…R 的结构，以及根据i’回文长度进行的状况划分<br>4）每一种情况划分，都可以加速求解i回文半径的过程</p><p>最长回文子串就是我知道可以进行。</p><h3 id="最长回文子序列">最长回文子序列</h3><p>子序列就是三种情况 L+1 ~R 和 L ~ R-1 和 L +1 ~ R - 1</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">longestPalindromeSubseq</span><span class="params">(String s)</span> &#123;</span><br><span class="line">      <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">longestPalindromeSubseq</span><span class="params">(String s)</span> &#123;</span><br><span class="line">       <span class="keyword">if</span>(s.length() == <span class="number">0</span> || s == <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="type">char</span>[] str = s.toCharArray();</span><br><span class="line">       <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> str.length;</span><br><span class="line">       <span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[N][N];</span><br><span class="line"></span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; N; i++)&#123;</span><br><span class="line">           dp[i][i] = <span class="number">1</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//对角线遍历</span></span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">         <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>; L &lt; i; L++)&#123;</span><br><span class="line">           <span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> L + N - i;</span><br><span class="line">           dp[L][R] = Math.max(dp[L + <span class="number">1</span>][R],dp[L][R - <span class="number">1</span>]);</span><br><span class="line">           <span class="keyword">if</span>(str[L] == str[R])&#123;</span><br><span class="line">             dp[L][R] = Math.max(dp[L + <span class="number">1</span>][R - <span class="number">1</span>] + <span class="number">2</span>, dp[L][R]);</span><br><span class="line">           &#125;</span><br><span class="line">&#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> dp[<span class="number">0</span>][N - <span class="number">1</span>];</span><br><span class="line">      &#125;</span><br><span class="line">   </span><br></pre></td></tr></table></figure><h2 id="4-最长递增子序列">4. 最长递增子序列</h2><h3 id="DP版-O-n-2">DP版  O(n^2)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">lengthOfLIS</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (nums.length == <span class="number">0</span>) &#123; </span><br><span class="line">          <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[nums.length];</span><br><span class="line">      dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">      <span class="type">int</span> <span class="variable">maxans</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">          dp[i] = <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">              <span class="keyword">if</span> (nums[i] &gt; nums[j]) &#123;</span><br><span class="line">                  dp[i] = Math.max(dp[i], dp[j] + <span class="number">1</span>);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          maxans = Math.max(maxans, dp[i]);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> maxans;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="二分查找-贪心-O-nlogn">二分查找+贪心  O(nlogn)</h3><p>维护一个end数组存储</p><ol><li><p>end[i] 代表  i+1 长度下子序列的最后下标</p></li><li><p>len = 递增子序列的长 度 - 1（end数组的下标 ）</p></li></ol><p>设当前已求出的最长上升子序列的长度为 len（初始时为1），从前往后遍历数组nums，在遍历到 nums[i] 时：</p><ul><li>如果 nums[i] &gt;[len] ，则[++len] = nums[i]；</li><li>否则，在end数组中[0 ~ len-1]二分查找，找到第一个比 nums[i] 小的数 end[k] ，并更新 end[k+1]=nums[i]。</li></ul><p><strong>代码</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">lengthOfLIS</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (nums.length == <span class="number">0</span> || nums == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// end[i]存储 第i+1长度下子序列的最后下标</span></span><br><span class="line"><span class="type">int</span>[] end = <span class="keyword">new</span> <span class="title class_">int</span>[nums.length];</span><br><span class="line">end[<span class="number">0</span>] = nums[<span class="number">0</span>];<span class="comment">//!!!</span></span><br><span class="line"><span class="comment">// end数组的下标 = 递增子序列的长度 - 1</span></span><br><span class="line"><span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 二分查找的下标</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span> (nums[i] &gt; end[len]) &#123;</span><br><span class="line">end[++len] = nums[i];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;<span class="comment">// 在end里面二分查找 &lt; num[i] 的数</span></span><br><span class="line"><span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> len - <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">pos</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//因为如果没有比他小的 说明都比他大 就更新的是end[0]</span></span><br><span class="line"><span class="keyword">while</span> (L &lt;= R) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> (R + L) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(end[mid] &lt; nums[i])&#123;</span><br><span class="line">pos = mid + <span class="number">1</span>;<span class="comment">//抓住当前小于numi的数的后面一位 后面会更新</span></span><br><span class="line">L = mid + <span class="number">1</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">R = mid - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">end[pos] = nums[i];<span class="comment">//更新</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> len + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="5-接雨水">5. 接雨水</h2><ul><li>左右两个指针 left right</li><li>左右两个变量存储左右最大的值</li><li>每次更新左右任意一边靠着lmax或者rmax的指针的雨水大小</li><li>相当于是把每一下标积的水累加。</li></ul><p>相当于是从左右两边来进行更新 哪边的max最大就比较那一边的L/R与max大小 累加并且更新最大值</p><p>最后返回累加和</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">trap</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> arr.length - <span class="number">2</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">leftMax</span> <span class="operator">=</span> arr[<span class="number">0</span>];</span><br><span class="line"><span class="type">int</span> <span class="variable">rightMax</span> <span class="operator">=</span> arr[arr.length - <span class="number">1</span>];z</span><br><span class="line"><span class="title function_">while</span><span class="params">(L &lt;= R)</span> &#123; <span class="comment">// ！！！！ &lt;=</span></span><br><span class="line"><span class="keyword">if</span>(leftMax &lt;= rightMax) &#123;</span><br><span class="line">ans += Math.max(<span class="number">0</span>, leftMax - arr[L]);</span><br><span class="line">leftMax = Math.max(leftMax, arr[L++]);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">ans += Math.max(<span class="number">0</span>, rightMax - arr[R]);</span><br><span class="line">rightMax = Math.max(rightMax, arr[R--]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-最长上升子序列">6. 最长上升子序列</h2><p>设当前已求出的最长上升子序列的长度为 len（初始时为1），从前往后遍历数组nums，在遍历到 nums[i] 时：</p><ul><li>如果 nums[i] d[len] ，则直接加入到 ddd 数组末尾，并更新 len= len+1；</li><li>否则，在 d数组中二分查找，找到第一个比 nums[i] 小的数 d[k] ，并更新 d[k+1]=nums[i].</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 这道题要用 二分查找和贪心</span></span><br><span class="line"><span class="comment"> * 暴力递归XXX不用了老子 </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> nums</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">lengthOfLIS</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (nums.length == <span class="number">0</span> || nums == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// end[i]存储 第i+1长度下子序列的最后下标</span></span><br><span class="line"><span class="type">int</span>[] end = <span class="keyword">new</span> <span class="title class_">int</span>[nums.length];</span><br><span class="line">end[<span class="number">0</span>] = nums[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// end数组的下标 = 递增子序列的长度 - 1</span></span><br><span class="line"><span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 二分查找的下标</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span> (nums[i] &gt; end[len]) &#123;</span><br><span class="line">end[++len] = nums[i];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;<span class="comment">// 在end里面二分查找 &lt; num[i] 的数</span></span><br><span class="line"><span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> len - <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">pos</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//因为如果没有比他小的 说明都比他大 就更新的是end[0]</span></span><br><span class="line"><span class="keyword">while</span> (L &lt;= R) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> (R + L) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(end[mid] &lt; nums[i])&#123;</span><br><span class="line">pos = mid + <span class="number">1</span>;<span class="comment">//抓住当前小于numi的数的后面一位 后面会更新</span></span><br><span class="line">L = mid + <span class="number">1</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">R = mid - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">end[pos] = nums[i];<span class="comment">//更新</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> len + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="7-爬楼梯">7. 爬楼梯</h2><h3 id="递归-笔试">递归 笔试</h3><p><strong>状态转移方程</strong> f(n) = f(n - 1) + f(n - 2); ----&gt; 可以看出就是斐波拉契数列</p><p>用三个常量所以空间复杂度为O(1)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">climbStairs</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">p</span> <span class="operator">=</span> <span class="number">0</span>, q = <span class="number">0</span>, r = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            p = q; </span><br><span class="line">            q = r; </span><br><span class="line">            r = p + q;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;+</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="矩阵快速幂-o-logn">矩阵快速幂 o(logn)</h3><img src="算法高频题总结/image-20220124114518863.png" alt="image-20220124114518863" style="zoom: 33%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Code4_ClimbStairs</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">climbStairs</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// [ 1 ,1 ]</span></span><br><span class="line"><span class="comment">// [ 1, 0 ]</span></span><br><span class="line"><span class="type">int</span>[][] base = &#123; &#123; <span class="number">1</span>, <span class="number">1</span> &#125;, &#123; <span class="number">1</span>, <span class="number">0</span> &#125; &#125;;</span><br><span class="line"><span class="type">int</span>[][] res = matrixPower(base, n);</span><br><span class="line"><span class="keyword">return</span> res[<span class="number">0</span>][<span class="number">0</span>]; </span><br><span class="line">    <span class="comment">// 如果是斐波拉契数列 就要从1 1 2 3 5 </span></span><br><span class="line">    <span class="comment">// 返回的就是res[0][0]+res[0][1]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  快速幂 方法就是将指数循环 每次循环内矩阵平方 然后指数右移一位</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[][] matrixPower(<span class="type">int</span>[][] m, <span class="type">int</span> p) &#123;</span><br><span class="line">    <span class="comment">// res初始化为单位1</span></span><br><span class="line"><span class="type">int</span>[][] res = &#123;&#123;<span class="number">1</span>, <span class="number">0</span> &#125;, &#123;<span class="number">0</span>,<span class="number">1</span>&#125;&#125;;</span><br><span class="line">    <span class="comment">// m ---&gt; 一次方</span></span><br><span class="line"><span class="type">int</span>[][] tmp = m;</span><br><span class="line"><span class="keyword">for</span> (; p != <span class="number">0</span>; p &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> ((p &amp; <span class="number">1</span>) != <span class="number">0</span>) &#123; <span class="comment">// ！！！先乘一次方 注意是不等于0 </span></span><br><span class="line">res = muliMatrix(res, tmp);</span><br><span class="line">&#125;</span><br><span class="line">tmp = muliMatrix(tmp, tmp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[][] muliMatrix(<span class="type">int</span>[][] m1, <span class="type">int</span>[][] m2) &#123;</span><br><span class="line"><span class="type">int</span>[][] res = <span class="keyword">new</span> <span class="title class_">int</span>[m1.length][m2[<span class="number">0</span>].length];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; m1.length; i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; m2[<span class="number">0</span>].length; j++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; m2.length; k++) &#123;</span><br><span class="line">res[i][j] += m1[i][k] * m2[k][j]; <span class="comment">// k = m1的列 = m2的行</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>主要就是注意快速幂里面要先进行 一次方的判断</p><h2 id="8-编辑距离-dp3">8. 编辑距离(dp3)</h2><h3 id="DP-样本对应模型：往往用最后的位置来判断可能性">DP 样本对应模型：往往用最后的位置来判断可能性</h3><p>给两个单词，返回第一个单词转换为第二个单词最少的操作数， 有增删改三种操作</p><p>（扩展：可以增加a d c分别代表增删改的代价）</p><p>根据最后一个位置有四种可能</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DP3_EditDistance</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minDistance</span><span class="params">(String word1, String word2)</span> &#123;</span><br><span class="line">      <span class="keyword">if</span>(word1 == <span class="literal">null</span> || word2 == <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">       <span class="type">char</span>[] str1 = word1.toCharArray();</span><br><span class="line">        <span class="type">char</span>[] str2 = word2.toCharArray();</span><br><span class="line">        <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> str1.length; </span><br><span class="line">        <span class="type">int</span> <span class="variable">M</span> <span class="operator">=</span> str2.length;</span><br><span class="line">        <span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[N+<span class="number">1</span>][M+<span class="number">1</span>];</span><br><span class="line">        <span class="comment">// 1 处理边界：其中有字符串是空的情况 全是增加操作</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= N; i++) &#123;</span><br><span class="line">            dp[i][<span class="number">0</span>] = i;</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= M; i++) &#123;</span><br><span class="line">            dp[<span class="number">0</span>][i] = i;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2 普通情况 从最后位置比较word1该如何处理</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= M; j++) &#123;</span><br><span class="line">                <span class="comment">// 2.1 最后一个位置修改或者保留</span></span><br><span class="line">                <span class="keyword">if</span>(str1[i- <span class="number">1</span>] == str2[j - <span class="number">1</span>]) &#123;<span class="comment">// ！！！ 注意</span></span><br><span class="line">                    dp[i][j] = dp[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    dp[i][j] = dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 2.2 最后一个位置删除</span></span><br><span class="line">                dp[i][j] = Math.min(dp[i- <span class="number">1</span>][j] + <span class="number">1</span>, dp[i][j]);</span><br><span class="line">                <span class="comment">// 2.3 最后一个位置增加 </span></span><br><span class="line">                dp[i][j] = Math.min(dp[i][j - <span class="number">1</span>] + <span class="number">1</span>, dp[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[N][M];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>⚠️ 因为有为0的情况 所以总的就是[0, N] 所以循环范围需要是[0,N]  并且<strong>str下标</strong> 对应 <strong>dp下标</strong>减一</p><img src="算法高频题总结/image-20220124222730796.png" alt="image-20220124222730796" style="zoom:33%;" /><h2 id="9-最长公共子序列-dp3">9. 最长公共子序列(dp3)</h2><img src="算法高频题总结/image-20220125165947341.png" alt="image-20220125165947341" style="zoom:50%;" /><p>⚠️填边界的时候先将<code>dp[0][0]</code>填了 防止 i - 1 越界</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">longestCommonSubsequence</span><span class="params">(String text1, String text2)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(text1 == <span class="literal">null</span> || text2 == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">char</span>[] str1 = text1.toCharArray();</span><br><span class="line">        <span class="type">char</span>[] str2 = text2.toCharArray();</span><br><span class="line">        <span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[str1.length][str2.length];</span><br><span class="line">        <span class="comment">// 1 填完第一行和第一列</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = str1[<span class="number">0</span>] == str2[<span class="number">0</span>] ? <span class="number">1</span> : <span class="number">0</span>; <span class="comment">// !!!</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; str2.length; i++) &#123;</span><br><span class="line">           dp[<span class="number">0</span>][i] = str1[<span class="number">0</span>] == str2[i] ? <span class="number">1</span> : dp[<span class="number">0</span>][i - <span class="number">1</span>];</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; str1.length; i++) &#123;</span><br><span class="line">           dp[i][<span class="number">0</span>] = str1[i] == str2[<span class="number">0</span>] ? <span class="number">1</span> : dp[i - <span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2 按每行没列填</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; str1.length; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt; str2.length; j++) &#123;</span><br><span class="line">              <span class="comment">// 1 不看当前的情况 比较[i - 1]和[j ]或者[ i]和[j - 1]</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">p1</span> <span class="operator">=</span> dp[i - <span class="number">1</span>][j];</span><br><span class="line">                <span class="type">int</span> <span class="variable">p2</span> <span class="operator">=</span> dp[i][j - <span class="number">1</span>];</span><br><span class="line">              <span class="comment">// 2 将这个位置的情况纳入 比较 [i]和 [j]</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">p3</span> <span class="operator">=</span> str1[i] == str2[j] ? dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">1</span> : dp[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">                dp[i][j] = Math.max(p1, Math.max(p2, p3));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[str1.length - <span class="number">1</span>][str2.length - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="10-最小路径和">10 最小路径和</h2><blockquote><p>m ✖️n 的网格 从左下角走到右下角 怎么走路径最短</p></blockquote><p>⚠️[1, 1] 开始填表</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minPathSum2</span><span class="params">(<span class="type">int</span>[][] grid)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (grid == <span class="literal">null</span> || grid.length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> grid.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> grid[<span class="number">0</span>].length;</span><br><span class="line">        <span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[m][n];</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = grid[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; m; i++) &#123; <span class="comment">// !!! 注意别写反了</span></span><br><span class="line">            dp[i][<span class="number">0</span>] = dp[i - <span class="number">1</span>][<span class="number">0</span>] + grid[i][<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">            dp[<span class="number">0</span>][j] = dp[<span class="number">0</span>][j - <span class="number">1</span>] + grid[<span class="number">0</span>][j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">                dp[i][j] = Math.min(dp[i - <span class="number">1</span>][j], dp[i][j - <span class="number">1</span>]) + grid[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[m - <span class="number">1</span>][n - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="扩展">扩展</h4><p>记录路径也可以开一个字典，应该知道了每个 [i,j] 上一个来源坐标 last， path[(i,j)] = (lasti,lastj)，最后用一个死循环输出所有path，当 (i,j) == (0,0 ) 时候退出 然后最后进行一个死循环 就可以将循环打出来了</p><h3 id="不同路径">不同路径</h3><blockquote><p>m ✖️n 的网格 从左下角走到右下角 有多少种走法 （方法数）</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">uniquePaths</span><span class="params">(<span class="type">int</span> m, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[m][n];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            dp[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            dp[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">                dp[i][j] = dp[i - <span class="number">1</span>][j]+ dp[i][j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[m-<span class="number">1</span>][n-<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="11-最长公共子数组-最长重复子数组">11  最长公共子数组(最长重复子数组)</h2><blockquote><p>注意的还是<strong>边界</strong>； 应为需要最开始的状态来依赖 所以要不选择dp外围加一圈 要不就是dp内围循环从1开始</p></blockquote><img src="算法高频题总结/image-20220125205333273.png" alt="image-20220125205333273" style="zoom: 33%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findLength</span><span class="params">(<span class="type">int</span>[] A, <span class="type">int</span>[] B)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> A.length, m = B.length;</span><br><span class="line"><span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">1</span>][m + <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> m - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">dp[i][j] = A[i] == B[j] ? dp[i + <span class="number">1</span>][j + <span class="number">1</span>] + <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">ans = Math.max(ans, dp[i][j]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findLength</span><span class="params">(<span class="type">int</span>[] nums1, <span class="type">int</span>[] nums2)</span> &#123;</span><br><span class="line">       <span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[nums1.length+<span class="number">1</span>][nums2.length+<span class="number">1</span>];</span><br><span class="line">       <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= nums1.length;i++) &#123;</span><br><span class="line">           <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= nums2.length; j++) &#123;</span><br><span class="line">               dp[i][j] = nums1[i-<span class="number">1</span>] == nums2[j-<span class="number">1</span>] ? dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">1</span> : <span class="number">0</span>; <span class="comment">//！！！</span></span><br><span class="line">               ans = Math.max(dp[i][j], ans);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> ans;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="12-零钱兑换问题-完全背包-dp4-难">12 零钱兑换问题 &lt;完全背包&gt;(dp4) 难</h2><p>关于背包问题 <a href="https://leetcode-cn.com/problems/coin-change/solution/yi-pian-wen-zhang-chi-tou-bei-bao-wen-ti-sq9n/">吃透背包所有问题</a></p><p><strong>从左向右的尝试模型</strong></p><blockquote><p>给你一个整数数组 coins ，表示不同面额的硬币；以及一个整数 amount ，表示总金额。</p></blockquote><h3 id="1-返回需要最少的硬币个数">1 返回需要最少的硬币个数</h3><blockquote><p>计算并返回可以凑成总金额所需的 <strong>最少</strong>硬币个数 。</p><p>每个硬币都可以说使用无限次。</p></blockquote><h4 id="动态规划">动态规划</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">coinChange</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> aim)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (aim == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> arr.length;</span><br><span class="line"><span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[N + <span class="number">1</span>][aim + <span class="number">1</span>];</span><br><span class="line">dp[N][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= aim; j++) &#123;</span><br><span class="line">dp[N][j] = Integer.MAX_VALUE;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> N - <span class="number">1</span>; index &gt;= <span class="number">0</span>; index--) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">rest</span> <span class="operator">=</span> <span class="number">0</span>; rest &lt;= aim; rest++) &#123;</span><br><span class="line">dp[index][rest] = dp[index + <span class="number">1</span>][rest];<span class="comment">// 下边</span></span><br><span class="line"><span class="keyword">if</span> (rest - arr[index] &gt;= <span class="number">0</span> </span><br><span class="line">&amp;&amp; dp[index][rest - arr[index]] != Integer.MAX_VALUE) &#123;</span><br><span class="line">          <span class="comment">// 最小值 相当于（ 左边+1）与（下边 ）进行比较</span></span><br><span class="line">dp[index][rest] = Math.min(dp[index][rest], dp[index][rest - arr[index]] + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dp[<span class="number">0</span>][aim] == Integer.MAX_VALUE ? -<span class="number">1</span> : dp[<span class="number">0</span>][aim];<span class="comment">// 无解情况返回-1</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="2-返回凑齐的所有方法数">2 返回凑齐的所有方法数</h3><blockquote><p>返回硬币或者货币可以凑齐钱的所有方法数</p></blockquote><h4 id="暴力递归的尝试">暴力递归的尝试</h4><img src="算法高频题总结/image-20220126121822867.png" alt="image-20220126121822867" style="zoom:50%;float:left;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">coinsWay</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> aim)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length == <span class="number">0</span> || aim &lt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> process(arr, <span class="number">0</span>, aim);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// arr[index....] 所有的面值，每一个面值都可以任意选择张数，组成正好rest这么多钱，方法数多少？</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">process</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> index, <span class="type">int</span> rest)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (index == arr.length) &#123; <span class="comment">// 没钱了</span></span><br><span class="line"><span class="keyword">return</span> rest == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="variable">ways</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">zhang</span> <span class="operator">=</span> <span class="number">0</span>; zhang * arr[index] &lt;= rest; zhang++) &#123; </span><br><span class="line">ways += process(arr, index + <span class="number">1</span>, rest - (zhang * arr[index]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ways;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="算法高频题总结/image-20220126122746347.png" alt="image-20220126122746347" style="zoom: 50%;float:left" /><p><strong>说明是有重复解的</strong>,所以可以进一步进行记忆化搜索</p><h4 id="记忆化搜索">记忆化搜索</h4><p>就是用一个结构存储f(i, rest)结果 后面就不会重复解</p><img src="算法高频题总结/image-20220126124736980.png" alt="image-20220126124736980" style="zoom:50%; float: left;" /><p>如果该题没有枚举行为那么傻缓存的方法和严格表结构（动态规划）的方法就是一样的。</p><p><strong>严格的表结构</strong>： 就是在记忆化搜索的基础上，进一步梳理了依赖关系，从简单位置算出复杂位置，严格规定好了计算顺序</p><p>有枚举行为：需要搞出严格的表结构进行继续优化。</p><h4 id="动态规划-2">动态规划</h4><p>第一版dp:有枚举行为，和上面记忆化搜索的方法是等效的</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">dp1</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> aim)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length == <span class="number">0</span> || aim &lt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> arr.length;</span><br><span class="line"><span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[N + <span class="number">1</span>][aim + <span class="number">1</span>];</span><br><span class="line">dp[N][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> N - <span class="number">1</span>; index &gt;= <span class="number">0</span>; index--) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">rest</span> <span class="operator">=</span> <span class="number">0</span>; rest &lt;= aim; rest++) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">ways</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">zhang</span> <span class="operator">=</span> <span class="number">0</span>; zhang * arr[index] &lt;= rest; zhang++) &#123;</span><br><span class="line">ways += dp[index + <span class="number">1</span>][rest - (zhang * arr[index])];</span><br><span class="line">&#125;</span><br><span class="line">dp[index][rest] = ways;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dp[<span class="number">0</span>][aim];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第二版：将枚举行为的规律找出来，利用<strong>严格的表结构</strong></p><img src="算法高频题总结/image-20220126140549709.png" alt="image-20220126140549709" style="zoom:50%;float:left" /><img src="算法高频题总结/image-20220126141740242.png" alt="image-20220126141740242" style="zoom:50%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">coinChange</span><span class="params">(<span class="type">int</span>[] coins, <span class="type">int</span> amount)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (coins == <span class="literal">null</span> || coins.length == <span class="number">0</span> || amount &lt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> coins.length;</span><br><span class="line"><span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[N + <span class="number">1</span>][amount + <span class="number">1</span>];</span><br><span class="line">dp[N][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> N - <span class="number">1</span>; index &gt;= <span class="number">0</span>; index--) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">rest</span> <span class="operator">=</span> <span class="number">0</span>; rest &lt;= amount; rest++) &#123;</span><br><span class="line">dp[index][rest] = dp[index + <span class="number">1</span>][rest];</span><br><span class="line"><span class="keyword">if</span> (rest - coins[index] &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">dp[index][rest] += dp[index][rest - coins[index]];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dp[<span class="number">0</span>][amount];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-最终代码">3 最终代码</h3><h4 id="零钱兑换1">零钱兑换1</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">coinChange</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> aim)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (aim == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> arr.length;</span><br><span class="line"><span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[N + <span class="number">1</span>][aim + <span class="number">1</span>];</span><br><span class="line">dp[N][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= aim; j++) &#123;</span><br><span class="line">dp[N][j] = Integer.MAX_VALUE;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> N - <span class="number">1</span>; index &gt;= <span class="number">0</span>; index--) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">rest</span> <span class="operator">=</span> <span class="number">0</span>; rest &lt;= aim; rest++) &#123;</span><br><span class="line">dp[index][rest] = dp[index + <span class="number">1</span>][rest];</span><br><span class="line"><span class="keyword">if</span> (rest - arr[index] &gt;= <span class="number">0</span> </span><br><span class="line">&amp;&amp; dp[index][rest - arr[index]] != Integer.MAX_VALUE) &#123;</span><br><span class="line">          <span class="comment">// 最小值判断</span></span><br><span class="line">dp[index][rest] = Math.min(dp[index][rest], dp[index][rest - arr[index]] + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dp[<span class="number">0</span>][aim] == Integer.MAX_VALUE ? -<span class="number">1</span> : dp[<span class="number">0</span>][aim];<span class="comment">// 无解情况返回-1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 一维 难理解</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">coinChange</span><span class="params">(<span class="type">int</span>[] coins, <span class="type">int</span> amount)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> amount + <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[amount + <span class="number">1</span>];</span><br><span class="line">        Arrays.fill(dp, max);</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= amount; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; coins.length; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (coins[j] &lt;= i) &#123;</span><br><span class="line">                    dp[i] = Math.min(dp[i], dp[i - coins[j]] + <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[amount] &gt; amount ? -<span class="number">1</span> : dp[amount];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="零钱兑换2">零钱兑换2</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">coinChange</span><span class="params">(<span class="type">int</span>[] coins, <span class="type">int</span> amount)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (coins == <span class="literal">null</span> || coins.length == <span class="number">0</span> || amount &lt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> coins.length;</span><br><span class="line"><span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[N + <span class="number">1</span>][amount + <span class="number">1</span>];</span><br><span class="line">dp[N][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> N - <span class="number">1</span>; index &gt;= <span class="number">0</span>; index--) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">rest</span> <span class="operator">=</span> <span class="number">0</span>; rest &lt;= amount; rest++) &#123;</span><br><span class="line">dp[index][rest] = dp[index + <span class="number">1</span>][rest];</span><br><span class="line"><span class="keyword">if</span> (rest - coins[index] &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">dp[index][rest] += dp[index][rest - coins[index]];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dp[<span class="number">0</span>][amount];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 一维 不是很好理解怕写错</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">change</span><span class="params">(<span class="type">int</span> amount, <span class="type">int</span>[] coins)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[amount + <span class="number">1</span>];</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> coin : coins) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> coin; i &lt;= amount; i++) &#123;</span><br><span class="line">                dp[i] += dp[i - coin];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[amount];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="13-最长有效括号">13 最长有效括号</h2><blockquote><p>给你一个只包含 <code>'('</code> 和 <code>')'</code> 的字符串，找出最长有效（格式正确且连续）括号子串的长度。</p></blockquote><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">思路：</span><br><span class="line">    是子串类型，看以i结尾</span><br><span class="line">1 如果当前是‘）’ 就找可以和他配对的最前左括号pre下标</span><br><span class="line">   pre = i - dp[i - 1] - 1; </span><br><span class="line">           （dp[i - 1] 前一个已经配好对的长度 </span><br><span class="line">2 如果pre是左括号(注意pre&gt;= 0 防止越界) </span><br><span class="line">     更新dp[i] == 2 + dp [i - 1]+ (pre &gt; 0? dp [pre - 1] : 0);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">longestValidParentheses</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(s == <span class="literal">null</span> || s.length()== <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">char</span>[] str= s.toCharArray();</span><br><span class="line">        <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[s.length()];</span><br><span class="line">        <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; str.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>( str[i] == <span class="string">&#x27;)&#x27;</span>) &#123; </span><br><span class="line">                <span class="type">int</span> <span class="variable">pre</span> <span class="operator">=</span> i - dp[i - <span class="number">1</span>] - <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>( pre &gt;= <span class="number">0</span> &amp;&amp; str[pre] == <span class="string">&#x27;(&#x27;</span> ) &#123; <span class="comment">// !! pre &gt;= 0在前 pre </span></span><br><span class="line">                    dp[i] = <span class="number">2</span> + dp[i - <span class="number">1</span>] + (pre &gt; <span class="number">0</span>? dp[pre - <span class="number">1</span>] : <span class="number">0</span>);  <span class="comment">//!!! pre -1 </span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            max = Math.max(dp[i], max);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> max;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="14-打家劫舍">14 打家劫舍</h2><blockquote><p>你是一个专业的小偷，计划偷窃沿街的房屋。每间房内都藏有一定的现金，影响你偷窃的唯一制约因素就是相邻的房屋装有相互连通的防盗系统，如果两间相邻的房屋在同一晚上被小偷闯入，系统会自动报警。</p><p>给定一个代表每个房屋存放金额的非负整数数组，计算你 不触动警报装置的情况下 ，一夜之内能够偷窃到的最高金额。<br>链接：<a href="https://leetcode-cn.com/problems/house-robber">https://leetcode-cn.com/problems/house-robber</a></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">rob</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> (nums == <span class="literal">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> (nums.length == <span class="number">1</span>) &#123; <span class="comment">// ！！！ </span></span><br><span class="line">           <span class="keyword">return</span> nums[<span class="number">0</span>];</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">       <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">       dp[<span class="number">0</span>] = nums[<span class="number">0</span>];</span><br><span class="line">       dp[<span class="number">1</span>] = Math.max(dp[<span class="number">0</span>], nums[<span class="number">1</span>]); <span class="comment">// ！！!注意要将[0][1] 先填 i从2开始</span></span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt; n; i++) &#123;</span><br><span class="line">           <span class="type">int</span> <span class="variable">p1</span> <span class="operator">=</span> nums[i];</span><br><span class="line">           <span class="type">int</span> <span class="variable">p2</span> <span class="operator">=</span> dp[i - <span class="number">1</span>];</span><br><span class="line">           <span class="type">int</span> <span class="variable">p3</span> <span class="operator">=</span> nums[i] + dp[i - <span class="number">2</span>];</span><br><span class="line">           dp[i] = Math.max(p1, Math.max(p2, p3));</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> dp[n - <span class="number">1</span>];</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="打家劫舍Ⅱ">打家劫舍Ⅱ</h2><blockquote><p>这个地方所有的房屋都 <strong>围成一圈</strong> ，这意味着第一个房屋和最后一个房屋是紧挨着的。</p></blockquote><p>是滚动数组，可以分成两个数组来判断[0]-[N-2] 和 [1]-[N-1]</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">rob</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums == <span class="literal">null</span> || nums.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (nums.length == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> nums[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (nums.length == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.max(nums[<span class="number">0</span>], nums[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[nums.length];</span><br><span class="line">        dp[<span class="number">0</span>] = nums[<span class="number">0</span>];</span><br><span class="line">        dp[<span class="number">1</span>] = Math.max(nums[<span class="number">0</span>], nums[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt; nums.length-<span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">p1</span> <span class="operator">=</span> nums[i];</span><br><span class="line">            <span class="type">int</span> <span class="variable">p2</span> <span class="operator">=</span> dp[i - <span class="number">1</span>];</span><br><span class="line">            <span class="type">int</span> <span class="variable">p3</span> <span class="operator">=</span> dp[i - <span class="number">2</span>] + nums[i];</span><br><span class="line">            dp[i] = Math.max(p1, Math.max(p2, p3));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans1</span> <span class="operator">=</span> dp[nums.length - <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">        dp[<span class="number">1</span>] = nums[<span class="number">1</span>];</span><br><span class="line">        dp[<span class="number">2</span>] = Math.max(nums[<span class="number">1</span>], nums[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">3</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">p1</span> <span class="operator">=</span> nums[i];</span><br><span class="line">            <span class="type">int</span> <span class="variable">p2</span> <span class="operator">=</span> dp[i - <span class="number">1</span>];</span><br><span class="line">            <span class="type">int</span> <span class="variable">p3</span> <span class="operator">=</span> dp[i - <span class="number">2</span>] + nums[i];</span><br><span class="line">            dp[i] = Math.max(p1, Math.max(p2, p3));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans2</span> <span class="operator">=</span> dp[nums.length - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> Math.max(ans1, ans2);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="15-矩阵的递增路径">15 矩阵的递增路径</h2><blockquote><p>给定一个 m x n 整数矩阵 matrix ，找出其中 最长递增路径 的长度。</p><p>对于每个单元格，你可以往上，下，左，右四个方向移动。 你 不能 在 对角线 方向上移动或移动到 边界外（即不允许环绕）。</p><img src="算法高频题总结/image-20220228231209380.png" alt="image-20220228231209380" style="zoom:33%;" /></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">longestIncreasingPath</span><span class="params">(<span class="type">int</span>[][] matrix)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> matrix.length;</span><br><span class="line"><span class="type">int</span> <span class="variable">M</span> <span class="operator">=</span> matrix[<span class="number">0</span>].length;</span><br><span class="line"><span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[N][M];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; M; j++) &#123;</span><br><span class="line">ans = Math.max(ans, process1(matrix, i, j, dp));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">process1</span><span class="params">(<span class="type">int</span>[][] m, <span class="type">int</span> i, <span class="type">int</span> j,<span class="type">int</span>[][] dp)</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(dp[i][j] != <span class="number">0</span>)&#123;<span class="comment">//存了数就不用再算了</span></span><br><span class="line"><span class="keyword">return</span> dp[i][j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 上下左右四个方向</span></span><br><span class="line"><span class="type">int</span> <span class="variable">up</span> <span class="operator">=</span> i &gt; <span class="number">0</span> &amp;&amp; m[i][j] &lt; m[i - <span class="number">1</span>][j] ? process1(m, i - <span class="number">1</span>, j, dp) : <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">down</span> <span class="operator">=</span> i &lt; (m.length - <span class="number">1</span>) &amp;&amp; m[i][j] &lt; m[i + <span class="number">1</span>][j] ? process1(m,</span><br><span class="line">i + <span class="number">1</span>, j, dp) : <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> j &gt; <span class="number">0</span> &amp;&amp; m[i][j] &lt; m[i][j - <span class="number">1</span>] ? process1(m, i, j - <span class="number">1</span>,dp) : <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> j &lt; (m[<span class="number">0</span>].length - <span class="number">1</span>) &amp;&amp; m[i][j] &lt; m[i][j + <span class="number">1</span>] ? process1(</span><br><span class="line">m, i, j + <span class="number">1</span>, dp) : <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> Math.max(Math.max(up, down), Math.max(left, right)) + <span class="number">1</span>;</span><br><span class="line">dp[i][j] = ans;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="16-机器人walk">16 机器人walk</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 机器人在n长度的数组中，位置在M，要走k步到p，有多少种方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DP_RobortWalk</span> &#123;</span><br><span class="line"><span class="comment">/* 1</span></span><br><span class="line"><span class="comment"> * 暴力递归尝试</span></span><br><span class="line"><span class="comment"> * 每次走一步： 1. rest - 1 ；2. 位置cur更新</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">way1</span><span class="params">(<span class="type">int</span> N, <span class="type">int</span> M, <span class="type">int</span> K, <span class="type">int</span> P)</span>&#123;</span><br><span class="line"><span class="keyword">if</span> (N &lt; <span class="number">2</span> || M &lt; <span class="number">1</span> || M &gt; N || P &lt; <span class="number">1</span> || P &gt; N || K &lt; <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> process1(N, M, K, P);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 1 当剩下0步 ：到了aim 返回1;没到 返回0</span></span><br><span class="line"><span class="comment">// 2 两个边界条件</span></span><br><span class="line"><span class="comment">// 3 返回递归结果</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">process1</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> cur, <span class="type">int</span> rest, <span class="type">int</span> aim)</span>&#123;</span><br><span class="line"><span class="comment">// 1 </span></span><br><span class="line"><span class="keyword">if</span>(rest == <span class="number">0</span> )&#123;<span class="comment">// base case</span></span><br><span class="line"><span class="keyword">return</span> cur == aim ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="keyword">if</span>(cur == <span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> process1(n, <span class="number">2</span>, rest - <span class="number">1</span>, aim);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(cur == n)&#123;</span><br><span class="line"><span class="keyword">return</span> process1(n, n - <span class="number">1</span>, rest - <span class="number">1</span>, aim);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="keyword">return</span> process1(n, cur - <span class="number">1</span>, rest - <span class="number">1</span>, aim) +  process1(n, cur + <span class="number">1</span>, rest - <span class="number">1</span>, aim);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * DP:直接使用矩阵来替代递归的过程</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">way3</span><span class="params">(<span class="type">int</span> N,<span class="type">int</span> M, <span class="type">int</span> K, <span class="type">int</span> P)</span>&#123;</span><br><span class="line"><span class="keyword">if</span> (N &lt; <span class="number">2</span> || M &lt; <span class="number">1</span> || M &gt; N || P &lt; <span class="number">1</span> || P &gt; N || K &lt; <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[N + <span class="number">1</span>][K + <span class="number">1</span>];</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line">dp[P][<span class="number">0</span>] = <span class="number">1</span>;<span class="comment">//base case </span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">rest</span> <span class="operator">=</span> <span class="number">1</span>; rest &lt;= K; rest++) &#123;</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line">dp[<span class="number">1</span>][rest] = dp[<span class="number">2</span>][rest - <span class="number">1</span>];</span><br><span class="line">dp[N][rest] = dp[N - <span class="number">1</span>][rest - <span class="number">1</span>];</span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">cur</span> <span class="operator">=</span> <span class="number">2</span>; cur &lt; N; cur++) &#123;</span><br><span class="line">dp[cur][rest] = dp[cur - <span class="number">1</span>][rest - <span class="number">1</span>] + dp[cur + <span class="number">1</span>][rest - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dp[M][K];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">System.out.println(way1(<span class="number">4</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>));</span><br><span class="line">System.out.println(way3(<span class="number">4</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="17-纸牌博弈">17 纸牌博弈</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 纸牌博弈问题</span></span><br><span class="line"><span class="comment"> * 两个会预判的人 从左右选卡片 返回胜利的人的分数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DP1_TwoSmartManPeekCard</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">win1</span><span class="params">(<span class="type">int</span>[] arr)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(arr==<span class="literal">null</span>||arr.length==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Math.max(f(arr,<span class="number">0</span>,arr.length-<span class="number">1</span>), s(arr,<span class="number">0</span>,arr.length-<span class="number">1</span>)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// f() 在i~j范围 先拿</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">f</span><span class="params">(<span class="type">int</span>[] arr,<span class="type">int</span> i,<span class="type">int</span> j)</span>&#123;</span><br><span class="line">        <span class="comment">//纸牌被聪明人先拿，获得的分数</span></span><br><span class="line">        <span class="keyword">if</span>(i==j)&#123;</span><br><span class="line">            <span class="keyword">return</span> arr[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//拿走一张（i或者j）后，聪明人成了后拿的人，在两种决策中选最优</span></span><br><span class="line">        <span class="keyword">return</span> Math.max(arr[i]+s(arr,i+<span class="number">1</span>,j),arr[j]+s(arr,i,j-<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// g() 在i~j范围 后拿</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">s</span><span class="params">(<span class="type">int</span>[] arr,<span class="type">int</span> i,<span class="type">int</span> j)</span>&#123;</span><br><span class="line">        <span class="comment">//纸牌被聪明人后拿，获得的分数</span></span><br><span class="line">        <span class="keyword">if</span>(i==j)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//对方拿走一张（i或者j）后，聪明人成了先拿的人，对方也是聪明人，会留下最差的情况</span></span><br><span class="line">        <span class="keyword">return</span> Math.min(f(arr,i+<span class="number">1</span>,j),f(arr,i,j-<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * DP</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">win2</span><span class="params">(<span class="type">int</span>[] arr)</span>&#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> arr.length;</span><br><span class="line"><span class="type">int</span>[][] fmap = <span class="keyword">new</span> <span class="title class_">int</span>[N][N];</span><br><span class="line"><span class="type">int</span>[][] gmap = <span class="keyword">new</span> <span class="title class_">int</span>[N][N];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//先处理L == R （gmap在初始化就是0，不用管</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= N - <span class="number">1</span>; i++)&#123;</span><br><span class="line">fmap[i][i] = arr[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//按着对角线来一步步求！！！</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">startCol</span> <span class="operator">=</span> <span class="number">1</span>; startCol &lt; N; startCol++) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> startCol;</span><br><span class="line"><span class="keyword">while</span> (R &lt; N) &#123;</span><br><span class="line">fmap[L][R] = Math.max(arr[L] + gmap[L + <span class="number">1</span>][R], arr[R] + gmap[L][R - <span class="number">1</span>]);</span><br><span class="line">gmap[L][R] = Math.min(fmap[L + <span class="number">1</span>][R], fmap[L][R - <span class="number">1</span>]);</span><br><span class="line">L++;</span><br><span class="line">R++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> Math.max(fmap[<span class="number">0</span>][N - <span class="number">1</span>], gmap[<span class="number">0</span>][N-<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>3 排序</h1><h2 id="快速排序">-快速排序-</h2><h4 id="1-0-partition">1.0 partition</h4><blockquote><p>partition 以arr[R] 为界分为 &lt;=arr[R]   arr[R]    &gt;arr[R] 三个部分</p><p>每次可以找到一个位置的数</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">partition</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> L, <span class="type">int</span> R)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (L &gt; R) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (L == R) &#123;</span><br><span class="line">        <span class="keyword">return</span> L;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">lessEqual</span> <span class="operator">=</span> L - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> L;</span><br><span class="line">    <span class="keyword">while</span> (index &lt; R) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr[index] &lt;= arr[R]) &#123;</span><br><span class="line">            swap(arr, index, ++lessEqual);</span><br><span class="line">        &#125;</span><br><span class="line">        index++;</span><br><span class="line">    &#125;</span><br><span class="line">    swap(arr, ++lessEqual, R);</span><br><span class="line">    <span class="keyword">return</span> lessEqual;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">quickSort1</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    process1(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">process1</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> L, <span class="type">int</span> R)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (L &gt;= R) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// L..R partition arr[R]  [   &lt;=arr[R]   arr[R]    &gt;arr[R]  ]</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">M</span> <span class="operator">=</span> partition(arr, L, R);</span><br><span class="line">    process1(arr, L, M - <span class="number">1</span>);</span><br><span class="line">    process1(arr, M + <span class="number">1</span>, R);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-0-荷兰国旗">2.0 荷兰国旗</h4><blockquote><p>在[l, r]上以arr[R]为界 将数组分为&lt; = &gt; 三个部分</p><p>每次可以找到中间等等于那部分的数</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[] netherlandsFlag(<span class="type">int</span>[] arr, <span class="type">int</span> L, <span class="type">int</span> R) &#123;</span><br><span class="line">  <span class="keyword">if</span>(L &gt; R) &#123;<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;-<span class="number">1</span>, -<span class="number">1</span>&#125;;&#125;</span><br><span class="line">  <span class="keyword">if</span>(L == R) &#123;<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;L, R&#125;;&#125;</span><br><span class="line">  <span class="type">int</span> <span class="variable">less</span> <span class="operator">=</span> L - <span class="number">1</span>;</span><br><span class="line">  <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> L;</span><br><span class="line">  <span class="type">int</span> <span class="variable">more</span> <span class="operator">=</span> R;</span><br><span class="line"> <span class="keyword">while</span>(index &lt; more) &#123; <span class="comment">// !!! index &lt; more</span></span><br><span class="line">    <span class="keyword">if</span>(arr[index] == arr[R]) &#123;<span class="comment">// 1 == 情况 index++</span></span><br><span class="line">      index++;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(arr[index] &lt; arr[R]) &#123; <span class="comment">// 2 &lt; 情况 交换index和less的右边 然后index++</span></span><br><span class="line">      swap(arr, index, ++less);</span><br><span class="line">      index++;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123; <span class="comment">// 3 &gt; 情况 交换index和more左边  不用index++！</span></span><br><span class="line">      swap(arr, index, --more);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  swap(arr, R, more);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;less+<span class="number">1</span>, more&#125;; <span class="comment">// ！！！</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="随机快排">随机快排</h5><blockquote><p>在荷兰国旗基础上 将数组的arr[R]进行随机交换 然后递归将数组所有部分都排完</p><p>最终期望求出来的复杂度就是O(logN*N)</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">quickSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(arr == <span class="literal">null</span> || arr.length == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  process(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">proces</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> L, <span class="type">int</span> R)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(L &gt; R) &#123;<span class="keyword">return</span>;&#125;</span><br><span class="line">  <span class="comment">// 随机交换</span></span><br><span class="line">  <span class="type">int</span> <span class="variable">random</span> <span class="operator">=</span> L + Math.random() * (R - L + <span class="number">1</span>);</span><br><span class="line">  swap(arr, R, random);</span><br><span class="line">  <span class="type">int</span>[] area = netherlandsFlag(arr, L, R);</span><br><span class="line">  process(arr, L, area[<span class="number">0</span>] - <span class="number">1</span>);</span><br><span class="line">  process(arr, area[<span class="number">1</span>] + <span class="number">1</span>, R);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="递归版本">递归版本</h5><blockquote><p>迭代，自己压栈，把任务做了然后再放出来</p><p>最开始做一次递归里做的 然后在迭代过程中再做递归里做的</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义任务</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Op</span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="type">int</span> L;</span><br><span class="line">  <span class="keyword">public</span> <span class="type">int</span> R;</span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Op</span><span class="params">(<span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">    L = left;</span><br><span class="line">    R = right;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 压栈：开始是从[0,N - 1]</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">quickSort2</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(...) &#123;<span class="keyword">return</span>;&#125;</span><br><span class="line">  <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> arr.length;</span><br><span class="line">  <span class="comment">// 随机交换 分界</span></span><br><span class="line">  <span class="type">int</span> <span class="variable">random</span> <span class="operator">=</span> (<span class="type">int</span>)(Math.random() * N);</span><br><span class="line">  swap(arr, N - <span class="number">1</span>, random);</span><br><span class="line">  <span class="type">int</span>[] area = netherlandsFlag(arr, <span class="number">0</span>, N - <span class="number">1</span>);</span><br><span class="line">  </span><br><span class="line">  Stack&lt;Op&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">  stack.push(<span class="keyword">new</span> <span class="title class_">Op</span>(<span class="number">0</span>, area[<span class="number">0</span>]-<span class="number">1</span>));</span><br><span class="line">  stack.push(<span class="keyword">new</span> <span class="title class_">Op</span>(area[<span class="number">1</span>]+<span class="number">1</span>, N - <span class="number">1</span>));</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">while</span>(!stack.isEmpty()) &#123;</span><br><span class="line">    <span class="type">Op</span> <span class="variable">op</span> <span class="operator">=</span> stack.pop();</span><br><span class="line">    <span class="keyword">if</span>(op.L &lt; op.R) &#123;</span><br><span class="line">      <span class="comment">// 随机交换和分界</span></span><br><span class="line">      random = op.L + (<span class="type">int</span>)(Math.random() * (op.R - op.L + <span class="number">1</span>));</span><br><span class="line">      swap(arr, op.R, random);</span><br><span class="line">      area = netherlandsFlag(arr, op.L, op.R);</span><br><span class="line">      </span><br><span class="line">      stack.push(<span class="keyword">new</span> <span class="title class_">Op</span>(op.L, area[<span class="number">0</span>]-<span class="number">1</span>));</span><br><span class="line">  stack.push(<span class="keyword">new</span> <span class="title class_">Op</span>(area[<span class="number">1</span>]+<span class="number">1</span>, op.R));</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="随机快排的时间复杂度分析">&lt;随机快排的时间复杂度分析&gt;</h4><p>1）通过分析知道，划分值越靠近中间，性能越好；越靠近两边，性能越差<br>2）随机选一个数进行划分的目的就是让好情况和差情况都变成概率事件<br>3）把每一种情况都列出来，会有每种情况下的时间复杂度，但概率都是1/N<br>4）那么所有情况都考虑，时间复杂度就是这种概率模型下的长期期望！</p><p><em><em>时间复杂度O(N</em> logN)，额外空间复杂度O(logN)都是这么来的。</em>*</p><h3 id="找到数组中的第k个最大元素">!!! ==找到数组中的第k个最大元素==</h3><p>⚠️是k大还是k小</p><h4 id="改写快速排序">改写<a href="###-%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F-">快速排序</a></h4><p><strong>时间复杂度O(N)</strong></p><p>1 原先数组不能改变 复制一个新数组<br>2 随机选一个数来分区<br>3 分区: 返回两个边界 partition<br>4 如果分区中间=部分包含k 就找到了<br>没有就根据k与边界大小比较大小去其中一部分去找</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findKthLargest</span><span class="params">(<span class="type">int</span>[] array, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">       <span class="comment">// 1 原来的数组不好更改</span></span><br><span class="line">       <span class="type">int</span>[] arr = copyArray(array);</span><br><span class="line">       <span class="keyword">return</span> process2(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>, arr.length - k);<span class="comment">// k 小的话就 k - 1</span></span><br><span class="line">   &#125;   </span><br><span class="line">   <span class="comment">// 2 partition分区返回两个边界 分区中间等于部分包含k 就是找到了</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">process2</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> L, <span class="type">int</span> R, <span class="type">int</span> index)</span> &#123;</span><br><span class="line">       <span class="keyword">if</span>(L == R) &#123;</span><br><span class="line">           <span class="keyword">return</span> arr[L];</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="type">int</span> <span class="variable">random</span> <span class="operator">=</span> L + (<span class="type">int</span>)(Math.random() * (R - L + <span class="number">1</span>));</span><br><span class="line">       <span class="type">int</span>[] area = partition(arr, L, R, arr[random]);</span><br><span class="line">       </span><br><span class="line">     </span><br><span class="line">       <span class="keyword">if</span>(index &gt;= area[<span class="number">0</span>] &amp;&amp; index &lt;= area[<span class="number">1</span>]) &#123;</span><br><span class="line">           <span class="keyword">return</span> arr[index];</span><br><span class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span>(index &lt; area[<span class="number">0</span>]) &#123;<span class="comment">// 没有找到就到另外两个部分继续找</span></span><br><span class="line">           <span class="keyword">return</span> process2(arr, L, area[<span class="number">0</span>] - <span class="number">1</span>, index);</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           <span class="keyword">return</span> process2(arr, area[<span class="number">1</span>] + <span class="number">1</span>, R, index);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>注意这里的partition</p><blockquote><p>因为是使用num来分区 所以边界注意⚠️对比快排用arr[R]来分区</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[] partition(<span class="type">int</span>[] arr, <span class="type">int</span> L , <span class="type">int</span> R, <span class="type">int</span> num) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">less</span> <span class="operator">=</span> L - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">more</span> <span class="operator">=</span> R + <span class="number">1</span>; <span class="comment">//！！</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> L;</span><br><span class="line">    <span class="keyword">while</span>(index &lt; more) &#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[index] &lt; num) &#123;</span><br><span class="line">            swap(arr, index, ++less);</span><br><span class="line">            index++;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(arr[index] &gt; num) &#123;</span><br><span class="line">            swap(arr, index, --more);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">// 快排还需要交换more和R</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;less + <span class="number">1</span>, more - <span class="number">1</span>&#125;; <span class="comment">//！！！ 返回的右边界是more - 1 快排是more</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="BFPRT-面试聊">BFPRT(面试聊)</h4><p><strong>俗称&quot;中位数之中位数算法&quot;。依靠一种精心设计的 pivot 选取方法，该算法从理论上保证了最坏情形下的线性时间复杂度，打败了平均线性、最坏 O(n^2) 复杂度的传统算法</strong></p><blockquote><p>bfprt算法</p><ul><li><p>改进部分就是将快排中随机选数的过程改为五个一组 分组组中排好序</p></li><li><p>找出每一段的中位数 组成m[]</p></li><li><p>找到m的中位数返回</p></li><li><p>medianOfMedian():<br>// 1 arr[L…R] 五个数一组<br>// 2 每个小组内部排序，找到中位数领出来，组成m<br>// 3 m[]中，找到中位数 反调bfprt</p></li></ul></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">process</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> L, <span class="type">int</span> R, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L == R)&#123;</span><br><span class="line">        <span class="keyword">return</span> arr[L];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 改进部分：随机部分改成一个方法</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> medianOfMedian(arr, L ,R);</span><br><span class="line">  </span><br><span class="line">    <span class="type">int</span>[] range = partition(arr, L, R, r);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(index &gt;= range[<span class="number">0</span>] &amp;&amp; index &lt;= range[<span class="number">1</span>])&#123;</span><br><span class="line">        <span class="keyword">return</span> arr[index];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index &lt; range[<span class="number">0</span>])&#123;</span><br><span class="line">        <span class="keyword">return</span> process(arr, L , range[<span class="number">0</span>] - <span class="number">1</span>, index);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> process(arr, range[<span class="number">1</span>] + <span class="number">1</span>, R, index);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1 arr[L...R] 五个数一组 </span></span><br><span class="line"><span class="comment">// 2 每个小组内部排序，找到中位数领出来，组成m </span></span><br><span class="line"><span class="comment">// 3 m[]中，找到中位数 反调bfprt</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">medianOfMedian</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> L, <span class="type">int</span> R)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> R - L + <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">offset</span> <span class="operator">=</span> size % <span class="number">5</span> == <span class="number">0</span> ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span>[] m = <span class="keyword">new</span> <span class="title class_">int</span>[size/<span class="number">5</span> + offset];</span><br><span class="line">    <span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; m.length - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">first</span> <span class="operator">=</span> L + i * <span class="number">5</span>;</span><br><span class="line">        m[i] = sortAndMedian(arr, first, Math.min(R, first + <span class="number">4</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 3</span></span><br><span class="line">    <span class="keyword">return</span> process(m, <span class="number">0</span>, m.length - <span class="number">1</span>, m.length / <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">sortAndMedian</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> L, <span class="type">int</span> R)</span> &#123;</span><br><span class="line">    <span class="comment">// SORT</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> L + <span class="number">1</span>; i &lt;= R; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i - <span class="number">1</span>; j &gt;= L &amp;&amp; arr[j] &gt; arr[j + <span class="number">1</span>]; j--) &#123;</span><br><span class="line">            swap(arr, j, j + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// MEDIAN</span></span><br><span class="line">    <span class="keyword">return</span> arr[(L + R) / <span class="number">2</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="堆排序">-堆排序-</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 1 从下至上让整个数组变为大根堆 并将堆顶(max)与结尾交换 再去重新调整</span></span><br><span class="line"><span class="comment">     * 2 遍历调整 直到heapSize = 0</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> arr</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">heapSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr.length &lt; <span class="number">2</span> || arr == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">heapSize</span> <span class="operator">=</span> arr.length;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> arr.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            heapify(arr, i, arr.length);</span><br><span class="line">        &#125;</span><br><span class="line">        swap(arr, <span class="number">0</span>, --heapSize);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2</span></span><br><span class="line">        <span class="keyword">while</span>(heapSize &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            heapify(arr, <span class="number">0</span>, heapSize);</span><br><span class="line">            swap(arr, <span class="number">0</span>, --heapSize);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从下到上将整个数组变为大根堆结构</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">heapify</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> i, <span class="type">int</span> heapSize)</span> &#123;</span><br><span class="line">        <span class="comment">//先找到左孩子 如果有孩子 将最大的找到并与根比较 谁大放在上面</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">2</span> * i + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(left &lt; heapSize)&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">largest</span> <span class="operator">=</span> left + <span class="number">1</span> &lt; heapSize &amp;&amp; arr[left + <span class="number">1</span>] &gt; arr[left] ? left + <span class="number">1</span> : left;</span><br><span class="line">            largest = arr[largest] &gt; arr[i] ? largest : i;</span><br><span class="line">            <span class="keyword">if</span>(largest == i)&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            swap(arr, largest, i);</span><br><span class="line">            i = largest;</span><br><span class="line">            left = <span class="number">432</span> * i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> largest, <span class="type">int</span> i)</span> &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> arr[i];</span><br><span class="line">        arr[i] = arr[largest];</span><br><span class="line">        arr[largest] = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="归并排序">-归并排序-</h2><hr><p>1）整体是递归，左边排好序+右边排好序+merge让整体有序<br>2）让其整体有序的过程里用了排外序方法<br>3）利用master公式来求解时间复杂度<br>4）当然可以用非递归实现</p><hr><h3 id="递归版本-2">递归版本</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 递归方法实现</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">mergeSort1</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    process(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// arr[L...R]范围上，变成有序的</span></span><br><span class="line"><span class="comment">// L...R    N    T(N) = 2*T(N/2) + O(N)  -&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> L, <span class="type">int</span> R)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (L == R) &#123; <span class="comment">// base case</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> L + ((R - L) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    process(arr, L, mid);</span><br><span class="line">    process(arr, mid + <span class="number">1</span>, R);</span><br><span class="line">    merge(arr, L, mid, R);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">merge</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> L, <span class="type">int</span> M, <span class="type">int</span> R)</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] help = <span class="keyword">new</span> <span class="title class_">int</span>[R - L + <span class="number">1</span>];</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">p1</span> <span class="operator">=</span> L;</span><br><span class="line">    <span class="type">int</span> <span class="variable">p2</span> <span class="operator">=</span> M + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (p1 &lt;= M &amp;&amp; p2 &lt;= R) &#123;</span><br><span class="line">        help[i++] = arr[p1] &lt;= arr[p2] ? arr[p1++] : arr[p2++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 要么p1越界了，要么p2越界了</span></span><br><span class="line">    <span class="keyword">while</span> (p1 &lt;= M) &#123;</span><br><span class="line">        help[i++] = arr[p1++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (p2 &lt;= R) &#123;</span><br><span class="line">        help[i++] = arr[p2++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; help.length; i++) &#123;</span><br><span class="line">        arr[L + i] = help[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="非递归版本">非递归版本</h3><p>流程就在于折腾  步长 这个概念<br>步长 = 1 开始, 步长的变化一定是2的某次方<br>最后一组: 凑不齐左组就不管了, 右组有多少算多少<br>步长一旦超过总长度, 说明搞完了, 停止就行了</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">mergeSort3</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> arr.length;</span><br><span class="line">    <span class="type">int</span> <span class="variable">step</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (step &lt; N) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (L &lt; N) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">M</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> ( N - L &gt;= step) &#123;</span><br><span class="line">                M = L + step - <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                M = N - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (M == N -<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (N -<span class="number">1</span> - M &gt;= step) &#123;</span><br><span class="line">                R = M + step;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                R = N - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            merge(arr, L, M, R);</span><br><span class="line">            <span class="keyword">if</span> (R == N - <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                L = R + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (step &gt; N / <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        step &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意最后一组左组: L + step - 1 可能越界</p><p>从右往左合并就不用考虑越界问题了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (step &gt; N / 2) &#123;</span><br><span class="line">    break;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此处不用等号的原因:<br>如果17个数, 最后一个调整是步长为16的时候的调整:<br>前16个数做左组, 后一个数做右组<br>而 N/2 是向下取整的, 17/2 =8 , 所以 mergeSize &gt;= N / 2,<br>在等于的时候就停止的话, 最后一个步长是8, 不会有最后一个步长为16的时候, 导致你出错了</p><h3 id="优化后的最终版本">优化后的最终版本</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 非递归方法实现</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">mergeSort2</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> arr.length;</span><br><span class="line">    <span class="type">int</span> <span class="variable">mergeSize</span> <span class="operator">=</span> <span class="number">1</span>;<span class="comment">// 当前有序的，左组长度</span></span><br><span class="line">    <span class="comment">// 一组是2倍的mergeSize</span></span><br><span class="line">    <span class="keyword">while</span> (mergeSize &lt; N) &#123; <span class="comment">// log N</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// 0.... </span></span><br><span class="line">        <span class="keyword">while</span> (L &lt; N) &#123;</span><br><span class="line">            <span class="comment">// L...M  左组（mergeSize）</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">M</span> <span class="operator">=</span> L + mergeSize - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (M &gt;= N) &#123; <span class="comment">// 当前组凑不齐,只有左边, 肯定有序</span></span><br><span class="line">                <span class="keyword">break</span>;    <span class="comment">// 预防越界风险</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//  L...M   M+1...R(mergeSize)</span></span><br><span class="line">            <span class="comment">// 有可能最后一组右组数目不够</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> Math.min(M + mergeSize, N - <span class="number">1</span>);</span><br><span class="line">            merge(arr, L, M, R);</span><br><span class="line">            L = R + <span class="number">1</span>; <span class="comment">// 下一次左组</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 防止溢出, INT_MAX</span></span><br><span class="line">        <span class="keyword">if</span> (mergeSize &gt; N / <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        mergeSize &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="复杂度">复杂度</h4><p>一共执行次数  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>N</mi></mrow><annotation encoding="application/x-tex">log_2N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>, merge 一次的复杂度 O(N)<br>总的复杂度: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N*logN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></p><h2 id="前缀树">-前缀树-</h2><p>1）单个字符串中，字符从前到后的加到一棵多叉树上<br>2）字符放在路上，节点上有专属的数据项（常见的是pass和end值）<br>3）所有样本都这样添加，如果没有路就新建，如有路就复用<br>4）沿途节点的pass值增加1，每个字符串结束时来-到的节点end值增加1</p><p>可以完成前缀相关的查询</p><h3 id="例子">例子</h3><p>设计一种结构。用户可以：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1）void insert(String str)            添加某个字符串，可以重复添加，每次算1个</span><br><span class="line">2）int search(String str)             查询某个字符串在结构中还有几个</span><br><span class="line">3) void delete(String str)           删掉某个字符串，可以重复删除，每次算1个</span><br><span class="line">4）int prefixNumber(String str)       查询有多少个字符串，是以str做前缀的</span><br></pre></td></tr></table></figure><h3 id="前缀树的实现方式">前缀树的实现方式</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> pass;<span class="comment">// 经过几次</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> end;<span class="comment">// 作为end几次</span></span><br><span class="line">        <span class="keyword">public</span> Node[] nexts; <span class="comment">// 后面的数组</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">()</span>&#123;</span><br><span class="line">            pass = <span class="number">0</span>;</span><br><span class="line">            end = <span class="number">0</span>;</span><br><span class="line">            nexts = <span class="keyword">new</span> <span class="title class_">Node</span>[<span class="number">26</span>];<span class="comment">// 一条最长就26 所以这个方式不适合很多类型的节点</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Trie1</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Node root;<span class="comment">// 头节点</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 构造方法</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Trie1</span><span class="params">()</span>&#123;</span><br><span class="line">            root = <span class="keyword">new</span> <span class="title class_">Node</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * insert()</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// 1 先抓住头节点  pass ++ </span></span><br><span class="line">        <span class="comment">// 2 从左向右遍历字符，next[path]== null则新建节点 pass++</span></span><br><span class="line">        <span class="comment">// 3 最后end++</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(String word)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(word == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">char</span>[] str = word.toCharArray();</span><br><span class="line">            <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> root;</span><br><span class="line">            node.pass++;</span><br><span class="line">            <span class="type">int</span> <span class="variable">path</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length; i++)&#123;</span><br><span class="line">                path = str[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span>(node.nexts[path] == <span class="literal">null</span>)&#123;</span><br><span class="line">                    node.nexts[path] = <span class="keyword">new</span> <span class="title class_">Node</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                node = node.nexts[path];</span><br><span class="line">                node.pass++;</span><br><span class="line">            &#125;</span><br><span class="line">            node.end++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * search():查找word出现了几次</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">search</span><span class="params">(String word)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(word ==  <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">char</span>[] str = word.toCharArray();</span><br><span class="line">            <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> root;</span><br><span class="line">            <span class="type">int</span> <span class="variable">path</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length; i++)&#123;</span><br><span class="line">                path = str[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span>(node.nexts[path] == <span class="literal">null</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                node = node.nexts[path];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> node.end;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * delete() 内存泄漏问题jvm可以解决的</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// 1 先search是否存在</span></span><br><span class="line">        <span class="comment">// 2 遍历经过要把pass-- 且当pass==0时将next[path]置空，后面的节点JVM自动会清除</span></span><br><span class="line">        <span class="comment">// 3 end --</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(String word)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">this</span>.search(word) != <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="type">char</span>[] str = word.toCharArray();</span><br><span class="line">                <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> root;</span><br><span class="line">                node.pass--;</span><br><span class="line">                <span class="type">int</span> <span class="variable">path</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length; i++)&#123;</span><br><span class="line">                    path = str[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">                    <span class="keyword">if</span>(--node.nexts[path].pass == <span class="number">0</span>)&#123;</span><br><span class="line">                        node.nexts[path] = <span class="literal">null</span>;</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    node = node.nexts[path];</span><br><span class="line">                &#125;</span><br><span class="line">                node.end--;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * prefixNode:有几个是以pre作为前缀的字符</span></span><br><span class="line"><span class="comment">         * </span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">//和search步骤差不多 最后return的是pass</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">prefixNode</span><span class="params">(String pre)</span>&#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> root;</span><br><span class="line">            <span class="type">int</span> <span class="variable">path</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="type">char</span>[] str = pre.toCharArray();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length;i++)&#123;</span><br><span class="line">                path = str[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span>(node.nexts[path] == <span class="literal">null</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                node = node.nexts[path];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> node.pass;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="（桶排序）不基于比较的">-（桶排序）不基于比较的-</h2><p>桶排序思想下的排序：计数排序 &amp; 基数排序</p><p>1)桶排序思想下的排序都是不基于比较的排序</p><p>2)时间复杂度为O(N)，额外空间负载度O(M)</p><p>3)应用范围有限，需要样本的数据状况满足桶的划分</p><h3 id="计数排序和基数排序">计数排序和基数排序</h3><h4 id="题目3-计数排序">题目3: <a href="app://obsidian.md/%E8%AE%A1%E6%95%B0%E6%8E%92%E5%BA%8F">计数排序</a></h4><p>计数排序要求，样本是整数，且范围比较窄</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// only for 0~200 value</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">countSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> Integer.MIN_VALUE;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        max = Math.max(max, arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span>[] bucket = <span class="keyword">new</span> <span class="title class_">int</span>[max + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        bucket[arr[i]]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; bucket.length; j++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (bucket[j]-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            arr[i++] = j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="题目4-基数排序代码">题目4: <a href="app://obsidian.md/%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F%E4%BB%A3%E7%A0%81">基数排序代码</a></h4><p>一般来讲，基数排序要求，样本是10进制的正整数</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// only for no-negative value</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">radixSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="literal">null</span> || arr.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    radixSort(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>, maxbits(arr));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">maxbits</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> Integer.MIN_VALUE;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        max = Math.max(max, arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (max != <span class="number">0</span>) &#123;</span><br><span class="line">        res++;</span><br><span class="line">        max /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// arr[l..r]排序  ,  digit</span></span><br><span class="line"><span class="comment">// l..r    3 56 17 100    3</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">radixSort</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> L, <span class="type">int</span> R, <span class="type">int</span> digit)</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">radix</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 有多少个数准备多少个辅助空间</span></span><br><span class="line">    <span class="type">int</span>[] help = <span class="keyword">new</span> <span class="title class_">int</span>[R - L + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">d</span> <span class="operator">=</span> <span class="number">1</span>; d &lt;= digit; d++) &#123; <span class="comment">// 有多少位就进出几次</span></span><br><span class="line">        <span class="comment">// 10个空间</span></span><br><span class="line">        <span class="comment">// count[0] 当前位(d位)是0的数字有多少个</span></span><br><span class="line">        <span class="comment">// count[1] 当前位(d位)是(0和1)的数字有多少个</span></span><br><span class="line">        <span class="comment">// count[2] 当前位(d位)是(0、1和2)的数字有多少个</span></span><br><span class="line">        <span class="comment">// count[i] 当前位(d位)是(0~i)的数字有多少个</span></span><br><span class="line">        <span class="type">int</span>[] count = <span class="keyword">new</span> <span class="title class_">int</span>[radix]; <span class="comment">// count[0..9]</span></span><br><span class="line">        <span class="keyword">for</span> (i = L; i &lt;= R; i++) &#123;</span><br><span class="line">            <span class="comment">// 103  1   3</span></span><br><span class="line">            <span class="comment">// 209  1   9</span></span><br><span class="line">            j = getDigit(arr[i], d);</span><br><span class="line">            count[j]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; radix; i++) &#123;</span><br><span class="line">            count[i] = count[i] + count[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (i = R; i &gt;= L; i--) &#123;</span><br><span class="line">            j = getDigit(arr[i], d);</span><br><span class="line">            help[count[j] - <span class="number">1</span>] = arr[i];</span><br><span class="line">            count[j]--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (i = L, j = <span class="number">0</span>; i &lt;= R; i++, j++) &#123;</span><br><span class="line">            arr[i] = help[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getDigit</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> d)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> ((x / ((<span class="type">int</span>) Math.pow(<span class="number">10</span>, d - <span class="number">1</span>))) % <span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>1）一般来讲，计数排序要求，样本是整数，且范围比较窄</strong></p><p><strong>2）一般来讲，基数排序要求，样本是10进制的正整数</strong></p><p><strong>一旦要求稍有升级，改写代价增加是显而易见的</strong></p><h2 id="排序算法的稳定性">排序算法的稳定性</h2><p>稳定性是指同样大小的样本再排序之后不会改变相对次序</p><p>对基础类型来说，稳定性毫无意义</p><p>对非基础类型来说，稳定性有重要意义</p><p>有些排序算法可以实现成稳定的，而有些排序算法无论如何都实现不成稳定的</p><h2 id="排序算法总结">排序算法总结</h2><table><thead><tr><th></th><th>时间复杂度</th><th>额外空间复杂度</th><th>稳定性</th></tr></thead><tbody><tr><td>选择排序</td><td>O(N^2)</td><td>O(1)</td><td>无</td></tr><tr><td>冒泡排序</td><td>O(N^2)</td><td>O(1)</td><td>有</td></tr><tr><td>插入排序</td><td>O(N^2)</td><td>O(1)</td><td>有</td></tr><tr><td>归并排序</td><td>O(N* logN)</td><td>O(N)</td><td>有</td></tr><tr><td>随机快排</td><td>O(N* logN)</td><td>O(logN)</td><td>无</td></tr><tr><td>堆排序</td><td>O(N* logN)</td><td>O(1)</td><td>无</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>计数排序</td><td>O(N)</td><td>O(M)</td><td>有</td></tr><tr><td>基数排序</td><td>O(N)</td><td>O(N)</td><td>有</td></tr></tbody></table><p>1）不基于比较的排序，对样本数据有严格要求，不易改写<br>2）基于比较的排序，只要规定好两个样本怎么比大小就可以直接复用<br>3）基于比较的排序，时间复杂度的极限是O(N∗logN)<br>4）时间复杂度O(N∗logN)、额外空间复杂度低于O(N)、且稳定的基于比较的排序是不存 在的。<br>5）为了绝对的速度选快排、为了省空间选堆排、为了稳定性选归并</p><h1>4 滑动窗口</h1><p>滑动窗口更新结构</p><h2 id="1-无重复数组的最长子串">1 无重复数组的最长子串</h2><blockquote><p>给定一个字符串 找出里面没有重复的最长子串</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 使用窗口 因为不重复 可以用hashset来存储 结果集是char[] str</span></span><br><span class="line"><span class="comment">// 2 遍历数组 L 向右</span></span><br><span class="line"><span class="comment">// 2.1 R向右遍历:更新表</span></span><br><span class="line"><span class="comment">// 2.2 更新max、更新set:删除头</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">lengthOfLongestSubstring</span><span class="params">(String s)</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(s.length() == <span class="number">0</span> || s ==  <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line">HashSet&lt;Character&gt; set = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;Character&gt;();</span><br><span class="line"><span class="type">char</span>[] str = s.toCharArray();</span><br><span class="line"><span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="keyword">while</span>(L &lt; str.length)&#123;</span><br><span class="line"><span class="comment">// 2.1</span></span><br><span class="line"><span class="keyword">while</span>(R &lt; str.length &amp;&amp; !set.contains(str[R]))&#123; <span class="comment">// !!! 注意是不包含</span></span><br><span class="line">set.add(str[R]);</span><br><span class="line">R++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.2</span></span><br><span class="line">ans = Math.max(ans, R - L );</span><br><span class="line">set.remove(str[L]);</span><br><span class="line">L++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="动态规划版">动态规划版</h3><p>使用256数组进行存储 先都初始化为-1 下标是字符串值</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">lengthOfLongestSubstring2</span><span class="params">(String s)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (s.length() == <span class="number">0</span> || s == <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span>[] str = s.toCharArray();</span><br><span class="line"><span class="type">int</span>[] map = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">256</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">map[i] = -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">map[str[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> str.length;</span><br><span class="line"><span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; N; i++) &#123;</span><br><span class="line">pre = Math.min(i - map[str[i]], pre + <span class="number">1</span>);</span><br><span class="line">ans = Math.max(ans, pre);</span><br><span class="line">map[str[i]] = i;&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-最小覆盖子串">2 最小覆盖子串</h2><blockquote><p>给你一个字符串 <code>s</code> 、一个字符串 <code>t</code> 。返回 <code>s</code> 中涵盖 <code>t</code> 所有字符的最小子串。如果 <code>s</code> 中不存在涵盖 <code>t</code> 所有字符的子串，则返回空字符串 <code>&quot;&quot;</code> 。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// 1 使用map[256]来记录 t中需要的每种字符的数量;</span></span><br><span class="line"><span class="comment">//all来记录所有字符剩下没找到的数量；start记录最小子串开头下标</span></span><br><span class="line"><span class="comment">// 2 遍历字符集  L = 0 遍历 R 向右 </span></span><br><span class="line"><span class="comment">// 2.1 右边界扩大 同时map相应-- 并且没有减到0的话all--</span></span><br><span class="line"><span class="comment">// 2.2 当all还完之后 要将左边界缩小 </span></span><br><span class="line"><span class="comment">// 2.2.1 map对应的str[L] 左边界有可能有重复值 对应map小于0 要缩到不能缩的地方</span></span><br><span class="line"><span class="comment">// 2.2.2 更新minLen 和开头start </span></span><br><span class="line"><span class="comment">// 2.2.3 左边界L++、map对应++、 all++</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">minLength2</span><span class="params">(String s1, String s2)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (s1 == <span class="literal">null</span> || s2 == <span class="literal">null</span> || s1.length() &lt; s2.length()) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span>[] str1 = s1.toCharArray();</span><br><span class="line"><span class="type">char</span>[] str2 = s2.toCharArray();</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="type">int</span>[] map = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">256</span>]; <span class="comment">// map[37] = 4  37  4次</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i != str2.length; i++) &#123;</span><br><span class="line">map[str2[i]]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="variable">all</span> <span class="operator">=</span> str2.length;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">// [L,R)  -&gt; [0,0)</span></span><br><span class="line"><span class="type">int</span> <span class="variable">minLen</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line"><span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">// 记录最小子串开头下标 </span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="keyword">while</span> (R != str1.length) &#123;</span><br><span class="line"><span class="comment">// 2.1</span></span><br><span class="line">map[str1[R]]--;</span><br><span class="line"><span class="keyword">if</span> (map[str1[R]] &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">all--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2.2</span></span><br><span class="line"><span class="keyword">if</span> (all == <span class="number">0</span>) &#123; <span class="comment">// 还完了 就是一个解</span></span><br><span class="line"><span class="comment">// 2.2.1</span></span><br><span class="line"><span class="keyword">while</span> (map[str1[L]] &lt; <span class="number">0</span>) &#123;<span class="comment">// ！！！左边界有可能有重复值 对应的map就是小于0的 我们要避免 所以缩到没有重复的地方才开始记录minlen</span></span><br><span class="line">map[str1[L]]++;</span><br><span class="line">         L++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2.2.2</span></span><br><span class="line"><span class="keyword">if</span>(minLen &gt; R - L + <span class="number">1</span>)&#123; </span><br><span class="line">minLen = R - L + <span class="number">1</span>;</span><br><span class="line">start = L;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2.2.3</span></span><br><span class="line">all++;</span><br><span class="line">map[str1[L++]]++;</span><br><span class="line">&#125;</span><br><span class="line">R++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> minLen == Integer.MAX_VALUE ? <span class="string">&quot;&quot;</span> : s1.substring(start, start + minLen);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>就是all还完之前r++往右展开 all==0 就要l++ 往左边缩</strong></p><h2 id=""></h2><h2 id="3-滑动窗口的最大值">3 滑动窗口的最大值</h2><blockquote><p>假设一个固定大小为W的窗口;依次划过arr 返回每一次滑出状况的最大值</p></blockquote><p>定义一个队列来作为窗口，里面放的是下标</p><p>循环遍历数组： L R边界</p><p>\1) 当窗口不为空&amp;窗口结尾小于当前R 结尾弹出（window是单调递减）<br>\2) 添加arr[R]<br>\3) 当队首元素已经不再滑动窗口内，将其从队首移除<br>\4) 当窗口右边界right+1大于等于窗口大小k时窗口形成。此时，队首元素就是该窗口内的最大值。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( arr == <span class="literal">null</span> || w &lt; <span class="number">1</span> || arr.length == <span class="number">0</span> )&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">    LinkedList&lt;Integer&gt; window = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">int</span>[arr.length - w + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> <span class="number">0</span>; R &lt; arr.length; R++)&#123;</span><br><span class="line">        <span class="comment">// 1)</span></span><br><span class="line">        <span class="keyword">while</span>(!window.isEmpty() &amp;&amp; arr[window.peekLast()] &lt; arr[R])&#123;</span><br><span class="line">            window.pollLast();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2)</span></span><br><span class="line">        window.addLast(R);</span><br><span class="line">        <span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> R - w + <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// 3)</span></span><br><span class="line">        <span class="keyword">if</span>(window.peekFirst() &lt; L)&#123;</span><br><span class="line">            window.pollFirst();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 4)</span></span><br><span class="line">        <span class="keyword">if</span>(R &gt;= w - <span class="number">1</span>)&#123;</span><br><span class="line">            res[L] = arr[window.peekFirst()];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br></pre></td></tr></table></figure><h2 id="4-满足绝对值差达标的子数组数量">4 满足绝对值差达标的子数组数量</h2><blockquote><p>给定一个整型数组arr, 和一个整数num 某一个arr中的子数组sub 如果想达标必须满足 sub中最大值 - sub中国最小值 &lt;= num 返回arr中达标子数组的数量</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SW_AllLessNumSubArray</span> &#123;</span><br><span class="line"><span class="comment">// 1 需要两个双端队列来存储max和min</span></span><br><span class="line"><span class="comment">// 2 遍历数组每一个数都做一次L开头</span></span><br><span class="line"><span class="comment">// 2.1 往右R直到当前窗口内子数组不达标</span></span><br><span class="line"><span class="comment">// 2.1.1 滑动窗口比较弹出末尾添加当前值</span></span><br><span class="line"><span class="comment">// 2.1.2 不达标要break</span></span><br><span class="line"><span class="comment">// 2.2 到达了不达标的位置 就可以结束当前L开头的收集 并弹出开头</span></span><br><span class="line"><span class="comment">// 2.2.1 更新res:对收集达标的数组个数 进行累加</span></span><br><span class="line"><span class="comment">// 2.2.2 更新窗口:弹出L开头</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">allLessNumSubArray</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> num)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (arr.length == <span class="number">0</span> || arr == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1 </span></span><br><span class="line">LinkedList&lt;Integer&gt; qmin = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">LinkedList&lt;Integer&gt; qmax = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"><span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 </span></span><br><span class="line"><span class="keyword">while</span> (L &lt; arr.length) &#123;</span><br><span class="line"><span class="comment">// 2.1</span></span><br><span class="line"><span class="keyword">while</span> (R &lt; arr.length) &#123;</span><br><span class="line"><span class="comment">// 2.1.1</span></span><br><span class="line"><span class="keyword">while</span> (!qmax.isEmpty() &amp;&amp; arr[qmax.peekLast()] &lt;= arr[R]) &#123;</span><br><span class="line">qmax.pollLast();</span><br><span class="line">&#125;</span><br><span class="line">qmax.addLast(R);</span><br><span class="line"><span class="keyword">while</span> (!qmin.isEmpty() &amp;&amp; arr[qmin.peekLast()] &gt;= arr[R]) &#123;</span><br><span class="line">qmin.pollLast();</span><br><span class="line">&#125;</span><br><span class="line">qmin.addLast(R);</span><br><span class="line"><span class="comment">// 2.1.2</span></span><br><span class="line"><span class="keyword">if</span> (arr[qmax.getFirst()] - arr[qmin.getFirst()] &gt; num) &#123;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">R++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.2</span></span><br><span class="line"><span class="comment">// 2.2.1</span></span><br><span class="line">res += R - L;</span><br><span class="line"><span class="comment">// 2.2.2</span></span><br><span class="line"><span class="keyword">if</span> (qmax.peekFirst() == L) &#123;</span><br><span class="line">qmax.pollFirst();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (qmin.peekFirst() == L) &#123;</span><br><span class="line">qmin.pollFirst();</span><br><span class="line">&#125;</span><br><span class="line">L++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>5 二叉树</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TreeNode</span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> val;</span><br><span class="line">  <span class="keyword">private</span> TreeNode left;</span><br><span class="line">  <span class="keyword">private</span> TreeNode right;</span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">TreeNode</span><span class="params">(<span class="type">int</span> val, <span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.val = val;</span><br><span class="line">    <span class="built_in">this</span>.left = left;</span><br><span class="line">    <span class="built_in">this</span>.right = right;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="1-二叉树先、中、后序遍历-DFS">1 二叉树先、中、后序遍历(DFS)</h2><h3 id="递归">递归</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line">  <span class="comment">// 前</span></span><br><span class="line">  process(head.left);</span><br><span class="line">  <span class="comment">// 中</span></span><br><span class="line">  process(head.right);</span><br><span class="line">  <span class="comment">// 后</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="非递归-压栈">非递归(压栈)</h3><ul><li>先： 先压右再压左 输出—》头左右</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">front</span><span class="params">(TreeNode head)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(head == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">  stack.push(head);</span><br><span class="line">  <span class="keyword">while</span>(!stack.isEmpty()) &#123;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">cur</span> <span class="operator">=</span> stack.pop();</span><br><span class="line">    <span class="comment">// 打印 </span></span><br><span class="line">    sysout();</span><br><span class="line">    <span class="keyword">if</span>(cur.right != <span class="literal">null</span>) &#123; <span class="comment">// !!! 判空</span></span><br><span class="line">      stack.push(cur.right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cur.left != <span class="literal">null</span>) &#123; <span class="comment">// !!! 判空</span></span><br><span class="line">      stack.push(cur.left);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>后：用两个栈 1）先压左再压右 同时答应弹出改为压入另一个栈 输出—》 头右左 2）最后输出的时候就是左右头  头左右</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(TreeNode head)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(head == <span class="literal">null</span>) &#123;<span class="keyword">return</span>;&#125;</span><br><span class="line">  Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">  Stack&lt;TreeNode&gt; stack2 = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">  <span class="keyword">while</span>(!stack.isEmpty()) &#123;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">cur</span> <span class="operator">=</span> stack.pop();</span><br><span class="line">    <span class="comment">// 前序打印行为改成压栈</span></span><br><span class="line">    stack2.push(cur.val);</span><br><span class="line">    <span class="keyword">if</span>(cur.left != <span class="literal">null</span>) &#123; <span class="comment">// 左</span></span><br><span class="line">      stack.push(cur.left);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cur.right != <span class="literal">null</span>) &#123;<span class="comment">// 右</span></span><br><span class="line">      stack.push(cur.right);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 栈2 弹出打印</span></span><br><span class="line">  <span class="keyword">while</span>(!stack2.isEmpty()) &#123;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">cur</span> <span class="operator">=</span> stack.pop();</span><br><span class="line">    <span class="comment">// 打印</span></span><br><span class="line">    sysout();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>中： 1）先将左边界压入栈 2）直到null，弹出并打印进入右树</p><img src="算法高频题总结/image-20220222171852618.png" alt="image-20220222171852618" style="zoom:50%;" /></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(TreeNode head)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(head != <span class="literal">null</span>) &#123;</span><br><span class="line">    Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();<span class="comment">// ⚠️一开始不用塞head</span></span><br><span class="line">    <span class="keyword">while</span>(!stack.isEmpty() || head != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span>(head != <span class="literal">null</span>) &#123;</span><br><span class="line">        stack.push(head);</span><br><span class="line">        head = head.left;</span><br><span class="line">      &#125; <span class="keyword">else</span>&#123; <span class="comment">// 空了 就弹出打印 进入右边</span></span><br><span class="line">        head = stack.pop();</span><br><span class="line">        sysout(head.val);</span><br><span class="line">        head = head.right;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>二叉搜索树也可以用这个</p><h2 id="2-二叉树的层序遍历-BFS）">2 二叉树的层序遍历(BFS）</h2><p>给你一个二叉树，请你返回其按 层序遍历 得到的节点值。 （即逐层地，从左到右访问所有节点）</p> <img src="算法高频题总结/25617_oW1zq2BOkhrT7ERQ.png" alt="image" style="zoom:50%;" /><h3 id="1-打印每一层">1) 打印每一层</h3><blockquote><p>给你二叉树的根节点root， 返回其节点值的层序遍历，就是逐层打印</p></blockquote><p>1.先定义结果集res 和判空操作</p><p>2.定义<strong>队列容器</strong>，head放入队列中。</p><p>3.定义结果集元素list 即每一层。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">levelOrder</span><span class="params">(TreeNode head)</span> &#123;</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line">List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">if</span> (head == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line">Queue&lt;TreeNode&gt; q = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">q.add(head);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="keyword">while</span> (!q.isEmpty()) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> q.size();</span><br><span class="line">List&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123; <span class="comment">// size !!!</span></span><br><span class="line"><span class="type">TreeNode</span> <span class="variable">cur</span> <span class="operator">=</span> q.poll();</span><br><span class="line">list.add(cur.val);</span><br><span class="line"><span class="keyword">if</span> (cur.left != <span class="literal">null</span>) &#123;</span><br><span class="line">q.add(cur.left);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (cur.right != <span class="literal">null</span>) &#123;</span><br><span class="line">q.add(cur.right);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">res.add(list);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="二叉树的锯齿形遍历">二叉树的锯齿形遍历</h4><blockquote><p>就是在层序遍历基础上 使用flag来判断打印的顺序 ⚠️list.add(0, root.val) 就是添加到开头</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">zigzagLevelOrder</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">     List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;List&lt;Integer&gt;&gt;();</span><br><span class="line">     <span class="keyword">if</span>(root == <span class="literal">null</span>)&#123;</span><br><span class="line">         <span class="keyword">return</span> res;</span><br><span class="line">     &#125;</span><br><span class="line">     Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;TreeNode&gt;();</span><br><span class="line">     queue.add(root);</span><br><span class="line">     <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">     <span class="keyword">while</span>(! queue.isEmpty())&#123;</span><br><span class="line">         List&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Integer&gt;();</span><br><span class="line">         <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> queue.size();</span><br><span class="line">         <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; ++i)&#123;</span><br><span class="line">             root =  queue.poll();</span><br><span class="line">             <span class="keyword">if</span>(flag)&#123;<span class="comment">//通过flag判断打印顺序</span></span><br><span class="line">                 list.add(root.val);</span><br><span class="line">             &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                 list.add(<span class="number">0</span>, root.val);<span class="comment">// ！！！</span></span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">if</span>(root.left != <span class="literal">null</span>)&#123;</span><br><span class="line">                 queue.add(root.left);</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">if</span>(root.right != <span class="literal">null</span>)&#123;</span><br><span class="line">                 queue.add(root.right);</span><br><span class="line">             &#125;</span><br><span class="line"></span><br><span class="line">         &#125;</span><br><span class="line">         flag = !flag;<span class="comment">//这里易错</span></span><br><span class="line">         res.add(list);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> res;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h3 id="2）返回节点最多的那一层">2）返回节点最多的那一层</h3><ol><li>需要curEnd记录是否当前到层的结尾 需要nextEnd记录下一层的最后节点</li><li>将上面层序遍历添加每层元素的过程改为记录层的curSize</li><li>当cur == curEnd 时 更新 ans (maxWidth</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">maxWidth</span><span class="params">(TreeNode head)</span> &#123;</span><br><span class="line">  <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(head == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="type">int</span> <span class="variable">curSize</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3）二叉树的右视图">3）二叉树的右视图</h3><blockquote><p>给定一个二叉树的 <strong>根节点</strong> <code>root</code>，想象自己站在它的右侧，按照从顶部到底部的顺序，返回从右侧所能看到的节点值。</p></blockquote><img src="算法高频题总结/image-20220209205752144.png" alt="image-20220209205752144" style="zoom:50%;" /><p>需要curEnd记录是否当前到层的结尾 需要nextEnd记录下一层的最后节点</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">if</span> (head == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="type">TreeNode</span> <span class="variable">curEnd</span> <span class="operator">=</span> head;</span><br><span class="line"><span class="type">TreeNode</span> <span class="variable">nextEnd</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">Queue&lt;TreeNode&gt; q = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">q.add(head);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (!q.isEmpty()) &#123;</span><br><span class="line"><span class="type">TreeNode</span> <span class="variable">cur</span> <span class="operator">=</span> q.poll();</span><br><span class="line"><span class="comment">// 2 用nextEnd记录最后一个节点</span></span><br><span class="line"><span class="keyword">if</span> (cur.left != <span class="literal">null</span>) &#123;</span><br><span class="line">q.add(cur.left);</span><br><span class="line">nextEnd = cur.left;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (cur.right != <span class="literal">null</span>) &#123;</span><br><span class="line">q.add(cur.right);</span><br><span class="line">nextEnd = cur.right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3 更新当前最后的节点</span></span><br><span class="line"><span class="keyword">if</span> (cur == curEnd) &#123;</span><br><span class="line">res.add(cur.val);</span><br><span class="line">curEnd = nextEnd;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br></pre></td></tr></table></figure><h3 id="4）最大宽度（左右节点的距离）">4）最大宽度（左右节点的距离）</h3><blockquote><p>给定一个二叉树，编写一个函数来获取这个树的最大宽度。树的宽度是所有层中的最大宽度。这个二叉树与满二叉树（full binary tree）结构相同，但一些节点为空。</p><p>每一层的宽度被定义为两个端点（该层最左和最右的非空节点，两端点间的null节点也计入长度）之间的长度。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">避免不了要记录每一个节点的index 所以需要一个新的节点结构</span><br><span class="line"></span><br><span class="line">newnode&#123;</span><br><span class="line"></span><br><span class="line">​treenode node;</span><br><span class="line"></span><br><span class="line">​int level;</span><br><span class="line"></span><br><span class="line">​int pos;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><ol><li><p><strong>在层序遍历基础上 队列添加的是一个新的节点结构来对每个节点的层数和position进行记录</strong> <strong>不需要</strong></p></li><li><p><strong>每次队列进行一次poll循环都要检查 如果curlever != cur.level 说明到了下一层，将curlevel更新，用first抓住第一个的pos</strong></p></li><li><p><strong>更新max</strong></p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">widthOfBinaryTree</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        Queue&lt;NewNode&gt; q = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        q.add(<span class="keyword">new</span> <span class="title class_">NewNode</span>(root, <span class="number">0</span>, <span class="number">0</span>)); <span class="comment">// ⚠️一开始添加的就是newnode</span></span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>; </span><br><span class="line">        <span class="type">int</span> <span class="variable">curlevel</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// 记录当前层</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">firstpos</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// 记录每层最前</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span>(!q.isEmpty())&#123;</span><br><span class="line">            <span class="type">NewNode</span> <span class="variable">cur</span> <span class="operator">=</span> q.poll();</span><br><span class="line">            <span class="keyword">if</span>(cur.node.left != <span class="literal">null</span>)&#123;</span><br><span class="line">                q.add(<span class="keyword">new</span> <span class="title class_">NewNode</span>(cur.node.left, cur.level + <span class="number">1</span>, cur.pos * <span class="number">2</span>)); <span class="comment">// ⚠️结构不能搞错 参数不要穿错</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(cur.node.right != <span class="literal">null</span>)&#123;</span><br><span class="line">                q.add(<span class="keyword">new</span> <span class="title class_">NewNode</span>(cur.node.right, cur.level + <span class="number">1</span> , cur.pos * <span class="number">2</span> + <span class="number">1</span>)); <span class="comment">// ⚠️</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(curlevel != cur.level)&#123;</span><br><span class="line">                curlevel = cur.level;</span><br><span class="line">                firstpos = cur.pos;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ans = Math.max(ans, cur.pos - firstpos + <span class="number">1</span>);            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NewNode</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> TreeNode node;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> level;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> pos;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">NewNode</span><span class="params">(TreeNode node, <span class="type">int</span> level, <span class="type">int</span> pos)</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.node = node;</span><br><span class="line">            <span class="built_in">this</span>.level = level;</span><br><span class="line">            <span class="built_in">this</span>.pos = pos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="3-二叉树的最近公共祖先">3 二叉树的最近公共祖先</h2><blockquote><p>给定一个二叉树, 找到该树中两个指定节点的最近公共祖先。</p><p>百度百科中最近公共祖先的定义为：“对于有根树 T 的两个节点 p、q，最近公共祖先表示为一个节点 x，满足 x 是 p、q 的祖先且 x 的深度尽可能大（一个节点也可以是它自己的祖先）。”</p></blockquote><p><code>Info&#123;boolean findP, boolean findQ, treenode ans&#125;</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> TreeNode <span class="title function_">lowestCommonAncestor</span><span class="params">(TreeNode root, TreeNode p, TreeNode q)</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> process(root,p,q).ans;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Info</span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> findP;<span class="comment">// 是否包含p</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> findQ;<span class="comment">// 是否包含q</span></span><br><span class="line"><span class="keyword">public</span> TreeNode ans;<span class="comment">// 保存结果</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Info</span><span class="params">(<span class="type">boolean</span> findP, <span class="type">boolean</span> findQ, TreeNode ans)</span>&#123;</span><br><span class="line"><span class="built_in">this</span>.findP = findP;</span><br><span class="line"><span class="built_in">this</span>.findQ = findQ;</span><br><span class="line"><span class="built_in">this</span>.ans = ans;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> Info <span class="title function_">process</span><span class="params">(TreeNode root, TreeNode p, TreeNode q)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(root == <span class="literal">null</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>(<span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Info</span> <span class="variable">leftInfo</span> <span class="operator">=</span> process(root.left, p, q);</span><br><span class="line"><span class="type">Info</span> <span class="variable">rightInfo</span> <span class="operator">=</span> process(root.right, p, q);</span><br><span class="line"></span><br><span class="line">   <span class="comment">// 填充当前info</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">findP</span> <span class="operator">=</span> leftInfo.findP || rightInfo.findP || (root == p);</span><br><span class="line"><span class="type">boolean</span> <span class="variable">findQ</span> <span class="operator">=</span> leftInfo.findQ || rightInfo.findQ || (root == q);</span><br><span class="line"></span><br><span class="line"><span class="type">TreeNode</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(leftInfo.ans != <span class="literal">null</span>)&#123;<span class="comment">// leftInfo.findP &amp;&amp; leftInfo.findQ</span></span><br><span class="line">ans = leftInfo.ans;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(rightInfo.ans != <span class="literal">null</span>)&#123; <span class="comment">// rightInfo.findP &amp;&amp; rightInfo.findQ</span></span><br><span class="line">ans = rightInfo.ans;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(findP &amp;&amp; findQ)&#123;</span><br><span class="line">ans = root;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>(findP, findQ, ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-二叉树最大路径和">4 二叉树最大路径和</h2><img src="算法高频题总结/image-20220211103231018.png" alt="image-20220211103231018" style="zoom: 67%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxPathSum</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">       <span class="keyword">if</span>(root == <span class="literal">null</span>)&#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> process(root).maxSum;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Info</span>&#123; <span class="comment">// z</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> maxGain;<span class="comment">//如果连上父节点的贡献值</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> maxSum ;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Info</span><span class="params">(<span class="type">int</span> m1, <span class="type">int</span> m2)</span>&#123;</span><br><span class="line">maxGain = m1;</span><br><span class="line">maxSum = m2;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Info <span class="title function_">process</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(head == <span class="literal">null</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>(<span class="number">0</span>, Integer.MIN_VALUE); <span class="comment">// ⚠️ maxsum返回minvalue</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">Info</span> <span class="variable">leftInfo</span> <span class="operator">=</span> process(head.left);</span><br><span class="line"><span class="type">Info</span> <span class="variable">rightInfo</span> <span class="operator">=</span> process(head.right);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">leftGain</span> <span class="operator">=</span> Math.max(leftInfo.maxGain, <span class="number">0</span>); <span class="comment">// ⚠️ &gt;0</span></span><br><span class="line"><span class="type">int</span> <span class="variable">rightGain</span> <span class="operator">=</span> Math.max(rightInfo.maxGain, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">maxGain</span> <span class="operator">=</span> Math.max(leftGain,rightGain) + head.val;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">maxSum</span> <span class="operator">=</span> Math.max(</span><br><span class="line">Math.max(leftInfo.maxSum,rightInfo.maxSum),</span><br><span class="line">leftGain + rightGain + head.val);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>(maxGain, maxSum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-对称二叉树">5 对称二叉树</h2><blockquote><p>给你一个二叉树的根节点 <code>root</code> ， 检查它是否轴对称。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSymmetric</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> isMirror(root, root); <span class="comment">// 复制一个自己的树</span></span><br><span class="line">      &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isMirror</span><span class="params">(TreeNode h1, TreeNode h2)</span> &#123;</span><br><span class="line">      <span class="keyword">if</span>(h1 == <span class="literal">null</span> &amp;&amp; h2 == <span class="literal">null</span>)&#123; <span class="comment">//两个树都是空</span></span><br><span class="line">          <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(h1 != <span class="literal">null</span> &amp;&amp; h2 != <span class="literal">null</span>)&#123;<span class="comment">// 两个树都不是空 就返回：1.当前节点值要相等 2.左边和右边也是mirror</span></span><br><span class="line">          <span class="keyword">return</span> (h1.val == h2.val) &amp;&amp; isMirror(h1.left, h2.right) &amp;&amp; isMirror(h1.right, h2.left); <span class="comment">// </span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">//一个是空一个不是空</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="6-从前序和中序序列构造二叉树">6 从前序和中序序列构造二叉树</h2><blockquote><p>给定两个整数数组 preorder 和 inorder ，其中 preorder 是二叉树的先序遍历， inorder 是同一棵树的中序遍历，请构造二叉树并返回其根节点。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 利用二叉树前序 头左右 找到头 再利用中序左右头进行左右树分离</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="keyword">public</span> TreeNode <span class="title function_">buildTree</span><span class="params">(<span class="type">int</span>[] pre, <span class="type">int</span>[] in)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(pre == <span class="literal">null</span> || in == <span class="literal">null</span> || pre.length != in.length)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> f(pre, <span class="number">0</span>, pre.length- <span class="number">1</span>, in, <span class="number">0</span>, in.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TreeNode <span class="title function_">f</span><span class="params">(<span class="type">int</span>[] pre, <span class="type">int</span> L1, <span class="type">int</span> R1, <span class="type">int</span>[] in, <span class="type">int</span> L2, <span class="type">int</span> R2)</span>&#123;</span><br><span class="line">        <span class="comment">// 越界情况</span></span><br><span class="line">        <span class="keyword">if</span>(L1 &gt; R1)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      <span class="comment">// 利用前序找到头</span></span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">head</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(pre[L1]);</span><br><span class="line">        <span class="keyword">if</span>(L1 == R1)&#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//中序对应找到头的下标find</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">find</span> <span class="operator">=</span> L2;</span><br><span class="line">        <span class="keyword">while</span>(in[find] != pre[L1])&#123;</span><br><span class="line">            find++;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">// （find - L2)就是左树的长度</span></span><br><span class="line">        head.left = f(pre, L1 + <span class="number">1</span>, L1 + (find - L2), in, L2, find - <span class="number">1</span>);</span><br><span class="line">        head.right = f(pre,  L1 + (find - L2) + <span class="number">1</span>, R1, in, find + <span class="number">1</span>, R2);</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="7-验证二叉搜索树">7 验证二叉搜索树</h2><blockquote><p>给你一个二叉树的根节点 root ，判断其是否是一个有效的二叉搜索树。</p><p>有效 二叉搜索树定义如下：</p><p>节点的左子树只包含 小于 当前节点的数。<br>节点的右子树只包含 大于 当前节点的数。<br>所有左子树和右子树自身必须也是二叉搜索树。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 用中序遍历</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isValidBST</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(head != <span class="literal">null</span>)&#123;</span><br><span class="line">Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;TreeNode&gt;();</span><br><span class="line"><span class="type">double</span> <span class="variable">last</span> <span class="operator">=</span> -Double.MAX_VALUE;<span class="comment">// ⚠️</span></span><br><span class="line"><span class="keyword">while</span>(!stack.isEmpty() || head != <span class="literal">null</span>)&#123;</span><br><span class="line"><span class="comment">// 1 </span></span><br><span class="line"><span class="keyword">if</span>(head != <span class="literal">null</span>)&#123;</span><br><span class="line">stack.push(head);</span><br><span class="line">head = head.left;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;<span class="comment">// 2</span></span><br><span class="line">head = stack.pop();</span><br><span class="line"><span class="keyword">if</span>(head.val &lt;= last)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">last = head.val;</span><br><span class="line">head = head.right;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-平衡二叉树">8 平衡二叉树</h2><p><strong>使用递归套路</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INFO &#123;</span><br><span class="line">高度；</span><br><span class="line">是否是平衡二叉树；</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isBalanced</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> process(root).isBt;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//需要的信息</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Info</span>&#123;</span><br><span class="line">      <span class="keyword">private</span> <span class="type">int</span> height;</span><br><span class="line">      <span class="keyword">private</span> <span class="type">boolean</span> isBt;</span><br><span class="line">      <span class="keyword">public</span> <span class="title function_">Info</span><span class="params">(<span class="type">int</span> h, <span class="type">boolean</span> ib)</span>&#123;</span><br><span class="line">          height = h;</span><br><span class="line">          isBt = ib;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//找信息的过程</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> Info <span class="title function_">process</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(head == <span class="literal">null</span>)&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>(<span class="number">0</span>, <span class="literal">true</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="type">Info</span> <span class="variable">leftInfo</span> <span class="operator">=</span> process(head.left);</span><br><span class="line">      <span class="type">Info</span> <span class="variable">rightInfo</span> <span class="operator">=</span> process(head.right);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="comment">//解决当前的Info的方法（也就是所有递归都会用到的方法）</span></span><br><span class="line">      <span class="type">int</span> <span class="variable">height</span> <span class="operator">=</span> Math.max(leftInfo.height, rightInfo.height) + <span class="number">1</span>; <span class="comment">// ⚠️ </span></span><br><span class="line">      <span class="type">boolean</span> <span class="variable">isBalanced</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">if</span>(leftInfo.isBt &amp;&amp; rightInfo.isBt &amp;&amp; Math.abs(leftInfo.height - rightInfo.height) &lt;= <span class="number">1</span>)&#123;</span><br><span class="line">          isBalanced = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>(height, isBalanced);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="9-二叉树的序列化和反序列化">9 二叉树的序列化和反序列化</h2><blockquote><p>思路</p><p>序列化： 准备一个string的队列 然后按照先序顺序将结点转为String类型然后加入队列，左边和右边结点按照顺序递归执行该方法</p><p>反序列化： 将要转化为二叉树的队列传入，然后弹出结点为head（注意转换回为Int类型），head左边递归执行preb（prelist），右边递归执行preb（prelist）</p><p>错误</p><p>判断null值注意判断哈 特别是递归里面 就算是方法前面判断了 当时不代表递归以后不会再次出现，所以方法内还要再判断一次</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 二叉树的前中后序列化</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BT_09_preSerial</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 序列化 使用队列</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Queue&lt;String&gt; <span class="title function_">preSerial</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line">Queue&lt;String&gt; ans = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">pre(head, ans);</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">pre</span><span class="params">(TreeNode head, Queue&lt;String&gt; ans)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(head == <span class="literal">null</span>)&#123;</span><br><span class="line">ans.add(<span class="literal">null</span>);<span class="comment">// 用来规定用什么来占位</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">ans.add(String.valueOf(head.val));</span><br><span class="line">pre(head.left, ans);</span><br><span class="line">pre(head.right, ans);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 反序列化</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> TreeNode <span class="title function_">buildByPreQueue</span><span class="params">(Queue&lt;String&gt; prelist)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(prelist == <span class="literal">null</span> || prelist.size() == <span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> preb(prelist);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> TreeNode <span class="title function_">preb</span><span class="params">(Queue&lt;String&gt; prelist)</span> &#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> prelist.poll();</span><br><span class="line"><span class="keyword">if</span>(value == <span class="literal">null</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">TreeNode</span> <span class="variable">head</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(Integer.valueOf(value));</span><br><span class="line">head.left = preb(prelist);</span><br><span class="line">head.right = preb(prelist);</span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="10-二叉树的最大深度">10 二叉树的最大深度</h2><blockquote><p>给定一个二叉树，找出其最大深度。</p><p>二叉树的深度为根节点到最远叶子节点的最长路径上的节点数。</p><p>说明: 叶子节点是指没有子节点的节点。</p><p>示例：<br>给定二叉树 [3,9,20,null,null,15,7]，</p><p>3</p><p>/ <br>9  20<br>/  <br>15   7</p><p>返回它的最大深度 3 。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxDepth</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> findDepth(root).height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Info</span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> height;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Info</span><span class="params">(<span class="type">int</span> h)</span>&#123;</span><br><span class="line">            height = h;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Info <span class="title function_">findDepth</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Info</span> <span class="variable">leftInfo</span> <span class="operator">=</span> findDepth(head.left);</span><br><span class="line">        <span class="type">Info</span> <span class="variable">rightInfo</span> <span class="operator">=</span> findDepth(head.right);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">height</span> <span class="operator">=</span> Math.max(leftInfo.height, rightInfo.height) + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>(height);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="11-最大直径">11 最大直径</h2><blockquote><p>给定一棵二叉树，你需要计算它的直径长度。一棵二叉树的直径长度是任意两个结点路径长度中的最大值。这条路径可能穿过也可能不穿过根结点。</p><p>示例 :<br>给定二叉树</p><pre><code>   1  / \ 2   3/ \     </code></pre><p>4   5</p><p>返回 3, 它的长度是路径 [4,2,1,3] 或者 [5,2,1,3]。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 二叉树最大直径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BT_05_ZhiJing</span> &#123;</span><br><span class="line"><span class="keyword">static</span> <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">max</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> process(head) - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">process</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(head == <span class="literal">null</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">lM</span> <span class="operator">=</span> process(head.left);</span><br><span class="line"><span class="type">int</span> <span class="variable">rM</span> <span class="operator">=</span> process(head.right);</span><br><span class="line">ans = Math.max(lM + rM + <span class="number">1</span>, ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> Math.max(lM, rM) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 递归套路</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> root</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">max2</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(root == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> process2(root).max;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Info</span>&#123;</span><br><span class="line"><span class="keyword">public</span> Integer height;</span><br><span class="line"><span class="keyword">public</span> Integer max;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Info</span><span class="params">(Integer h, Integer m)</span>&#123;</span><br><span class="line">height = h;</span><br><span class="line">max = m;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> Info <span class="title function_">process2</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(root == <span class="literal">null</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Info</span> <span class="variable">leftInfo</span> <span class="operator">=</span> process2(root.left);</span><br><span class="line"><span class="type">Info</span> <span class="variable">rightInfo</span> <span class="operator">=</span> process2(root.right);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">height</span> <span class="operator">=</span> Math.max(leftInfo.height, rightInfo.height) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> Math.max(Math.max(leftInfo.max, rightInfo.max),</span><br><span class="line">leftInfo.height + rightInfo.height);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Info</span>(height, max);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="12-路径总和">12 路径总和</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 路径总和 Ⅰ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 要求返回是否存在总和为target的从根到节点的路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> isSum;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasPathSum</span><span class="params">(TreeNode root, <span class="type">int</span> targetSum)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">isSum = <span class="literal">false</span>;</span><br><span class="line">process(root, <span class="number">0</span>, targetSum);</span><br><span class="line"><span class="keyword">return</span> isSum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(TreeNode head, <span class="type">int</span> preSum, <span class="type">int</span> sum)</span> &#123;</span><br><span class="line"><span class="comment">// 是叶子节点</span></span><br><span class="line"><span class="keyword">if</span> (head.left == <span class="literal">null</span> &amp;&amp; head.right == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (preSum + head.val == sum) &#123;</span><br><span class="line">isSum = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不是叶子节点</span></span><br><span class="line">preSum += head.val;</span><br><span class="line"><span class="keyword">if</span> (head.left != <span class="literal">null</span>) &#123;</span><br><span class="line">process(head.left, preSum, sum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (head.right != <span class="literal">null</span>) &#123;</span><br><span class="line">process(head.right, preSum, sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 路径总和Ⅱ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 要求返回所有满足target的路径</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// 1 </span></span><br><span class="line"><span class="comment">// 2 注意现场要恢复，因为只有一个path来存路 如果没有清空，后面根本装不下</span></span><br><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">pathSum</span><span class="params">(TreeNode root, <span class="type">int</span> targetSum)</span> &#123;</span><br><span class="line">List&lt;List&lt;Integer&gt;&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">List&lt;Integer&gt; path = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">process(root, path, <span class="number">0</span>, targetSum, ans);</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(TreeNode head, List&lt;Integer&gt; path, <span class="type">int</span> preSum, <span class="type">int</span> sum,</span></span><br><span class="line"><span class="params">List&lt;List&lt;Integer&gt;&gt; ans)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 叶子节点</span></span><br><span class="line"><span class="keyword">if</span> (head.left == <span class="literal">null</span> &amp;&amp; head.right == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (head.val + preSum == sum) &#123;</span><br><span class="line">path.add(head.val);</span><br><span class="line">ans.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(path));<span class="comment">// 传递是引用不能直接传path</span></span><br><span class="line">path.remove(path.size() - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">preSum += head.val;</span><br><span class="line">path.add(head.val);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不是叶子节点</span></span><br><span class="line"><span class="keyword">if</span> (head.left != <span class="literal">null</span>) &#123;</span><br><span class="line">process(head.left, path, preSum, sum, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (head.right != <span class="literal">null</span>) &#123;</span><br><span class="line">process(head.right, path, preSum, sum, ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 恢复现场</span></span><br><span class="line">path.remove(path.size() - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="13-翻转二叉树">13 翻转二叉树</h2><blockquote><p>给你一棵二叉树的根节点 <code>root</code> ，翻转这棵二叉树，并返回其根节点。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">翻转二叉树</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 有点像数组swap</span></span><br><span class="line">    <span class="keyword">public</span> TreeNode <span class="title function_">invertTree</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(root == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">left</span> <span class="operator">=</span> root.left;</span><br><span class="line">        root.left = invertTree(root.right);</span><br><span class="line">        root.right = invertTree(left);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h1>6 栈</h1><h2 id="1-有效括号">1 有效括号</h2><blockquote><p>给定一个只包括 <code>'('</code>，<code>')'</code>，<code>'&#123;'</code>，<code>'&#125;'</code>，<code>'['</code>，<code>']'</code> 的字符串 <code>s</code> ，判断字符串是否有效。</p></blockquote><ol><li>遍历所有左边的括号变成对应的右括号压入栈</li><li>遇到的右边的括号<ol><li>如果stack是空的，则false</li><li>弹出栈顶比较不相等 false</li></ol></li><li>最后stack 必须是空的才能满足</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isValid</span><span class="params">(String s)</span> &#123;</span><br><span class="line"> <span class="type">char</span>[] str = s.toCharArray();</span><br><span class="line">        Stack&lt;Character&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(str[i] == <span class="string">&#x27;(&#x27;</span> || str[i] == <span class="string">&#x27;[&#x27;</span> || str[i] == <span class="string">&#x27;&#123;&#x27;</span>) &#123;</span><br><span class="line">                stack.push(str[i]);</span><br><span class="line">            &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(stack.isEmpty()) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125; </span><br><span class="line">                <span class="type">char</span> <span class="variable">cur</span> <span class="operator">=</span> stack.pop();</span><br><span class="line">                <span class="keyword">if</span>((str[i] == <span class="string">&#x27;)&#x27;</span> &amp;&amp; cur != <span class="string">&#x27;(&#x27;</span>) || (str[i] </span><br><span class="line">                == <span class="string">&#x27;&#125;&#x27;</span> &amp;&amp; cur != <span class="string">&#x27;&#123;&#x27;</span>) || (str[i] == <span class="string">&#x27;]&#x27;</span> &amp;&amp; cur != <span class="string">&#x27;[&#x27;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> stack.isEmpty();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-用栈实现队列">2 用栈实现队列</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyQueue</span> &#123;</span><br><span class="line"><span class="keyword">private</span> Stack&lt;Integer&gt; sPop;</span><br><span class="line">    <span class="keyword">private</span> Stack&lt;Integer&gt; sPush;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        sPop = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;Integer&gt;();</span><br><span class="line">        sPush = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;Integer&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        sPush.push(x);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(sPop.isEmpty())&#123;</span><br><span class="line">            <span class="keyword">while</span>(!sPush.isEmpty())&#123;</span><br><span class="line">                sPop.push(sPush.pop());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sPop.pop();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(sPop.isEmpty())&#123;</span><br><span class="line">            <span class="keyword">while</span>(!sPush.isEmpty())&#123;</span><br><span class="line">                sPop.push(sPush.pop());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sPop.peek();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">empty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(sPop.isEmpty() &amp;&amp; sPush.isEmpty())&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-最小栈">3 最小栈</h2><blockquote><p>设计一个支持 <code>push</code> ，<code>pop</code> ，<code>top</code> 操作，并能在常数时间内检索到最小元素的栈。</p><ul><li><code>push(x)</code> —— 将元素 x 推入栈中。</li><li><code>pop()</code> —— 删除栈顶的元素。</li><li><code>top()</code> —— 获取栈顶元素。</li><li><code>getMin()</code> —— 检索栈中的最小元素。</li></ul></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MinStack</span> &#123;</span><br><span class="line"><span class="keyword">public</span> Stack&lt;Integer&gt; data;</span><br><span class="line"><span class="keyword">public</span> Stack&lt;Integer&gt; min;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">MinStack</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.data = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;Integer&gt;();</span><br><span class="line"><span class="built_in">this</span>.min = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;Integer&gt;();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">this</span>.min.isEmpty())&#123;</span><br><span class="line">    <span class="built_in">this</span>.min.push(val);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(val &lt; <span class="built_in">this</span>.getMin())&#123;</span><br><span class="line">    <span class="built_in">this</span>.min.push(val);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.min.push(<span class="built_in">this</span>.getMin());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">this</span>.data.push(val);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.data.pop();</span><br><span class="line">    <span class="built_in">this</span>.min.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">top</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.data.peek();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getMin</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.min.peek();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="4-两个队列实现栈">4 两个队列实现栈</h2><p>在push操作里进行改进就可以：<br>通过</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyStack</span> &#123;</span><br><span class="line">           <span class="keyword">public</span> Queue&lt;Integer&gt; q1;</span><br><span class="line">        <span class="keyword">public</span> Queue&lt;Integer&gt; q2;</span><br><span class="line">        <span class="comment">/** Initialize your data structure here. */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">MyStack</span><span class="params">()</span>&#123;</span><br><span class="line">            q1 = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;Integer&gt;();</span><br><span class="line">            q2 = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;Integer&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">/** Push element x onto stack. */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">            q2.offer(x);</span><br><span class="line">            <span class="keyword">while</span>(!q1.isEmpty())&#123;</span><br><span class="line">                q2.offer(q1.poll());</span><br><span class="line">            &#125;</span><br><span class="line">            Queue&lt;Integer&gt; tmp = q1;</span><br><span class="line">            q1 = q2;</span><br><span class="line">            q2 = tmp;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/** Removes the element on top of the stack and returns that element. */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> q1.poll();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/** Get the top element. */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">top</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> q1.peek();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/** Returns whether the stack is empty. */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">empty</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> q1.isEmpty();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>用一个队列也可以</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">       <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> queue.size();</span><br><span class="line">       queue.offer(x);</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">           queue.offer(queue.poll());</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="5-单调栈">5 单调栈</h2><p>为了解决给定的一个可能含有重复值的arr，i位置一定有以下信息</p><p>1）arr[i] 左边有离它最近比它小的（大）的数</p><p>2）arr[i] 右边有离它最近比它小的（大）的数</p><h3 id="找到左边和右边离i最近比其小的下表对-res-n-2">找到左边和右边离i最近比其小的下表对 <code>res[n][2]</code></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Code1_MonotonousStack</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[][] getNearLessNoRepeat(<span class="type">int</span>[] arr)&#123;</span><br><span class="line"><span class="type">int</span>[][] res = <span class="keyword">new</span> <span class="title class_">int</span>[arr.length][<span class="number">2</span>];</span><br><span class="line">Stack&lt;Integer&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++)&#123;</span><br><span class="line"><span class="comment">//新的数压栈 如果比栈底小 栈底弹出 并记录</span></span><br><span class="line"><span class="keyword">while</span>(!stack.isEmpty() &amp;&amp; arr[stack.peek()] &gt; arr[i])&#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">popIndex</span> <span class="operator">=</span> stack.pop();</span><br><span class="line"><span class="type">int</span> <span class="variable">leftLessIndex</span> <span class="operator">=</span> stack.isEmpty() ? -<span class="number">1</span> : stack.peek();</span><br><span class="line">res[popIndex][<span class="number">0</span>] = leftLessIndex;</span><br><span class="line">res[popIndex][<span class="number">1</span>] = i;</span><br><span class="line">&#125;</span><br><span class="line">stack.push(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(!stack.isEmpty())&#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">popIndex</span> <span class="operator">=</span> stack.pop();</span><br><span class="line"><span class="type">int</span> <span class="variable">leftLessIndex</span> <span class="operator">=</span> stack.isEmpty() ? -<span class="number">1</span> : stack.peek();</span><br><span class="line">res[popIndex][<span class="number">0</span>] = leftLessIndex;</span><br><span class="line">res[popIndex][<span class="number">1</span>] = -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//数组中有重复的情况</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[][] getNearLess(<span class="type">int</span>[] arr)&#123;</span><br><span class="line"><span class="type">int</span>[][] res = <span class="keyword">new</span> <span class="title class_">int</span>[arr.length][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// List&lt;Integer&gt; -&gt; 放的是位置，同样值的东西，位置压在一起</span></span><br><span class="line"><span class="comment">// 代表值    底  -&gt;  顶   小  -&gt; 大</span></span><br><span class="line">Stack&lt;List&lt;Integer&gt;&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++)&#123;</span><br><span class="line"><span class="comment">//新的数压栈 如果比栈底小 栈底弹出 并记录</span></span><br><span class="line"><span class="keyword">while</span>(!stack.isEmpty() &amp;&amp; arr[stack.peek().get(<span class="number">0</span>)] &gt; arr[i])&#123;</span><br><span class="line">List&lt;Integer&gt; popIndex = stack.pop();</span><br><span class="line"><span class="type">int</span> <span class="variable">leftLessIndex</span> <span class="operator">=</span> stack.isEmpty() ? -<span class="number">1</span> : stack.peek().get(stack.peek().size() - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(Integer popi : popIndex)&#123;</span><br><span class="line">res[popi][<span class="number">0</span>] = leftLessIndex;</span><br><span class="line">res[popi][<span class="number">1</span>] = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//相等的比你小的 都要把存入栈的格式改为存储了位置的list数组</span></span><br><span class="line"><span class="keyword">if</span>(!stack.isEmpty() &amp;&amp; arr[stack.peek().get(<span class="number">0</span>)] == arr[i])&#123;</span><br><span class="line">stack.peek().add(Integer.valueOf(i));</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">List&lt;Integer&gt; pushIndex = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">pushIndex.add(Integer.valueOf(i));</span><br><span class="line">stack.push(pushIndex);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(!stack.isEmpty())&#123;</span><br><span class="line">List&lt;Integer&gt; popIndex = stack.pop();</span><br><span class="line"><span class="comment">//取决于最晚加入的那个</span></span><br><span class="line"><span class="type">int</span> <span class="variable">leftLessIndex</span> <span class="operator">=</span> stack.isEmpty() ? -<span class="number">1</span> : stack.peek().get(stack.peek().size() - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(Integer popi : popIndex)&#123;</span><br><span class="line">res[popi][<span class="number">0</span>] = leftLessIndex;</span><br><span class="line">res[popi][<span class="number">1</span>] = -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="正数数组arr中（sub的累加和-min）的最大值">正数数组arr中（sub的累加和*min）的最大值</h3><blockquote><p>给定一个只包含正数的数组arr，arr中任何一个子数组sub，一定都可以算出(sub累加和 )* (sub中的最小值)是什么，<br>那么所有子数组中，这个值最大是多少？</p></blockquote><p>直接找每个数两边最近比它小中间部分累加和（这部分该数一定最小）</p><p>1 建立前缀和数组<code>sums[i]</code>(这样求累加和就可以[0~R] -[0~L-1])</p><p>2 和上面单调栈思路差不多</p><p>​1）栈顶弹出<code>[j]</code>后更新max</p><p>​2）再遍历栈里的元素 右边没有比它最小所以累加直接用<code>sums[N-1]</code>来减</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h1>7 递归</h1><h2 id="1-全排列">1 全排列</h2><blockquote><p>给定一个不含重复数字的数组 <code>nums</code> ，返回其 <em>所有可能的全排列</em> 。你可以 <strong>按任意顺序</strong> 返回答案</p></blockquote><img src="算法高频题总结/image-20220210103904616.png" alt="image-20220210103904616" style="zoom:50%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">permute</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        List&lt;List&lt;Integer&gt;&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        List&lt;Integer&gt; path = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Integer&gt;();<span class="comment">//选择的路</span></span><br><span class="line">        <span class="keyword">if</span>(nums.length == <span class="number">0</span> || nums == <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">            path.add(num);</span><br><span class="line">        &#125;</span><br><span class="line">        process(path, <span class="number">0</span>, ans);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  DFS</span></span><br><span class="line"><span class="comment">// 1 for是在树形结构里平行进行  - - -&gt;</span></span><br><span class="line"><span class="comment">// 2 先交换成为一种情况</span></span><br><span class="line"><span class="comment">// 3 往下|递归将剩余部分的情况搞定</span></span><br><span class="line"><span class="comment">//      |</span></span><br><span class="line"><span class="comment">//      v</span></span><br><span class="line"><span class="comment">// 4 恢复原来状态 因为平行的分支需要同样的状态</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(List&lt;Integer&gt; path, <span class="type">int</span> i, List&lt;List&lt;Integer&gt;&gt; ans)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(i == path.size())&#123;</span><br><span class="line">ans.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Integer&gt;(path));</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">boolean</span>[] vis = <span class="keyword">new</span> <span class="title class_">boolean</span>[<span class="number">256</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i; j &lt; path.size(); j++)&#123;</span><br><span class="line"><span class="keyword">if</span>(!vis[path.get(j) + <span class="number">128</span>])&#123; <span class="comment">// 剪枝</span></span><br><span class="line">vis[path.get(j) + <span class="number">128</span>] = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line">Collections.swap(path, i, j);</span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line">process(path, i + <span class="number">1</span>, ans);</span><br><span class="line"><span class="comment">// 4</span></span><br><span class="line">Collections.swap(path, i, j);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="全排列2⃣️-不重复">全排列2⃣️ 不重复</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 全排列</span></span><br><span class="line"><span class="comment"> * 将给定数组进行排列组合 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Recursion</span>回溯_Permutation &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">permute</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        List&lt;List&lt;Integer&gt;&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        List&lt;Integer&gt; path = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();<span class="comment">// 不同打印结果存储</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> num : nums)&#123;</span><br><span class="line">            path.add(num);</span><br><span class="line">        &#125;</span><br><span class="line">        process(path, <span class="number">0</span>, ans);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  DFS</span></span><br><span class="line">    <span class="comment">// 1 for是在树形结构里平行进行  - - -&gt;</span></span><br><span class="line">    <span class="comment">// 2 先交换成为一种情况</span></span><br><span class="line">    <span class="comment">// 3 往下|递归将剩余部分的情况搞定</span></span><br><span class="line">    <span class="comment">//      |</span></span><br><span class="line">    <span class="comment">//      v</span></span><br><span class="line">    <span class="comment">// 4 恢复原来状态 因为平行的分支需要同样的状态</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(List&lt;Integer&gt; path, <span class="type">int</span> i, List&lt;List&lt;Integer&gt;&gt; ans)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(i == path.size())&#123;</span><br><span class="line">            ans.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Integer&gt;(path));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span>[] vis = <span class="keyword">new</span> <span class="title class_">boolean</span>[<span class="number">256</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i; j &lt; path.size(); j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!vis[path.get(j)]+<span class="number">128</span>)&#123; <span class="comment">// 剪枝 数组有负数要加上128</span></span><br><span class="line">                vis[path.get(j)+<span class="number">128</span>] = <span class="literal">true</span>;</span><br><span class="line">                <span class="comment">// 2</span></span><br><span class="line">                Collections.swap(path, i, j);</span><br><span class="line">                <span class="comment">// 3</span></span><br><span class="line">                process(path, i + <span class="number">1</span>, ans);</span><br><span class="line">                <span class="comment">// 4</span></span><br><span class="line">                Collections.swap(path, i, j);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="2-括号生成">2 括号生成</h2><blockquote><p>数字 <code>n</code> 代表生成括号的对数，请你设计一个函数，用于能够生成所有可能的并且 <strong>有效的</strong> 括号组合。</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">利用一个原理是 当前面已经做了选择的左括号比右括号多的时候</span><br><span class="line">就添加右括号 </span><br><span class="line">需要剪枝 在往path里面添加括号的时候</span><br><span class="line">进行条件剪枝</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;String&gt; <span class="title function_">generateParenthesis</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">char</span>[] path = <span class="keyword">new</span> <span class="title class_">char</span>[n &lt;&lt; <span class="number">1</span>];</span><br><span class="line">        List&lt;String&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        process(path,<span class="number">0</span>, n, <span class="number">0</span>, ans); <span class="comment">// ⚠️传进去的参数！</span></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// 剪枝 左边括号还有 和左边-右边》0</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(<span class="type">char</span>[] path, <span class="type">int</span> i,<span class="type">int</span> leftRest, <span class="type">int</span> leftMinusRight, List&lt;String&gt; ans )</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(i == path.length)&#123; <span class="comment">// 到结尾</span></span><br><span class="line">            ans.add(String.valueOf(path)); <span class="comment">// 一种可能</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(leftRest &gt; <span class="number">0</span>)&#123; <span class="comment">// 左边的括号还有 将当前的位置设为左， 剩下的去递归</span></span><br><span class="line">                path[i] = <span class="string">&#x27;(&#x27;</span>;</span><br><span class="line">                process(path, i + <span class="number">1</span>, leftRest - <span class="number">1</span>, leftMinusRight + <span class="number">1</span>, ans);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(leftMinusRight &gt; <span class="number">0</span>)&#123;<span class="comment">// 左边的括号大于右边的括号</span></span><br><span class="line">                path[i] = <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">                process(path, i + <span class="number">1</span>, leftRest, leftMinusRight - <span class="number">1</span>, ans);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="3-复原ip地址">3 复原ip地址</h2><blockquote><p>有效 IP 地址 正好由四个整数（每个整数位于 0 到 255 之间组成，且不能含有前导 0），整数之间用 ‘.’ 分隔。</p><p>例如：“0.1.2.201” 和 “192.168.1.1” 是 有效 IP 地址，但是 “0.011.255.245”、“192.168.1.312” 和 “192.168@1.1” 是 无效 IP 地址。</p><p>给定一个只包含数字的字符串 s ，用以表示一个 IP 地址，返回所有可能的有效 IP 地址，这些地址可以通过在 s 中插入 ‘.’ 来形成。你 不能 重新排序或删除 s 中的任何数字。你可以按 任何 顺序返回答案。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">COUNT</span> <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line"><span class="type">int</span>[] segment; <span class="comment">// segment[i]存储第i段</span></span><br><span class="line">List&lt;String&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> List&lt;String&gt; <span class="title function_">restoreIpAddresses</span><span class="params">(String s)</span> &#123;</span><br><span class="line">segment = <span class="keyword">new</span> <span class="title class_">int</span>[COUNT];</span><br><span class="line">dfs(s, <span class="number">0</span>, <span class="number">0</span>);<span class="comment">// s 字符串 id 段数 segstart</span></span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dfs</span><span class="params">(String s, <span class="type">int</span> id, <span class="type">int</span> segStart)</span> &#123;</span><br><span class="line"><span class="comment">// 1 已经递归到第四段</span></span><br><span class="line"><span class="keyword">if</span> (id == COUNT) &#123;</span><br><span class="line"><span class="keyword">if</span> (segStart == s.length()) &#123;<span class="comment">// 并且 所有数字都完成</span></span><br><span class="line"><span class="type">StringBuffer</span> <span class="variable">str</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; COUNT; i++) &#123;</span><br><span class="line">str.append(segment[i]);</span><br><span class="line"><span class="keyword">if</span> (i != COUNT - <span class="number">1</span>) &#123;</span><br><span class="line">str.append(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">ans.add(str.toString());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span>; <span class="comment">// 记得向上返回！！！</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2 四段没玩但是已经到结尾</span></span><br><span class="line"><span class="keyword">if</span> (segStart == s.length()) &#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3 有0的情况</span></span><br><span class="line"><span class="keyword">if</span> (s.charAt(segStart) == <span class="string">&#x27;0&#x27;</span>) &#123; <span class="comment">// 有零</span></span><br><span class="line">segment[id] = <span class="number">0</span>;</span><br><span class="line">dfs(s, id + <span class="number">1</span>, segStart + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4 一般情况</span></span><br><span class="line"><span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">segEnd</span> <span class="operator">=</span> segStart; segEnd &lt; s.length(); segEnd++) &#123;</span><br><span class="line">ans = ans * <span class="number">10</span> + (s.charAt(segEnd) - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (ans &gt; <span class="number">0</span> &amp;&amp; ans &lt;= <span class="number">0xFF</span>) &#123;<span class="comment">// ans属于[0, 255]</span></span><br><span class="line">segment[id] = ans;</span><br><span class="line">dfs(s, id + <span class="number">1</span>, segEnd + <span class="number">1</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-单词搜索">4 单词搜索</h2><p>dfs+回溯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">exist</span><span class="params">(<span class="type">char</span>[][] board, String word)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">h</span> <span class="operator">=</span> board.length, w = board[<span class="number">0</span>].length;</span><br><span class="line">        <span class="type">boolean</span>[][] visited = <span class="keyword">new</span> <span class="title class_">boolean</span>[h][w];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; h; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; w; j++) &#123;</span><br><span class="line">                <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> check(board, visited, i, j, word, <span class="number">0</span>);</span><br><span class="line">                <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(<span class="type">char</span>[][] board, <span class="type">boolean</span>[][] visited, <span class="type">int</span> i, <span class="type">int</span> j, String s, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (board[i][j] != s.charAt(k)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (k == s.length() - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        visited[i][j] = <span class="literal">true</span>;</span><br><span class="line">        <span class="type">int</span>[][] directions = &#123;&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">0</span>, -<span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;-<span class="number">1</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] dir : directions) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">newi</span> <span class="operator">=</span> i + dir[<span class="number">0</span>], newj = j + dir[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (newi &gt;= <span class="number">0</span> &amp;&amp; newi &lt; board.length &amp;&amp; newj &gt;= <span class="number">0</span> &amp;&amp; newj &lt; board[<span class="number">0</span>].length) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!visited[newi][newj]) &#123;</span><br><span class="line">                    <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> check(board, visited, newi, newj, s, k + <span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">                        result = <span class="literal">true</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        visited[i][j] = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="5-子集">5 子集</h2><blockquote><p>给你一个整数数组 nums ，数组中的元素 互不相同 。返回该数组所有可能的子集（幂集）。</p><p>解集 不能 包含重复的子集。你可以按 任意顺序 返回解集。</p><p>示例 1：</p><p>输入：nums = [1,2,3]<br>输出：[[],[1],[2],[1,2],[3],[1,3],[2,3],[1,2,3]]</p><p>示例 2：</p><p>输入：nums = [0]<br>输出：[[],[0]]</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">subsets</span><span class="params">(<span class="type">int</span>[] nums)</span>&#123;</span><br><span class="line">List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">List&lt;Integer&gt; path = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();<span class="comment">//用来存放之前决定</span></span><br><span class="line"><span class="keyword">if</span>(nums.length == <span class="number">0</span> || nums == <span class="literal">null</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">process2(nums, <span class="number">0</span>, res, path);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">process2</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> i, List&lt;List&lt;Integer&gt;&gt; res, List&lt;Integer&gt; path)</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(i == nums.length)&#123;</span><br><span class="line">res.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(path));</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 两种可能</span></span><br><span class="line">process2(nums, i + <span class="number">1</span>, res, path);</span><br><span class="line">List&lt;Integer&gt; path2 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(path);</span><br><span class="line">path2.add(nums[i]);</span><br><span class="line">process2(nums, i + <span class="number">1</span>, res, path2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>8 并查集</h1><h2 id="并查集">并查集</h2><p>用来解决图的连通性和环的数量</p><h2 id="结构（hash表）">结构（hash表）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Code01_UnionFind</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;V&gt; &#123;</span><br><span class="line">V value;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(V v)</span> &#123;</span><br><span class="line">value = v;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 并查集 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// 1 构造方法</span></span><br><span class="line"><span class="comment">// 2 Node&lt;V&gt; findFather(Node&lt;V&gt; cur)</span></span><br><span class="line"><span class="comment">// 3 boolean isSameSet(V a, V b)</span></span><br><span class="line"><span class="comment">// 4 void union(V a, V b)</span></span><br><span class="line"><span class="comment">// 5 int sets()</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">UnionFind</span>&lt;V&gt; &#123;</span><br><span class="line"><span class="keyword">public</span> HashMap&lt;V, Node&lt;V&gt;&gt; nodes;<span class="comment">// 点</span></span><br><span class="line"><span class="keyword">public</span> HashMap&lt;Node&lt;V&gt;, Node&lt;V&gt;&gt; parents;<span class="comment">// 最高父亲</span></span><br><span class="line"><span class="keyword">public</span> HashMap&lt;Node&lt;V&gt;, Integer&gt; sizeMap;<span class="comment">// 所在集合大小</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">UnionFind</span><span class="params">(List&lt;V&gt; values)</span> &#123;</span><br><span class="line">      <span class="comment">//1 初始化参数</span></span><br><span class="line">nodes = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">parents = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">sizeMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">      <span class="comment">//2 遍历：先new一个node 然后更新点集，更新父亲表（自己是自己爹），最后更新sizemap</span></span><br><span class="line"><span class="keyword">for</span> (V cur : values) &#123;</span><br><span class="line">Node&lt;V&gt; node = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(cur);</span><br><span class="line">nodes.put(cur, node);</span><br><span class="line">parents.put(node, node);</span><br><span class="line">sizeMap.put(node, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 找爹</span></span><br><span class="line"><span class="keyword">public</span> Node&lt;V&gt; <span class="title function_">findFather</span><span class="params">(Node&lt;V&gt; cur)</span> &#123; </span><br><span class="line">      <span class="comment">//1 new 一个 栈</span></span><br><span class="line">Stack&lt;Node&lt;V&gt;&gt; path = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">      <span class="comment">//2 如果当前cur不是自己爹 ：1）压栈 2）cur更新为自己爹</span></span><br><span class="line"><span class="keyword">while</span> (cur != parents.get(cur)) &#123;</span><br><span class="line">path.push(cur);</span><br><span class="line">cur = parents.get(cur);</span><br><span class="line">&#125;</span><br><span class="line">      <span class="comment">//3 如果栈不空 cur就是当前最爹 所以循环弹出 将cur设为他们爹</span></span><br><span class="line"><span class="keyword">while</span> (!path.isEmpty()) &#123;</span><br><span class="line">parents.put(path.pop(), cur);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cur;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回两爹是否相等</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSameSet</span><span class="params">(V a, V b)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> findFather(nodes.get(a)) == findFather(nodes.get(b));</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 并</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">union</span><span class="params">(V a, V b)</span> &#123;</span><br><span class="line">Node&lt;V&gt; aHead = findFather(nodes.get(a));</span><br><span class="line">Node&lt;V&gt; bHead = findFather(nodes.get(b));</span><br><span class="line"><span class="comment">// 如果两爹不同</span></span><br><span class="line"><span class="keyword">if</span>(aHead != bHead) &#123;</span><br><span class="line">        <span class="comment">// 1 抓住size大小</span></span><br><span class="line"><span class="type">int</span> <span class="variable">aSize</span> <span class="operator">=</span> sizeMap.get(aHead);</span><br><span class="line"><span class="type">int</span> <span class="variable">bSize</span> <span class="operator">=</span> sizeMap.get(bHead);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2 小的那个接在大的下面（big是small的父</span></span><br><span class="line">Node&lt;V&gt; small = aSize &lt; bSize ? aHead : bHead;</span><br><span class="line">Node&lt;V&gt; big = small == aHead ? bHead : aHead;</span><br><span class="line">parents.put(small, big);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3 更新大集的size 并转移小集的sizemap</span></span><br><span class="line">sizeMap.put(big, aSize + bSize);</span><br><span class="line">sizeMap.remove(small);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">sets</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> sizeMap.size();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="1-岛屿数量">1 岛屿数量</h2><blockquote><p>给你一个由 ‘1’（陆地）和 ‘0’（水）组成的的二维网格，请你计算网格中岛屿的数量。</p><p>岛屿总是被水包围，并且每座岛屿只能由水平方向和/或竖直方向上相邻的陆地连接形成。</p><p>此外，你可以假设该网格的四条边均被水包围。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">numIslands</span><span class="params">(<span class="type">char</span>[][] board)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">islands</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; board.length; i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; board[<span class="number">0</span>].length; j++) &#123;</span><br><span class="line"><span class="keyword">if</span> (board[i][j] == <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">islands++;</span><br><span class="line">infect(board, i, j);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> islands;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从(i,j)这个位置出发，把所有练成一片的&#x27;1&#x27;字符，变成0</span></span><br><span class="line"><span class="comment">// DFS</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">infect</span><span class="params">(<span class="type">char</span>[][] board, <span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (i &lt; <span class="number">0</span> || j &lt; <span class="number">0</span> || i &gt;= board.length || j &gt;= board[<span class="number">0</span>].length</span><br><span class="line">|| board[i][j] != <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">board[i][j] = <span class="number">0</span>;</span><br><span class="line">infect1(board, i, j - <span class="number">1</span>);</span><br><span class="line">infect1(board, i, j + <span class="number">1</span>);</span><br><span class="line">infect1(board, i + <span class="number">1</span>, j);</span><br><span class="line">infect1(board, i - <span class="number">1</span>, j);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * BFS</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">infect2</span><span class="params">(<span class="type">char</span>[][] board, <span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">Queue&lt;<span class="type">int</span>[]&gt; list = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">list.add(<span class="keyword">new</span> <span class="title class_">int</span>[] &#123; a, b &#125;);</span><br><span class="line"><span class="keyword">while</span>(!list.isEmpty()) &#123;</span><br><span class="line"><span class="type">int</span>[] cur = list.poll();</span><br><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> cur[<span class="number">0</span>];</span><br><span class="line"><span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> cur[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> (i &gt;= <span class="number">0</span> &amp;&amp; j &gt;= <span class="number">0</span> &amp;&amp; i &lt; board.length &amp;&amp; j &lt; board[<span class="number">0</span>].length</span><br><span class="line">&amp;&amp; board[i][j] == <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">board[i][j] = <span class="number">0</span>;</span><br><span class="line">list.add(<span class="keyword">new</span> <span class="title class_">int</span>[] &#123; i - <span class="number">1</span>, j &#125;);</span><br><span class="line">list.add(<span class="keyword">new</span> <span class="title class_">int</span>[] &#123; i + <span class="number">1</span>, j &#125;);</span><br><span class="line">list.add(<span class="keyword">new</span> <span class="title class_">int</span>[] &#123; i, j - <span class="number">1</span> &#125;);</span><br><span class="line">list.add(<span class="keyword">new</span> <span class="title class_">int</span>[] &#123; i, j + <span class="number">1</span> &#125;);</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="使用并查集（面试）">使用并查集（面试）</h3><p>为什么要并查集？ 如果有多台cpu 大岛变成小岛就会很容易</p><p><strong>面试就讲一下怎么通过并查集来进行union ： 并查集就是可以将a, b所在的集合进行合并；需要每个岛的位置 所以需要一个index方法来返回每格子的位置就是行数乘以矩阵宽度再加上列数， 然后要进行union（） 具体过程就是先找到两个要合并的点的父亲，如果不相同就再调出两个所在集合的大小sizemap，然后将小的集合接在大的集合下面， 更新sizemap。 这里找父亲的操作可以用一个help数组倒序遍历来代替栈</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用并查集</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> board</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">numIslands2</span><span class="params">(<span class="type">char</span>[][] board)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> board.length;</span><br><span class="line"><span class="type">int</span> <span class="variable">col</span> <span class="operator">=</span> board[<span class="number">0</span>].length;</span><br><span class="line"><span class="type">UnionFind2</span> <span class="variable">uf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UnionFind2</span>(board);</span><br><span class="line"><span class="comment">// 把第一行第一列先处理 就不需要后面考虑边界</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt; col; j++) &#123;</span><br><span class="line"><span class="keyword">if</span> (board[<span class="number">0</span>][j - <span class="number">1</span>] == <span class="string">&#x27;1&#x27;</span> &amp;&amp; board[<span class="number">0</span>][j] == <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">uf.union(<span class="number">0</span>, j - <span class="number">1</span>, <span class="number">0</span>, j);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; row; i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (board[i - <span class="number">1</span>][<span class="number">0</span>] == <span class="string">&#x27;1&#x27;</span> &amp;&amp; board[i][<span class="number">0</span>] == <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">uf.union(i - <span class="number">1</span>, <span class="number">0</span>, i, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 除了第一行第一列的部分</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; row; i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt; col; j++) &#123;</span><br><span class="line"><span class="keyword">if</span> (board[i][j] == <span class="string">&#x27;1&#x27;</span>)  <span class="comment">// 看上面和左边</span></span><br><span class="line"><span class="keyword">if</span> (board[i][j - <span class="number">1</span>] == <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">uf.union(i, j - <span class="number">1</span>, i, j);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (board[i - <span class="number">1</span>][j] == <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">uf.union(i - <span class="number">1</span>, j, i, j);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> uf.sets();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">UnionFind2</span> &#123;</span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span>[] parent;</span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span>[] size;</span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span>[] help;</span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> col;<span class="comment">// 用来计算矩阵数r*col + c</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> sets;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">UnionFind2</span><span class="params">(<span class="type">char</span>[][] board)</span> &#123;</span><br><span class="line">col = board[<span class="number">0</span>].length;</span><br><span class="line">sets = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> board.length;</span><br><span class="line"><span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> row * col;</span><br><span class="line">parent = <span class="keyword">new</span> <span class="title class_">int</span>[len];</span><br><span class="line">size = <span class="keyword">new</span> <span class="title class_">int</span>[len];</span><br><span class="line">help = <span class="keyword">new</span> <span class="title class_">int</span>[len];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> <span class="number">0</span>; r &lt; row; r++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">0</span>; c &lt; col; c++) &#123;</span><br><span class="line"><span class="keyword">if</span> (board[r][c] == <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> index(r, c);</span><br><span class="line">parent[i] = i;</span><br><span class="line">size[i] = <span class="number">1</span>;</span><br><span class="line">sets++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// (r,c) -&gt; i</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">index</span><span class="params">(<span class="type">int</span> r, <span class="type">int</span> c)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> r * col + c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 原始位置 -&gt; 下标</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">find</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">hi</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (i != parent[i]) &#123;</span><br><span class="line">help[hi++] = i;</span><br><span class="line">i = parent[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (hi--; hi &gt;= <span class="number">0</span>; hi--) &#123;</span><br><span class="line">parent[help[hi]] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">union</span><span class="params">(<span class="type">int</span> r1, <span class="type">int</span> c1, <span class="type">int</span> r2, <span class="type">int</span> c2)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">i1</span> <span class="operator">=</span> index(r1, c1);</span><br><span class="line"><span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> index(r2, c2);</span><br><span class="line"><span class="type">int</span> <span class="variable">f1</span> <span class="operator">=</span> find(i1);</span><br><span class="line"><span class="type">int</span> <span class="variable">f2</span> <span class="operator">=</span> find(i2);</span><br><span class="line"><span class="keyword">if</span> (f1 != f2) &#123;</span><br><span class="line"><span class="keyword">if</span> (size[f1] &gt;= size[f2]) &#123;</span><br><span class="line">size[f1] += size[f2];</span><br><span class="line">parent[f2] = f1;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">size[f2] += size[f1];</span><br><span class="line">parent[f1] = f2;</span><br><span class="line">&#125;</span><br><span class="line">sets--;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">sets</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> sets;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-省份数量（朋友圈）">2 省份数量（朋友圈）</h2><blockquote><p>有 n 个城市，其中一些彼此相连，另一些没有相连。如果城市 a 与城市 b 直接相连，且城市 b 与城市 c 直接相连，那么城市 a 与城市 c 间接相连。</p><p>省份 是一组直接或间接相连的城市，组内不含其他没有相连的城市。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findCircleNum</span><span class="params">(<span class="type">int</span>[][] M)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> M.length;</span><br><span class="line">        <span class="type">UnionFind</span> <span class="variable">unionFind</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UnionFind</span>(N);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i+<span class="number">1</span>; j &lt; N; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(M[i][j] == <span class="number">1</span>) &#123;</span><br><span class="line">                    unionFind.union(i, j);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> unionFind.sets();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用数组结构的并查集</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">UnionFind</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span>[] parents;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span>[] size;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span>[] help;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> sets;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">UnionFind</span><span class="params">(<span class="type">int</span> N)</span> &#123;</span><br><span class="line">            parents = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">            size = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">            help = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">            sets = N;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">                parents[i] = i;</span><br><span class="line">                size[i] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1 定义一个指针</span></span><br><span class="line">        <span class="comment">// 2 while(i不是自己爹）&#123;</span></span><br><span class="line">        <span class="comment">// 2.1 压help栈（虚拟的</span></span><br><span class="line">        <span class="comment">// 2.2 i指向自己的爹    &#125;</span></span><br><span class="line">        <span class="comment">// 3 for遍历help：模拟栈弹出 &#123;所有人爹设为i&#125;</span></span><br><span class="line">        <span class="comment">// 4 返回i:此时i指向最爹</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findFather</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">hi</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>( i != parents[i]) &#123;</span><br><span class="line">                help[hi++] = i;</span><br><span class="line">                i = parents[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(hi--; hi &gt;=<span class="number">0</span>; hi--)&#123;</span><br><span class="line">                parents[help[hi]] = i;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">union</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">iF</span> <span class="operator">=</span> findFather(i);</span><br><span class="line">            <span class="type">int</span> <span class="variable">jF</span> <span class="operator">=</span> findFather(j);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(iF != jF) &#123;</span><br><span class="line">                <span class="keyword">if</span>(size[iF] &lt; size[jF]) &#123;</span><br><span class="line">                    size[jF] += size[iF];</span><br><span class="line">                    parents[iF] = jF;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    size[iF] += size[jF];</span><br><span class="line">                    parents[jF] = iF;</span><br><span class="line">                &#125;</span><br><span class="line">                sets--;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">sets</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> sets;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>7 图</h1><h2 id="将矩阵转化为自己的结构-creatGraph">将矩阵转化为自己的结构(creatGraph)</h2><ol><li>new一个自己的graph</li><li>遍历矩阵每一行 for(matrix.length)<ol><li>weight:<code>matrix[i][0]</code> from<code>[i][1]</code> to:<code>[i][2]</code></li><li>判断是否contanskey(from和to) 分别放入点集</li><li>edge初始化 并赋值 (weight,fromNode,toNode)</li><li>更新出入度、直接点、直接边</li><li>边放入边集</li></ol></li></ol><h2 id="1-图的bfs">1 图的bfs</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Code01_BFS</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从node出发，进行宽度优先遍历</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">bfs</span><span class="params">(Node start)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (start == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">Queue&lt;Node&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">HashSet&lt;Node&gt; set = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">queue.add(start);</span><br><span class="line">set.add(start);</span><br><span class="line"><span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line"><span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">System.out.println(cur.value);</span><br><span class="line"><span class="keyword">for</span> (Node next : cur.nexts) &#123;</span><br><span class="line"><span class="keyword">if</span> (!set.contains(next)) &#123;</span><br><span class="line">set.add(next);</span><br><span class="line">queue.add(next);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="2-DFS">2 DFS</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> all.Graph;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Code02_DFS</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">dfs</span><span class="params">(Node node)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">Stack&lt;Node&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">HashSet&lt;Node&gt; set = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">stack.add(node);</span><br><span class="line">set.add(node);</span><br><span class="line">System.out.println(node.value);</span><br><span class="line"><span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line"><span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> stack.pop();</span><br><span class="line"><span class="keyword">for</span> (Node next : cur.nexts) &#123;</span><br><span class="line"><span class="keyword">if</span> (!set.contains(next)) &#123;</span><br><span class="line">stack.push(cur);</span><br><span class="line">stack.push(next);</span><br><span class="line">set.add(next);</span><br><span class="line">System.out.println(next.value);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="3-拓扑排序">3 拓扑排序</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 拓扑排序 ： 有向无环图</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> chs</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Code03_TopologySort</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// directed graph and no loop</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Node&gt; <span class="title function_">sortedTopology</span><span class="params">(Graph graph)</span> &#123;</span><br><span class="line"><span class="comment">// key 某个节点   value 剩余的入度</span></span><br><span class="line">HashMap&lt;Node, Integer&gt; inMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="comment">// 只有剩余入度为0的点，才进入这个队列</span></span><br><span class="line">Queue&lt;Node&gt; zeroInQueue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (Node node : graph.nodes.values()) &#123;</span><br><span class="line">inMap.put(node, node.in);</span><br><span class="line"><span class="keyword">if</span> (node.in == <span class="number">0</span>) &#123;</span><br><span class="line">zeroInQueue.add(node);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">List&lt;Node&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">while</span> (!zeroInQueue.isEmpty()) &#123;</span><br><span class="line"><span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> zeroInQueue.poll();</span><br><span class="line">result.add(cur);</span><br><span class="line"><span class="keyword">for</span> (Node next : cur.nexts) &#123;</span><br><span class="line">inMap.put(next, inMap.get(next) - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (inMap.get(next) == <span class="number">0</span>) &#123;</span><br><span class="line">zeroInQueue.add(next);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redis</title>
      <link href="/2022/02/12/Redis%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
      <url>/2022/02/12/Redis%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=cc1239ec-bc17-fc61-6a27-a0ac8180e495</cover>
      <date>Sat Feb 12 2022 22:39:18 GMT+0800</date>
      
        <content type="html"><![CDATA[<p>Redis是一个使用c语言编写的，开源的高性能非关系型数据库(NoSQL)</p><span id="more"></span><h1>数据类型</h1><p>回答：一共五种<br>(一)String<br>这个其实没啥好说的，最常规的set/get操作，value可以是String也可以是数字。一般做一些复杂的计数功能的缓存。<br>(二)hash<br>这里value存放的是结构化的对象，比较方便的就是操作其中的某个字段。博主在做单点登录的时候，就是用这种数据结构存储用户信息，以cookieId作为key，设置30分钟为缓存过期时间，能很好的模拟出类似session的效果。<br>(三)list<br>使用List的数据结构，可以做简单的消息队列的功能。另外还有一个就是，可以利用lrange命令，做基于redis的分页功能，性能极佳，用户体验好。本人还用一个场景，很合适—取行情信息。就也是个生产者和消费者的场景。LIST可以很好的完成排队，先进先出的原则。<br>(四)set<br>因为set堆放的是一堆不重复值的集合。所以可以做全局去重的功能。为什么不用JVM自带的Set进行去重？因为我们的系统一般都是集群部署，使用JVM自带的Set，比较麻烦，难道为了一个做一个全局去重，再起一个公共服务，太麻烦了。<br>另外，就是利用交集、并集、差集等操作，可以计算共同喜好，全部的喜好，自己独有的喜好等功能。<br>(五)sorted set<br>sorted set多了一个权重参数score,集合中的元素能够按score进行排列。可以做排行榜应用，取TOP N操作。</p><h1>内部结构</h1><ul><li>dict 本质上是为了解决算法中的查找问题（Searching）是一个用于维护key和value映射关系的数据结构，与很多语言中的Map或dictionary类似。 本质上是为了解决算法中的查找问题（Searching）</li><li>sds sds就等同于char * 它可以存储任意二进制数据，不能像C语言字符串那样以字符’\0’来标识字符串的结 束，因此它必然有个长度字段。</li><li>skiplist （跳跃表） 跳表是一种实现起来很简单，单层多指针的链表，它查找效率很高，堪比优化过的二叉平衡树，且比平衡树的实现，</li><li>quicklist</li><li>ziplist 压缩表 ziplist是一个编码后的列表，是由一系列特殊编码的连续内存块组成的顺序型数据结构，</li></ul><h1>redis怎么用</h1><h2 id="命令">命令</h2><h4 id="1-Key操作">1. Key操作</h4><table><thead><tr><th style="text-align:center">命令</th><th>含义</th><th>返回值</th></tr></thead><tbody><tr><td style="text-align:center">exists key 名称</td><td>判断key是否存在</td><td>数字/0</td></tr><tr><td style="text-align:center">expire key 秒数</td><td>设置key过期时间</td><td>1/0</td></tr><tr><td style="text-align:center">ttl key</td><td>查看key的剩余过期时间</td><td>返回剩余时间，如果不过期返回-1</td></tr><tr><td style="text-align:center">del key</td><td>根据key删除键值对。</td><td>被删除key的数量</td></tr></tbody></table><h4 id="2-字符串值-String">2. <strong>字符串值(String)</strong></h4><table><thead><tr><th style="text-align:center">命令</th><th>含义</th><th>返回值</th></tr></thead><tbody><tr><td style="text-align:center">set key value</td><td>设置指定key的值</td><td>成功OK</td></tr><tr><td style="text-align:center">get key</td><td>获取指定key的值</td><td>key的值。不存在返回nil</td></tr><tr><td style="text-align:center">setnx key value</td><td>当且仅当key不存在时才新增。</td><td>不存在时返回1，存在返回0</td></tr><tr><td style="text-align:center">setex key seconds value</td><td>设置key的存活时间，无论是否存在指定key都能新增，如果存在key覆盖旧值。同时必须指定过期时间。</td><td>OK</td></tr></tbody></table><h4 id="3-哈希表-Hash">3.<strong>哈希表(Hash)</strong></h4><p>​Hash类型的值中包含多组field value。</p><img src="https://img.soniachen.com/blog/posts/2025/06/Redis-03.jpg" style="zoom:67%;" /><h5 id="3-1-hset">3.1 <strong>hset</strong></h5><p>​给key中field设置值。</p><p>​语法：hset key field value</p><p>​返回值：成功1，失败0</p><h5 id="3-2-hget">3.2 <strong>hget</strong></h5><p>​获取key中某个field的值</p><p>​语法：hget key field</p><p>​返回值：返回field的内容</p><h5 id="3-3-hmset">3.3 <strong>hmset</strong></h5><p>​给key中多个filed设置值</p><p>​语法：hmset key field value field value</p><p>​返回值：成功OK</p><h5 id="3-4-hmget">3.4 <strong>hmget</strong></h5><p>​一次获取key中多个field的值</p><p>​语法：hmget key field field</p><p>​返回值：value列表</p><h5 id="3-5-hvals">3.5 <strong>hvals</strong></h5><p>​获取key中所有field的值</p><p>​语法：hvals key</p><p>​返回值：value列表</p><h5 id="3-6-hgetall">3.6 <strong>hgetall</strong></h5><p>​获取所有field和value</p><p>​语法：hgetall key</p><p>​返回值：field和value交替显示列表</p><h5 id="3-7-hdel">3.7 <strong>hdel</strong></h5><p>​删除key中任意个field</p><p>​语法：hdel key field field</p><p>​返回值：成功删除field的数量</p><h4 id="4-列表（List）">4. <strong>列表（List）</strong></h4><h5 id="4-1-Rpush">4.1 <strong>Rpush</strong></h5><p>​向列表末尾中插入一个或多个值</p><p>​语法；rpush key value value</p><p>​返回值：列表长度</p><h5 id="4-2-lrange">4.2 <strong>lrange</strong></h5><p>​返回列表中指定区间内的值。可以使用-1代表列表末尾</p><p>​语法：lrange list 0 -1</p><p>​返回值：查询到的值</p><h5 id="4-3-lpush">4.3 <strong>lpush</strong></h5><p>​将一个或多个值插入到列表前面</p><p>​语法：lpush key value value</p><p>​返回值：列表长度</p><h5 id="4-4-llen">4.4 <strong>llen</strong></h5><p>​获取列表长度</p><p>​语法：llen key</p><p>​返回值：列表长度</p><h5 id="4-5-lrem">4.5 <strong>lrem</strong></h5><p>​删除列表中元素。count为正数表示从左往右删除的数量。负数从右往左删除的数量。</p><p>​语法：lrem key count value</p><p>​返回值：删除数量。</p><h4 id="5-集合-Set">5 <strong>集合(Set)</strong></h4><p>​set和java中集合一样。</p><h5 id="5-1-sadd">5.1 <strong>sadd</strong></h5><p>​向集合中添加内容。不允许重复。</p><p>​语法：sadd key value value value</p><p>​返回值：集合长度</p><h5 id="5-2-scard">5.2 <strong>scard</strong></h5><p>​返回集合元素数量</p><p>​语法：scard key</p><p>​返回值：集合长度</p><h5 id="5-3-smembers">5.3 **smembers **</h5><p>​查看集合中元素内容</p><p>​语法：smembers key</p><p>​返回值：集合中元素</p><h4 id="6-有序集合（Sorted-Set）">6 .<strong>有序集合（Sorted Set）</strong></h4><p>​有序集合中每个value都有一个分数（score），根据分数进行排序。</p><h5 id="6-1-zadd">6.1 <strong>zadd</strong></h5><p>​向有序集合中添加数据</p><p>​语法：zadd key score value score value</p><p>​返回值：长度</p><h5 id="6-2-zrange">6.2 <strong>zrange</strong></h5><p>​返回区间内容，withscores表示带有分数</p><p>​语法：zrange key 区间 [withscores]</p><p>​返回值：值列表</p><h2 id="使用SpringBoot整合SpringDataRedis操作redis"><strong>使用SpringBoot整合SpringDataRedis操作redis</strong></h2><p>​Spring Data是Spring公司的顶级项目，里面包含了N多个二级子项目，这些子项目都是相对独立的项目。每个子项目是对不同API的封装。</p><p>​所有Spring Boot整合Spring Data xxxx的启动器都叫做spring-boot-starter-data-xxxx</p><p>​Spring Data 好处很方便操作对象类型。</p><p>​把Redis不同值得类型放到一个opsForXXX方法中。</p><p>​opsForValue : String值</p><p>​opsForList : 列表List</p><p>​opsForHash: 哈希表Hash</p><p>​opsForZSet: 有序集合Sorted Set</p><p>​opsForSet : 集合</p><h4 id="1-添加依赖">1. <strong>添加依赖</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;parent&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.2.2.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/parent&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependencies&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure><h4 id="2-配置配置文件">2. <strong>配置配置文件</strong></h4><p>​spring.redis.host=localhost 默认值</p><p>​spring.redis.port=6379 端口号默认值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  redis:</span><br><span class="line">    host: 192.168.52.133</span><br><span class="line"># cluster:</span><br><span class="line"># nodes: 192.168.93.10:7001,192.168.93.10:7002,192.168.93.10:7003,192.168.93.10:7004,192.168.93.10:7005,192.168.93.10:7006</span><br></pre></td></tr></table></figure><h4 id="3-编写配置类">3.<strong>编写配置类</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class RedisConfig &#123;</span><br><span class="line">    @Bean</span><br><span class="line">    public RedisTemplate&lt;String,Object&gt; redisTemplate(RedisConnectionFactory   factory)&#123;</span><br><span class="line">        RedisTemplate&lt;String,Object&gt; redisTemplate = new RedisTemplate&lt;&gt;();</span><br><span class="line">        redisTemplate.setConnectionFactory(factory);</span><br><span class="line">        redisTemplate.setKeySerializer(new StringRedisSerializer());</span><br><span class="line">        redisTemplate.setValueSerializer(new Jackson2JsonRedisSerializer&lt;Object&gt;(Object.class));</span><br><span class="line">        return redisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-编写代码">4. <strong>编写代码</strong></h4><h5 id="4-1-编写对象新增">4.1 <strong>编写对象新增</strong></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line">private RedisTemplate&lt;String, Object&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">public void testString() &#123;</span><br><span class="line">    People peo = new People(1, &quot;张三&quot;);</span><br><span class="line">    redisTemplate.opsForValue().set(&quot;peo1&quot;, peo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="4-2-编写对象获取">4.2 <strong>编写对象获取</strong></h5><p>此处必须编写值序列化器。不指定时返回类型为LinkedHashMap</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void testGetString() &#123;</span><br><span class="line">    redisTemplate.setValueSerializer(new Jackson2JsonRedisSerializer&lt;People&gt;(People.class));</span><br><span class="line">    People peo = (People) redisTemplate.opsForValue().get(&quot;peo1&quot;);</span><br><span class="line">    System.out.println(peo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="4-3-编写List">4.3 <strong>编写List</strong></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void testList() &#123;</span><br><span class="line">    List&lt;People&gt; list = new ArrayList&lt;&gt;();</span><br><span class="line">    list.add(new People(1, &quot;张三&quot;));</span><br><span class="line">    list.add(new People(2, &quot;李四&quot;));</span><br><span class="line">    redisTemplate.opsForValue().set(&quot;list2&quot;, list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="4-4-编写List取值">4.4 <strong>编写List取值</strong></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void testGetList()&#123;</span><br><span class="line">    redisTemplate.setValueSerializer(new Jackson2JsonRedisSerializer&lt;List&gt;(List.class));</span><br><span class="line">    List&lt;People&gt; list2 = (List&lt;People&gt;) redisTemplate.opsForValue().get(&quot;list2&quot;);</span><br><span class="line">    System.out.println(list2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>redis持久化</h1><p>​Redis不仅仅是一个内存型数据库，还具备持久化能力。</p><h4 id="1-RDB">1. <strong>RDB</strong></h4><p>​rdb模式是默认模式，可以在指定的时间间隔内生成数据快照（snapshot），默认保存到dump.rdb文件中。当redis重启后会自动加载dump.rdb文件中内容到内存中。用户可以使用SAVE（同步）或BGSAVE（异步）手动保存数据。比如save 900 1 的设置就会让服务器在900 秒以内，如果对数据库修改了至少一次的时候就会执行BGSAVE。</p><p>优点就是这样的恢复效率会比aof高，而且直接用文件就可以还原，但是如果出现不可预知的关闭的时候，就会可能丢失数据。并且每次保存数据的时候都会进行fork()子进程，这样会导致大量的耗费性能。</p><h4 id="2-AOF">2 <strong>AOF</strong></h4><p>​AOF默认是关闭的，需要在配置文件中开启AOF。Redis支持AOF和RDB同时生效，如果同时存在，AOF优先级高于RDB，也就是Redis重新启动时会使用AOF进行数据恢复，他存储的是redis所有的修改数据的操作。开启方法就是修改redis.conf文件里面appendonly yes（默认是no）</p><p>优点就是比RDB数据更加安全不容易丢失数据，在重启的时候就会进行数据恢复，但是就是数据集很大，比RDB也会更慢一点。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 默认no</span><br><span class="line">appendonly yes</span><br><span class="line"># aof文件名</span><br><span class="line">appendfilename &quot;appendonly.aof&quot;</span><br></pre></td></tr></table></figure><h1>穿透、击穿、雪崩、预热、更新过期key</h1><h2 id="穿透">穿透</h2><p>就是数据库和缓存都没有这个数据，这样就导致了用户查询的时候再缓存里面找不到，每次又去数据库里面找，然后返回空，相当于进行了两次无效请求，要解决这种重复的无效请求，可以用两种办法，第一种就是简单暴力的将key对应null值存入缓存，但是这样就会有对空间的占用，第二种就是使用布隆过滤器，布隆过滤器是将所有可能存在的数据hash到一个足够大的bitmap里面，一个一定不会存在的数据，就会被这个bitmap给拦截掉，从而避免了直接对底层数据库查询的压力，并且因为有hash冲突的可能，底层算法使用多个hash函数来解决“冲突”，因为同一个hash函数算出来的值有可能相等，所以引入多个hash，通过一个hash某元素不在集合里面，说明就不在，判断在的时候就得当所有hash算出来在才算在。这是布隆过滤器的实现核心。</p><h2 id="击穿">击穿</h2><p>击穿就是当一个key很热点的时候，大并发集中对这个点进行访问，当这个key在缓存过期失效的一瞬间，就会持续的穿破缓存，直接对数据库进行一个请求，简单来说就是缓存里面没有，数据库里面有。</p><p>解决的话可以在访问key之前，把这些请求用锁锁起来，设置一个短期的key来锁，访问结束再删除短期key。 处理的案例之前做项目的时候我记得，多个机器拿token，token再存一份到redis里面，保证系统再token过期的时候只有一个线程去获取token，使用分布式锁。</p><h2 id="雪崩">雪崩</h2><p>缓存雪崩也是一种缓存里面没有数据库里面有的情况，只不过是比击穿多了很多过期的key，比如设置了相同的过期时间，同一时间内出现了大面积的缓存过期，所有原本应该访问缓存的请求都去查询数据库了，而对数据库CPU和内存造成巨大压力，严重的会造成数据库宕机。从而形成一系列连锁反应，造成整个系统崩溃。<br>解决办法：<br>大多数系统设计者考虑用加锁（ 最多的解决方案）或者队列的方式保证来保证不会有大量的线程对数据库一次性进行读写，从而避免失效时大量的并发请求落到底层存储系统上。还有一个简单方案就时讲<strong>缓存失效时间分散开。</strong></p><h2 id="预热">预热</h2><p>缓存预热就是在系统上线后，我们将相关的缓存数据直接加载到系统之中，这样提前就避免了一个用户请求直接去查询数据库的情况。</p><p>具体操作可以是先写一个缓存刷新页面，然后数据量如果不打就自行加载，后面再定时刷新</p><h2 id="更新">更新</h2><p>自定义的缓存淘汰（更），第一种是定时去清理过期的缓存； 第二种是用户请求过来时再去判断这个缓存是否过期。<br>两者各有优劣，第一种的缺点是维护大量缓存的key是比较麻烦的，第二种的缺点就是每次用户请求过来都要判断缓存失效，逻辑相对比较复杂！</p><h2 id="降级">降级</h2><p>降级服务，是为了防止redis服务故障导致数据库一起发生雪崩问题，所以对于不要的缓存数据，可以进行降级，举个例子就是，redis出现问题了，就不去数据库查询，而是返回默认值给用户。</p><h1>redis单线程</h1><img src="https://img.soniachen.com/blog/posts/2025/06/image-20220320220341675.png" alt="image-20220320220341675" style="zoom:50%;" /><p>Redis是单线程的，做的都是纯内存操作，使用单线程就避免了频繁的上下文切换，并且在6.x版本以后就增加了非阻塞I/O多路复用机制，但是工作线程其实还是单线程，计算都是串行的，redis从内核读取数据搬运数据的操作在6.x版本以后就是并行的在多个cpu上进行，但是主要的计算工作线程里还是将多个事件进行串行处理的，多路复用器里面使用selec、epoll等进行读写事件的一个判断，有就取出来进行处理。</p><h3 id="快的关键">快的关键</h3><p>(一)纯内存操作<br>(二)单线程操作，避免了频繁的上下文切换<br>(三)采用了非阻塞I/O多路复用机制</p><h1>分布式锁</h1><p>Redis为单进程单线程模式，采用队列模式将并发访问变成串行访问，且多客户端对Redis的连接并不存在竞争关系Redis中可以使用SETNX命令实现分布式锁。<br>将 key 的值设为 value ，当且仅当 key 不存在。 若给定的 key 已经存在，则 SETNX 不做任何动作</p><p>解锁：使用 del key 命令就能释放锁<br>解决死锁：<br>1）通过Redis中expire()给锁设定最大持有时间，如果超过，则Redis来帮我们释放锁。<br>2） 使用 setnx key “当前系统时间+锁持有的时间”和getset key “当前系统时间+锁持有的时间”组合的命令就可以实现。</p><p>锁续期：好像是redission这个客户端里面自动就会实现的一个，底层我看过一篇文章好像是watchdog来每30秒判断是否client还持有锁，如果还持有就不断延长key，我还记得好像还使用的是可重入锁。</p><h1>redis的过期策略以及内存淘汰机制</h1><p>redis采用的是定期删除+惰性删除策略。定期删除呢举个例子就是每一段时间去检查是否有过期的key，但是这个检查不是说检查所有的，是随机抽取检查，所以如果只采用定期删除的话，就会导致很多key没有被定时删除，所以就引入惰性删除，就是说在你获取某个key的时候，redis会检查一下，这个key如果设置了过期时间，就判断是否过期进行删除操作。</p><p>但是即使采用了这两种策略，也会有这种情况，就是如果定期删除没删掉，也没有及时去请求一个key，也就是惰性删除也没生效，就会导致一个内存越来越高，所以就还有一个内存淘汰机制。</p><p>内存淘汰机制是redis.conf文件的一行配置， 使用maxmemory-policy 加上 具体淘汰机制的这个名称： 机制我记得有这几种：</p><ul><li>volatile-lru：从<strong>已设置过期时间</strong>的数据集（server.db[i].expires）中挑选最近<strong>最少使用</strong>的数据淘汰</li><li>volatile-ttl：从已设置过期时间的数据集（server.db[i].expires）中挑选<strong>将要过期</strong>的数据淘汰</li><li>volatile-random：从<strong>已设置过期时间</strong>的数据集（server.db[i].expires）中<strong>任意选择</strong>数据淘汰</li><li>allkeys-lru：从数据集（server.db[i].dict）中挑选最近最少使用的数据淘汰</li><li>allkeys-random：从数据集（server.db[i].dict）中任意选择数据淘汰</li><li>no-enviction（驱逐）：禁止驱逐数据，新写入操作会报错</li><li>ps：如果没有设置 expire 的key, 不满足先决条件(prerequisites); 那么 volatile-lru, volatile-random 和 volatile-ttl 策略的行为, 和 noeviction(不删除) 基本上一致。</li></ul><h1>主从复制 集群（cluster）</h1><p>支持集群功能，并且还支持主从复制，就是每个节点有N个复制品，然后其中一个复制品是主，另外都是slave从，支持一个 一主多从，每个从又可以看作主，优点就是增强单一节点的健壮性，从节点可以对主节点做一个复制数据备份，提升了容灾能力。还有一点就是redis里面主节点一般用来写，从节点只能读，这样实现了读写分离，减少并发出现的一些同步错误。</p><p>搭建主从节点： replicaof + 主节点ip+ 端口</p><p>启动：在starup.sh文件里面进行设置 cd + 目录+ redis.conf</p><p>收于权限：chmod a+x <a href="http://startup.sh">startup.sh</a></p><h3 id="哨兵">哨兵</h3><p>由于主从复制默认从只有读能力，所以如果主节点出现宕机，整个节点就不具备写能力了，所以呢我们用哨兵Sentinel来监控节点，如果主节点宕机，就重新选取主节点。</p><h1>Memcache与Redis的区别都有哪些？</h1><p>(1) memcached所有的值均是简单的字符串，redis作为其替代者，支持更为丰富的数据类型</p><p>(2) redis的速度比memcached快很多</p><p>(3) redis可以持久化其数据：存储方式 Memecache把数据全部存在内存之中，断电后会挂掉，数据不能超过内存大小。 Redis有部份存在硬盘上，redis可以持久化其数据</p><p>(4)使用底层模型不同 它们之间底层实现方式 以及与客户端之间通信的应用协议不一样。 Redis直接自己构建了VM 机制 ，因为一般的系统调用系统函数的话，会浪费一定的时间去移动和请求。</p>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> NoSQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多线程</title>
      <link href="/2022/02/09/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
      <url>/2022/02/09/%E5%A4%9A%E7%BA%BF%E7%A8%8B/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=4278a9a7-c050-3156-d4c3-9a625829404a</cover>
      <date>Wed Feb 09 2022 13:19:50 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>并发编程三大特性</h1><h2 id="可见性">可见性</h2><p><u><strong>MESI</strong></u> 多线程的底层并不是通过mesi</p><p>多线程提高效率，本地缓存数据，造成数据修改不可见，</p><p>要想保证可见，要么触发同步指令，要么加上volatile，被修饰的内存，只要有修改，马上同步涉及到的每个线程。</p><span id="more"></span><h3 id="volatile">==volatile==</h3><h5 id="介绍一下volatile的功能？">==介绍一下volatile的功能？==</h5><p>volatile关键字保证了<strong>可见性和禁止指令重排</strong></p><p>提供了happen-before的保证，确保一个线程的修改可以对其他线程是可见的。当一个共享变量被修饰的时候，就会保证修改的值立即被更新到内存，当其他线程需要读取的时候，就会去内存中读取新值。从实际角度来说，其中的一个重要作用就是与CAS结合，保证了<strong>原子性</strong>。volatile经常用在多线程环境下的单次操作。</p><p><u>通俗来讲</u>就是 ab线程要用一个变量，然后java默认是a线程中保留一份copy，这样如果b线程来修改，则a线程未必知道，如果使用这个关键字，线程之间数据修改都能可见。</p><h5 id="volatile的可见性和禁止指令重排序怎么实现的？">==volatile的可见性和禁止指令重排序怎么实现的？==</h5><p>volatile本质上是通过内存屏障来实现可见性的，被修饰的变量在被修改之后可以立即同步到主内存，该变量每次使用之前都从主内存刷新，而禁止指令重排序也是通过内存屏障来禁止的，本来现在的cpu为了提高效率会见指令并发执行，一个指令从JMM内存屏障的策略来看，就是在volatile的写操作的前面插入一个StoreStore屏障，后面插入一个StoreLoad，在读操作前面加入一个LoadLoad，后面加一个LoadStore屏障。</p><h5 id="volatile-的底层实现？">==volatile 的底层实现？==</h5><p>volatile 底层jmm</p><h5 id="实现一下DCL-单例模式下的双重检查-volatile的实践">==实现一下DCL(单例模式下的双重检查)/ volatile的实践==</h5><p>是否lazy化？ 是</p><p>是否线程安全？ 是</p><p>实现难度： 针对需要双重检查的操作</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="comment">// volatile防止指令重排</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton singleton;</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 第一层判断singleton是不是null</span></span><br><span class="line">        <span class="keyword">if</span>(Singleton == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//现在再加锁</span></span><br><span class="line">            <span class="keyword">synchronized</span>(Singleton.class)&#123;</span><br><span class="line">                <span class="comment">// 第二层判断</span></span><br><span class="line">                <span class="comment">// 如果A,B 两个线程都在synchronized等待</span></span><br><span class="line">                <span class="comment">// A 创建完对象之后，B还会再进入，如果不再检查一遍，B又会创建一个对象</span></span><br><span class="line">                <span class="keyword">if</span>(singleton == <span class="literal">null</span>)&#123;</span><br><span class="line">                    singleton = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> singleton;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;                                                                                </span><br></pre></td></tr></table></figure><h5 id="单例里面要不要加volatile？">==单例里面要不要加volatile？==</h5><p>要加，如果不加volatile问题就会出现在指令重排序上，</p><p>比如有一行初始化对象的代码，被编译器执行之后就会分成三步，1 给指令申请内存，2 给成员变量初始化，3 把这块内存的内容赋值，重排序以后 既然已经有这个值，在另外一个线程上来先去检查就会发现已经存在该值，就不会进入锁部分的代码，但是加了volatile就不会允许指令重排序，一定会保证你初始化完了才会给你赋值这个变量。</p><h2 id="有序性">有序性</h2><h3 id="程序真的是按照顺序执行的吗？">程序真的是按照顺序执行的吗？</h3><p>并不是 cpu为了提高效率，通常都是乱序</p><p>在执行程序时，为了提供性能，处理器和编译器常常会对指令进行重排序，但是不能随意重排序，不是你想怎么排序就怎么排序，它需要满足以下两个条件：在单线程环境下不能改变程序运行的结果；存在数据依赖关系的不允许重排序需要注意的是：重排序不会影响单线程环境的执行结果，但是会破坏多线程的执行语义。</p><h3 id="单线程也不是顺序执行">单线程也不是顺序执行</h3><p>单线程有一个 a i s 语义保证了其单线程执行结果不被改变，其实也不是顺序执行的。</p><p><strong>as-if-serial语义</strong>保证单线程内程序的执行结果不被改变，happensbefore关系保证正确同步的多线程程序的执行结果不被改变。 as-if-serial语义给编写单线程程序的程序员创造了一个幻境：单线程程序是按程序的顺序来执行的。<strong>happens-before</strong>关系给编写正确同步的多线程程序的程序员创造了一个幻境：正确同步的多线程程序是按 happens-before指定的顺序来执行的。</p><p>as-if-serial语义和happens-before这么做的目的，都是为了在不改变程序执行结果的前提下，尽可能地提高程序执行的并行度。</p><h2 id="原子性">原子性</h2><p>保证操作的原子性可以通过synchronized(悲观锁) 和 cas(乐观锁)</p><h3 id="CAS">CAS</h3><p>CAS 是 compare and swap 的缩写，即我们所说的比较交换。</p><p>cas 是一种基于锁的操作，而且是乐观锁。在 java 中锁分为乐观锁和悲观锁。</p><p>悲观锁是将资源锁住，等一个之前获得锁的线程释放锁之后，下一个线程才可以访问。而乐观锁采取了一种宽泛的态度，通过某种方式不加锁来处理资源，比如通过给记录加 version 来获取数据，性能较悲观锁有很大的提高。</p><p>CAS 操作包含三个操作数 —— 内存位置（V）、预期原值（A）和新值(B)。如果内存地址里面的值和 A 的值是一样的，那么就将内存里面的值更新成 B。</p><p>CAS是通过无限循环来获取数据的，若果在第一轮循环中，a 线程获取地址里面的值被b 线程修改了，那么 a 线程需要自旋，到下次循环才有可能机会执行。</p><p>java.util.concurrent.atomic 包下的类大多是使用 CAS 操作来实现的(AtomicInteger,AtomicBoolean,AtomicLong)。</p><h5 id="CAS底层">==CAS底层==</h5><p>以AtomicInterger 这个类为例，里面的incrementAndGet() 就调用了compareAndSet()方法 里面有一个unsafe对象 查看jdk里面的c语言代码就会有一个底层的指令 <code> cmpxchg</code>指令 意思是<code>cas修改变量值</code> 这个指令不是原子的所以需要 lock ，而在硬件层面lock指令在执行的时候看情况来采用总线锁或者缓存锁，所以底层层面cas是用的lock指令。</p><h5 id="如何解决ABA问题">==如何解决ABA问题==</h5><p>如果是基础类型就无所谓，就是两个线程去同时修改一个变量值，一个线程被某些原因发生阻塞等待过程中另一个线比较更新 变量值从A到B，这个时候再来第三个线程想把变量改为B到A，进行比较更新更改完毕以后，原来被阻塞的线程这个时候获得CPU时间片发现是A 于是更新为B 可是其实该值已经更新过了，这个问题可以通过加版本号或者时间戳解决，但是一般是每次版本号加一，时间戳不容易指定精度一般不用。</p><h1>线程调度与同步</h1><h3 id="线程调度器">线程调度器</h3><p>负责将runnable的线程分配CPU</p><h4 id="怎么进行多线程抢占cpu的调度呢？（线程调度算法">怎么进行多线程抢占cpu的调度呢？（<strong>线程调度算法</strong></h4><ol><li>分时调度 大家平均分配时间片</li><li>抢占式 优先级高的线程占用 ，如果优先级都相等就随机选一个，都是等线程结束才放弃CPU</li></ol><h3 id="线程同步以及线程调度方">线程同步以及线程调度方</h3><ol><li><p>wait(): 释放锁； 需要被唤醒 ；是object的方法；用于进程通信；</p></li><li><p>sleep()：不释放锁 ；自动苏醒；是thread的静态方法</p></li><li><p>notify()：随机唤醒一个进入锁池</p></li><li><p>notifyAll()： 唤醒所有进入锁池</p><h4 id="sleep-和-wait-不同">sleep() 和 wait() 不同</h4><h4 id="sleep-和yeild-不同">sleep()和yeild() 不同</h4><p>sleep()是成为阻塞状态，其他线程不考虑优先级，抛出interrupted异常，移植性更好</p><p>yeild()是成为就绪状态，其他线程和当前一起按优先级，没有声明异常，不怎么建议使用</p><h4 id="sleep-和yeild-为啥是静态">sleep()和yeild()为啥是静态</h4><p>两个方法是在正在执行的线程运行，在处于等待状态里面调用无意义</p></li></ol><h3 id="wait-和-notify-实际使用">==wait() 和 notify()实际使用==</h3><p>这里是一个面试题，就是两个线程实现线程a打印1～10，然后另外一个线程b在a打到5的时候执行，然后a在b执行完之后打印剩下的</p><p><u>这里具体就是线程b先启动然后wait ，然后等到a打印1～5以后唤醒线程b，同时也要wait()释放锁，b执行完毕又要notify a。</u></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">T03_NotifyHoldingLock</span> &#123; <span class="comment">//wait notify</span></span><br><span class="line"><span class="comment">//添加volatile，使t2能够得到通知</span></span><br><span class="line"><span class="keyword">volatile</span> <span class="type">List</span> <span class="variable">lists</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">lists.add(o);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> lists.size();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">T03_NotifyHoldingLock</span> <span class="variable">c</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T03_NotifyHoldingLock</span>();</span><br><span class="line"><span class="keyword">final</span> <span class="type">Object</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">       </span><br><span class="line">    <span class="comment">//需要注意先启动t2再启动t1</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line"><span class="keyword">synchronized</span>(lock) &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;t2 启动&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(c.size() != <span class="number">5</span>) &#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">lock.wait();</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">&quot;t2 结束&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">            <span class="comment">//通知t1继续执行</span></span><br><span class="line">            lock.notify()。</span><br><span class="line">&#125;, <span class="string">&quot;t2&quot;</span>).start();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e1) &#123;</span><br><span class="line">e1.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;t1 启动&quot;</span>);</span><br><span class="line"><span class="keyword">synchronized</span>(lock) &#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++) &#123;</span><br><span class="line">c.add(<span class="keyword">new</span> <span class="title class_">Object</span>());</span><br><span class="line">System.out.println(<span class="string">&quot;add &quot;</span> + i);</span><br><span class="line"><span class="keyword">if</span>(c.size() == <span class="number">5</span>) &#123;</span><br><span class="line">lock.notify();</span><br><span class="line">                        <span class="comment">//释放锁，让t2得以执行</span></span><br><span class="line">                        <span class="keyword">try</span>&#123;</span><br><span class="line">                           lock.wait();</span><br><span class="line">                        &#125;<span class="keyword">catch</span>(InterruptedException e)&#123;</span><br><span class="line">   e.printStackTrace();</span><br><span class="line">                        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;, <span class="string">&quot;t1&quot;</span>).start();</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="描述notify和notifyAll区别">描述notify和notifyAll区别</h3><p>嗯一般呢这个object里面当我调wait的时候它就会放到等待队列里面，当我去拿的时候，就会在wait列表里面，这个时候如果我调notify等待列表就是那个等待池里面就会随机唤醒一个线程来进入锁池竞争锁，如果我调notifyAll就会将该对象所有wait的线程唤醒。其中那个锁池就是等待获得该对象锁拥有权的线程们。</p><h4 id="如何唤醒线程？">如何唤醒线程？</h4><p>首先阻塞的然后可以被唤醒的线程，是调用任意对象的wait()，导致了线程阻塞进入等待队列等待被唤醒，阻塞的同时要释放该对象的锁，要唤醒就需要调用notify()或者notifyAll()，首先释放当前对象的锁，然后唤醒任意一个或者是全部线程到锁池直到线程获得当前对象的锁才能继续执行。还需要注意的是方法一定要放在同步方法或者同步方法块中，并且调用方法的对象一定和同步块或方法的对象是同一个，这样才能保证调用方法之前线程就已经获得了锁，这样才能执行线程的锁释放</p><h3 id="为什么三个方法要定义在object里？">为什么三个方法要定义在object里？</h3><p>等待和唤醒必须是同一个锁。而锁可以是任意对象，所以可以被任意对象调用的方法是定义在object类中。</p><h3 id="为什么三个方法要在同步方法或者代码块里面调用？">为什么三个方法要在同步方法或者代码块里面调用？</h3><p>因为三个方法都需要线程持有对象的锁，比如调wait()的时候这个线程必须拥有该对象的锁，接着他就释放这个锁进入等待状态直到其他线程调用这个对象的notify方法，同样notify呢，也是需要先释放对象的锁，这样其他线程才能来竞争锁；所以方法都是需要通过同步实现，进而必须。。。</p><h3 id="什么是线程同步？">什么是线程同步？</h3><p>当一个线程对共享的数据进行操作时，应使之成为一个&quot;原子操作&quot;， 即在没完成相关操作之前，不允许其他线程打断它，否则就会破坏数据的完整性，必然会得到错误的处理结果，这就是线程的同步</p><h3 id="同步方法和非同步方法可以同时调用吗？">同步方法和非同步方法可以同时调用吗？</h3><p>当然是可以的啊 当我有一个synchronized的m1方法，我调用m1的时候是可以调用m2的，因为线程访问m1的时候需要加锁，但是访问m2的时候又不需要加锁，所以允许执行m2。</p><p>模拟银行账户： 如果业务里面写方法加锁但是读方法没有加锁，这样就会容易产生脏读，但是如果业务允许，就可以，脏读过程就是没加锁的线程在没等你整个过程执行完就读到了你中间的结果产生的内存，解决办法就是将没有加锁的线程加上锁，会效率变低。</p><h4 id="什么是线程互斥？">什么是线程互斥？</h4><p>资源的固有特性 互斥 一个资源在同一时间只能由一个线程去调用</p><p>对于共享的进程系统资源，在单个线程访问时的排他性。就是当有若干个线程都要使用某一个资源的时候，任何时刻，都只允许一个线程来去使用，其他要使用该资源的线程必须等待，知道占用志愿者释放该资源。</p><h1>Synchronized</h1><h3 id="synchronized、volatile、CAS-比较">synchronized、volatile、CAS 比较</h3><p>（1）synchronized 是悲观锁，属于抢占式，会引起其他线程阻塞。</p><p>（2）volatile 提供多线程共享变量可见性和禁止指令重排序优化。</p><p>（3）CAS 是基于冲突检测的乐观锁（非阻塞）</p><h3 id="synchronized-和-ReentrantLock-区别是什么？">==synchronized 和 ReentrantLock 区别是什么？==</h3><p>synchronized 是和 if、else、for、while 一样的关键字，ReentrantLock 是类，这是二者的本质区别。既然 ReentrantLock 是类，那么它就提供了比synchronized 更多更灵活的特性，可以被继承、可以有方法、可以有各种各样的类变量</p><p>synchronized 早期的实现比较低效，对比 ReentrantLock，大多数场景性能都相差较大，但是在 Java 6 中对 synchronized 进行了非常多的改进。</p><p>==相同点：==</p><p><u>两者都是可重入锁两者都是可重入锁。“可重入锁”概念是：自己可以再次获取自己的内部锁。比如一个线程获得了某个对象的锁，此时这个对象锁还没有释放，当其再次想要获取这个对象的锁的时候还是可以获取的，如果不可锁重入的话，就会造成死锁。同一个线程每次获取锁，锁的计数器都自增1，所以要等到锁的计数器下降为0 时才能释放锁。</u></p><p>==不同点==</p><ul><li>ReentrantLock 使用起来比较灵活：1. 可以使用trylock来控制，如果抢不到线程也不会一定阻塞，2. 通过lockInterruptibly()可以响应interrupt()，可以被打断。但是必须有释放锁的配合动作；</li><li>ReentrantLock 必须手动获取与释放锁，而 synchronized 不需要手动释放和开启锁；</li><li>ReentrantLock 只适用于代码块锁，而 synchronized 可以修饰类、方法、变量等。</li><li>二者的锁机制其实也是不一样的。ReentrantLock 底层调用的是 Unsafe 的 park 方法加锁，synchronized 操作的应该是对象头中 markword</li></ul><h4 id="锁的是什么">锁的是什么?</h4><p>Java中每一个对象都可以作为锁，这是synchronized实现同步的基础: 普通同步方法，锁是当前实例对象；静态同步方法，锁是当前类的class对象；同步方法块，锁是括号里面的对象</p><h3 id="锁重入？">锁重入？</h3><img src="多线程/image-20220304231552625.png" alt="image-20220304231552625" style="zoom: 33%;" /><p>可重入的原理其实就是一个线程获得锁之后，可以重复得到该锁，底层就轻量级锁来说，其实就是在线程栈里面压入lockRecord然后有一个指向一个备份当前对象markword的指针，这个备份叫做displace markword（重入以后的hashword字段也在这里面），这里就是使用这个锁记录进行一个重入计数器的作用。</p><p>重量级锁：进入重量级锁，会分配一个objectmonitor对象，然后将锁标志置为‘10’，然后markword存储指向这个对象的指针。om对象有两个队列和一个指针，每个需要获取锁的线程都会进入队列被包装为这个对象，如果是多线程指向同一段代码时，objectwaiter就会进入队列，当某个线程抢到锁了也就是获得对象的监视器monitor了就进入owner区域，并把monitor中的owner变量设为当前线程同时monitor中的计数器count+1。（锁重入）</p><h3 id="Sych的锁升级的原理或者是过程？">==Sych的锁升级的原理或者是过程？==</h3><p>首先主要有四种锁状态分别是：无状态锁、偏向锁、轻量级锁和重量级锁（要去操作系统申请资源）</p><p>锁的升级的目的/背景：锁升级是为了减低了锁带来的性能消耗。在 Java 6 之后优化 synchronized 的实现方式，使用了偏向锁升级为轻量级锁再升级到重量级锁的方式，从而减低了锁带来的性能消耗。</p><img src="多线程/image-20220304103932619.png" alt="image-20220304103932619" style="zoom:50%;" /><img src="多线程/image-20220304232258996.png" alt="image-20220304232258996" style="zoom: 50%;" /><h4 id="详细锁升级过程：">详细锁升级过程：</h4><p>总：在锁对象的<strong>对象头</strong>里面有一个 threadID 字段，在第一次访问的时候 threadid 为空，jvm 让其持有偏向锁，并将 threadid 设置为其线程 id，再次进入的时候会先判断 threadid 是否与其线程 id 一致，如果一致则可以直接使用此对象，如果不一致，则升级偏向锁为轻量级锁，通过自旋循环一定次数来获取锁，执行一定次数之后，如果还没有正常获取到要使用的对象，此时就会把锁从轻量级升级为重量级锁，此过程就构成了 synchronized 锁的升级。</p><p>分：new对象之后先判断是否为可偏向状态，markword有两个字节作为锁标志：首先看是否是‘01’，然后mw前面还有一个字段来判断是否是已经拿到偏向锁‘1’表示偏向锁已启动，启动但是要判断锁线程是否是当前的线程id，如果是就开始执行代码块；但是不是的话，说明就有竞争了，这个时候cas操作去获取锁失败了的话，达到safepoint时获得偏向锁的线程就会被挂起，偏向锁会被撤销，然后<strong>升级为轻量级锁，这个时候被阻塞的线程再继续执行同步代码块。</strong></p><p>这部分有个细节就是<strong>轻度竞争就会升级为轻量级锁</strong>，如果是重度竞争（比如耗时过长、调用了wait方法等）就会直接升级为重量级锁，先讲轻量级锁：</p><p>升级为轻量级锁以后还是在<u>用户空间</u>里面进行，当前线程栈会划分一部分作为锁记录lock record，并且会将锁对象的markwor复制到锁记录中，接下来jvm会进行CAS操作将markword一部分更新为指向锁记录的指针（如下图），</p><img src="多线程/image-20220304234448327.png" alt="image-20220304234448327" style="zoom:33%;" /><p>如果成功就会将锁标志位设为‘00’，说明已经获得轻量级锁，这个时候就会进入<strong>锁重入</strong>阶段：（底下的锁重入有解释）</p><p>但是失败了就会检查当前锁对象的markword是否指向当前锁记录，如果没有就表示已经被其他线程抢了，这个时候就会进行自旋等待（默认是10次），等到此处如果超出阈值还是没有获得锁这个时候就会<strong>升级为重量级锁</strong></p><p>进入重量级锁，会分配一个objectmonitor对象，然后将锁标志置为‘10’，然后markword存储指向这个对象的指针。om对象有两个队列和一个指针，每个需要获取锁的线程都会进入队列被包装为这个对象，如果是多线程指向同一段代码时，objectwaiter就会进入队列，当某个线程抢到锁了也就是获得对象的监视器monitor了就进入owner区域，并把monitor中的owner变量设为当前线程同时monitor中的计数器count+1。（锁重入）</p><h3 id="什么时候用自旋锁和系统锁？-为什么有了自旋锁还要重量级锁？">什么时候用自旋锁和系统锁？/ 为什么有了自旋锁还要重量级锁？</h3><p>因为自旋锁是要占用CPU的，而系统锁是到等待队列里面，所以你，代码如果执行时间短，线程数少就用自旋，长线程数多，就用系统锁；</p><p>自旋也是要消耗cpu资源的如果锁的时间过长或者自旋线程过多，cpu就会被消耗； 而重量级锁又自己的等待队列，所有拿不到所有的进入等待队列，不需要消耗cpu资源。</p><h3 id="什么时候升级为重量级锁？">什么时候升级为重量级锁？</h3><p>竞争加剧，有线程超过10次自旋：<code>-xx:PreBlockSpin</code> ；或者是自旋线程数超过cpu核数的一半，1.6之后jvm有了自适应自旋Adapative-Self Spinning，是可以自己控制的自旋；</p><h3 id="偏向锁是否启动？">偏向锁是否启动？</h3><p>偏向锁有一个启动时间，我记得是四秒钟，当你new一个普通对象的时候，偏向锁没有启动，它默认就是无锁态；但是一开始new的时候如果已经启动了偏向锁，那么就是一个匿名偏向，锁对象的markword里的threadkid其实就是空的，等到你加了sychronized（这个对象），才会指向当前的这个线程了，treadid字段就会更新为当前线程了。</p><h1>Lock体系</h1><h3 id="Java-Concurrency-API-中的-Lock-接口-Lock-interface-是什么？对比同步它有什么优势？">Java Concurrency API 中的 Lock 接口(Lock interface)是什么？对比同步它有什么优势？</h3><p><u>ReentrantLock是lock的唯一子类。</u></p><p>Lock 接口比同步方法和同步块提供了更具扩展性的锁操作。他们允许更灵活的结构，可以具有完全不同的性质，并且可以支持多个相关类的条件对象。</p><p>它的优势有：</p><p>（1）  可以使锁更公平</p><p>（2）  可以使线程在等待锁的时候响应中断</p><p>（3）  可以让线程尝试获取锁，并在无法获取锁的时候立即返回或者等待一段时间</p><p>（4）  可以在不同的范围，以不同的顺序获取和释放锁</p><p>整体上来说 Lock 是 synchronized 的扩展版，Lock 提供了无条件的、可轮询的(tryLock 方法)、定时的(tryLock 带参方法)、可中断的(lockInterruptibly)、可多条件队列的(newCondition 方法)锁操作。另外 Lock 的实现类基本都支持非公平锁(默认)和公平锁，synchronized 只支持非公平锁，当然，在大部分情况下，非公平锁是高效的选择。</p><h3 id="实现一个阻塞队列？-使用Condition写生产者和消费者？">==实现一个阻塞队列？/ 使用Condition写生产者和消费者？==</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProviderConsumer</span>&lt;T&gt;&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> length;</span><br><span class="line">  <span class="keyword">private</span> Queue&lt;T&gt; queue; <span class="comment">// 产品队列</span></span><br><span class="line">  <span class="keyword">private</span> <span class="type">ReentrantLock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>(); <span class="comment">// 可重入锁</span></span><br><span class="line">  <span class="keyword">private</span> <span class="type">Condition</span> <span class="variable">providerCondition</span> <span class="operator">=</span> lock.newConditon();<span class="comment">// 生产者</span></span><br><span class="line">  <span class="keyword">private</span> <span class="type">Condition</span> <span class="variable">consumerCondition</span> <span class="operator">=</span> lock.newCondition();<span class="comment">// 消费者</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">ProviderConsumer</span><span class="params">(<span class="type">int</span> length)</span>&#123;<span class="comment">// 构造器一开始传入产品队列的长度</span></span><br><span class="line">    <span class="built_in">this</span>.length = length;</span><br><span class="line">    <span class="built_in">this</span>.queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;T&gt;();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  * 生产</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">provide</span><span class="params">(T product)</span>&#123;</span><br><span class="line">    lock.lock();</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      <span class="keyword">while</span>(queue.size() &gt;= length)&#123;<span class="comment">// 生产者队列等待</span></span><br><span class="line">        providerCondition.await();</span><br><span class="line">      &#125;</span><br><span class="line">      queue.add(product);</span><br><span class="line">      consumerCondition.signal();<span class="comment">// 提醒消费者队列；</span></span><br><span class="line">    &#125; <span class="keyword">catch</span>()&#123;</span><br><span class="line">      </span><br><span class="line">    &#125; <span class="keyword">finally</span>&#123;</span><br><span class="line">      lock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  * 消费</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">public</span> T <span class="title function_">consume</span><span class="params">()</span>&#123;</span><br><span class="line">    lock.lock;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      <span class="keyword">while</span>(queue.isEmpty())&#123;</span><br><span class="line">        consumerCondition.await();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="type">T</span> <span class="variable">product</span> <span class="operator">=</span> queue.remove();</span><br><span class="line">      provideCondition.signal();</span><br><span class="line">      <span class="keyword">return</span> product;</span><br><span class="line">    &#125; <span class="keyword">catch</span>()&#123;</span><br><span class="line">      </span><br><span class="line">    &#125; <span class="keyword">finally</span>&#123;</span><br><span class="line">      lock.unlock;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>AQS</h1><h2 id="AQS-原理分析">AQS 原理分析</h2><p>下面大部分内容其实在AQS类注释上已经给出了，不过是英语看着比较吃力一点，感兴趣的话可以看看源码。</p><h3 id="AQS-原理概览">AQS 原理概览</h3><p>AQS核心思想是，如果被请求的共享资源空闲，则将当前请求资源的线程设置为有效的工作线程，并且将共享资源设置为锁定状态。如果被请求的共享资源被占用，那么就需要一套线程阻塞等待以及被唤醒时锁分配的机制，这个机制AQS是用CLH队列锁实现的，即将暂时获取不到锁的线程加入到队列中。CLH(Craig,Landin,and Hagersten)队列是一个虚拟的双向队列（虚拟的双向队列即不存在队列实例，仅存在结点之间的关联关系）。AQS是将每条请求共享资源的线程封装成一个CLH锁队列的一个结点（Node）来实现锁的分配。</p><p>看个AQS(AbstractQueuedSynchronizer)原理图：</p><img src="多线程/image-20201109202131975.png" alt="image-20201109202131975" style="zoom: 67%;" /><h3 id="源码">源码</h3><p>AQS是一个构建锁和同步器的框架，最核心的是它的一个共享的int类型值叫做state，这个state用来干什么，其实主要是看他的子类是怎么实现的，比如ReentrantLock这个state，拿这个state来记录这个线程到底重入了多少次，比如说有一个线程拿到state这个把锁了，state的值就从0变成了1，这个线程又重入了一次，state就变成2了，又重入一次就变成3等等，释放的时候一次释放减一变成0就释放了。这个数代表了什么要看子类怎么去实现它，那么在这个state核心上还会有一堆的线程节点，当然这个节点是node，每个node里面包含一个线程，我们称为线程节点，这么多的线程节点去争用这个state，谁拿到了state，就表示谁得到了这把锁，AQS得核心就是一个共享的数据和一堆互相抢夺竞争的线程，这个就是AQS。</p><p>看reentrantlock源码里面:</p><p>在lock()方法里里面，我们可以读到它调用了sync.acquire(1)，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//JDK源码</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReentrantLock</span> <span class="keyword">implements</span> <span class="title class_">Lock</span>, java.io.Serializable &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lock</span><span class="params">()</span>&#123;</span><br><span class="line">        sync.acquire(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再跟进到acquire(1)里，可以看到acquire(1)里又调用了我们自己定义自己写的那个tryAcquire(arg)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//JDK源码</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractQueuedSynchronizer</span></span><br><span class="line">    <span class="keyword">extends</span> <span class="title class_">AbstractOwnableSynchronizer</span></span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">java</span>.io.Serializable &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">acquire</span><span class="params">(<span class="type">int</span> arg)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!tryAcquire(arg) </span><br><span class="line">           &amp;&amp; acquireQueued(addWaiter(Node.EXCLUSIVE),arg))</span><br><span class="line">        selfInterrupt();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>tryAquire(int)是使用者需要自定义同步器时要重写的模版方法：reentrantlock()里面的这个方法又调用了nofairTryAquire(int aquire)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//JDK源码</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReentrantLock</span> <span class="keyword">implements</span> <span class="title class_">Lock</span>, java.io.Serializable &#123;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lock</span><span class="params">()</span>&#123;</span><br><span class="line">        sync.acquire(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> NonfairSync <span class="keyword">extends</span> <span class="title class_">Sync</span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">tryAcquire</span><span class="params">(<span class="type">int</span> acquire)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> nonfairTrytAcquire(acquires);</span><br><span class="line">   &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">nonfairTrytAcquire</span><span class="params">(<span class="type">int</span> acquire)</span>&#123;</span><br><span class="line">         <span class="comment">//获取当前线程</span></span><br><span class="line"><span class="keyword">final</span> <span class="type">Thread</span> <span class="variable">current</span> <span class="operator">=</span> Thread.currentThread();</span><br><span class="line">        <span class="comment">//拿到AQS核心数值state</span></span><br><span class="line">         <span class="type">int</span> c <span class="title function_">getState</span><span class="params">()</span>;</span><br><span class="line">        <span class="comment">//如果数值为0说明没人上锁</span></span><br><span class="line">         <span class="keyword">if</span>(c == <span class="number">0</span>)&#123;</span><br><span class="line">             <span class="comment">//给当线程上锁</span></span><br><span class="line"><span class="keyword">if</span>(compareAndSetState(<span class="number">0</span>,acquires))&#123;</span><br><span class="line">                <span class="comment">//设置当前线程为独一无二拥有这把锁的线程</span></span><br><span class="line">    setExclusiveOwnerThread(current);</span><br><span class="line">                 <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">        <span class="comment">//判断当前线程是否拥有这个把锁</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(current == getExclusiveOwnerThread)&#123;</span><br><span class="line">            <span class="comment">//设置重入</span></span><br><span class="line"><span class="type">int</span> <span class="variable">nextc</span> <span class="operator">=</span> c + acquires;</span><br><span class="line">             <span class="keyword">if</span>(nextc &lt; <span class="number">0</span>)</span><br><span class="line">                 <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Maximum lock count wxceeded&quot;</span>);</span><br><span class="line">             setState(nextc);</span><br><span class="line">             <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">         &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>nonfairTrytAcquire(acquires)我们读进去会发现它的里面就调用到了state这个值，首先拿到当前线程，拿到state的值，然后进行if判断，如果state的值为0，说明没人上锁，没人上锁怎么办呢？就给自己上锁，当前线程就拿到这把锁，拿到这个把锁的操作用到了CAS(compareAndSetState)的操作，从0让他变成1，state的值设置为1以后，设置当前线程是独一无二的拥有这把锁的线程，否则如果当前线程已经占有这把锁了，怎么办？很简单我们在原来的基础上加1就可以了，这样就能拿到这把锁了，就重入，前者是加锁后者是重入</p><h4 id="state状态变量">state状态变量</h4><p>AQS使用一个int成员变量来表示同步状态，通过内置的FIFO队列来完成获取资源线程的排队工作。AQS使用CAS对该同步状态进行原子操作实现对其值的修改。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">private volatile int state;//共享变量，使用volatile修饰保证线程可见性</span><br></pre></td></tr></table></figure><p>状态信息通过protected类型的getState，setState，compareAndSetState进行操作</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="comment">//返回同步状态的当前值</span></span><br><span class="line"><span class="number">2</span><span class="keyword">protected</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">getState</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="number">3</span><span class="keyword">return</span> state;</span><br><span class="line"><span class="number">4</span>&#125;</span><br><span class="line"><span class="number">5</span><span class="comment">// 设置同步状态的值</span></span><br><span class="line"><span class="number">6</span><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">setState</span><span class="params">(<span class="type">int</span> newState)</span> &#123;</span><br><span class="line"><span class="number">7</span>state = newState;</span><br><span class="line"><span class="number">8</span>&#125;</span><br><span class="line"><span class="number">9</span><span class="comment">//原子地（CAS操作）将同步状态值设置为给定值update如果当前同步状态的值等于expect （期望值）</span></span><br><span class="line"><span class="number">10</span><span class="keyword">protected</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">compareAndSetState</span><span class="params">(<span class="type">int</span> expect, <span class="type">int</span> update)</span> &#123; </span><br><span class="line"><span class="number">11</span> <span class="keyword">return</span> unsafe.compareAndSwapInt(<span class="built_in">this</span>, stateOffset, expect, update);</span><br><span class="line"><span class="number">12</span> &#125;</span><br></pre></td></tr></table></figure><h4 id="AQS队列">AQS队列</h4><p><strong>如果没有tryAquire() 到state呢</strong>，那么就进行aquireQueue()方法，里面会调用addwaiter()这个方法，线程添加进入队列里面，具体操作也是通过cas进行添加的，方法是compareAndAetTail(oldTail,node)，oldTail是它的预期值，假如说我们想把当前线程设置为整个链表尾巴的过程中，另外一个线程来了，它插入了一个节点，那么仔细想一下Node oldTail = tail;的整个oldTail还等于整个新的Tail吗？不等于了吧，那么既然不等于了，说明中间有线程被其它线程打断了，那如果说却是还是等于原来的oldTail，这个时候就说明没有线程被打断，那我们就接着设置尾巴，只要设置成功了OK，compareAndAetTail(oldTail,node)方法中的参数node就做为新的Tail了，所以用了CAS操作就不需要把原来的整个链表上锁，这也是AQS在效率上比较高的核心。</p><img src="多线程/image-20220308201744929.png" alt="image-20220308201744929" style="zoom:50%;" /><h2 id="资源的共享方式">资源的共享方式</h2><p>AQS定义两种资源共享方式</p><ul><li><p>Exclusive（独占）：只有一个线程能执行，如ReentrantLock。又可分为公平锁和非公平锁：</p><p>公平锁：按照线程在队列中的排队顺序，先到者先拿到锁</p><p>非公平锁：当线程要获取锁时，无视队列顺序直接去抢锁，谁抢到就是谁的</p></li><li><p>Share（共享）：多个线程可同时执行。Semaphore、CountDownLatch、 CyclicBarrier、ReadWriteLock 我们都会在后面讲到。ReentrantReadWriteLock 可以看成是组合式，因为ReentrantReadWriteLock也就是读写锁允许多个线程同时对某一资源进行读。不同的自定义同步器争用共享资源的方式也不同。自定义同步器在实现时只需要实现共享资源 state 的获取与释放方式即可，至于具体线程等待队列的维护（如获取资源失败入队/唤醒出队等），AQS已经在顶层实现好了。</p></li></ul><h2 id="模版方法">模版方法</h2><p>AQS使用了模板方法模式，自定义同步器时需要重写下面几个AQS提供的模板方法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1isHeldExclusively()//该线程是否正在独占资源。只有用到condition才需要去实现它。</span><br><span class="line">2tryAcquire(int)//独占方式。尝试获取资源，成功则返回true，失败则返回false。</span><br><span class="line">3tryRelease(int)//独占方式。尝试释放资源，成功则返回true，失败则返回false。</span><br><span class="line">4tryAcquireShared(int)//共享方式。尝试获取资源。负数表示失败；0表示成功，但没有剩余可用资源；正数表示成功，且有剩余资源。</span><br><span class="line">5tryReleaseShared(int)//共享方式。尝试释放资源，成功则返回true，失败则返回false。</span><br></pre></td></tr></table></figure><p>默认情况下，每个方法都抛出 UnsupportedOperationException。 这些方法的实现必须是内部线程安全的，并且通常应该简短而不是阻塞。AQS类中的其他方法都是final ，所以无法被其他类使用，只有这几个方法可以被其他类使用。以ReentrantLock为例，state初始化为0，表示未锁定状态。A线程lock()时，会调用tryAcquire()独占该锁并将state+1。此后，其他线程再tryAcquire()时就会失败，直到A线程unlock()到state=0（即释放锁）为止，其它线程才有机会获取该锁。当然，释放锁之前，A线程自己是可以重复获取此锁的（state会累加），这就是可重入的概念。但要注意，获取多少次就要释放多么次，这样才能保证state是能回到零态的。</p><p>再以CountDownLatch以例，任务分为N个子线程去执行，state也初始化为N（注意N要与线程个数一致）。这N个子线程是并行执行的，每个子线程执行完后countDown()一次，state会CAS(Compare and Swap)减1。等到所有子线程都执行完后(即state=0)，会unpark()主调用线程，然后主调用线程就会从 await()函数返回，继续后余动作。</p><p>一般来说，自定义同步器要么是独占方法，要么是共享方式，他们也只需实现 tryAcquire-tryRelease、tryAcquireShared-tryReleaseShared中的一种即可。但AQS 也支持自定义同步器同时实现独占和共享两种方式，如ReentrantReadWriteLock。主要是高16位存储互斥锁的状态，高16位存储共享锁的状态。</p><h2 id="并发工具类">并发工具类</h2><h3 id="CountDownLatch-倒计时器-：">CountDownLatch(倒计时器)：</h3><p>CountDownLatch是一个同步工具类，用来协调多个线程之间的同步。这个工具通常用来控制线程等待，它可以让某一个线程等待直到倒计时结束，再开始执行。</p><h4 id="用法？">用法？</h4><ol><li>让主线程await()， 主线程在开始运行前等待n个业务线程执行完毕。将CountDownLatch的计数器初始化为new CountDownLatch(n)，每当一个任务线程执行完毕，就将计数器减1 countdownLatch.countDown()，当计数器的值变为0时，在CountDownLatch上await()的线程就会被唤醒。一个典型应用场景就是启动一个服务时，主线程需要等待多个组件加载完毕，之后再继续执行。</li><li>让业务线程await()，主线程处理完数据之后进行countDownLatch.countDown(),此时业务线程被唤醒，然后去主线程拿数据，或者执行自己的业务逻辑，这样实现多个线程开始执行任务的最大并行性，</li></ol><h3 id="CyclicBarrier-循环栅栏-：">CyclicBarrier(循环栅栏)：</h3><p>CyclicBarrier 和 CountDownLatch 非常类似，它也可以实现线程间的技术等待，但是它的功能比 CountDownLatch 更加复杂和强大。主要应用场景和 CountDownLatch 类似。CyclicBarrier 的字面意思是可循环使用（Cyclic）的屏障（Barrier）。它要做的事情是，让一组线程到达一个屏障（也可以叫同步点）时被阻塞，直到最后一个线程到达屏障时，屏障才会开门，所有被屏障拦截的线程才会继续干活。</p><p>CyclicBarrier默认的构造方法是 CyclicBarrier(int parties)，其参数表示屏障拦截的线程数量，每个线程调用await()方法告诉CyclicBarrier 我已经到达了屏障，然后当前线程被阻塞。</p><h3 id="Semaphore-信号量-允许多个线程同时访问：">Semaphore(信号量)-允许多个线程同时访问：</h3><p>synchronized 和ReentrantLock 都是一次只允许一个线程访问某个资源，Semaphore(信号量)可以指定多个线程同时访问某个资源。</p><p>Semaphore 就是一个信号量，它的作用是限制某段代码块的并发数。</p><p>Semaphore有一个构造函数，可以传入一个 int 型整数 n，表示某段代码 多只有 n 个线程可以访问，如果超出了 n，那么请等待，等到某个线程执行完毕这段代码块，下一个线程再进入。由此可以看出如果 Semaphore 构造函数中传入的 int 型整数 n=1，相当于变成了一个 synchronized 了。</p><h3 id="Exchange-线程见交换数据的工具">Exchange(线程见交换数据的工具)</h3><p>Exchanger是一个用于线程间协作的工具类，**用于两个线程间交换数据。**它提供了一个交换的同步点，在这个同步点两个线程能够交换数据。交换数据是通过 exchange方法来实现的，如果一个线程先执行exchange方法，那么它会同步等待另一个线程也执行exchange方法，这个时候两个线程就都达到了同步点，两个线程就可以交换数据。</p><h3 id="ReadWriteLock">ReadWriteLock</h3><p><strong>实现这个接口是ReentrantReadWriteLock， 这个接口是一个读写锁接口，主要就是实现了读写分离，写锁是独占锁，读锁是共享锁，实现了读读之间不会互斥，但是读写和写写之间的互斥，提高了读写效率。还实现了锁降级，写锁可以降级为读锁。</strong></p><p>首先明确一下，不是说 ReentrantLock 不好，只是 ReentrantLock 某些时候有局限。如果使用 ReentrantLock，可能本身是为了防止线程 A 在写数据、线程 B 在读数据造成的数据不一致，但这样，如果线程 C 在读数据、线程 D 也在读数据，读数据是不会改变数据的，没有必要加锁，但是还是加锁了，降低了程序的性能。因为这个，才诞生了读写锁 ReadWriteLock。</p><p>ReadWriteLock 是一个读写锁接口，读写锁是用来提升并发程序性能的锁分离技术，ReentrantReadWriteLock 是 ReadWriteLock 接口的一个具体实现，实现了读写的分离，读锁是共享的，写锁是独占的，读和读之间不会互斥，读和写、写和读、写和写之间才会互斥，提升了读写的性能。</p><p>而读写锁有以下三个重要的特性：</p><p>（1）  公平选择性：支持非公平（默认）和公平的锁获取方式，吞吐量还是非公平优于公平。</p><p>（2）  重进入：读锁和写锁都支持线程重进入。</p><p>（3）  锁降级：遵循获取写锁、获取读锁再释放写锁的次序，写锁能够降级成为读锁。</p><h1>ThreadLocal</h1><h2 id="原理">原理</h2><p>ThreadLocal源码的set方法，ThreadLocal往里边设置值的时候是怎么设置的呢？首先拿到当前线程，这是你会发现，这个set方法里多了一个容器ThreadLocalMap，这个容器是一个map，是一个key/value对，其实这个值是设置到了map里面，key设置的是this，value设置的是我们想要的那个值，这个this就是当前对象ThreadLocal，value就是Person类，如果map不等于空的情况下就设置进去就行了，如果等于空呢？就创建一个map</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ThraedLocal源码</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadLocal</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(T value)</span> &#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> Thread.currentThread();</span><br><span class="line">        <span class="type">ThreadLocalMap</span> <span class="variable">map</span> <span class="operator">=</span> getMap(t);</span><br><span class="line">        <span class="keyword">if</span> (map != <span class="literal">null</span>)</span><br><span class="line">            map.set(<span class="built_in">this</span>, value);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            createMap(t, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们回过头来看这个map，ThreadLocalMap map=getMap(t)，我们来看看这个map到底在哪里，我们点击到了getMap这个方法看到，它的返回值是t.threadLocals</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ThreadLocal源码</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadLocal</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(T value)</span> &#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> Thread.currentThread();</span><br><span class="line">        <span class="type">ThreadLocalMap</span> <span class="variable">map</span> <span class="operator">=</span> getMap(t);</span><br><span class="line">        <span class="keyword">if</span> (map != <span class="literal">null</span>)</span><br><span class="line">            map.set(<span class="built_in">this</span>, value);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            createMap(t, value);</span><br><span class="line">    &#125;</span><br><span class="line">    ThreadLocalMap <span class="title function_">getMap</span><span class="params">(Thread t)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> t.threadLocals;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们进入这个t.threadLocals，你会发现ThreadLocalMap这个东西在哪里呢？居然是在Thread这个类里，所以说这个map是在Thred类里的</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Thread</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span>&#123;</span><br><span class="line">ThreadLocal.<span class="type">ThreadLocalMap</span> <span class="variable">threadLocals</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个时候我们应该明白，map的set方法其实就是设置当前线程里面的map：</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">·set</span><br><span class="line">- Thread.currentThread.map(ThreadLocal,person)</span><br></pre></td></tr></table></figure><p>所以这个时候你会发现，原来Person类被set到了，当前线程里的某一个map里面去了，这个时候，我们是不是就能想明白了，我set了一个值以后，为什么其他线程访问不到？我们注重“当前线程”这个段话，所以个t1线程set了一个Person对象到自己的map里，t2线程去访问的也是自己的属于t2线程的map，所以是读不到值的，因此你使用ThreadLocal的时候，你用set和get就完全的把他隔离开了，就是我自己线程里面所特有的，其它的线程是没有的，以前我们的理解是都在一个map，然而并不是，所以你得读源码，读源码你就明白了</p><h2 id="用途">用途</h2><p>声明式的事务保证同一个connetion</p><p>我们根据Spirng的声明式事务来解析，为什么要用ThreadLocal，声明式事务一般来讲我们是要通过数据库的，但是我们知道Spring结合Mybatis，我们是可以把整个事务写在配置文件中的，而这个配置文件里的事务，它实际上是管理了一系列的方法，方法1、方法2、方法3…，而这些方法里面可能写了，比方说第1个方法写了去配置文件里拿到数据库连接Connection，第2个、第3个都是一样去拿数据库连接，然后声明式事务可以把这几个方法合在一起，视为一个完整的事务，如果说在这些方法里，每一个方法拿的连接，它拿的不是同一个对象，你觉的这个东西能形成一个完整的事务吗？Connection会放到一个连接池里边，如果第1个方法拿的是第1个Connection，第2个拿的是第2个，第3个拿的是第3个，这东西能形成一个完整的事务吗？百分之一万的不可能，没听说过不同的Connection还能形成一个完整的事务的，那么怎么保证这么多Connection之间保证是同一个Connection呢？把这个Connection放到这个线程的本地对象里ThreadLocal里面，以后再拿的时候，实际上我是从ThreadLocal里拿的，第1个方法拿的时候就把Connection放到ThreadLocal里面，后面的方法要拿的时候，从ThreadLocal里直接拿，不从线程池拿。</p><h2 id="四种引用">四种引用</h2><h3 id="引用是什么？">引用是什么？</h3><p>就是一个变量值指向一个对象</p><h3 id="强引用normalReference">强引用normalReference</h3><p>普通的引用比如Object o = new Object()，这个就叫强引用; 特点就是说，只要有一个应用指向这个对象，那么垃圾回收器一定不会回收它，这就是普通的引用，也就是强引用。因为有引用指向，所以不会回收，只有没有引用指向的时候才会回收，指向谁？指向你创建的那个对象。</p><h3 id="弱引用softReference">弱引用softReference</h3><p>当有一个对象(字节数组)被一个软引用所指向的时候，只有系统内存不够用的时候，才会回收它(字节数组)</p><h3 id="虚引用">虚引用</h3><h4 id="在threadlocal的应用-内存泄露">==在threadlocal的应用 / 内存泄露==</h4><img src="多线程/image-20220310175800308.png" alt="image-20220310175800308" style="zoom:60%;" /><p>我们来看图中从左开始看，这时候我们应该明白了，这里tl是一个强引用指向这个ThreadLocal对象，而Map里的key是通过一个弱引用指向了一个ThreadLocal对象，我们假设这是个强引用，当tl指向这个ThreadLocal对象消失的时候，tl这个东西是个局部变量，方法已结束它就消失了，当tl消失了，如果这个ThreadLocal对象还被一个强引用的key指向的时候，这个ThreadLocal对象不能被回收，而且由于这个线程有很多线程是长期存在的，比如这个是一个服务器线程，7*24小时一年365天不间断运行，那么不间断运行的时候，这个tl会长期存在，这个Map会长期存在，这个Map的key也会长期存在，这个key长期存在的话，这个ThreadLocal对象永远不会被消失，所以这里是不是就会有内存泄漏，但是如果这个key是弱引用的话还会存在这个问题吗？当这个强引用消失的时候这个弱引用是不是自动就会回收了，这也是为什么用WeakReference的原因</p><p>关于ThreadLocal还有一个问题，当我们tl这个强引用消失了，key的指向也被回收了，可是很不幸的是这个key指向了一个null值，但是这个threadLocals的Map是永远存在的，相当于说key/value对，你这个key是null的，你这个value指向的东西，你的这个10MB的字节码，你还能访问到吗？访问不到了，如果这个Map越积攒越多，越来越多，它还是会内存泄漏，怎么办呢？所以必须记住这一点，使用ThreadLocal里面的对象不用了，务必要remove掉，不然还会有内存泄漏</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ThradLocalM&gt; tl = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line">tl.set(<span class="keyword">new</span> <span class="title class_">M</span>());</span><br><span class="line">tl.remove();</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>JUC同步容器</h1><h2 id="ConcurrentHashMap">ConcurrentHashMap</h2><p>集合部分</p><p>我们来看这个经常在多线程的情况下使用的这些个容器 ，从Map开始讲，Map经常用的有这么几个</p><ul><li><p>ConcurrentHashMap用hash表实现的这样一个高并发容器；</p><p>既然有了ConcurrentHashMap正常情况下就应该有ConcurrentTreeMap，你可以去查查，它没有，就等于缺了一块，为什么没有呢，原因就是ConcurrentHashMap里面用的是cas操作，这个cas操作它用在tree的时候，用在树这个节点上的时候实现起来太复杂了，所以就没有这个ConcurrentTreeMap，但是有时间也需要这样一个排好序的Map，那就有了ConcurrentSkipListMap跳表结构就出现了。</p></li><li><p>ConcurrentSkipListMap通过跳表来实现的高并发容器并且这个Map是有排序的；</p><img src="多线程/06_02.jpg" alt="06_02" style="zoom:67%;" /><p>跳表是什么样的结构呢？底层本身存储的元素一个链表，它是排好顺序的，大家知道当一个链表排好顺序的时候往里插入是特别困难的，查找的时候也特别麻烦，因为你得从头去遍历查找这个元素到底在哪里，所以就出现了这个跳表的结构，底层是一个链表，链表查找的时候比较困难怎么办，那么我们在这些链表的基础上在拿出一些关键元素来，在上面做一层，那这个关键元素的这一层也是一个链表，那这个数量特别大的话在这个基础之上在拿一层出来再做一个链表，每层链表的数据越来越少，而且它是分层，在我们查找的时候从顶层往下开始查找，所以呢，查找容易了很多，同时它无锁的实现难度比TreeMap又容易很多，因此在JUC里面提供了ConcurrentSkipListMap这个类。</p></li></ul><p>他们两个的区别一个是有序的一个是无序的，同时都支持并发的操作。下面这个小程序是一个效率的测试其实也没多大意义，大家可以去写一下跑跑。</p><h2 id="CopyOnWriteArrayList">CopyOnWriteArrayList</h2><h3 id="CopyOnWriteArrayList-是什么，可以用于什么应用场景？有哪些优缺点？">CopyOnWriteArrayList 是什么，可以用于什么应用场景？有哪些优缺点？</h3><p>CopyOnWriteArrayList 是一个并发容器。有很多人称它是线程安全的，我认为这句话不严谨，缺少一个前提条件，那就是非复合场景下操作它是线程安全的。</p><p>CopyOnWriteArrayList(免锁容器)的好处之一是当多个迭代器同时遍历和修改这个列表时，不会抛出 ConcurrentModificationException。在CopyOnWriteArrayList 中，写入将导致创建整个底层数组的副本，而源数组将保留在原地，使得复制的数组在被修改时，读取操作可以安全地执行。</p><p>CopyOnWriteArrayList 的使用场景通过源码分析，我们看出它的优缺点比较明显，所以使用场景也就比较明显。就是合适读多写少的场景。</p><p>CopyOnWriteArrayList 的缺点</p><ol><li><p>由于写操作的时候，需要拷贝数组，会消耗内存，如果原数组的内容比较多的情况下，可能导致 young gc 或者 full gc。</p></li><li><p>不能用于实时读的场景，像拷贝数组、新增元素都需要时间，所以调用一个 set 操作后，读取到数据可能还是旧的，虽然CopyOnWriteArrayList 能做到始终一致性,但是还是没法满足实时性要求。</p></li><li><p>由于实际使用中可能没法保证 CopyOnWriteArrayList 到底要放置多少数据，万一数据稍微有点多，每次 add/set 都要重新复制数组，这个代价实在太高昂了。在高性能的互联网应用中，这种操作分分钟引起故障。</p></li></ol><p>CopyOnWriteArrayList 的设计思想</p><ol><li>读写分离，读和写分开</li><li>终一致性</li><li>使用另外开辟空间的思路，来解决并发冲突</li></ol><h2 id="BlockingQueue">BlockingQueue</h2><h3 id="ArrayBlockingQueue"><strong>ArrayBlockingQueue</strong></h3><p>ArrayBlockingQueue是有界的，你可以指定它一个固定的值10，它容器就是10，那么当你往里面扔容器的时候，一旦他满了这个put方法就会阻塞住。然后你可以看看用add方法满了之后他会报异常。offer用返回值来判断到底加没加成功，offer还有另外一个写法你可以指定一个时间尝试着往里面加1秒钟，1秒钟之后如果加不进去它就返回了。</p><p>回到那个面试经常被问到的问题，Queue和List的区别到底在哪里，主要就在这里，添加了offer、peek、poll、put、take这些个对线程友好的或者阻塞，或者等待方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mashibing.juc.c_025;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.BlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">T06_ArrayBlockingQueue</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">static</span> BlockingQueue&lt;String&gt; strs = <span class="keyword">new</span> <span class="title class_">ArrayBlockingQueue</span>&lt;&gt;(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">static</span> <span class="type">Random</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">         strs.put(<span class="string">&quot;a&quot;</span> + i);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">//strs.put(&quot;aaa&quot;); //满了就会等待，程序阻塞</span></span><br><span class="line">      <span class="comment">//strs.add(&quot;aaa&quot;);</span></span><br><span class="line">      <span class="comment">//strs.offer(&quot;aaa&quot;);</span></span><br><span class="line">      strs.offer(<span class="string">&quot;aaa&quot;</span>, <span class="number">1</span>, TimeUnit.SECONDS);</span><br><span class="line">      </span><br><span class="line">      System.out.println(strs);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Queue和List的区别">Queue和List的区别</h3><p>区别主要就是Queue添加了许多对线程友好的API offer、peek、poll，他的一个子类型叫BlockingQueue对线程友好的API又添加了put和take，这两个实现了阻塞操作。</p><h1>线程池</h1><img src="多线程/image-20220314163745382.png" alt="image-20220314163745382" style="zoom:50%;" /><h2 id="Executor-线程的工厂">Executor(线程的工厂</h2><h3 id="newSingleThreadPool">newSingleThreadPool</h3><p>这个线程池里面只有一个线程，这个一个线程的线程池可以保证我们扔进去的任务是顺序执行的。为什么会有单线程的线程池？第一个线程池是有任务队列的；生命周期管理线程池是能帮你提供的。</p><h3 id="newCachedThreadPool没上限">newCachedThreadPool没上限</h3><p>来一个新的任务就必须马上执行，没有线程空着我就new一个线程。那么阿里是不会推荐使用这中线程池的，原因是线程会启动的特别多，基本接近于没有上限的。</p><h3 id="newFixedThreadPool-固定的">newFixedThreadPool 固定的</h3><p>指定一个参数，到底有多少个线程，他的核心线程和最大线程都是固定的，因为他的最大线程和核心线程都是固定的就没有回收之说所以把他指定成0，这里用的是LinkedBlockingQueue</p><h3 id="newScheduledThreadPool定时任务">newScheduledThreadPool定时任务</h3><p>这是专门给定时任务用的这样的一个线程池，了解就可以了。</p><h2 id="ThreadPoolExecutor">ThreadPoolExecutor</h2><h3 id="1-状态">1. 状态</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4. 线程池有5种状态，按大小排序如下：RUNNING &lt; SHUTDOWN &lt; STOP &lt; TIDYING &lt; TERMINATED</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">RUNNING</span>    <span class="operator">=</span> -<span class="number">1</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SHUTDOWN</span>   <span class="operator">=</span>  <span class="number">0</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">STOP</span>       <span class="operator">=</span>  <span class="number">1</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">TIDYING</span>    <span class="operator">=</span>  <span class="number">2</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">TERMINATED</span> <span class="operator">=</span>  <span class="number">3</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>RUNNING：正常运行的；</p><p>SHUTDOWN：调用了shutdown方法了进入了shutdown状态；</p><p>STOP：调用了shutdownnow马上让他停止；</p><p>TIDYING：调用了shutdown然后这个线程也执行完了，现在正在整理的这个过程叫TIDYING；</p><p>TERMINATED：整个线程全部结束；</p><img src="多线程/image-20220314162532547.png" alt="image-20220314162532547" style="zoom:50%;" /><p>⚠️多线程的生命周期和线程的生命周期</p><h3 id="2-构造方法参数">2. 构造方法参数</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">ThreadPoolExecutor</span><span class="params">(<span class="type">int</span> corePoolSize,</span></span><br><span class="line"><span class="params">                          <span class="type">int</span> maximumPoolSize,</span></span><br><span class="line"><span class="params">                          <span class="type">long</span> keepAliveTime,</span></span><br><span class="line"><span class="params">                          TimeUnit unit,</span></span><br><span class="line"><span class="params">                          BlockingQueue&lt;Runnable&gt; workQueue,</span></span><br><span class="line"><span class="params">                          ThreadFactory threadFactory,</span></span><br><span class="line"><span class="params">                          RejectedExecutionHandler handler)</span> &#123;</span><br><span class="line">    <span class="comment">// 基本类型参数校验</span></span><br><span class="line">    <span class="keyword">if</span> (corePoolSize &lt; <span class="number">0</span> ||</span><br><span class="line">        maximumPoolSize &lt;= <span class="number">0</span> ||</span><br><span class="line">        maximumPoolSize &lt; corePoolSize ||</span><br><span class="line">        keepAliveTime &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>();</span><br><span class="line">    <span class="comment">// 空指针校验</span></span><br><span class="line">    <span class="keyword">if</span> (workQueue == <span class="literal">null</span> || threadFactory == <span class="literal">null</span> || handler == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line">    <span class="built_in">this</span>.corePoolSize = corePoolSize;</span><br><span class="line">    <span class="built_in">this</span>.maximumPoolSize = maximumPoolSize;</span><br><span class="line">    <span class="built_in">this</span>.workQueue = workQueue;</span><br><span class="line">    <span class="comment">// 根据传入参数`unit`和`keepAliveTime`，将存活时间转换为纳秒存到变量`keepAliveTime `中</span></span><br><span class="line">    <span class="built_in">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);</span><br><span class="line">    <span class="built_in">this</span>.threadFactory = threadFactory;</span><br><span class="line">    <span class="built_in">this</span>.handler = handler;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>corePoolSize核心线程数</p><p>maximumPS最大线程数</p><p>keepAliveTime销毁之前等待的时间</p><p>TimeUnit时间单位</p><p>BlockingQueue任务队列<br>LinkedBQ<br>ArrayBQ<br>SynchronousBQ</p><p>ThreadFactory线程工厂</p><p>RejectStrategy拒绝策略<br>Abort抛异常<br>Discard扔掉<br>DiscardOldest<br>CallerRuns</p><h3 id="3-execute-调度任务">3. execute()调度任务</h3><p>execute执行任务的时候判断任务等于空抛异常，这个很简单，接下来就是拿状态值，拿到值之后计算这个值里面的线程数，活着的那些线程数是不是小于核心线程数，如果小于addWorker添加一个线程，addWorker是比较难的一个方法，他的第二个参数指的是，是不是核心线程，所有上来之后如果核心数不够先添加核心线程，再次检查这个值。我们原来讲过这个线程里面上来之后刚开始为0，来一个任务启动一个核心线程，第二个就是核心线程数满了之后，放到队列里。最后核心线程满了，队列也满了，启动非核心线程。小于线程数就直接加，后面执行的逻辑就是不小于了，不小于就是超过核心线程数了直接往里扔，workQueue.offer就是把他扔进去队列里，再检查状态。在这中间可能会被改变状态值，因此需要双重检查，这个跟我们之前聊过的单例模式里面的DC是一样的逻辑。isRunning，重新又拿这个状态，拿到这个状态之后这里是要进行一个状态切换的，如果不是Running状态说明执行过shutdown命令，才会把这个Running转换成别的状态，其他情况下workerCountOf如果等于0说明里面没有线程了，没有线程我线程池正常运行就添加非核心线程。这些步骤都是通过源码可以看出来的。如果添加work本身都不行就reject把他给拒绝掉。</p><img src="多线程/image-20220313141951366.png" alt="image-20220313141951366" style="zoom:50%;" /><ol><li><p>核心线程不够，启动核心的</p></li><li><p>core够了就加队列</p></li><li><p>核心和队列都够了，就非核心</p></li></ol><h3 id="4-addWorker-—-runWorker">4. addWorker()—&gt;runWorker()</h3><ol><li><p>addWorker() 就做了两步，使用lock()和自旋做的</p><ol><li>count++</li><li>加进任务并且start</li></ol></li><li><p>runWorker()是真正执行线程的部分</p></li></ol><h4 id="work类">work类</h4><p>这个work他本身是Runnable同时又是AQS。这个work类里面会记录着一个成员变量，这个成员变量是thread，很多个线程worker，这个就是为什么要用AQS的原因。另外呢，在你整个执行的过程之中你也需要加锁，不然的话你别的线程进来，因此AQS是需要的。这是这个work类，简单的你就可以把它当成线程类，然后这个线程类执行的是你自己的任务就行了。</p><h3 id="submit-和execute-区别">submit()和execute()区别</h3><p>Callable实现了Future接口，比runnable多了返回值并且可以抛出异常，然后这个Future是用来存储执行的线程将来才产生的结果，callable为线程池设计，配合future使用，有返回值，实现了任务交给线程池，未来要结果时再get返回。</p><p>FutureTask是继承了RunnableFuture接口和Future接口，既是一个任务又是一个Future。在ForkJoinPool 这类线程池里面用，这类线程池是每个线程都有一个阻塞队列。</p><h1>杂问题</h1><h2 id="1-怎么预防死锁？">1. 怎么预防死锁？</h2><p>答：首先我们要知道产生死锁的四个必要条件：第一个，资源在同一时间只能有一个线程来占用，这个也就是互斥条件；第二个，不可剥夺条件，当一个线程已经占有一个资源在释放之前是不会让其他线程抢占；在有就是线程等待的过程中不会释放自己持有的资源，也就是请求和保持条件；第四个条件就是循环等待条件 ，多个线程在互相等待对方释放资源；有了这四个条件当多个线程都持有对方想要的资源却等待对方释放资源的状态就造成了死锁；</p><p>​      所以预防死锁就需要从这四个方面入手，第一个资源互斥因为是资源固有属性不能破坏这个条件；我们去破坏第二个不可剥夺条件，可以让进程在等待过程中将其占有的资源隐性释放到系统的资源列表中，而等待的进程只有重新获得自己原有的资源和新申请的资源才能启动执行；破坏第三个请求和保持条件可以使用静态分配和动态分配两种方法；静态分配就是在每一个进程开始执行时就申请他需要的资源；动态分配就是在申请资源的时候他本身不能占用系统资源；最后就是破坏循环等待条件，将系统中的所有资源顺序编号，紧缺资源用大编号，进程在申请资源的时候必须按照编号的顺序执行。嗯，我认为就从这四个方面去着手，谢谢。</p><h2 id="2-线程创建方式和生命周期">2. 线程创建方式和生命周期</h2><p>有五种方式，第一种方法就是继承thread类，重写run()，调用start开启线程；第二种实现runnable接口，重写run()，实现接口比继承类要灵活；第三种是使用lamda表达式，本质是一样；第四种是实现callable接口执行call()，这种方法相对runnable不同就是执行完毕有返回值，返回值通过future接收可以通过泛型指定类型，也可以抛出异常；第五种就是通过线程池threadpool创建。</p><h3 id="start-和-run">start 和 run</h3><p>new 一个 thread 调用start就是启动一个线程然后进入就绪状态，但分配到时间片就可以运行，而run只是用于执行线程运行时执行代码可以重复调用，也就是说start用来真正启动多线程工作，进行准备就绪，而线程只是通过run来完成它的运行状态，是一个普通方法的调用，其实还是再主线程里执行的。</p><h3 id="线程生命周期和五种状态">线程生命周期和五种状态</h3><img src="多线程/image-20220307173638132.png" alt="image-20220307173638132" style="zoom: 33%;" /><p>new -&gt; runnable(start()) -&gt; running (run()) --&gt;blocked (wait()、synch进入锁池、join()/sleep()/IO请求) -&gt; dead （run()结束或者异常退出）</p><h2 id="3-进程与线程的区别">3. 进程与线程的区别</h2><p>进程是系统进行资源分配和调度的基本单位是操作系统结构的基础；线程是操作进行运算调度的最小单位。通俗来讲就是，一个程序它本来是一种静态的指令和数据，当系统开始运行这个程序就会load到内存里，然后系统为其分配资源，这个时候就是一个进程，可以理解为进程就是动态的程序；而线程就是进程实际运行的单位，一种单一顺序的控制流，一个进程可以并发多个线程，每条线程有不同任务。</p><h2 id="4-并发与并行">4. 并发与并行</h2><p>并发是指多个任务在同一个CPU核上，按照细分的时间片交替进行，如果交替时间片够短，逻辑上可以看作同时执行</p><p>并行是多个CPU核在同一时间处理多个任务，是真正意义上的同时进行</p><p>串行就是一个CPU多个任务串联在一起，按照顺序执行</p><h2 id="5-程序开多少线程合适-是不是线程数越高效率越高">5. 程序开多少线程合适/是不是线程数越高效率越高/</h2><p>多线程的缺点？线程数过多会怎么样</p><ol><li>占用内存，给垃圾处理器带来压力、</li><li>需要协调和管理CPU时间跟踪线程、</li><li>还会互相竞争共享资源这样会带来很多其他性能的开销</li></ol><p>与线程的体制完全耦合完全相关所以这个时候就看程序要干什么；</p><p>根据I/O操作和CPU操作区分程序；如果CPU计算比例占大部分也就是cpu密集型程序，这个时候线程等待时间接近于0，也就是耗费大量时间的就是上下文切换，为了减少上下文切换，一般开CPU核数个线程再加一条保证线程意外暂停；如果是IO操作占比大部分，等待时间长，理论上是可以开无限多个线程但是考虑到节约资源又要保证性能及稳定性，一般用两倍的CPU核数，再加一条为backup，如果需要精密计算的任务就可以使用公式CPU核数/（1-阻塞系数）(阻塞系数0.8~0.9）</p><h3 id="单个cpu设定多线程有没有意义？结合上面">单个cpu设定多线程有没有意义？结合上面</h3><p>根据实际需要来处理</p><p>如果你的每个线程的工作与时序无关的，并且含有外部的读写操作</p><p>那么是很有意义的，当一个线程进行读写的时候，其他线程可以占用CPU进行运行。</p><p>也即线程属于I/O密集型的时候，在CPU才会体现的多线程的好处</p><p>如果是CPU密集型的，你开了很多个线程，只是增加了CPU在各个线程中进行切换的负担<br>没有带来好处，和性能的提高</p><h2 id="6-如何结束一个线程？">6.如何结束一个线程？</h2><ol><li><p>就是run方法结束就正常退出线程了，自然退出</p></li><li><p>使用stop ，但是不建议使用，因为stop结束线程不会在意你进行到哪突然结束，会容易产生数据不一致。</p></li><li><p>volatile标志 也可以 如果是不依赖中间状态 停止就很方便，是特定场景下比较优雅的解决方案。</p><ul><li><p>不适合没有同步的时候，线程阻塞，没办法循环回去</p></li><li><p>打断时间不精确，（比如在一个阻塞容器容量为5的时候结束生产者，由于其对同步线程标志位的时间控制不是很精确，有时候生产者还会生产一部分时间。</p></li></ul></li><li><p>interrupt/isinterrupt比较优雅</p></li></ol><p>当然要精确停止，控制线程有时候更加需要和外面的线程进行合作吗这个时候就需要用到锁了。</p><h3 id="interrupt和isInterrupt">interrupt和isInterrupt()</h3><ol><li><p>interrupt() ：实例⽅法，设置线程中断标志（打扰⼀下，你该处理⼀下中断）比如sleep()在睡眠的时候没办法中断，这个时候就需要</p></li><li><p>isInterrupted()：实例⽅法，有没有⼈打扰我？</p></li><li><p>interrupted()：静态⽅法，有没有⼈打扰我（当前线程）？复位</p></li></ol><p>interrupt()是静态方法，一个线程被中断，第一次调用时返回true然后清除中断信号，后面再次调用就是false了 ;isI就是查看当前信息</p><h2 id="7-线程类的构造方法、静态块是被哪个线程调用的？">7. 线程类的构造方法、静态块是被哪个线程调用的？</h2><p>这是一个非常刁钻和狡猾的问题。请记住：线程类的构造方法、静态块是被</p><p>new这个线程类所在的线程所调用的，而 run 方法里面的代码才是被线程自身所调用的。</p><p>如果说上面的说法让你感到困惑，那么我举个例子，假设 Thread2 中 new 了</p><p>Thread1，main 函数中 new 了 Thread2，那么：</p><p>（1）  Thread2 的构造方法、静态块是 main 线程调用的，Thread2 的 run()方法是Thread2 自己调用的</p><p>（2）  Thread1 的构造方法、静态块是 Thread2 调用的，Thread1 的 run()方法是Thread1 自己调用的</p><h2 id="8-线程安全活跃态？">8. 线程安全活跃态？</h2><p><strong>死锁</strong>：是指两个或两个以上的进程（或线程）在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去。</p><p><strong>活锁</strong>：任务或者执行者没有被阻塞，由于某些条件没有满足，导致一直重复尝试，失败，尝试，失败。例如：循环递归没有写输出条件抛stackoverflow</p><p>​活锁和死锁的区别在于，处于活锁的实体是在不断的改变状态，这就是所谓的“活”， 而处于死锁的实体表现为等待；活锁有可能自行解开，死锁则不能。</p><p><strong>饥饿</strong>：一个或者多个线程因为种种原因无法获得所需要的资源，导致一直无法执行的状态。例子：读写锁，一直读导致写操作一直等待</p><p>​Java 中导致饥饿的原因：</p><ol><li>其他线程在临界区做了无限循环或无限制等待资源的操作，让其他的线程一直不能拿到锁进入临界区，对其他线程来说就进入了饥饿状态。</li><li>因为线程优先级分配的不合理，导致部分线程始终无法获得CPU资源。</li></ol><h2 id="9-1～26和a-b顺序交替打印">9. 1～26和a~b顺序交替打印</h2><p>这道面试题呢实际上是华为的一道面试题，其实它里面是一道填空题，后来就很多的开始考这道题，这个面试题是两个线程，第一个线程是从1到26，第二个线程是从A到一直到Z，然后要让这两个线程做到同时运行，交替输出，顺序打印。那么这道题目的解法有非常多。</p><h3 id="1-LockSupport">1.LockSupport</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">T02_00_LockSupport</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">Thread</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="literal">null</span>, t2 = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">char</span>[] aI = <span class="string">&quot;1234567&quot;</span>.toCharArray();</span><br><span class="line">        <span class="type">char</span>[] aC = <span class="string">&quot;ABCDEFG&quot;</span>.toCharArray();</span><br><span class="line"></span><br><span class="line">        t1 = <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">char</span> c : aI) &#123;</span><br><span class="line">                    System.out.print(c);</span><br><span class="line">                    LockSupport.unpark(t2); <span class="comment">//叫醒T2</span></span><br><span class="line">                    LockSupport.park(); <span class="comment">//T1阻塞</span></span><br><span class="line">                &#125;</span><br><span class="line">        &#125;, <span class="string">&quot;t1&quot;</span>);</span><br><span class="line"></span><br><span class="line">        t2 = <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">char</span> c : aC) &#123;</span><br><span class="line">                LockSupport.park(); <span class="comment">//t2阻塞</span></span><br><span class="line">                System.out.print(c);</span><br><span class="line">                LockSupport.unpark(t1); <span class="comment">//叫醒t1</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="string">&quot;t2&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​</p><h3 id="2-wait-和-notify">2. wait() 和 notify()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">waitNotify</span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">  <span class="type">char</span>[] c1 = <span class="string">&quot;ABCDEFG&quot;</span>.toCharArray();</span><br><span class="line">  <span class="type">char</span>[] c2 = <span class="string">&quot;123456&quot;</span>.toCharArray();</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">    Sychronized(o)&#123;</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">char</span> c:c1)&#123;</span><br><span class="line">        System.out.println(c);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">          o.notify();</span><br><span class="line">        o.wait();</span><br><span class="line">        &#125; <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      o.notify();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,<span class="string">&quot;t1&quot;</span>).start;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">    Sychronized(o)&#123;</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">char</span> c:c2)&#123;</span><br><span class="line">        System.out.println(c );</span><br><span class="line">        o.notify();</span><br><span class="line">        o.wait();</span><br><span class="line">      &#125;</span><br><span class="line">      o.notify();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,<span class="string">&quot;t2&quot;</span>).start;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>一定要注意最后都要notify（）</p><h2 id="10-多线程之间是怎么通信的？">10. 多线程之间是怎么通信的？</h2><ol><li><p>通过共享变量，变量需要volatile修饰；</p></li><li><p>使用wait和notify方法，但是由于需要使用同一把锁，所以必须通知线程释放锁，被通知的线程才能获得到多，这样导致通知不及时；</p></li><li><p>使用countDownLatch实现，通知线程到指定条件，调用countDownLatc.countDown()被通知的线程进行await()方法</p></li><li><p>使用Condition的await()和signalAll()方法。</p></li></ol><h2 id="11-生产者消费者模型">11. 生产者消费者模型?</h2><h3 id="Condition-阻塞队列">Condition 阻塞队列</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProviderConsumer</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> length;</span><br><span class="line"><span class="keyword">private</span> Queue&lt;T&gt; queue;</span><br><span class="line"><span class="keyword">private</span> <span class="type">ReentrantLock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"><span class="keyword">private</span> <span class="type">Condition</span> <span class="variable">provideCondition</span> <span class="operator">=</span> lock.newCondition();</span><br><span class="line"><span class="keyword">private</span> <span class="type">Condition</span> <span class="variable">consumeCondition</span> <span class="operator">=</span> lock.newCondition();</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ProviderConsumer</span><span class="params">(<span class="type">int</span> length)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.length = length;</span><br><span class="line"><span class="built_in">this</span>.queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;T&gt;();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">provide</span><span class="params">(T product)</span> &#123;</span><br><span class="line"></span><br><span class="line">lock.lock();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="keyword">while</span> (queue.size() &gt;= length) &#123;</span><br><span class="line">provideCondition.await();</span><br><span class="line">&#125;</span><br><span class="line">queue.add(product);</span><br><span class="line">consumeCondition.signal();</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">lock.unlock();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> T <span class="title function_">consume</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">lock.lock();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="keyword">while</span> (queue.isEmpty()) &#123;</span><br><span class="line">consumeCondition.await();</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">T</span> <span class="variable">product</span> <span class="operator">=</span> queue.remove();</span><br><span class="line">provideCondition.signal();</span><br><span class="line"><span class="keyword">return</span> product;</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">lock.unlock();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="wait-和-notify">wait() 和 notify()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerConsumerModel</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">EventStorage</span> <span class="variable">eventStorage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EventStorage</span>();</span><br><span class="line">        <span class="type">Producer</span> <span class="variable">producer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Producer</span>(eventStorage);</span><br><span class="line">        <span class="type">Consumer</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Consumer</span>(eventStorage);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(producer).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(consumer).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Producer</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> EventStorage storage;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Producer</span><span class="params">(EventStorage storage)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.storage = storage;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">                storage.put(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Consumer</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> EventStorage storage;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Consumer</span><span class="params">(EventStorage storage)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.storage = storage;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">                storage.take(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">EventStorage</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line">        <span class="keyword">private</span> LinkedList&lt;String&gt; storage;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">EventStorage</span><span class="params">()</span> &#123;</span><br><span class="line">            size = <span class="number">10</span>;</span><br><span class="line">            storage = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (storage.size() == <span class="built_in">this</span>.size) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    wait();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            storage.push(<span class="string">&quot;数据&quot;</span> + i);</span><br><span class="line">            System.out.println(<span class="string">&quot;生产 -&gt; 数据&quot;</span> + i + <span class="string">&quot; 当前仓库中已经有了 &quot;</span> + storage.size() + <span class="string">&quot; 条数据&quot;</span>);</span><br><span class="line">            notify();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">take</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (storage.size() == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    wait();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;消费 -&gt; &quot;</span> + storage.poll() + <span class="string">&quot; 当前仓库中剩下 &quot;</span> + storage.size() + <span class="string">&quot; 条数据&quot;</span>);</span><br><span class="line">            notify();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 多线程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 多线程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>m1 2020配置java后端环境</title>
      <link href="/2021/09/12/m1-2020%E9%85%8D%E7%BD%AEjava%E5%90%8E%E7%AB%AF%E7%8E%AF%E5%A2%83/"/>
      <url>/2021/09/12/m1-2020%E9%85%8D%E7%BD%AEjava%E5%90%8E%E7%AB%AF%E7%8E%AF%E5%A2%83/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=aad29c96-7772-7fc4-338c-b186adae00af</cover>
      <date>Sun Sep 12 2021 18:48:02 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>m1 2020配置java后端环境</h1><h2 id="1-安装JDK">1 安装JDK</h2><p>OracleJDK暂时并不支持arm架构的芯片，我们需要使用openjdk：zulu版本 <a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.azul.com%2Fdownloads%2F%3Fpackage%3Djdk%23download-openjdk">地址</a></p><p>安装完成 终端输入<code>java --version</code></p><img src="m1-2020配置java后端环境/image-20220105102457083.png" alt="image-20220105102457083" style="zoom:50%;" /><h4 id="配置问题！！！">配置问题！！！</h4><p>😭m1 默认是zsh 不是bash 一开始不知道的我 把所有配置全部输入到 bash_profile 然后看maven版本却显示</p><img src="m1-2020配置java后端环境/008i3skNgy1gy2mx6qgabj30qy02q74q.jpg" alt="image-20220105112802157" style="zoom:50%;" /><p>想要更换bash 和 zsh模式可以参考这个： <a href="https://www.jianshu.com/p/3d93f23454d8">mac中bash和zsh终端切换方法和zsh配置</a></p><figure class="highlight vim"><figcaption><span>./zshrc ```添加配置（可以**修改版本**）</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><p>export JAVA_HOME=/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home<br>#export JAVA_HOME=/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 2 安装homebrew</span><br><span class="line"></span><br><span class="line">homebrew 是macos的包管理工具</span><br><span class="line"></span><br><span class="line">在终端输入 ```/bin/zsh -c &quot;$(curl -fsSL https://gitee.com/cunkai/HomebrewCN/raw/master/Homebrew.sh)&quot;```</span><br><span class="line"></span><br><span class="line">选择镜像 </span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;m1-2020配置java后端环境/008i3skNgy1gy2l6681ocj30vu0eytbd.jpg&quot; alt=&quot;image-20220105102727012&quot; style=&quot;zoom:50%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">安装完毕查看 ```brew -v```</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;m1-2020配置java后端环境/008i3skNgy1gy2l75gne0j30vm03aaam.jpg&quot; alt=&quot;image-20220105102825749&quot; style=&quot;zoom:50%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">## 3 安装maven</span><br><span class="line"></span><br><span class="line">在第一步里面安装的homebrew是在mac隐藏文件夹 **/opt**下的  maven也同样最好安装在**/opt**下</span><br><span class="line"></span><br><span class="line">如果找不到opt 可以将文件夹显示 在访达  **command+shift+.**  隐藏的文件夹就会显示</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;m1-2020配置java后端环境/008i3skNgy1gy2n8jgqxhj30c60dk3yt.jpg&quot; alt=&quot;image-20220105104745708&quot; style=&quot;zoom:50%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">我们将[官网的maven](https://maven.apache.org/download.cgi)（见下图）拖到 **/opt**下</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;m1-2020配置java后端环境/008i3skNgy1gy2lp0zdtvj314u088abg.jpg&quot; alt=&quot;image-20220105104526757&quot; style=&quot;zoom:50%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;m1-2020配置java后端环境/008i3skNgy1gy2n9im9rzj30ra0go0tj.jpg&quot; alt=&quot;image-20220105104910817&quot; style=&quot;zoom: 25%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">#### 配置maven</span><br><span class="line"></span><br><span class="line">```vim ~./zshrc```</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>export MAVEN_HOME=/opt/apache-maven-3.8.4<br>export PATH=<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>A</mi><mi>T</mi><mi>H</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">PATH:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span></span></span></span>MAVEN_HOME/bin</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">查看 ```mvn -v```</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;m1-2020配置java后端环境/image-20220614185135880.png&quot; alt=&quot;image-20220614185135880&quot; style=&quot;zoom:50%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">这样就配置成功啦！</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 4 下载npm</span><br><span class="line"></span><br><span class="line">brew install npm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 5 下载iterm2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1. 下载iTerm2</span><br><span class="line">   我是在官网下载安装的 </span><br><span class="line"></span><br><span class="line">https://www.iterm2.com/index.html</span><br><span class="line"></span><br><span class="line">也可以使用Homebrew安装</span><br><span class="line"></span><br><span class="line">$ brew cask install iterm2</span><br><span class="line">使用brew cask要先安装cask，下面粗略给出cask的介绍。</span><br><span class="line"></span><br><span class="line">homebrew-cask与brew的区别:</span><br><span class="line"></span><br><span class="line">brew是下载源码解压然后./configure &amp;&amp; make install, 并且会自动配置好环境变量。</span><br><span class="line"></span><br><span class="line">brew cask主要用于有GUI的软件，下载已经编译好的应用包(.dmg/.pkg)。</span><br><span class="line"></span><br><span class="line">安装brew cask:</span><br><span class="line"></span><br><span class="line">$ brew install caskroom/cask/brew-cask</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 6 配置node.js + typora + picgo</span><br><span class="line"></span><br><span class="line">下载node.js </span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;m1-2020配置java后端环境/image-20220614185208815.png&quot; alt=&quot;image-20220614185208815&quot; style=&quot;zoom:50%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">安装完成进行以下步骤</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```shell</span><br><span class="line"># 查看node 安装路径</span><br><span class="line">tinachan@tinadeair ~ % which node</span><br><span class="line">/usr/local/bin/node</span><br><span class="line"># npm安装picgo</span><br><span class="line">tinachan@tinadeair ~ % sudo npm install picgo -g</span><br><span class="line"></span><br><span class="line"># 查看picgo安装路径</span><br><span class="line">tinachan@tinadeair ~ % which picgo</span><br><span class="line">/opt/homebrew/bin/picgo</span><br><span class="line"># 设置gitee插件</span><br><span class="line">tinachan@tinadeair ~ % picgo install gitee-uploader</span><br><span class="line"># 设置插件 ：只需要填repo 和 token</span><br><span class="line">tinachan@tinadeair ~ % picgo set uploader</span><br><span class="line">? Choose a(n) uploader gitee</span><br><span class="line">? repo: # 填仓库名（格式：用户名/仓库名）</span><br><span class="line">? branch: master</span><br><span class="line">? token: # 填私人令牌</span><br><span class="line">? path: </span><br><span class="line">? customPath: default</span><br><span class="line">? customUrl: </span><br><span class="line">[PicGo SUCCESS]: Configure config successfully!</span><br><span class="line"># 设置use uploader</span><br><span class="line">tinachan@tinadeair ~ % picgo use uploader</span><br><span class="line">? Use an uploader gitee</span><br><span class="line">[PicGo SUCCESS]: Configure config successfully!</span><br></pre></td></tr></table></figure><p>到typora设置</p><img src="m1-2020配置java后端环境/image-20220614185957433.png" alt="image-20220614185957433" style="zoom:50%;" />]]></content>
      
      
      <categories>
          
          <category> 环境配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> macOS </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git</title>
      <link href="/2021/08/13/git/"/>
      <url>/2021/08/13/git/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=226072cc-2161-a096-494a-0e892ba19c3c</cover>
      <date>Fri Aug 13 2021 23:39:23 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>概念</h1><p>Git是一个免费的、开源的分布式版本控制系统，可以快速高效地处理从小型到大型的项目。</p><p>版本控制：版本控制是一种记录一个或若干文件内容变化，以便将来查阅特定版本修订情况的系统 。</p><h2 id="代码托管中心">代码托管中心</h2><p>我们已经有了本地库，本地库可以帮我们进行版本控制，为什么还需要代码托管中心呢？<br>它的任务是帮我们维护远程库，下面说一下本地库和远程库的交互方式，也分为两种：</p><ol><li><p>团队内部协作</p><img src="git/20210716160327.png" alt="image-20210716160327295" style="zoom: 50%;" /></li><li><p>跨团队协作</p><img src="git/20210716160355.png" alt="image-20210716160355825" style="zoom:50%;" /><p><a href="https://github.com/SoniaChan33/SoniaChan33.github.io">https://github.com/SoniaChan33/SoniaChan33.github.io</a></p></li></ol><h2 id="初始化本地仓库">初始化本地仓库</h2><ul><li><p>创建一个文件夹</p><img src="git/20210716160820.png" alt="image-20210716160820389" style="zoom: 50%;" /></li><li><p>打开Git终端：Git Bash Here</p></li><li><p>查看Git安装版本</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git --version</span><br></pre></td></tr></table></figure></li><li><p>清屏</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clear</span><br></pre></td></tr></table></figure></li><li><p>设置签名</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;TeaSea33&quot;</span><br><span class="line">git config --global user.email &quot;TeaSea33@outlook.com&quot;</span><br></pre></td></tr></table></figure></li><li><p>本地仓库的初始化操作(目录在本地仓库里)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><img src="git/20210716162158.png" alt="image-20210716162158453"  /></li><li><p>查看.git下的内容</p><img src="git/20210716162242.png" alt="image-20210716162242909" style="zoom: 50%;" /><p>注意事项： .git目录下的本地库相关的子目录和子文件不要删除，不要胡乱修改。</p></li></ul><h1>Git常用命令</h1><h2 id="add和commit">add和commit</h2><ul><li><p>先创建文件</p></li><li><p>将文件提交到暂存区</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add Demo2.txt</span><br></pre></td></tr></table></figure></li><li><p>将暂存区的内容提交到本地库</p><img src="git/20210716162745.png" alt="image-20210716162745742" style="zoom:67%;" /></li><li><p>注意：</p><ol><li>不放在本地仓库中的文件，git是不进行管理</li><li>即使放在本地仓库的文件，git也不管理，必须通过add,commit命令操作才可以将内容提交到本地库。</li></ol></li></ul><h2 id="Status">Status</h2><p>查看工作区和暂存区的状态</p><ul><li><p>创建一个文件，然后查看状态</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure><img src="git/20210716163201.png" alt="image-20210716163201433" style="zoom:67%;" /></li><li><p>然后将Demo2.txt通过git add命令提交到暂存区</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add &quot;Demo3.txt&quot;</span><br></pre></td></tr></table></figure></li><li><p>status查看状态</p><img src="git/20210716163336.png" alt="image-20210716163335957" style="zoom:67%;" /></li><li><p>commit提交文件</p><img src="git/20210716163613.png" alt="image-20210716163613057" style="zoom:67%;" /></li><li><p>修改文件 并查看状态</p><img src="git/20210716163744.png" alt="image-20210716163744634" style="zoom:67%;" /></li><li><p>重新添加至暂存区 并查看状态</p><img src="git/20210716163903.png" alt="image-20210716163903519" style="zoom:67%;" /></li><li><p>提交以后查看状态</p><img src="git/20210716164259.png" alt="image-20210716164259073" style="zoom:67%;" /><img src="git/20210716164315.png" alt="image-20210716164315251" style="zoom:67%;" /></li></ul><h2 id="log">log</h2><p>可以查看提交的日志，显示最近到最远的日志</p><h3 id="日志展示方式">日志展示方式</h3><ol><li><pre><code class="language-shell">git log <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   &lt;img src=&quot;git/20210716165040.png&quot; alt=&quot;image-20210716164533294&quot; style=&quot;zoom:67%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">   ---&gt; 分页</span><br><span class="line"></span><br><span class="line">   当历史记录过多的时候使用**空格**翻页，**b**  回到上一页，到尾页显示END,</span><br><span class="line"></span><br><span class="line">   退出：**q**</span><br><span class="line"></span><br><span class="line">2. ```shell</span><br><span class="line">   git log --pretty=oneline</span><br></pre></td></tr></table></figure>&lt;img src=&quot;git/20210716165022.png&quot; alt=&quot;image-20210716165022038&quot; style=&quot;zoom:67%;&quot; /&gt;</code></pre></li><li><pre><code class="language-shell">git log --oneline<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   &lt;img src=&quot;git/20210716165148.png&quot; alt=&quot;image-20210716165147993&quot; style=&quot;zoom:67%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">4. ```shell</span><br><span class="line">   git reflog</span><br></pre></td></tr></table></figure>多了信息：HEAD@&#123;数字&#125;数字：指针回到当前这个历史版本需要多少步&lt;img src=&quot;git/20210716165501.png&quot; alt=&quot;image-20210716165500983&quot; style=&quot;zoom:67%;&quot; /&gt;</code></pre></li></ol><h2 id="reset">reset</h2><p>前进或者后退历史版本</p><ul><li>先查看历史log状态</li></ul><img src="git/20210716172535.png" alt="image-20210716172535073" style="zoom:67%;" /><ul><li><p>将文件后退到版本1</p><img src="git/20210716173722.png" alt="image-20210716173722034" style="zoom:67%;" /></li><li><p>再次查看</p><img src="git/20210716173804.png" alt="image-20210716173804875" style="zoom:67%;" /></li></ul><h3 id="三个参数-hard-mixed-soft">三个参数(hard\mixed\soft)</h3><p><strong>git reset --[参数] [索引]</strong></p><ul><li><p>hard</p><p>本地库的指针移动的同时，重置暂存区，重置工作区</p><img src="git/20210716190012.png" alt="image-20210716190011958" style="zoom: 33%;" /></li><li><p>mixed</p><p>本地库的指针移动的同时，重置暂存区，但是工作区不动</p><img src="git/20210716190039.png" alt="image-20210716190039546" style="zoom:33%;" /></li><li><p>soft</p><p>本地库的指针移动的时候，暂存区，工作区都不动</p><img src="git/20210716190052.png" alt="image-20210716190052572" style="zoom:33%;" /></li></ul><p><strong>用得最多的就是第一种hard参数</strong></p><h3 id="hard">hard</h3><h4 id="1-找回本地库删除的文件">1.找回本地库删除的文件</h4><ul><li><p>新建一个Test2.txt文件 并将它add到暂存区中</p><img src="git/20210716191040.png" alt="image-20210716191040843" style="zoom:67%;" /></li><li><p>再通过commit提交到本地库</p><img src="git/20210716191249.png" alt="image-20210716191249904" style="zoom:67%;" /></li><li><p>删除工作区中的Test2.txt 并将删除操作同步到暂存区</p><img src="git/20210716191505.png" alt="image-20210716191505941" style="zoom:67%;" /></li><li><p>将删除操作同步到本地库</p><img src="git/20210716191516.png" alt="image-20210716191516088" style="zoom:67%;" /></li><li><p>查看日志</p><img src="git/20210716191540.png" alt="image-20210716191540549" style="zoom:67%;" /></li><li><p>找到本地库中删除的文件，实际上就是将历史版本切换到刚才添加文件的那个版本即可</p><img src="git/20210716191642.png" alt="image-20210716191642335" style="zoom:67%;" /></li></ul><h4 id="2-找回暂存区删除的文件">2.找回暂存区删除的文件</h4><ul><li><p>删除工作区数据</p><img src="git/20210716192257.png" alt="image-20210716192257627" style="zoom:67%;" /></li><li><p>同步到缓存区</p><img src="git/20210716192305.png" alt="image-20210716192305650" style="zoom:67%;" /></li><li><p>查看日志</p><img src="git/20210716192331.png" alt="image-20210716192331458" style="zoom:67%;" /></li><li><p>找到当前指针 然后返回到该状态</p><img src="git/20210716192952.png" alt="image-20210716192952612" style="zoom:67%;" /><img src="git/20210716193047.png" alt="image-20210716193047918" style="zoom:67%;" /></li></ul><h2 id="diff">diff</h2><ol><li><p>比对<strong>工作区</strong>和<strong>暂存区</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff [文件名]</span><br></pre></td></tr></table></figure><ul><li>添加并提交一个内容为aaaa的Test3.txt</li></ul><img src="git/20210716195249.png" alt="image-20210716195249530" style="zoom:67%;" /><ul><li>更改工作区的文件加入bbb，再用dif进行比对，发现不同</li></ul><img src="git/20210716195504.png" alt="image-20210716195504098" style="zoom:67%;" /><ul><li>如果修改了多个文件，多个文件的比对命令直接是git diff</li></ul><img src="git/20210716195715.png" alt="image-20210716195715409" style="zoom:67%;" /></li><li><p>比对<strong>暂存区</strong>和<strong>本地库</strong> ：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff [历史版本] [文件]</span><br></pre></td></tr></table></figure><ul><li><p>文件添加不提交到本地库，此时暂存区就和工作区相同为aaaabbb</p></li><li><p>查看日志</p><img src="git/20210716202947.png" alt="image-20210716202947616" style="zoom:67%;" /><p>此刻的本地库还停留在之前第一次修改</p></li><li><p>比对暂存区和本地库中的HEAD当前指针状态</p><img src="git/20210716203057.png" alt="image-20210716203056977" style="zoom:67%;" /><p>发现不一样，说明没有提交的时候就是不一样的</p></li><li><p>HEAD部分可以改成其他历史版本的标号</p><img src="git/20210716203405.png" alt="image-20210716203405603" style="zoom:67%;" /></li></ul></li></ol><h1>分支</h1><p>查看分支</p><img src="git/20210716205522.png" alt="image-20210716205522520" style="zoom:67%;" /><p>创建新分支</p><img src="git/20210716205639.png" alt="image-20210716205639017" style="zoom:67%;" /><p>切换分支</p><img src="git/20210716205742.png" alt="image-20210716205742388" style="zoom: 67%;" /><p>进入branch01分支，增加内容</p><img src="git/20210716210648.png" alt="image-20210716210648550" style="zoom: 67%;" /><img src="git/20210716210051.png" alt="image-20210716210051334" style="zoom:67%;" /><p>再次查看两个分支发现主分支没有改变</p><img src="git/20210716210157.png" alt="image-20210716210157353" style="zoom:67%;" /><p>查看文件</p><img src="git/20210716210515.png" alt="image-20210716210515711" style="zoom: 67%;" /><p>将branch01合并到主分支</p><img src="git/20210716211526.png" alt="image-20210716211526286" style="zoom: 67%;" /><p>因为在同一文件的同一位置修改了文件</p><img src="git/20210716211737.png" alt="image-20210716211737215" style="zoom:50%;" /><p>解决冲突：</p><p>人为决定，留下想要的就可以，然后再添加</p><img src="git/20210716212101.png" alt="image-20210716212101854" style="zoom:67%;" /><p>提交冲突，不能带文件名</p><img src="git/20210716212214.png" style="zoom:67%;" /><img src="git/20210716212214.png" alt="image-20210716212214847" style="zoom:67%;" /><h1>Github</h1><p>创建远程库</p><p>为远程库取别名</p><img src="git/20210717114246.png" alt="image-20210717114246916" style="zoom:67%;" /><h3 id="将本地库数据推送到远程库中">将本地库数据推送到远程库中</h3><img src="git/20210717114612.png" alt="image-20210717114612323" style="zoom:67%;" /><img src="git/20210717114625.png" alt="image-20210717114625397" style="zoom:67%;" /><img src="git/20210717114728.png" alt="image-20210717114728691" style="zoom:67%;" /><p>查看远程库</p><img src="git/20210717114756.png" alt="image-20210717114756656" style="zoom:67%;" /><h1>SSH免密操作</h1><ol><li><p>进入用户的主目录中：</p></li><li><p>执行命令，生成一个.ssh目录</p><img src="git/20210717204402.png" alt="image-20210717204402583" style="zoom: 67%;" /></li><li><p>发现.ssh目录下有两个文件</p><img src="git/20210717204425.png" alt="image-20210717204425794" style="zoom:67%;" /></li><li><p>第二个文件里面的密钥复制，去github下新建密钥</p></li><li><p>密钥生成：</p><img src="git/20210717144958.png" alt="image-20210717144958526" style="zoom:67%;" /></li></ol><p>免密操作使每次需要push仓库的时候，都不用再输入密码434</p>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux学习</title>
      <link href="/2021/07/21/Linux%E5%AD%A6%E4%B9%A0/"/>
      <url>/2021/07/21/Linux%E5%AD%A6%E4%B9%A0/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=137555bd-631d-c30f-2ee3-e84b1c16ffe1</cover>
      <date>Wed Jul 21 2021 23:24:39 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>常用配置</h1><h2 id="启动网络">启动网络</h2><ul><li>启动网卡（仅针对单次可用）</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">nmcli c up ens33</span></span><br></pre></td></tr></table></figure><ul><li>修改配置文件（永久可用）</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vim /etc/sysconfig/network-scripts/ifcfg-ens33</span></span><br></pre></td></tr></table></figure><img src="Linux学习/20210810165254.png" alt="image-20210810165233126" style="zoom:33%;" /><p>ONBOOT=yes</p><p>NAT模式</p><p>在VMWare中默认使用的NAT模式</p><ul><li>Network Address Translation 网络地址转换，</li></ul><p>为什么要求改网络类型：因为给NAT模式外界不能访问windows里面的操作系统</p><p>改成桥接模式</p><img src="Linux学习/20210810165902.png" alt="image-20210810165902006" style="zoom: 33%;" />]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaEE</title>
      <link href="/2021/07/20/JavaEE/"/>
      <url>/2021/07/20/JavaEE/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=4f7e55a4-6762-4c54-3e3d-65cdd4ab1bf4</cover>
      <date>Tue Jul 20 2021 09:35:44 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>引入</h1><p>​</p><img src="JavaEE/20210731155304-20220507093630276.png" alt="image-20210731155304853" style="zoom:67%;" /><span id="more"></span><h1>Tomcat</h1><h2 id="HTTP协议">HTTP协议</h2><p>协议：Protocol</p><h3 id="定义">定义</h3><p>HTTP协议是**Hyper Text Transfer Protocol（超文本传输协议）**的缩写, HTTP是万维网（WWW:World Wide Web）的数据通信的基础。</p><p>HTTP是一个简单的请求-响应协议，它通常运行在TCP之上。它指定了客户端可能发送给服务器什么样的消息以及得到什么样的响应。</p><img src="JavaEE/20210802110328-20220507093630140.png" alt="image-20210802110327666" style="zoom:67%;" /><p>HTTP是一个基于<strong>TCP/IP</strong>通信协议来传递数据（HTML 文件, 图片文件, 查询结果等）。</p><img src="JavaEE/20210802110337-20220507093630336.png" alt="image-20210802110337133" style="zoom:67%;" /><h3 id="特点">特点</h3><p>1支持客户/服务器模式</p><p>HTTP协议支持客户端服务端模式，需要使用浏览器作为客户端来访问服务端。</p><p>2简单快速</p><p>客户向服务器请求服务时，只需传送请求方法和路径。请求方法常用的有GET、POST等。每种方法规定了客户与服务器联系的类型不同。由于HTTP协议简单，使得HTTP服务器的程序规模小，因而通信速度很快。</p><p>3灵活</p><p>HTTP允许传输任意类型的数据对象。正在传输的类型由Content-Type（Content-Type是HTTP包中用来表示内容类型的标识）加以标记。</p><p>4无连接</p><p>每次请求一次，释放一次连接。所以无连接表示每次连接只能处理一个请求。优点就是节省传输时间，实现简单。我们有时称这种无连接为短连接。对应的就有了长链接，长连接专门解决效率问题。当建立好了一个连接之后，可以多次请求。但是缺点就是容易造成占用资源不释放的问题。当HTTP协议头部中字段Connection：keep-alive表示支持长链接。</p><p>5单向性</p><p>服务端永远是被动的等待客户端的请求。</p><p>6无状态</p><p>HTTP协议是无状态协议。无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快。为了解决HTTP协议无状态，于是，两种用于保持HTTP连接状态的技术就应运而生了，一个是Cookie，而另一个则是Session。</p><p>HTTP协议发展和版本</p><p>http协议在1991年发布第一个版本版本号为0.9。随后WWW联盟（WWW Consortium-W3C）于1994年成立，http协议被纳入到W3C组织中进行维护和管理。</p><p>http1.0</p><p>最早在1996年在网页中使用，内容简单，所以浏览器的每次请求都需要与服务器建立一个TCP连接，服务器处理完成后立即断开TCP连接（无连接），服务器不跟踪每个客户端也不记录过去的请求（无状态）,请求只能由客户端发起（单向性）。</p><p>http1.1</p><p>到1999年广泛在各大浏览器网络请求中使用，HTTP/1.0中默认使用Connection: close。在HTTP/1.1中已经默认使用Connection: keep-alive（长连接），避免了连接建立和释放的开销，但服务器必须按照客户端请求的先后顺序依次回送相应的结果，以保证客户端能够区分出每次请求的响应内容。通过Content-Length字段来判断当前请求的数据是否已经全部接收。不允许同时存在两个并行的响应。</p><p>1.1中最重要的一个特点是支持“长连接”，即“一次连接可以多次请求”。</p><p>HTTP 1.1支持持久连接（HTTP/1.1的默认模式使用带流水线的持久连接），在一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟。一个包含有许多图像的网页文件的多个请求和应答可以在一个连接中传输，但每个单独的网页文件的请求和应答仍然需要使用各自的连接。HTTP 1.1还允许客户端不用等待上一次请求结果返回，就可以发出下一次请求，但服务器端必须按照接收到客户端请求的先后顺序依次回送响应结果，以保证客户端能够区分出每次请求的响应内容，这样也显著地减少了整个下载过程所需要的时间。</p><p>http2.0</p><p>长连接</p><p>在HTTP/2中，客户端向某个域名的服务器请求页面的过程中，只会创建一条TCP连接，即使这页面可能包含上百个资源。  单一的连接应该是HTTP2的主要优势，单一的连接能减少TCP握手带来的时延。HTTP2中用一条单一的长连接，避免了创建多个TCP连接带来的网络开销，提高了吞吐量。</p><p>多路复用 (Multiplexing)</p><p>HTTP2.0中所有加强性能的核心是二进制传输，在HTTP1.x中，我们是通过文本的方式传输数据。在HTTP2.0中引入了新的编码机制，所有传输的数据都会被分割，并采用二进制格式编码。</p><p>多路复用，连接共享。不同的request可以使用同一个连接传输（最后根据每个request上的id号组合成正常的请求）。</p><p>HTTP2.0中，有两个概念非常重要：帧（frame）和流（stream）。<br>帧是最小的数据单位，每个帧会标识出该帧属于哪个流，流是多个帧组成的数据流。<br>所谓多路复用，即在一个TCP连接中存在多个流，即可以同时发送多个请求，对端可以通过帧中的表示知道该帧属于哪个请求。在客户端，这些帧乱序发送，到对端后再根据每个帧首部的流标识符重新组装。通过该技术，可以避免HTTP旧版本的队头阻塞问题，极大提高传输性能。</p><p>首部压缩（Header Compression）</p><p>由于1.1中header带有大量的信息，并且得重复传输，2.0使用encoder来减少需要传输的hearder大小。</p><p>服务端推送（Server Push）</p><p>在HTTP2.0中，服务端可以在客户端某个请求后，主动推送其他资源。<br>可以想象一下，某些资源客户端是一定会请求的，这时就可以采取服务端push的技术，提前给客户端推送必要的资源，就可以相对减少一点延迟时间。在浏览器兼容的情况下也可以使用prefetch。</p><p>更安全</p><p>HTTP2.0使用了tls的拓展ALPN做为协议升级，除此之外，HTTP2.0对tls的安全性做了近一步加强，通过黑名单机制禁用了几百种不再安全的加密算法。</p><h1>Servlet</h1><h2 id="1-引入">1.   引入</h2><h3 id="介绍">介绍</h3><p>Servlet是Server Applet的简称，称为服务端小程序，是JavaEE平台下的技术标准，基于Java语言编写的服务端程序。Web容器或应用服务器实现了Servlet标准所以Servlet需运行在Web容器或应用服务器中。Servlet主要功能在于能在服务器中执行并生成数据。</p><h3 id="特点-2">特点</h3><p>使用单进程多线程方式运行</p><img src="JavaEE/20210802204053-20220507093630091.png" alt="image-20210802204049056" style="zoom:80%;" /><h3 id="应用程序中的位置">应用程序中的位置</h3><p><img src="JavaEE/20210802204157-20220507093630043.png" alt="image-20210802204157808"></p><h3 id="静态资源和动态资源的区分">静态资源和动态资源的区分</h3><ul><li>静态资源：每次访问都不需要运算，直接就可以返回的资源，如HTML CSS JS 多媒体文件等等 每次访问获得地资源都是一样的</li><li>动态资源：每次访问都需要运算代码生成的资源如 Servlet JSP 每次访问获得的结果可能都是不一样的</li></ul><p>Servlet 作为一种动态资源技术 是后面学习框架的基础</p><h3 id="Servlet在程序中的地位">Servlet在程序中的地位</h3><p>Servlet是可以接受Http请求并作出相应的一种技术,是JAVA语言编写的一种动态资源<br>Servlet是前后端衔接的一种技术,不是所有的JAVA类都可以接收请求和作出相应,Servlet可以</p><p>在MVC模式中,Servlet作为Controller层(控制层)主要技术,用于和浏览器完成数据交互,控制交互逻辑</p><h3 id="servlet三大域对象">==servlet三大域对象==</h3><p><strong>Servlet三大域对象的应用 request、session、application（ServletContext）</strong></p><p><strong>ServletContext是一个全局的储存信息的空间，服务器开始就存在，服务器关闭才释放。</strong></p><p><strong>request，一个用户可有多个；session，一个用户一个；而servletContext，所有用户共用一个。所以，为了节省空间，提高效率，ServletContext中，要放必须的、重要的、所有用户需要共享的线程又是安全的一些信息。</strong></p><h2 id="案例1：初步认识">案例1：初步认识</h2><ul><li><p>创建一个JAVAWEB项目，并在项目中开发一个自己的Servlet，继承HttpServlet类</p><img src="JavaEE/20210802205500-20220507093630287.png" alt="image-20210802205500530" style="zoom:50%;" /><p><img src="JavaEE/20210802205532-20220507093629703.png" alt="image-20210802205532234"></p></li><li><p>在MyServlet类中重写service方法</p><p><img src="JavaEE/20210802205558-20220507093630506.png" alt="image-20210802205558243"></p></li><li><p>在service方法中定义具体的功能代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">//动态生成数据</span></span><br><span class="line">    <span class="comment">//随机生成一个整数</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>().nextInt();</span><br><span class="line">    <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> (num%<span class="number">2</span>==<span class="number">0</span>)?<span class="string">&quot;happy birthday&quot;</span>:<span class="string">&quot;happy new year&quot;</span>;</span><br><span class="line">    <span class="comment">//对浏览器做出响应</span></span><br><span class="line">    <span class="type">PrintWriter</span> <span class="variable">writer</span> <span class="operator">=</span> resp.getWriter();<span class="comment">//该打印流指向了浏览器</span></span><br><span class="line">    writer.write(message);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在web.xml中配置Servlet的映射路径</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--向Tomcat声明一个Servlet--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>myFirstServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span><span class="comment">&lt;!--这只是别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.chs.servlet.Myservlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--给Servlet匹配一个请求的映射路径--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>myFirstServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/mySerlvet.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>打开浏览器请求Servlet资源</p><p><img src="JavaEE/20210802205836-20220507093630044.png" alt="image-20210802205836668"></p></li></ul><h2 id="案例2：登录页">案例2：登录页</h2><h3 id="需求：">需求：</h3><p>准备一个登陆页，可以输入要用户名和密码</p><p>输入完毕向Servlet提交用户名和密码</p><p>Servlet接收到用户名和密码之后校验是否正确</p><p>如果正确响应success</p><p>如果不正确响应Failed</p><h3 id="具体步骤：">具体步骤：</h3><ul><li><p>项目结构：</p><img src="JavaEE/20210802210210-20220507093630228.png" alt="image-20210802210210084" style="zoom:67%;" /></li><li><p>开发登录页：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span> <span class="attr">action</span>=<span class="string">&quot;loginServlet.do&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">&quot;margin: 0px auto&quot;</span> <span class="attr">width</span>=<span class="string">&quot;300px&quot;</span> <span class="attr">cellpadding</span>=<span class="string">&quot;0px&quot;</span> <span class="attr">cellspacing</span>=<span class="string">&quot;0px&quot;</span> <span class="attr">border</span>=<span class="string">&quot;1px&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> &gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;登录&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>开发后台Servlet</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;login servlet invoked&quot;</span>);</span><br><span class="line">        <span class="comment">// 获取请求中的数据</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;pwd&quot;</span>);</span><br><span class="line">        <span class="comment">// 判断数据</span></span><br><span class="line">        String message=<span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(username.equals(<span class="string">&quot;mashibing&quot;</span>)&amp;&amp; pwd.equals(<span class="string">&quot;123456&quot;</span>))&#123;</span><br><span class="line">            message=<span class="string">&quot;Success&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            message=<span class="string">&quot;Fail&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 作出响应</span></span><br><span class="line">        resp.getWriter().write(message);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p>配置Servlet</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>loginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.mashibing.servlet.LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>loginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/loginServlet.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>login.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><p>运行测试</p><p><img src="JavaEE/20210802210437-20220507093630239.png" alt="image-20210802210437528"></p><img src="JavaEE/20210802210446-20220507093630225.png" alt="image-20210802210446147" style="zoom:67%;" /><h2 id="2-HttpServletRequest">2. HttpServletRequest</h2><p>一个http可以分为三个部分：<strong>请求行 请求头 请求体</strong></p><h3 id="请求行">请求行</h3><ul><li>请求方式：GET</li><li>请求的URL： <a href="http://192.168.56.220:8080/logOnDemo/logon.html">http://192.168.56.220:8080/logOnDemo/logon.html</a></li><li>协议及版本： HTTP/1.1</li></ul><h3 id="请求头">请求头</h3><p><img src="JavaEE/20210802210812-20220507093630614.png" alt="image-20210802210812138"></p><h3 id="请求体">请求体</h3><p>get方式提交的请求数据通过地址栏提交 ,没有请求体<br>post方式提交请求数据单独放到请求体中,请求时所携带的数据 (post方式)</p><h3 id="http支持的请求方式">http支持的请求方式</h3><p><img src="JavaEE/20210802211209-20220507093630776.png" alt="image-20210802211209830"></p><h4 id="get和post的区别">==get和post的区别==</h4><p>==(面试）==</p><ul><li><p>GET在浏览器回退时是无害的，而POST会再次提交请求。</p></li><li><p>GET产生的URL地址可以被Bookmark，而POST不可以。</p></li><li><p>GET请求会被浏览器主动cache，而POST不会，除非手动设置。</p></li><li><p>GET请求只能进行url编码，而POST支持多种编码方式。</p></li><li><p>GET请求参数会被完整保留在浏览器历史记录里，而POST中的参数不会被保留。</p></li><li><p>GET请求在URL中传送的参数是有长度限制的，而POST则没有。对参数的数据类型GET只接受ASCII字符，而POST即可是字符也可是字节。</p></li><li><p>GET比POST更不安全，因为参数直接暴露在URL上，所以不能用来传递敏感信息。</p></li><li><p>GET参数通过URL传递，POST放在Request body中。</p></li></ul><h3 id="具体操作：获得客户端请求信息">具体操作：获得客户端请求信息</h3><p>HttpServletRequest对象代表客户端浏览器的请求，当客户端浏览器通过HTTP协议访问服务器时，HTTP请求中的所有信息都会被Tomcat所解析并封装在这个对象中，通过这个对象提供的方法，可以获得客户端请求的所有信息。</p><h4 id="1-获取请求行信息">1.获取请求行信息</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">req.getRequestURL():<span class="comment">//返回客户端浏览器发出请求时的完整URL。</span></span><br><span class="line"></span><br><span class="line">req.getRequestURI():<span class="comment">//返回请求行中指定资源部分。</span></span><br><span class="line"></span><br><span class="line">req.getRemoteAddr():<span class="comment">//返回发出请求的客户机的IP地址。</span></span><br><span class="line"></span><br><span class="line">req.getLocalAddr():<span class="comment">//返回WEB服务器的IP地址。</span></span><br><span class="line"></span><br><span class="line">req.getLocalPort():<span class="comment">//返回WEB服务器处理Http协议的连接器所监听的端口。</span></span><br></pre></td></tr></table></figure><h4 id="2-获取请求头信息">2.获取请求头信息</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">req.getHeader(<span class="string">&quot;headerKey&quot;</span>):<span class="comment">//根据请求头中的key获取对应的value。</span></span><br><span class="line"><span class="type">String</span> <span class="variable">headerValue</span> <span class="operator">=</span> req.getHeader(<span class="string">&quot;headerKey&quot;</span>);</span><br><span class="line">req.getHeaderNames():<span class="comment">//获取请求头中所有的key，该方法返回枚举类型。</span></span><br><span class="line">Enumeration&lt;String&gt; headerNames = req.getHeaderNames();</span><br></pre></td></tr></table></figure><p>测试代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet3</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(req.getRequestURL());<span class="comment">//返回客户端浏览器发出请求时的完整URL。</span></span><br><span class="line">        System.out.println(req.getRequestURI());<span class="comment">//返回请求行中指定资源部分。</span></span><br><span class="line">        System.out.println(req.getRemoteAddr());<span class="comment">//返回发出请求的客户机的IP地址。</span></span><br><span class="line">        System.out.println(req.getLocalAddr());<span class="comment">//返回WEB服务器的IP地址。</span></span><br><span class="line">        System.out.println(req.getLocalPort());<span class="comment">//返回WEB服务器处理Http协议的连接器所监听的端口。</span></span><br><span class="line">        System.out.println(<span class="string">&quot;主机名: &quot;</span> + req.getLocalName());</span><br><span class="line">        System.out.println(<span class="string">&quot;客户端PORT: &quot;</span> + req.getRemotePort());</span><br><span class="line">        System.out.println(<span class="string">&quot;当前项目部署名: &quot;</span> + req.getContextPath());</span><br><span class="line">        System.out.println(<span class="string">&quot;协议名:&quot;</span>+req.getScheme());</span><br><span class="line">        System.out.println(<span class="string">&quot;请求方式:&quot;</span>+req.getMethod());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 根据请求头名或者请求头对应的值</span></span><br><span class="line">        System.out.println(req.getHeader(<span class="string">&quot;Accept&quot;</span>));</span><br><span class="line">        <span class="comment">// 获得全部的请求头名</span></span><br><span class="line">        Enumeration&lt;String&gt; headerNames = req.getHeaderNames();</span><br><span class="line">        <span class="keyword">while</span> (headerNames.hasMoreElements())&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">headername</span> <span class="operator">=</span> headerNames.nextElement();</span><br><span class="line">            System.out.println(headername+<span class="string">&quot;:&quot;</span>+req.getHeader(headername));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-获取请求数据">3.获取请求数据</h4><ul><li><p>根据key获取指定value:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.getParameter(<span class="string">&quot;key&quot;</span>):<span class="comment">//根据key获取指定value。</span></span><br></pre></td></tr></table></figure></li><li><p>获java取复选框(checkbox组件)中的值（多个值）：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.getParameterValues(<span class="string">&quot;checkboxkey&quot;</span>):<span class="comment">//获取复选框(checkbox组件)中的值，返回一个String[]。</span></span><br></pre></td></tr></table></figure></li><li><p>获取所有提交数据的key</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.getParameterNames():<span class="comment">//获取请求中所有数据的key，该方法返回一个枚举类型。</span></span><br></pre></td></tr></table></figure></li><li><p>使用Map结构获取提交数据</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.getParameterMap():<span class="comment">//获取请求中所有的数据并存放到一个Map结构中，该方法返回一个Map，其中key为String类型value为String[]类型。</span></span><br></pre></td></tr></table></figure></li><li><p>设置请求编码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>)</span><br></pre></td></tr></table></figure><p>请求的数据包基于字节在网络上传输，Tomcat接收到请求的数据包后会将数据包中的字节转换为字符。在Tomcat中使用的是ISO-8859-1的单字节编码完成字节与字符的转换，所以数据中含有中文就会出现乱码，可以通过req.setCharacterEncoding(“utf-8”)方法来对提交的数据根据指定的编码方式重新做编码处理。</p></li></ul><h2 id="案例3-HTTP请求">案例3:HTTP请求</h2><p><strong>需求 ：获得前端客户端表单中请求的数据信息</strong></p><h3 id="前端代码">前端代码</h3><h4 id="开发form表单注意事项">开发form表单注意事项</h4><ol><li><p>form 不是from</p></li><li><p>form表单内部不是所有的标签信息都会提交 一些输入信息  input select textarea … …</p></li><li><p>提交的标签必须具备<strong>name属性</strong>  name属性的作用是让后台区分数据  id便于在前端区分数据</p></li><li><p>提交的标签一般都要具备<strong>value属性</strong>  value属性确定我们要提交的具体的数据</p></li><li><p>==get post==<a href="#get%E5%92%8Cpost%E7%9A%84%E5%8C%BA%E5%88%AB">区别</a><br>get方式数据是通过URL携带<br>提交的数据只能是文本<br>提交的数据量不大<br>get方式提交的数据相对不安全</p><p>post 将数据单独打包放到请求体中<br>提交的数据可以是文本可以是各种文件<br>提交的数据量理论上没有上限<br>post方式提交数据相对安全</p></li></ol><p>==readonly只读== 也是会提交数据的<br>==hidden==  隐藏 也是会提交数据<br>==disabled== 不可用 显示但是不提交</p><p><strong>代码：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">&quot;get&quot;</span> action=<span class="string">&quot;myServlet&quot;</span>&gt;</span><br><span class="line">    &lt;table style=<span class="string">&quot;margin: 0px auto&quot;</span> width=<span class="string">&quot;300px&quot;</span> cellpadding=<span class="string">&quot;0px&quot;</span> cellspacing=<span class="string">&quot;0px&quot;</span> border=<span class="string">&quot;1px&quot;</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;用户名&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span> id=<span class="string">&quot;in1&quot;</span> value=<span class="string">&quot;12345&quot;</span> disabled &gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;密码&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;input type=<span class="string">&quot;password&quot;</span> name=<span class="string">&quot;pwd&quot;</span>&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;性别&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;input type=<span class="string">&quot;radio&quot;</span> name=<span class="string">&quot;gender&quot;</span> value=<span class="string">&quot;1&quot;</span> checked&gt;男</span><br><span class="line">                &lt;input type=<span class="string">&quot;radio&quot;</span> name=<span class="string">&quot;gender&quot;</span> value=<span class="string">&quot;0&quot;</span>&gt;女</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;爱好&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;input type=<span class="string">&quot;checkbox&quot;</span> name=<span class="string">&quot;hobby&quot;</span> value=<span class="string">&quot;1&quot;</span>&gt;蓝球</span><br><span class="line">                &lt;input type=<span class="string">&quot;checkbox&quot;</span> name=<span class="string">&quot;hobby&quot;</span> value=<span class="string">&quot;2&quot;</span>&gt;足球</span><br><span class="line">                &lt;input type=<span class="string">&quot;checkbox&quot;</span> name=<span class="string">&quot;hobby&quot;</span> value=<span class="string">&quot;3&quot;</span>&gt;羽毛球</span><br><span class="line">                &lt;input type=<span class="string">&quot;checkbox&quot;</span> name=<span class="string">&quot;hobby&quot;</span> value=<span class="string">&quot;4&quot;</span>&gt;乒乓球</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;个人简介&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;!--文本域 双标签 页面上显示的文字是双标签中的文本 不是value属性</span><br><span class="line"></span><br><span class="line">                    文本域提交的数据不是value属性值,是双标签中的文本</span><br><span class="line">                --&gt;</span><br><span class="line">                &lt;textarea name=<span class="string">&quot;introduce&quot;</span> &gt;b&lt;/textarea&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line"></span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;籍贯&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;!--</span><br><span class="line">                select</span><br><span class="line">                option没有定义value属性 那么就提交option中间的文字(不推荐)</span><br><span class="line"></span><br><span class="line">                --&gt;</span><br><span class="line">                &lt;select name=<span class="string">&quot;provience&quot;</span>&gt;</span><br><span class="line">                    &lt;option value=<span class="string">&quot;1&quot;</span>&gt;a京&lt;/option&gt;</span><br><span class="line">                    &lt;option value=<span class="string">&quot;2&quot;</span>&gt;b津&lt;/option&gt;</span><br><span class="line">                    &lt;option value=<span class="string">&quot;3&quot;</span>&gt;c冀&lt;/option&gt;</span><br><span class="line">                &lt;/select&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr align=<span class="string">&quot;center&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">            &lt;td colspan=<span class="string">&quot;2&quot;</span>&gt;</span><br><span class="line">                &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交数据&quot;</span>&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure><p><strong>效果：</strong></p><img src="JavaEE/20210803102738-20220507093630489.png" alt="image-20210803102513541" style="zoom: 50%;" /><h3 id="Servlet代码">Servlet代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// req获取参数</span></span><br><span class="line">        <span class="comment">// 如果 前端发过来的数据由数据名但是没有值, getParameter返回的是一个空字符串  &quot;&quot;</span></span><br><span class="line">        <span class="comment">// 获取的参数在提交的数据中名都没有,getParameter返回的是null</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;username:&quot;</span>+username);</span><br><span class="line">        System.out.println(<span class="string">&quot;password:&quot;</span>+req.getParameter(<span class="string">&quot;pwd&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;gender:&quot;</span>+req.getParameter(<span class="string">&quot;gender&quot;</span>));</span><br><span class="line">        <span class="comment">// hobby=1&amp;hobby=2&amp;hobby=3 想要获得多个同名的参数 getParameterValues 返回的是一个Sting数组</span></span><br><span class="line">        String[] hobbies = req.getParameterValues(<span class="string">&quot;hobby&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;hobbies:&quot;</span>+ Arrays.toString(hobbies));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// textarea</span></span><br><span class="line">        System.out.println(<span class="string">&quot;introduce:&quot;</span>+req.getParameter(<span class="string">&quot;introduce&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// select</span></span><br><span class="line">        System.out.println(<span class="string">&quot;provience:&quot;</span>+req.getParameter(<span class="string">&quot;provience&quot;</span>));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;___________________________&quot;</span>);</span><br><span class="line">        <span class="comment">// 如果不知道参数的名字?</span></span><br><span class="line">        <span class="comment">// 获取所有的参数名</span></span><br><span class="line">        Enumeration&lt;String&gt; pNames = req.getParameterNames();</span><br><span class="line">        <span class="keyword">while</span>(pNames.hasMoreElements())&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">pname</span> <span class="operator">=</span> pNames.nextElement();</span><br><span class="line">            String[] pValues = req.getParameterValues(pname);</span><br><span class="line">            System.out.println(pname+<span class="string">&quot;:&quot;</span>+Arrays.toString(pValues));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;________________________________&quot;</span>);</span><br><span class="line">        Map&lt;String, String[]&gt; pmap = req.getParameterMap();</span><br><span class="line">        Set&lt;Map.Entry&lt;String, String[]&gt;&gt; entries = pmap.entrySet();</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, String[]&gt; entry : entries) &#123;</span><br><span class="line">            System.out.println(entry.getKey()+<span class="string">&quot;:&quot;</span>+Arrays.toString(entry.getValue()));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="JavaEE/20210803102814-20220507093630541.png" alt="image-20210803102714186" style="zoom:50%;" /><h2 id="3-HttpServletResponse">3. HttpServletResponse</h2><p>http响应部分可以分为三部分：<strong>响应行，响应头，响应体</strong></p><h3 id="响应行">响应行</h3><p><img src="JavaEE/20210803161928-20220507093630572.png" alt="image-20210803161927018"></p><p>响应状态码列表</p><p><img src="JavaEE/20210803161950-20220507093630931.png" alt="image-20210803161950030"></p><h3 id="响应头">响应头</h3><p>Content-Type：响应内容的类型(MIME)</p><p><img src="JavaEE/20210803162052-20220507093630775.png" alt="image-20210803162052600"></p><h3 id="响应实体">响应实体</h3><p>即<strong>服务器响应回来的内容</strong></p><p>​HttpServletResponse对象代表服务器的响应，封装了响应客户端浏览器的<strong>流对象</strong>，以及向客户端浏览器响应的<strong>响应头、响应数据、响应状态码等信息</strong>。</p><h4 id="ContentType-响应设置">ContentType:响应设置</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resp.setContentType(<span class="string">&quot;MIME&quot;</span>):<span class="comment">//该方法可通过MIME-Type设置响应类型。</span></span><br></pre></td></tr></table></figure><h6 id="MIME"><strong>MIME</strong></h6><p>全称是<strong>Multipurpose Internet Mail Extensions</strong>，即多用途互联网邮件扩展类型。<br>这是HTTP协议中用来定义文档性质及格式的标准。对HTTP传输内容类型进行了全面定义。<br>服务器通过MIME告知响应内容类型，而浏览器则通过MIME类型来确定如何处理文档。</p><p><strong>HTTP content-type 类型表：</strong></p><p><a href="https://www.runoob.com/http/http-content-type.html">https://www.runoob.com/http/http-content-type.html</a></p><p><strong>常见的媒体格式类型如下：</strong></p><ul><li>text/html ： HTML格式</li><li>text/plain ：纯文本格式</li><li>text/xml ： XML格式</li><li>image/gif ：gif图片格式</li><li>image/jpeg ：jpg图片格式</li><li>image/png：png图片格式</li></ul><p>以application开头的媒体格式类型：</p><ul><li>application/xhtml+xml ：XHTML格式</li><li>application/xml： XML数据格式</li><li>application/atom+xml ：Atom XML聚合格式</li><li>application/json： JSON数据格式</li><li>application/pdf：pdf格式</li><li>application/msword ： Word文档格式</li><li>application/octet-stream ： 二进制流数据（如常见的文件下载）</li><li>application/x-www-form-urlencoded ： <form encType="">中默认的encType，form表单数据被编码为key/value格式发送到服务器（表单默认的提交数据的格式）</li></ul><p>另外一种常见的媒体格式是上传文件之时使用的：</p><ul><li>multipart/form-data ： 需要在表单中进行文件上传时，就需要使用该格式</li></ul><p><strong>常见的字节型响应：</strong></p><ul><li><p>image/jpeg：图片类型为jpeg或jpg格式。</p></li><li><p>image/gif: 图片类型为gif格式。</p></li></ul><p><strong>设置响应编码</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br></pre></td></tr></table></figure><p>设置服务端为浏览器产生响应的响应编码，服务端会根据此编码将响应内容的字符转换为字节。同时客户端浏览器会根据此编码方式显示响应内容。</p><p><strong>在响应中添加附加信息（文件下载）</strong></p><p>在实现文件下载时，我们需要修改响应头，添加附加信息。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>,   <span class="string">&quot;attachment; filename=&quot;</span>+文件名);</span><br></pre></td></tr></table></figure><p>==Content-Disposition:attachment==</p><p>该附加信息表示作为对下载文件的一个标识字段。不会在浏览器中显示而是直接做下载处理。</p><p>filename=文件名,表示指定下载文件的文件名。</p><p>解决文件名中文乱码问题:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resp.addHeader(<span class="string">&quot;Content-Disposition&quot;</span>,<span class="string">&quot;attachment;filename=&quot;</span>+<span class="keyword">new</span> <span class="title class_">String</span> (file.getName().getBytes(<span class="string">&quot;gbk&quot;</span>),<span class="string">&quot;iso-8859-1&quot;</span>));</span><br></pre></td></tr></table></figure><h3 id="测试代码">测试代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServlet2</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 设置响应码</span></span><br><span class="line">        <span class="comment">//resp.setStatus(500);</span></span><br><span class="line">        <span class="comment">//resp.setStatus(405, &quot;request method not supported&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置响应头</span></span><br><span class="line">        <span class="comment">//resp.setHeader(&quot;Date&quot;,&quot;2022-11-11&quot;);</span></span><br><span class="line">        <span class="comment">// 自定义头</span></span><br><span class="line">        <span class="comment">// resp.setHeader(&quot;aaa&quot;, &quot;bbb&quot;);</span></span><br><span class="line">        <span class="comment">// 高速浏览器响应的数据是什么? 浏览器根据此头决定 数据如何应用</span></span><br><span class="line">        <span class="comment">// 设置MIME类型 json  xml 文件下载  ... ...</span></span><br><span class="line">        <span class="comment">// resp.setHeader(&quot;content-type&quot;, &quot;text/css&quot;);</span></span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html&quot;</span>);<span class="comment">// 专门用于设置Content-Type 响应头</span></span><br><span class="line">        resp.getWriter().write(<span class="string">&quot;&lt;h1&gt;this is tag h1&lt;/h1&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="乱码问题">乱码问题</h2><h3 id="1-控制台乱码">1 控制台乱码</h3><p>设置Tomcat中 conf下logging.properties中所有的UTF-8编码为GBK即可</p><h3 id="2-post请求乱码">2 post请求乱码</h3><p>通过HttpServletRequest设置请求编码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="3-get请求乱码">3 get请求乱码</h3><p>需要手动进行编码解码,或者设置tomcat中的server.xml中的URI编码.tomcat9已经解决了该问题</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span>   <span class="attr">port</span>=<span class="string">&quot;8080&quot;</span> <span class="attr">protocol</span>=<span class="string">&quot;HTTP/1.1&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">connectionTimeout</span>=<span class="string">&quot;20000&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">redirectPort</span>=<span class="string">&quot;8443&quot;</span> <span class="attr">URIEncoding</span>=<span class="string">&quot;utf-8&quot;</span>  /&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4-响应乱码">4 响应乱码</h3><p>通过HttpServletResponse设置响应编码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//以UTF-8编码处理数据</span></span><br><span class="line">resp.setContentType(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"><span class="comment">//设置响应头,以便浏览器知道以何种编码解析数据</span></span><br><span class="line">resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="4-servlet生命周期">4. servlet生命周期</h2><h3 id="四个阶段">四个阶段</h3><p>Servlet的生命周期是由容器管理的，分别经历四个阶段：</p><table><thead><tr><th>阶段</th><th>次数</th><th>时机</th></tr></thead><tbody><tr><td>创建 new</td><td>1次</td><td>第一次请求</td></tr><tr><td>初始化 init()</td><td>1次</td><td>实例化之后</td></tr><tr><td>执行服务 service()</td><td>多次</td><td>每次请求</td></tr><tr><td>销毁 destroy()</td><td>1次</td><td>停止服务</td></tr></tbody></table><p>当客户端浏览器第一次请求Servlet时，容器会实例化这个Servlet，然后调用一次init方法，并在新的线程中执行service方法处理请求。service方法执行完毕后容器不会销毁这个Servlet而是做缓存处理，当客户端浏览器再次请求这个Servlet时，容器会从缓存中直接找到这个Servlet对象，并再一次在新的线程中执行Service方法。当容器在销毁Servlet之前对调用一次destory方法。</p><p><strong>在Servlet中我们一般不要轻易使用成员变量!!! 可能会造成线程安全问题</strong></p><p><strong>如果要使用的话,应该尽量避免对成员变量产生修改</strong></p><p><strong>如果要产生修改我们应该注意线程安全问题</strong></p><p><strong>如果我们自己添加线程安全编码处理,会严重影响效率</strong></p><p><strong>综上所述:原则,能不用成员变量就不用!!!</strong></p><p>servlet代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServlet4</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="comment">// 成员变量</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyServlet4</span><span class="params">()</span>   &#123;<span class="comment">// 构造一个Servlet对象的方法</span></span><br><span class="line">        System.out.println(<span class="string">&quot;MyServlet4 Constructor invoked&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;<span class="comment">// 初始化</span></span><br><span class="line">        System.out.println(<span class="string">&quot;MyServlet4 init invoked&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 执行服务</span></span><br><span class="line">        System.out.println(<span class="string">&quot;MyServlet4 service invoked&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;<span class="comment">// 销毁</span></span><br><span class="line">        System.out.println(<span class="string">&quot;MyServlet4 destory invoked&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>myServlet4<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.mashibing.servlet.MyServlet4<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>6<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>myServlet4<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/myServlet4.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p>​多次请求servlet并查看控制台输出即可印证上述结论,值得注意的是,如果需要Servlet在服务启动时就实例化并初始化,我们可以在servlet的配置中添加load-on-startup配置启动顺序,配置的数字为启动顺序,应避免冲突且应**&gt;6**</p><p><img src="JavaEE/20210803205411-20220507093631302.png" alt="image-20210803205409578"></p><p><strong>Servlet处理请求的过程</strong></p><p>​当浏览器基于get方式请求我们创建Servlet时，我们自定义的Servlet中的doGet方法会被执行。doGet方法能够被执行并处理get请求的原因是，容器在启动时会解析web工程中WEB-INF目录中的web.xml文件，在该文件中我们配置了Servlet与URI的绑定，容器通过对请求的解析可以获取请求资源的URI，然后找到与该URI绑定的Servlet并做实例化处理(注意：只实例化一次，如果在缓存中能够找到这个Servlet就不会再做次实例化处理)。在实例化时会使用Servlet接口类型作为引用类型的定义，并调用一次init方法，由于HttpServlet中重写了该方法所以最终执行的是HttpServlet中init方法(HttpServlet中的Init方法是一个空的方法体)，然后在新的线程中调用service方法。由于在HttpServlet中重写了Service方法所以最终执行的是HttpServlet中的service方法。在service方法中通过request.getMethod()获取到请求方式进行判断如果是Get方式请求就执行doGet方法，如果是POST请求就执行doPost方法。如果是基于GET方式提交的，并且在我们自定义的Servlet中又重写了HttpServlet中的doGet方法，那么最终会根据Java的多态特性转而执行我们自定义的Servlet中的doGet方法。</p><p><img src="JavaEE/20210803205435-20220507093630830.png" alt="image-20210803205435158"></p><ul><li>老程序员喜欢重写doGet()和doPost()方法 然后挑一个方法里面直接调用另一个方法，因为两个方法很相似。</li><li>但是又可以直接重写service，可以同时处理get和post</li></ul><h2 id="5-ServletContext和ServletConfig">5. ServletContext和ServletConfig</h2><h3 id="ServletContext-application">ServletContext(application)</h3><h4 id="定义-2">定义</h4><p>ServletContext官方叫Servlet上下文。服务器会为每一个Web应用创建一个ServletContext对象。这个对象全局唯一，而且Web应用中的所有Servlet都共享这个对象。所以叫全局应用程序共享对象</p><img src="JavaEE/20210804094215-20220507093631574.png" alt="image-20210804094215771" style="zoom:67%;" /><h4 id="作用">作用</h4><ul><li>相对路径转绝对路径</li><li>获取容器的附加信息</li><li>读取配置信息</li><li>全局容器</li></ul><h4 id="操作">操作</h4><ul><li><p>获取项目的部署名<br>==context.getContextPath()==</p></li><li><p>相对路径转绝对路径(文件上传下载时需要注意)</p><p>==context.getRealPath(“path”)==</p><p>该方法可以将一个相对路径转换为绝对路径，在文件上传与下载时需要用到该方法做路径的转换。</p></li><li><p>获取容器的附加信息</p><p>==servletContext.getServerInfo()==</p></li><li><p>返回Servlet容器的名称和版本号</p><ul><li><p>返回Servlet容器所支持Servlet的主版本号</p><p>==servletContext.getMajorVersion()==</p></li><li><p>返回Servlet容器所支持Servlet的副版本号</p><p>==servletContext.getMinorVersion()==</p></li></ul></li><li><p>获取web.xml文件中的信息</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>key<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>value<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>读取web.xml文件中<context-param>标签中的配置信息</p><p>==servletContext.getInitParameter(“key”)==</p></li><li><p>读取web.xml文件中所有param-name标签中的值。</p><p>==servletContext.getInitParameterNames()==</p></li></ul></li><li><p>全局容器</p><ul><li><p>向全局容器中存放数据。</p><p>==servletContext.setAttribute(“key”,ObjectValue)==</p></li><li><p>从全局容器中获取数据。</p><p>==servletContext.getAttribute(“key”)==</p></li><li><p>根据key删除全局容器中的value。</p><p>==servletContext.removeAttribute(“key”)==</p></li></ul></li></ul><h5 id="测试代码：">测试代码：</h5><p><strong>xml配置</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>username<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>mashibing<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>password<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>servlet1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.msb.testServlet.Servlet1<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>servlet1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/servlet1.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>servlet</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet1</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//1 通过req获取Servlet对象</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext1</span> <span class="operator">=</span> req.getServletContext();</span><br><span class="line">        <span class="comment">//通过继承的方法获取Servlet对象</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext2</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext();</span><br><span class="line">        <span class="comment">//比较两种获取方法获取的对象</span></span><br><span class="line">        System.out.println(servletContext1==servletContext2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2 获取部署名</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">contextPath</span> <span class="operator">=</span> servletContext1.getContextPath();</span><br><span class="line">        System.out.println(<span class="string">&quot;contextPath&quot;</span>+contextPath);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3 将一个相对路径转换为项目的绝对路径</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fileUpload</span> <span class="operator">=</span> servletContext1.getRealPath(<span class="string">&quot;fileUpload&quot;</span>);</span><br><span class="line">        System.out.println(fileUpload);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4 获取容器的附加信息</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">serverInfo</span> <span class="operator">=</span> servletContext1.getServerInfo();</span><br><span class="line">        System.out.println(serverInfo);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5 获取Servlet容器的名称和版本号</span></span><br><span class="line">        <span class="comment">//主版本号</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">majorVersion</span> <span class="operator">=</span> servletContext1.getMajorVersion();</span><br><span class="line">        <span class="comment">//副版本号</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">minorVersion</span> <span class="operator">=</span> servletContext1.getMinorVersion();</span><br><span class="line">        System.out.println(<span class="string">&quot;majorVersion&quot;</span>+majorVersion);</span><br><span class="line">        System.out.println(<span class="string">&quot;minorVersion&quot;</span>+minorVersion);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//6 读取web.xml文件信息</span></span><br><span class="line">        <span class="comment">//获取配置的全局初始信息</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> servletContext1.getInitParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> servletContext1.getInitParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;username&quot;</span>+username);</span><br><span class="line">        System.out.println(<span class="string">&quot;password&quot;</span>+password);</span><br><span class="line">        <span class="comment">//配置信息名称未知情况下 获取全局初始信息</span></span><br><span class="line">        Enumeration&lt;String&gt; pNames = servletContext1.getInitParameterNames();</span><br><span class="line">        <span class="keyword">while</span> (pNames.hasMoreElements())&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">e</span> <span class="operator">=</span> pNames.nextElement();</span><br><span class="line">            System.out.println(e+<span class="string">&quot;:&quot;</span>+ servletContext1.getInitParameter(e));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//7 向ServletContext对象中增加数据域对象</span></span><br><span class="line">        List&lt;String&gt; data = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        Collections.addAll(data,<span class="string">&quot;张三&quot;</span>,<span class="string">&quot;李四&quot;</span>,<span class="string">&quot;王武&quot;</span>);</span><br><span class="line">        servletContext1.setAttribute(<span class="string">&quot;list&quot;</span>,data);</span><br><span class="line">        servletContext1.setAttribute(<span class="string">&quot;gender&quot;</span>,<span class="string">&quot;boy&quot;</span>);</span><br><span class="line">        <span class="comment">//getAttribute也可以获得初始信息对象</span></span><br><span class="line">        List&lt;String&gt; list = (List&lt;String&gt;) servletContext1.getAttribute(<span class="string">&quot;list&quot;</span>);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        <span class="type">String</span> <span class="variable">gender</span> <span class="operator">=</span> (String) servletContext1.getAttribute(<span class="string">&quot;gender&quot;</span>);</span><br><span class="line">        System.out.println(gender);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>测试结果</p><p><img src="JavaEE/20210804112525-20220507093631140.png" alt="image-20210804112522391"></p><h4 id="生命周期">生命周期</h4><p>​当容器启动是会创建ServletContext对象并一直缓存该对象，知道容器关闭后该对象生命周期结束。ServletContext对象的生命周期非常长，所以在使用全局容器时不建议存放业务数据</p><h3 id="ServletConfig">ServletConfig</h3><h4 id="定义-3">定义</h4><p>ServletConfig对象对应web.xml文件中的<servlet>节点。当Tomcat初始化一个Servlet时，会将该Servlet的配置信息，封装到一个ServletConfig对象中。</p><h4 id="操作-2">操作</h4><p>我们通过Config对象读取servlet节点中的配置信息</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>servletName<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servletClass<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>key<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>value<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>读取web.xml文件中<servlet>标签中<init-param>标签中的配置信息。</p><p>==servletConfig.getInitParameter(“key”);==</p></li><li><p>读取web.xml文件中当前<servlet>标签中所有<init-param>标签中的值。</p><p>==servletConfig.getInitParameterNames();==</p></li></ul><h5 id="测试代码-2">测试代码</h5><p><strong>xml配置</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>servlet3<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.msb.testServlet.Servlet3<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>brand<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>ASUS<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>screen<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>三星<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>servlet4<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.msb.testServlet.Servlet4<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>pinpai<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>联想<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>pingmu<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>京东方<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>servlet3<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/servlet3.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>servlet4<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/servlet4.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>servlet</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet3</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">ServletConfig</span> <span class="variable">servletConfig</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletConfig();</span><br><span class="line">        System.out.println(servletConfig.getInitParameter(<span class="string">&quot;brand&quot;</span>));</span><br><span class="line">        System.out.println(servletConfig.getInitParameter(<span class="string">&quot;screen&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet4</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">ServletConfig</span> <span class="variable">servletConfig</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletConfig();</span><br><span class="line">        System.out.println(servletConfig.getInitParameter(<span class="string">&quot;pinpai&quot;</span>));</span><br><span class="line">        System.out.println(servletConfig.getInitParameter(<span class="string">&quot;pingmu&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="6-URL的匹配规则">6. URL的匹配规则</h2><h3 id="精确匹配">精确匹配</h3><p>精确匹配是指<url-pattern>中配置的值必须与url完全精确匹配。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>demoServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/demo.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a href="http://localhost:8888/demo/demo.do">http://localhost:8888/demo/demo.do</a> 匹配</p><p><a href="http://localhost:8888/demo/suibian/demo.do">http://localhost:8888/demo/suibian/demo.do</a> 不匹配</p><h3 id="扩展名匹配">扩展名匹配</h3><p>在<url-pattern>允许使用统配符“<em>”作为匹配规则，“</em>”表示匹配任意字符。在扩展名匹配中只要扩展名相同都会被匹配和路径无关。注意，在使用扩展名匹配时在<url-pattern>中不能使用“/”，否则容器启动就会抛出异常。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>demoServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a href="http://localhost:8888/demo/abc.do">http://localhost:8888/demo/abc.do</a> 匹配</p><p><a href="http://localhost:8888/demo/suibian/haha.do">http://localhost:8888/demo/suibian/haha.do</a> 匹配</p><p><a href="http://localhost:8888/demo/abc">http://localhost:8888/demo/abc</a> 不匹配</p><h3 id="路径匹配">路径匹配</h3><p>根据请求路径进行匹配，在请求中只要包含该路径都匹配，“*”表示任意路径以及子路径</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>demoServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/suibian/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a href="http://localhost:8888/demo/suibian/haha.do">http://localhost:8888/demo/suibian/haha.do</a> 匹配</p><p><a href="http://localhost:8888/demo/suibian/hehe/haha.do">http://localhost:8888/demo/suibian/hehe/haha.do</a> 匹配</p><p><a href="http://localhost:8888/demo/hehe/heihei.do">http://localhost:8888/demo/hehe/heihei.do</a> 不匹配</p><h3 id="任意匹配">任意匹配</h3><p>匹配“/ 匹配所有但不包括JSP页面</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a href="http://localhost:8888/demo/suibian.do%E5%8C%B9%E9%85%8D">http://localhost:8888/demo/suibian.do匹配</a></p><p><a href="http://localhost:8888/demo/addUser.html%E5%8C%B9%E9%85%8D">http://localhost:8888/demo/addUser.html匹配</a></p><p><a href="http://localhost:8888/demo/css/view.css%E5%8C%B9%E9%85%8D">http://localhost:8888/demo/css/view.css匹配</a></p><p><a href="http://localhost:8888/demo/addUser.jsp%E4%B8%8D%E5%8C%B9%E9%85%8D">http://localhost:8888/demo/addUser.jsp不匹配</a></p><p><a href="http://localhost:8888/demo/user/addUser.jsp%E4%B8%8D%E5%8C%B9%E9%85%8D">http://localhost:8888/demo/user/addUser.jsp不匹配</a></p><h3 id="匹配所有">匹配所有</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a href="http://localhost:8888/demo/suibian.do%E5%8C%B9%E9%85%8D">http://localhost:8888/demo/suibian.do匹配</a></p><p><a href="http://localhost:8888/demo/addUser.html%E5%8C%B9%E9%85%8D">http://localhost:8888/demo/addUser.html匹配</a></p><p><a href="http://localhost:8888/demo/suibian/suibian.do%E5%8C%B9%E9%85%8D">http://localhost:8888/demo/suibian/suibian.do匹配</a></p><h3 id="优先顺序">优先顺序</h3><p>当一个url与多个Servlet的匹配规则可以匹配时，则按照 “ 精确路径 &gt; 最长路径 &gt;扩展名”这样的优先级匹配到对应的Servlet。</p><h4 id="案例分析">案例分析</h4><p>Servlet1映射到 /abc/*</p><p>Servlet2映射到 /*</p><p>Servlet3映射到 /abc</p><p>Servlet4映射到 *.do</p><p>当请求URL为“/abc/a.html”，“/abc/<em>”和“/</em>”都匹配，Servlet引擎将调用Servlet1。</p><p>当请求URL为“/abc”时，“/abc/*”和“/abc”都匹配，Servlet引擎将调用Servlet3。</p><p>当请求URL为“/abc/a.do”时，“/abc/<em>”和“</em>.do”都匹配，Servlet引擎将调用Servlet1。</p><p>当请求URL为“/a.do”时，“/<em>”和“</em>.do”都匹配，Servlet引擎将调用Servlet2。</p><p>当请求URL为“/xxx/yyy/a.do”时，“/<em>”和“</em>.do”都匹配，Servlet引擎将调用Servlet2。</p><h3 id="URL映射方式">URL映射方式</h3><p>在web.xml文件中支持将多个URL映射到一个Servlet中，但是相同的URL不能同时映射到两个Servlet中。</p><h4 id="方式一">方式一</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>demoServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/suibian/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="方式二">方式二</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>demoServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/suibian/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>demoServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="7-注解开发">7. 注解开发</h2><p><strong>基于注解式开发Servlet</strong></p><p>​在Servlet3.0以及之后的版本中支持注解式开发Servlet。对于Servlet的配置不在依赖于web.xml配置文件而是使用@WebServlet将一个继承于javax.servlet.http.HttpServlet的类定义为Servlet组件。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> WebServlet &#123;</span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    String[] value() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    String[] urlPatterns() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">loadOnStartup</span><span class="params">()</span> <span class="keyword">default</span> -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    WebInitParam[] initParams() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">asyncSupported</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">smallIcon</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">largeIcon</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">description</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">displayName</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="相关属性">相关属性</h3><p><img src="JavaEE/20210804163548-20220507093631188.png" alt="image-20210804163546326"></p><h2 id="8-forward-请求转发">8. forward 请求转发</h2><h3 id="forward处理流程">forward处理流程</h3><ol><li>清空Response存放响应正文数据的缓冲区</li><li>如果目标资源为Servlet或JSP，就调用它们的service()方法，把该方法产生的响应结果发送到客户端；如果目标资源文件系统中的静态HTML，就读取文档中的数据把它发送到客户端。</li></ol><p><img src="JavaEE/20210804165930-20220507093631487.png" alt="image-20210804165930737"></p><ul><li>请求转发是一种<strong>服务器的行为</strong>,是对浏览器屏蔽</li><li>浏览器的地址栏不会发生变化</li><li>请求的参数是可以从源组件传递到目标组件的</li><li>请求对象和响应对象没有重新创建,而是传递给了目标组件</li><li>请求转发可以帮助我们完成页面的跳转</li><li>请求转发可以转发至WEB-INF里</li><li>请求转发只能转发给当前项目的内部资源,不能转发至外部资源</li><li>常用forward</li></ul><h3 id="forword处理特点">forword处理特点</h3><ol><li>由于forword()方法先清空用于存放响应正文的缓冲区，因此源Servlet生成的响应结果不会被发送到客户端，只有目标资源生成的响应结果才会被发送到客户端。</li><li>如果源Servlet在进行请求转发之前，已经提交了响应结（flushBuffer(),close()方法），那么forward()方法抛出IllegalStateException。为了避免该异常，不应该在源Servlet中提交响应结果。</li></ol><h4 id="注意">注意</h4><ol><li><p>在forward转发模式下,请求应该完全交给目标资源去处理,我们在源组件中,不要作出任何的响应处理</p></li><li><p>在forward方法调用之后,也不要在使用req和resp对象做其他操作了</p></li></ol><h3 id="测试代码-3">测试代码</h3><p>servlet1 请求转发至 servlet2</p><p><strong>servlet1</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &quot;/servlet1.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet1</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;servlet1 service invoked&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">money</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;money&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;money:&quot;</span>+money);</span><br><span class="line">        <span class="comment">// 设置响应类型和编码(include模式下)</span></span><br><span class="line">        <span class="comment">/*  resp.setCharacterEncoding(&quot;UTF-8&quot;);</span></span><br><span class="line"><span class="comment">        resp.setContentType(&quot;text/html;charset=UTF-8&quot;);*/</span></span><br><span class="line">        <span class="comment">// 增加响应内容</span></span><br><span class="line">        <span class="comment">//resp.getWriter().println(&quot;servlet1在转发之前增加的响应内容&quot;);</span></span><br><span class="line">        <span class="comment">// 请求转发给另一个组件</span></span><br><span class="line">        <span class="comment">// 获得一个请求转发器</span></span><br><span class="line">        <span class="comment">//RequestDispatcher requestDispatcher = req.getRequestDispatcher(&quot;servlet2.do&quot;);</span></span><br><span class="line">        <span class="comment">//RequestDispatcher requestDispatcher = req.getRequestDispatcher(&quot;aaa.html&quot;);</span></span><br><span class="line">        <span class="comment">//RequestDispatcher requestDispatcher = req.getRequestDispatcher(&quot;index.jsp&quot;);</span></span><br><span class="line">        <span class="comment">//RequestDispatcher requestDispatcher = req.getRequestDispatcher(&quot;WEB-INF/bbb.html&quot;);</span></span><br><span class="line">        <span class="type">RequestDispatcher</span> <span class="variable">requestDispatcher</span> <span class="operator">=</span> req.getRequestDispatcher(<span class="string">&quot;https://www.baidu.com&quot;</span>);</span><br><span class="line">        <span class="comment">// 由请求转发器作出转发动作</span></span><br><span class="line">        requestDispatcher.forward(req,resp);<span class="comment">// 托管给目标资源(forward多一些)</span></span><br><span class="line">        <span class="comment">//requestDispatcher.include(req,resp);  // 让目标资源完成部分工作</span></span><br><span class="line">        <span class="comment">// 继续增加响应信息 (include模式)</span></span><br><span class="line">        <span class="comment">//resp.getWriter().println(&quot;servlet1在转发之后增加的响应内容&quot;);</span></span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>Servlet2</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &quot;/servlet2.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet2</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;servlet2 service invoked&quot;</span>);</span><br><span class="line">        <span class="comment">// 接收参数</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">money</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;money&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;money:&quot;</span>+money);</span><br><span class="line">        <span class="comment">// 作出响应 (在forWord模式下)</span></span><br><span class="line">        resp.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">writer</span> <span class="operator">=</span> resp.getWriter();</span><br><span class="line">        writer.println(<span class="string">&quot;支付宝到账:&quot;</span>+money+<span class="string">&quot;元&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="include（了解）">include（了解）</h3><p>在include转发模式下,设置响应可以在转发之前,也可以在转发之后</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*servlet1在转发之前增加的响应内容*/</span></span><br><span class="line"><span class="comment">// 设置响应类型和编码(include模式下)</span></span><br><span class="line">        resp.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">        <span class="comment">// 增加响应内容</span></span><br><span class="line">        resp.getWriter().println(<span class="string">&quot;servlet1在转发之前增加的响应内容&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获得一个请求转发器</span></span><br><span class="line">        <span class="type">RequestDispatcher</span> <span class="variable">requestDispatcher</span> <span class="operator">=</span> req.getRequestDispatcher(<span class="string">&quot;servlet2.do&quot;</span>);</span><br><span class="line"><span class="comment">// 让目标资源完成部分工作</span></span><br><span class="line">requestDispatcher.include(req,resp);  </span><br><span class="line"></span><br><span class="line"><span class="comment">/*servlet1在转发之后增加的响应内容*/</span></span><br><span class="line"><span class="comment">// 继续增加响应信息 (include模式)</span></span><br><span class="line">resp.getWriter().println(<span class="string">&quot;servlet1在转发之后增加的响应内容&quot;</span>);</span><br></pre></td></tr></table></figure><p>但是不常用的</p><h2 id="9-sendRedirect-响应重定向">9. sendRedirect 响应重定向</h2><p>响应重定向是通过HttpServletResponse对象sendRedirect(“路径”)的方式。实现是——服务器通知浏览器,让浏览器去自主请求其他资源的一种方式</p><p><img src="JavaEE/20210804171205-20220507093631361.png" alt="image-20210804171130006"></p><h3 id="运作流程：">运作流程：</h3><ol><li>用户在浏览器端输入特定URL，请求访问服务器端的某个Servlet。</li><li>服务器端的Servlet返回一个状态码为302的响应结果，该响应结果的含义为：让浏览器端再请求访问另一个Web资源，在响应结果中提供了另一个Web资源的URL。另一个Web资源有可能在同一个Web服务器上，也有可能不再同一个Web服务器上。</li><li>当浏览器端接收到这种响应结果后，再立即自动请求访问另一个Web资源。</li><li>浏览器端接收到另一个Web资源的响应结果。</li></ol><h3 id="测试代码-4">测试代码:</h3><p><strong>servlet3</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &quot;/servlet3.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet3</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;servlet3 service invoked&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">money</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;money&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;money:&quot;</span>+money);</span><br><span class="line">        <span class="comment">// 响应重定向</span></span><br><span class="line">        resp.sendRedirect(<span class="string">&quot;servlet4.do?money=&quot;</span>+money);</span><br><span class="line">        <span class="comment">//resp.sendRedirect(&quot;WEB-INF/bbb.html&quot;);</span></span><br><span class="line">        <span class="comment">//resp.sendRedirect(&quot;https://www.baidu.com&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>servlet4</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &quot;/servlet4.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet4</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;servlet4 service invoked&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">money</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;money&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;money:&quot;</span>+money);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="注意-2">注意</h3><ol><li>重定向是服务器给浏览器重新指定请求方向 是一种<strong>浏览器行为</strong> 地址栏会发生变化</li><li>重定向时,请求对象和响应对象都会再次产生,请求中的参数是不会携带</li><li>重定向也可以帮助我们完成页面跳转</li><li>重定向不能帮助我们访问WEB-INF中的资源</li><li>重定向可以定向到外部资源</li></ol><h2 id="10-路径问题">10. 路径问题</h2><h3 id="前端路径">前端路径</h3><p>项目结构</p><img src="JavaEE/20210804210749-20220507093631233.png" alt="image-20210804201746315" style="zoom:67%;" /><p>测试代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    base标签的作用是在相对路径之前自动补充base[href]中的值</span></span><br><span class="line"><span class="comment">    如果base标签不写,那么默认就是当前文件所在的路径</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">&quot;http://127.0.0.1:8080/testServlet4_war_exploded/&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;base href=&quot;http://127.0.0.1:8080/testServlet4_war_exploded/a/a2/&quot;&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">this is page a1</span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    相对(基准)路径:以当前文件本身的位置去定位其他文件,相对自己的路径,以当前文件所在的位置为基准位置</span></span><br><span class="line"><span class="comment">    绝对(基准)路径:以一个固定的位置去定位其他文文件,以一个固定的路径作为定位文件的基准位置,和文件本身位置无关</span></span><br><span class="line"><span class="comment">    相对路径,不以/开头,就是相对路径  ..代表向上一层</span></span><br><span class="line"><span class="comment">    绝对路径,以/开头   在页面上 /代表从项目的部署目录开始找  从webapps中开始找</span></span><br><span class="line"><span class="comment">    页面的绝对路径要有项目名,除非我们的项目没有设置项目名</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;a2.html&quot;</span> <span class="attr">TARGET</span>=<span class="string">&quot;_self&quot;</span>&gt;</span>相对路径跳转至A2<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;../../b/b2/b1.html&quot;</span> <span class="attr">TARGET</span>=<span class="string">&quot;_self&quot;</span>&gt;</span>相对路径跳转至b1<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;a/a2/a2.html&quot;</span> <span class="attr">TARGET</span>=<span class="string">&quot;_self&quot;</span>&gt;</span>base相对路径跳转至A2<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;b/b2/b1.html&quot;</span> <span class="attr">TARGET</span>=<span class="string">&quot;_self&quot;</span>&gt;</span>base相对路径跳转至b1<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/testServlet4_war_exploded/a/a2/a2.html&quot;</span> <span class="attr">TARGET</span>=<span class="string">&quot;_self&quot;</span>&gt;</span>绝对路径跳转至A2<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/testServlet4_war_exploded/b/b2/b1.html&quot;</span> <span class="attr">TARGET</span>=<span class="string">&quot;_self&quot;</span>&gt;</span>绝对路径跳转至b1<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="总结">总结</h4><ol><li><p>以/开头的路径是绝对路径,不以/开头是相对路径</p></li><li><p>绝对路径/后面要写当前服务的上下文路径名</p></li><li><p>==…/==代表向上一层的路径</p></li><li><p>==base标签==可以简化相对路径,当使用相对路径时,默认会在相对路径之前补充 base中的内容；如果没有定义base 默认就是当前文件所在的路径</p></li></ol><h2 id="11-会话管理">11. 会话管理</h2><h3 id="认识Cookie和Session">认识Cookie和Session</h3><p>Cookie对象与HttpSession对象的作用是维护客户端浏览器与服务端的会话状态的两个对象。由于HTTP协议是一个无状态的协议，所以服务端并不会记录当前客户端浏览器的访问状态，但是在有些时候我们是需要服务端能够记录客户端浏览器的访问状态的，如获取当前客户端浏览器的访问服务端的次数时就需要会话状态的维持。在Servlet中提供了Cookie对象与HttpSession对象用于维护客户端与服务端的会话状态的维持。二者不同的是Cookie是通过客户端浏览器实现会话的维持，而HttpSession是通过服务端来实现会话状态的维持。</p><img src="JavaEE/20210805102003-20220507093631748.png" alt="image-20210805101816416" style="zoom: 50%;" /><img src="JavaEE/20210805102039-20220507093631952.png" alt="image-20210805102039111" style="zoom: 50%;" /><h3 id="Cookie">Cookie</h3><p>Cookie是一种保存少量信息至浏览器的一种技术,第一请求时,服务器可以响应给浏览器一些Cookie信息,第二次请求,浏览器会携带之前的cookie发送给服务器,通过这种机制可以实现在浏览器端保留一些用户信息.为服务端获取用户状态获得依据</p><h4 id="特点-3">特点</h4><ul><li><p>Cookie使用字符串存储数据</p></li><li><p>Cookie使用Key与Value结构存储数据</p></li><li><p>单个Cookie存储数据大小限制在4097个字节</p></li><li><p>Cookie存储的数据中不支持中文，Servlet4.0中支持</p></li><li><p>Cookie是与域名绑定所以不支持跨一级域名访问</p></li><li><p>Cookie对象保存在客户端浏览器内存上或系统磁盘中</p></li><li><p>Cookie分为持久化Cookie(保存在磁盘上)与状态Cookie(保存在内存上)</p></li><li><p>浏览器在保存同一域名所返回Cookie的数量是有限的。不同浏览器支持的数量不同，Chrome浏览器为50个</p></li><li><p>浏览器每次请求时都会把与当前访问的域名相关的Cookie在请求中提交到服务端。</p></li></ul><h4 id="创建对象和响应">创建对象和响应</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;value&quot;</span>)</span><br><span class="line"><span class="comment">//通过new关键字创建Cookie对象</span></span><br><span class="line">response.addCookie(cookie)</span><br><span class="line"><span class="comment">//通过HttpServletResponse对象将Cookie写回给客户端浏览器。</span></span><br></pre></td></tr></table></figure><h4 id="数据的获取">数据的获取</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过HttpServletRequest对象获取Cookie，返回Cookie数组。</span></span><br><span class="line">Cookie[] cookies = request.getCookies()</span><br></pre></td></tr></table></figure><h4 id="Cookie持久化和状态Cookie">Cookie持久化和状态Cookie</h4><ul><li>==状态Cookie==：浏览器会缓存Cookie对象。浏览器关闭后Cookie对象销毁。</li><li>==持久化Cookie==：浏览器会对Cookie做持久化处理，基于文件形式保存在系统的指定目录中。在Windows10系统中为了安全问题不会显示Cookie中的内容。</li></ul><p>​       当Cookie对象创建后<strong>默认为状态Cookie</strong>。可以使用Cookie对象下的==cookie.setMaxAge(60)==方法设置失效时间，单位为秒。一旦设置了失效时间，那么该Cookie为持久化Cookie，浏览器会将Cookie对象持久化到磁盘中。当失效时间到达后文件删除。</p><h4 id="测试代码-5">测试代码</h4><p><strong>通过响应对象 向浏览器响应cookie</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &quot;/servlet1.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet1</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 通过响应对象,向浏览器响应一些Cookie</span></span><br><span class="line">        Cookie c1=<span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;age&quot;</span>,<span class="string">&quot;10&quot;</span>);<span class="comment">// 状态Cookie 重启即清除</span></span><br><span class="line">        Cookie c2=<span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;gender&quot;</span>, <span class="string">&quot;男&quot;</span>);<span class="comment">//持久化Cookie 让浏览器保留1分钟</span></span><br><span class="line">        <span class="comment">//c2.setMaxAge(60);// 秒钟    持久化Cookie 让浏览器保留1分钟</span></span><br><span class="line">        resp.addCookie(c1);</span><br><span class="line">        resp.addCookie(c2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>获取请求中cookie</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &quot;/servlet2.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet2</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 读取请求中的Cookie</span></span><br><span class="line">        Cookie[] cookies = req.getCookies();</span><br><span class="line">        <span class="comment">//cookies不为null</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="literal">null</span> != cookies)&#123;</span><br><span class="line">            <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</span><br><span class="line">                System.out.println(cookie.getName()+<span class="string">&quot;=&quot;</span>+cookie.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="案例：通过Cookie判断用户是否访问过当前Servlet">案例：通过Cookie判断用户是否访问过当前Servlet</h4><p>需求：</p><p>​                                                                                                                                                                                      当客户端浏览器第一次访问Servlet时返回“您好，欢迎您第一次访问！”，第二次访问时返回“欢迎您回来！”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &quot;/servlet3.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Servlet3</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 如果是第一访问当前Servlet.向浏览器响应一个cookie (&quot;servlet3&quot;,&quot;1&quot;)</span></span><br><span class="line">        <span class="comment">// 如果是多次访问,就再次数上+1</span></span><br><span class="line">        Cookie[] cookies = req.getCookies();</span><br><span class="line">        <span class="type">boolean</span>  <span class="variable">flag</span> <span class="operator">=</span><span class="literal">false</span> ;</span><br><span class="line">        <span class="keyword">if</span>(<span class="literal">null</span> !=cookies)&#123;</span><br><span class="line">            <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">cookieName</span> <span class="operator">=</span> cookie.getName();</span><br><span class="line">                <span class="keyword">if</span>(cookieName.equals(<span class="string">&quot;servlet3&quot;</span>))&#123;</span><br><span class="line">                    <span class="comment">// 创建Cookie次数+1</span></span><br><span class="line">                    <span class="type">Integer</span> <span class="variable">value</span> <span class="operator">=</span> Integer.parseInt(cookie.getValue())+<span class="number">1</span>;</span><br><span class="line">                    Cookie c=<span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;servlet3&quot;</span>, String.valueOf(value));</span><br><span class="line">                    resp.addCookie(c);</span><br><span class="line">                    System.out.println(<span class="string">&quot;欢迎您第&quot;</span>+value+<span class="string">&quot;访问&quot;</span>);</span><br><span class="line">                    flag=<span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;欢迎您第一次访问&quot;</span>);</span><br><span class="line">            Cookie c=<span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;servlet3&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">            resp.addCookie(c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Session">Session</h3><h3 id="案例-判断用户是否登录">案例:判断用户是否登录</h3><h4 id="需求">需求:</h4><p>实现登录一次即可,在一次会话内,可以反复多次访问WEB-INF/ welcome.html,如果没有登录过,跳转到登录页,登录成功后,可以访问</p><h4 id="项目结构">项目结构:</h4><img src="JavaEE/20210805142941-20220507093631639.png" alt="image-20210805142907533" style="zoom:67%;" /><h4 id="组件介绍：">组件介绍：</h4><h5 id="login-html">login.html</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span> <span class="attr">action</span>=<span class="string">&quot;loginServlet.do&quot;</span>&gt;</span></span><br><span class="line">    用户名:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> &gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    密码:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> &gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="main-html">main.html</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   this is main page</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="LoginServlet">LoginServlet</h5><p>用来校验登录的，登陆成功将用户信息存户HttpSession，否则返回到登录页。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &quot;/loginServlet.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 获取用户名和密码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        <span class="comment">// 如果用户名和密码为 msb 1234</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;msb&quot;</span>.equals(username)  &amp;&amp; <span class="string">&quot;1234&quot;</span>.equals(password))&#123;</span><br><span class="line">            <span class="comment">// 将用户信息放在HTTPSession中</span></span><br><span class="line">            <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">User</span>(<span class="literal">null</span>, <span class="literal">null</span>, <span class="string">&quot;msb&quot;</span>, <span class="string">&quot;1234&quot;</span>);</span><br><span class="line">            <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> req.getSession();</span><br><span class="line">            session.setAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">            <span class="comment">// 登录成功 跳转至 main.html</span></span><br><span class="line">            resp.sendRedirect(req.getContextPath()+<span class="string">&quot;/mainServlet.do&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">// 登录失败 回到login.html</span></span><br><span class="line">            resp.sendRedirect(req.getContextPath()+<span class="string">&quot;/login.html&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="MainServlet">MainServlet</h5><p>用来向mian.html中跳转的，同时验证登录的，可以直接跳转，否则回到登录页。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &quot;/mainServlet.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//跳转至main.html</span></span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> req.getSession();</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User)session.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="literal">null</span> != user)&#123;</span><br><span class="line">            <span class="comment">// 判断如果登录过 允许跳转  HTTPSession中如果有登陆过的信息</span></span><br><span class="line">            req.getRequestDispatcher(<span class="string">&quot;/WEB-INF/main.html&quot;</span>).forward(req,resp);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">// 如果没有登录过 回到登录去登录  HTTPSession中如果有登陆过的信息</span></span><br><span class="line">            resp.sendRedirect(<span class="string">&quot;login.html&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="User">User</h5><p>存储用户信息的实体类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer uid;</span><br><span class="line">    <span class="keyword">private</span> String realname;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String pasword;</span><br></pre></td></tr></table></figure><h1>JSP</h1><h2 id="指令标签">指令标签</h2><p>三种指令标签</p><table><thead><tr><th>指令</th><th>描述</th></tr></thead><tbody><tr><td>&lt;%@ page %&gt;</td><td>定义网页依赖属性，如脚本语言，error页面、缓存需求等</td></tr><tr><td>&lt;%@ include %&gt;</td><td>包含其他文件</td></tr><tr><td>&lt;%@ taglib%</td><td>引入标签库的定义</td></tr></tbody></table><h3 id="page标签">page标签</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;%--告知浏览器以什么格式和编码解析 响应的数据--%&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span>  %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%--设置JSP页面转换的语言--%&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%@ page language=<span class="string">&quot;java&quot;</span>%&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%--导包--%&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;com.msb.entity.User&quot;</span> %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%--在转换成java代码时使用的编码 一般不用设置--%&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%@ page pageEncoding=<span class="string">&quot;UTF-8&quot;</span> %&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%--指定错误页 当页面发生错误时 指定跳转的页面--%&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%@ page errorPage=<span class="string">&quot;error500.JSP&quot;</span> %&gt;</span><br><span class="line">    &lt;%--指定当前页为异常提示页 当前页面可以接收异常对象 --%&gt;</span><br><span class="line"></span><br><span class="line">    &lt;%<span class="meta">@page</span> isErrorPage=<span class="string">&quot;true&quot;</span> %&gt;</span><br></pre></td></tr></table></figure><p>errorPage是一种处理错误提示也的功能除了JSP有的错误提示页功能</p><p>javaEE中自带其他的错位提示页处理功能，具体配置如下</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">error-code</span>&gt;</span>500<span class="tag">&lt;/<span class="name">error-code</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">location</span>&gt;</span>/error500.JSP<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">error-page</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">error-code</span>&gt;</span>404<span class="tag">&lt;/<span class="name">error-code</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">location</span>&gt;</span>/error404.JSP<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">error-page</span>&gt;</span></span><br></pre></td></tr></table></figure><p>当JSP中发生了异常时,如果JSP中配置的错误页和web.xml 中配置的错误页冲突了,JSP page指令的 errorPage优先级更高</p><img src="JavaEE/20210807110128-20220507093631490.png" alt="image-20210807110126899" style="zoom:67%;" /><h3 id="include标签">include标签</h3><p>JSP可以通过Include指令来包含其他文件。被包含的文件可以是JSP文件、HTML文件或文本文件。包含的文件就好像是该JSP文件的一部分，会被同时编译执行。除了include指令标签可以实现引入以外，使用jsp:include也可以实现引入</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;%--静态引入使用的是 include 指令标签</span><br><span class="line"></span><br><span class="line">    被引入的JSP页面不会生成java代码 被引入的网页和当前页生成代码后形成了一个java文件--%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">&quot;head.JSP&quot;</span>%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%--动态引入 JSP标签中的 include选项</span><br><span class="line"></span><br><span class="line">    被引入的JSP页面会生成独立的java代码 </span><br><span class="line"></span><br><span class="line">    在生成的java代码中 使用JSPRuntimeLibrary.include(request, response, <span class="string">&quot;head.JSP&quot;</span>, out, <span class="literal">false</span>);引入其他页面</span><br><span class="line"></span><br><span class="line">    --%&gt;</span><br><span class="line"></span><br><span class="line">&lt;jsp:include page=<span class="string">&quot;head.JSP&quot;</span>/&gt;</span><br></pre></td></tr></table></figure><p>查看转译以后的java源代码文件中的区别</p><p>静态引入：@include被引入的网页和当前页生成代码后形成了一个java文件</p><p>动态引入：jsp:include被引入的JSP页面会生成独立的java代码</p><h3 id="taglib指令标签">taglib指令标签</h3><p>JSP API允许用户自定义标签，一个自定义标签库就是自定义标签的集合。Taglib指令引入一个自定义标签集合的定义，包括库路径、自定义标签。</p><p>语法：</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib   uri=<span class="string">&quot;uri&quot;</span> prefix=<span class="string">&quot;prefixOfTag&quot;</span> %&gt;</span><br></pre></td></tr></table></figure><h2 id="内置对象">内置对象</h2><h3 id="九大对象">九大对象</h3><p><strong>四大域对象</strong></p><ul><li><p>pageContext  page域     当前页面内可用</p></li><li><p>request       reqeust域  单次请求</p></li><li><p>session       session域   单次会话</p></li><li><p>application   application 域项目运行</p></li></ul><p><strong>响应对象</strong></p><ul><li>response</li></ul><p><strong>输出流对象</strong></p><ul><li>out 打印流</li></ul><p><strong>其他三个对象</strong></p><ul><li><p>servletConfig:由于JSP本身也是一个Servlet,所以容器也会给我们准备一个ServletConfig</p></li><li><p>page        就是他this对象 当前JSP对象本身</p></li><li><p>exception   异常对象,在错误提示页上使用,当isErrorpage=true 才具有该对象</p></li></ul><h2 id="案例一：在浏览器上访问Emp表-动态地分等级">案例一：在浏览器上访问Emp表 动态地分等级</h2><p>EmpDaoImpl.java</p><p>实现类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">EmpDao</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String url=<span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mydb?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghai&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> String username=<span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> String password=<span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Emp&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Emp&gt; list =<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span><span class="literal">null</span>;</span><br><span class="line">        PreparedStatement pstat=<span class="literal">null</span>;</span><br><span class="line">        ResultSet resultSet=<span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">            connection = DriverManager.getConnection(url, username, password);</span><br><span class="line">            pstat = connection.prepareStatement(<span class="string">&quot;select * from emp&quot;</span>);</span><br><span class="line">            resultSet = pstat.executeQuery();</span><br><span class="line">            <span class="keyword">while</span>(resultSet.next())&#123;</span><br><span class="line">                Integer empno=resultSet.getInt(<span class="string">&quot;empno&quot;</span>);</span><br><span class="line">                Integer deptno=resultSet.getInt(<span class="string">&quot;deptno&quot;</span>);</span><br><span class="line">                Integer mgr=resultSet.getInt(<span class="string">&quot;mgr&quot;</span>);</span><br><span class="line">                String ename=resultSet.getString(<span class="string">&quot;ename&quot;</span>);</span><br><span class="line">                String job=resultSet.getString(<span class="string">&quot;job&quot;</span>);</span><br><span class="line">                Double sal=resultSet.getDouble(<span class="string">&quot;sal&quot;</span>);</span><br><span class="line">                Double comm=resultSet.getDouble(<span class="string">&quot;comm&quot;</span>);</span><br><span class="line">                Date hiredate=resultSet.getDate(<span class="string">&quot;hiredate&quot;</span>);</span><br><span class="line">                <span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">Emp</span>( empno,  ename,  job,  mgr,  hiredate,  sal,  comm,  deptno);</span><br><span class="line">                list.add(emp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span>!=resultSet)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    resultSet.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span>!=pstat)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    pstat.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span>!=connection)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Emp.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmpDao</span> &#123;</span><br><span class="line">    List&lt;Emp&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>EmpServlet</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/empServlet.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="comment">// dao对象</span></span><br><span class="line">    EmpDao empDao=<span class="keyword">new</span> <span class="title class_">EmpDaoImpl</span>();</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 获取数据</span></span><br><span class="line">        List&lt;Emp&gt; list = empDao.findAll();</span><br><span class="line">        <span class="comment">// 将数据放入请求域</span></span><br><span class="line">        req.setAttribute(<span class="string">&quot;emps&quot;</span>, list);</span><br><span class="line">        <span class="comment">// 请求转发给JSP</span></span><br><span class="line">        req.getRequestDispatcher(<span class="string">&quot;showEmp.jsp&quot;</span>).forward(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>showEmp.jsp</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.List&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;com.msb.pojo.Emp&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        table&#123;</span><br><span class="line">            border: 3px solid blue;</span><br><span class="line">            width: <span class="number">80</span>%;</span><br><span class="line">            margin: 0px auto;</span><br><span class="line">        &#125;</span><br><span class="line">        td,th&#123;</span><br><span class="line">            border: 2px solid green;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;table cellspacing=<span class="string">&quot;0px&quot;</span> cellpadding=<span class="string">&quot;0px&quot;</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;th&gt;编号&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;姓名&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;上级编号&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;职务&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;入职日期&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;薪资&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;补助&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;部门号&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;薪资等级&lt;/th&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;%</span><br><span class="line">            List&lt;Emp&gt; emps = (List&lt;Emp&gt;) request.getAttribute(<span class="string">&quot;emps&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (Emp emp : emps) &#123;</span><br><span class="line">        %&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;&lt;%=emp.getEmpno()%&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;%=emp.getEname()%&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;%=emp.getMgr()%&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;%=emp.getJob()%&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;%=emp.getHiredate()%&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;%=emp.getSal()%&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;%=emp.getComm()%&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;%=emp.getDeptno()%&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;%--out.print(<span class="string">&quot;&lt;td&gt;&quot;</span>)--%&gt;</span><br><span class="line">         &lt;%</span><br><span class="line">             <span class="type">Double</span> <span class="variable">sal</span> <span class="operator">=</span> emp.getSal();</span><br><span class="line">             <span class="keyword">if</span>(sal&lt;=<span class="number">500</span>)&#123;</span><br><span class="line">                 out.print(<span class="string">&quot;A&quot;</span>);</span><br><span class="line">             &#125;<span class="keyword">else</span> <span class="keyword">if</span>( sal &lt;=<span class="number">1000</span>)&#123;</span><br><span class="line">                 out.print(<span class="string">&quot;B&quot;</span>);</span><br><span class="line">             &#125;<span class="keyword">else</span> <span class="keyword">if</span>( sal &lt;=<span class="number">1500</span>)&#123;</span><br><span class="line">                 out.print(<span class="string">&quot;C&quot;</span>);</span><br><span class="line">             &#125;<span class="keyword">else</span> <span class="keyword">if</span>( sal &lt;=<span class="number">2000</span>)&#123;</span><br><span class="line">                 out.print(<span class="string">&quot;D&quot;</span>);</span><br><span class="line">             &#125;<span class="keyword">else</span> <span class="keyword">if</span>( sal &lt;=<span class="number">3000</span>)&#123;</span><br><span class="line">                 out.print(<span class="string">&quot;E&quot;</span>);</span><br><span class="line">             &#125;<span class="keyword">else</span> <span class="keyword">if</span>( sal &lt;=<span class="number">4000</span>)&#123;</span><br><span class="line">                 out.print(<span class="string">&quot;F&quot;</span>);</span><br><span class="line">             &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                 out.print(<span class="string">&quot;G&quot;</span>);</span><br><span class="line">             &#125;</span><br><span class="line">         %&gt;</span><br><span class="line">                &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;%</span><br><span class="line">            &#125;</span><br><span class="line">        %&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="EL表达式">EL表达式</h2><p>Expression Languaga</p><p>EL表达式中定义了一些可以帮助我们快捷从域对象中取出数据的写法,<strong>基本语法为</strong></p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;域标志.数据名.属性名(可选)&#125;</span><br></pre></td></tr></table></figure><p><strong>四个域标志关键字分别为</strong></p><ul><li><p>requestScope         request域</p></li><li><p>sessionScope          session域</p></li><li><p>applicationScope   application域</p></li><li><p>pageScope             page域</p></li></ul><h3 id="EL表达式快捷取出域对象">EL表达式快捷取出域对象</h3><ul><li><p>requestScope         request域</p></li><li><p>sessionScope          session域</p></li><li><p>applicationScope   application域</p></li><li><p>pageScope             page域</p></li></ul><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;com.msb.pojo.User&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;%--向pageContext域中放数据--%&gt;</span><br><span class="line">        &lt;%</span><br><span class="line">        pageContext.setAttribute(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;pageContextMessage&quot;</span>);</span><br><span class="line">        pageContext.setAttribute(<span class="string">&quot;userx&quot;</span>, <span class="keyword">new</span> <span class="title class_">User</span>(<span class="number">1</span>,<span class="string">&quot;大黄&quot;</span>,<span class="string">&quot;abcdefg&quot;</span>));</span><br><span class="line">        %&gt;</span><br><span class="line">        &lt;%--</span><br><span class="line">    从域中取出数据</span><br><span class="line">    El表达式在获取对象属性值得时候,是通过对象的属性的get方法获取的</span><br><span class="line">    保证对象的要获取的属性必须有对应get方法才可以</span><br><span class="line">    EL表达式在使用时是不需要<span class="keyword">import</span>其他类的</span><br><span class="line">    El如果获取的是NULL值,是不展示任何信息的</span><br><span class="line">    --%&gt;</span><br><span class="line">        pageContext域中的数据:&lt;br/&gt;</span><br><span class="line">        msg:$&#123;pageScope.msg&#125;&lt;br/&gt;</span><br><span class="line">        username:$&#123;pageScope.userx.name&#125;&lt;br/&gt;</span><br><span class="line">        &lt;hr/&gt;</span><br><span class="line">        request域中的数据:&lt;br/&gt;</span><br><span class="line">        msg:$&#123;requestScope.msg&#125;&lt;br/&gt;</span><br><span class="line">        username:$&#123;requestScope.user.name&#125;&lt;br/&gt;</span><br><span class="line">        &lt;hr/&gt;</span><br><span class="line">        session域中的数据:&lt;br/&gt;</span><br><span class="line">        msg:$&#123;sessionScope.msg&#125;&lt;br/&gt;</span><br><span class="line">        username:$&#123;sessionScope.users[<span class="number">1</span>].name&#125;&lt;br/&gt;</span><br><span class="line">        &lt;hr/&gt;</span><br><span class="line">        application域中的数据:&lt;br/&gt;</span><br><span class="line">        msg:$&#123;applicationScope.msg&#125;&lt;br/&gt;</span><br><span class="line">        username:$&#123;applicationScope.userMap.a.name&#125;&lt;br/&gt;</span><br><span class="line">        &lt;hr/&gt;</span><br><span class="line">        &lt;%--EL表达式在取出数据的时候是可以省略域标志的</span><br><span class="line">    EL表达式会自动依次到四个域中去找数据</span><br><span class="line">    --%&gt;</span><br><span class="line">        PageContext username:$&#123;userx.name&#125;&lt;br/&gt;</span><br><span class="line">        Request username:$&#123;user.name&#125;&lt;br/&gt;</span><br><span class="line">        Session username:$&#123;users[<span class="number">1</span>].name&#125;&lt;br/&gt;</span><br><span class="line">        Application username:$&#123;userMap.a.name&#125;&lt;br/&gt;</span><br><span class="line">        &lt;hr/&gt;</span><br><span class="line">        &lt;%--</span><br><span class="line">    $&#123;数据的名字&#125;如果省略域标志,取数据的顺序如下</span><br><span class="line">    pageContext</span><br><span class="line">    request</span><br><span class="line">    session</span><br><span class="line">    application</span><br><span class="line">    --%&gt;</span><br><span class="line">        $&#123;msg&#125;</span><br><span class="line">        &lt;hr/&gt;</span><br><span class="line">        &lt;%--</span><br><span class="line">    移除域中的数据</span><br><span class="line">    --%&gt;</span><br><span class="line">        &lt;%</span><br><span class="line">        <span class="comment">//pageContext.removeAttribute(&quot;msg&quot;);// pageContext.removeAttribute()方法会移除四个域中的所有的同名的数据</span></span><br><span class="line">        <span class="comment">//request.removeAttribute(&quot;msg&quot;);</span></span><br><span class="line">        %&gt;</span><br><span class="line">        pagecontextMsg:$&#123;pageScope.msg&#125;&lt;br/&gt;</span><br><span class="line">        requestMsg:$&#123;requestScope.msg&#125;&lt;br/&gt;</span><br><span class="line">        sessionMsg:$&#123;sessionScope.msg&#125;&lt;br/&gt;</span><br><span class="line">        applicationMsg:$&#123;applicationScope.msg&#125;&lt;br/&gt;</span><br><span class="line">        &lt;hr/&gt;</span><br><span class="line">        &lt;%--</span><br><span class="line">    EL表达式获取请求中的参数</span><br><span class="line">    --%&gt;</span><br><span class="line">        username:$&#123;param.username&#125;&lt;br/&gt;</span><br><span class="line">        hobby:$&#123;paramValues.hobby[<span class="number">0</span>]&#125;</span><br><span class="line">        hobby:$&#123;paramValues.hobby[<span class="number">1</span>]&#125;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="总结-2">总结</h4><ul><li><p>EL表达式定义在JSP页面上,在转译之后的java文件中,会被转化成java代码</p></li><li><p>EL表达式是一种后台技术,服务器上运行,不是在浏览器上运行,不能用于HTML页面</p></li><li><p>EL表达式底层是通过反射实现的,在获取对象属性值时是通过对象的get方法实现的</p></li></ul><h3 id="EL表达式运算符">EL表达式运算符</h3><h4 id="运算符">运算符</h4><p><strong>算数运算符</strong>: + - * / %</p><p><strong>比较运算符:</strong></p><p>==  eq equals</p><p>&gt;gt greater then</p><p>&lt;     lt   lower then</p><p>&gt;=  ge  greater then or equals</p><p>&lt;=  le   lower then or equals</p><p>!=   ne   not equals</p><p><strong>逻辑运算符</strong>: || or    &amp;&amp; and</p><p><strong>三目运算符</strong>: ${条件 ?表达式1 : 表达式2}</p><p><strong>判空运算符</strong>: empty</p><h4 id="使用">使用</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.List&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.ArrayList&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%--</span><br><span class="line">+两端如果有字符串,会尝试将字符串转换成数字之后进行加法运算</span><br><span class="line">/如果除以<span class="number">0</span> 结果为Infinity 而不是出现异常</span><br><span class="line">%如果和<span class="number">0</span>取余数,那么会出现异常</span><br><span class="line">--%&gt;</span><br><span class="line">    算数运算符：</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    $&#123;<span class="number">10</span> + <span class="number">10</span>&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;<span class="string">&quot;10&quot;</span> + <span class="number">10</span>&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;<span class="string">&quot;10&quot;</span> + <span class="string">&quot;10&quot;</span>&#125;&lt;br/&gt;</span><br><span class="line">    &lt;%--$&#123;<span class="string">&quot;10a&quot;</span> + <span class="number">10</span>&#125;&lt;br/&gt;--%&gt;</span><br><span class="line">    $&#123;<span class="number">10</span>/<span class="number">0</span>&#125;&lt;br/&gt;</span><br><span class="line">    &lt;%-- $&#123;<span class="number">10</span>%<span class="number">0</span>&#125;&lt;br/&gt;--%&gt;</span><br><span class="line">    关系运算符/比较运算符</span><br><span class="line">    &lt;%--</span><br><span class="line">    比较运算符推荐写成字母形式,不推荐使用 == &gt;=  &lt;=</span><br><span class="line">    --%&gt;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    $&#123;<span class="number">10</span> == <span class="number">10</span>&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;<span class="number">10</span> eq <span class="number">10</span>&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;<span class="number">10</span> gt <span class="number">8</span>&#125;&lt;br/&gt;</span><br><span class="line">    逻辑运算符</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    $&#123; <span class="literal">true</span> || <span class="literal">false</span>&#125;&lt;br/&gt;</span><br><span class="line">    $&#123; <span class="literal">true</span> or <span class="literal">false</span>&#125;&lt;br/&gt;</span><br><span class="line">    $&#123; <span class="literal">true</span> &amp;&amp; <span class="literal">false</span>&#125;&lt;br/&gt;</span><br><span class="line">    $&#123; <span class="literal">true</span> and <span class="literal">false</span>&#125;&lt;br/&gt;</span><br><span class="line">    条件运算符/三目运算符</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    $&#123;(<span class="number">100</span>-<span class="number">1</span>)%<span class="number">3</span>==<span class="number">0</span>?<span class="number">10</span>+<span class="number">1</span>:<span class="number">10</span>-<span class="number">1</span>&#125;&lt;br/&gt;</span><br><span class="line">    判断空运算符</span><br><span class="line">    &lt;%--empty 为<span class="literal">null</span> 则为<span class="literal">true</span>--%&gt;</span><br><span class="line">    &lt;%  <span class="comment">//向域中放入数据</span></span><br><span class="line">        pageContext.setAttribute(<span class="string">&quot;a&quot;</span>,<span class="literal">null</span>);</span><br><span class="line">        pageContext.setAttribute(<span class="string">&quot;b&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="type">int</span>[] arr =&#123;&#125;;</span><br><span class="line">        pageContext.setAttribute(<span class="string">&quot;arr&quot;</span>,arr);</span><br><span class="line">        <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">        pageContext.setAttribute(<span class="string">&quot;list&quot;</span>,list);</span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    $&#123;empty a&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;empty b&#125;&lt;br/&gt;&lt;%--字符串长度为<span class="number">0</span> 则认为是空--%&gt;</span><br><span class="line">    $&#123;empty arr&#125;&lt;br/&gt;&lt;%--数组长度为<span class="number">0</span> 认为不是空--%&gt;</span><br><span class="line">    $&#123;empty list&#125;&lt;br/&gt;&lt;%--集合长度为<span class="number">0</span> 认为是空--%&gt;</span><br><span class="line">    $&#123;list.size() eq <span class="number">0</span>&#125;&lt;br/&gt;&lt;%--集合长度为<span class="number">0</span> 认为是空--%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="案例一优化：使用EL表达式优化查询员工信息的页面处理">案例一优化：使用EL表达式优化查询员工信息的页面处理</h2><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.List&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;com.msb.pojo.Emp&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">        &lt;style&gt;</span><br><span class="line">            table&#123;</span><br><span class="line">                border: 3px solid blue;</span><br><span class="line">                width: <span class="number">80</span>%;</span><br><span class="line">                margin: 0px auto;</span><br><span class="line">            &#125;</span><br><span class="line">            td,th&#123;</span><br><span class="line">                border: 2px solid green;</span><br><span class="line">            &#125;</span><br><span class="line">        &lt;/style&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;table cellspacing=<span class="string">&quot;0px&quot;</span> cellpadding=<span class="string">&quot;0px&quot;</span>&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;th&gt;编号&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;姓名&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;上级编号&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;职务&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;入职日期&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;薪资&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;补助&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;部门号&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;薪资等级&lt;/th&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;%</span><br><span class="line">            List&lt;Emp&gt; emps = (List&lt;Emp&gt;) request.getAttribute(<span class="string">&quot;emps&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (Emp emp : emps) &#123;</span><br><span class="line">                pageContext.setAttribute(<span class="string">&quot;emp&quot;</span>, emp);<span class="comment">//将员工对象放入PageContext 域</span></span><br><span class="line">                %&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;$&#123;emp.empno&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;emp.ename&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;emp.mgr&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;emp.job&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;emp.hiredate&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;emp.sal&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;emp.comm&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;emp.deptno&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;</span><br><span class="line">                    $&#123;emp.sal le <span class="number">500</span>?<span class="string">&quot;A&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                    $&#123;emp.sal gt <span class="number">500</span> and emp.sal le <span class="number">1000</span>?<span class="string">&quot;B&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                    $&#123;emp.sal gt <span class="number">1000</span> and emp.sal le <span class="number">1500</span>?<span class="string">&quot;C&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                    $&#123;emp.sal gt <span class="number">1500</span> and emp.sal le <span class="number">2000</span>?<span class="string">&quot;D&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                    $&#123;emp.sal gt <span class="number">2000</span> and emp.sal le <span class="number">3000</span>?<span class="string">&quot;E&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                    $&#123;emp.sal gt <span class="number">3000</span> and emp.sal le <span class="number">4000</span>?<span class="string">&quot;F&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                    $&#123;emp.sal gt <span class="number">4000</span>?<span class="string">&quot;G&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;%</span><br><span class="line">            &#125;</span><br><span class="line">            %&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="JSTL">JSTL</h2><p>JSTL（Java server pages standarded tag library，即JSP标准标签库）是由JCP（Java community Proces）所制定的标准规范，它主要提供给Java Web开发人员一个标准通用的标签库，并由Apache的Jakarta小组来维护。</p><p><strong>使用前提</strong></p><ol><li><p>需要导包</p></li><li><p>页面中通过taglib指令引入标签库</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@   taglib uri=<span class="string">&quot;标签库的定位&quot;</span> prefix=<span class="string">&quot;前缀(简称)&quot;</span> %&gt;</span><br></pre></td></tr></table></figure><p>uri可以在对应的tld文件中找到</p></li></ol><h3 id="核心标签库">核心标签库</h3><p>导入语句为</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span>%&gt;</span><br></pre></td></tr></table></figure><h4 id="操作对象的标签c-set-out-remove">操作对象的标签c:set/out/remove</h4><ul><li>==&lt;c:set&gt;==         向域对象中放入数据  setAttribute</li><li>==&lt;c:out&gt;==        从域对象中取出数据  getAttribute</li><li>==&lt;c:remove&gt;== 从域对象中移除数据   removeAttribute</li></ul><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;%--</span><br><span class="line">    c:set</span><br><span class="line">        scope 指定放数据的域 可选值 page request session application</span><br><span class="line">        <span class="keyword">var</span>   数据的名称</span><br><span class="line">        value 数据</span><br><span class="line">    --%&gt;</span><br><span class="line">    &lt;c:set scope=<span class="string">&quot;page&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;msg&quot;</span> value=<span class="string">&quot;pageMessage&quot;</span>&gt;&lt;/c:set&gt;</span><br><span class="line">    &lt;c:set scope=<span class="string">&quot;request&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;msg&quot;</span> value=<span class="string">&quot;requestMessage&quot;</span>&gt;&lt;/c:set&gt;</span><br><span class="line">    &lt;c:set scope=<span class="string">&quot;session&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;msg&quot;</span> value=<span class="string">&quot;sessionMessage&quot;</span>&gt;&lt;/c:set&gt;</span><br><span class="line">    &lt;c:set scope=<span class="string">&quot;application&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;msg&quot;</span> value=<span class="string">&quot;applicationMessage&quot;</span>&gt;&lt;/c:set&gt;</span><br><span class="line">    &lt;%--移除指定域中的值--%&gt;</span><br><span class="line">   &lt;%-- &lt;c:remove <span class="keyword">var</span>=<span class="string">&quot;msg&quot;</span> scope=<span class="string">&quot;page&quot;</span>&gt;&lt;/c:remove&gt;</span><br><span class="line">    &lt;c:remove <span class="keyword">var</span>=<span class="string">&quot;msg&quot;</span> scope=<span class="string">&quot;request&quot;</span>&gt;&lt;/c:remove&gt;--%&gt;</span><br><span class="line">    &lt;c:remove <span class="keyword">var</span>=<span class="string">&quot;msg&quot;</span> scope=<span class="string">&quot;session&quot;</span>&gt;&lt;/c:remove&gt;</span><br><span class="line">    &lt;c:remove <span class="keyword">var</span>=<span class="string">&quot;msg&quot;</span> scope=<span class="string">&quot;application&quot;</span>&gt;&lt;/c:remove&gt;</span><br><span class="line">    &lt;%--通过EL表达式取出域中的值--%&gt;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    $&#123;pageScope.msg&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;requestScope.msg&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;sessionScope.msg&#125;&lt;br/&gt;</span><br><span class="line">    $&#123;applicationScope.msg &#125;&lt;br/&gt;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;%--通过c:out标签获取域中的值--%&gt;</span><br><span class="line">    &lt;c:out value=<span class="string">&quot;$&#123;pageScope.msg&#125;&quot;</span> <span class="keyword">default</span>=<span class="string">&quot;page msg not found&quot;</span>/&gt;</span><br><span class="line">    &lt;c:out value=<span class="string">&quot;$&#123;requestScope.msg&#125;&quot;</span> <span class="keyword">default</span>=<span class="string">&quot;request msg not found&quot;</span>/&gt;</span><br><span class="line">    &lt;c:out value=<span class="string">&quot;$&#123;sessionScope.msg&#125;&quot;</span> <span class="keyword">default</span>=<span class="string">&quot;session msg not found&quot;</span>/&gt;</span><br><span class="line">    &lt;c:out value=<span class="string">&quot;$&#123;applicationScope.msg&#125;&quot;</span> <span class="keyword">default</span>=<span class="string">&quot;application msg not found&quot;</span>/&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="多条件分支标签c-if和c-choose">多条件分支标签c:if和c:choose</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;%--</span><br><span class="line">    随机生成一个分数  <span class="number">0</span>-<span class="number">100</span></span><br><span class="line">    &gt;=<span class="number">90</span> A</span><br><span class="line">    &gt;=<span class="number">80</span> B</span><br><span class="line">    &gt;=<span class="number">70</span> C</span><br><span class="line">    &gt;=<span class="number">60</span> D</span><br><span class="line">    &lt;<span class="number">60</span>  E</span><br><span class="line">    --%&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        <span class="type">int</span> <span class="variable">score</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(<span class="number">101</span>);</span><br><span class="line">        pageContext.setAttribute(<span class="string">&quot;score&quot;</span>, score);</span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;%--</span><br><span class="line">    test  判断条件</span><br><span class="line">    c:<span class="keyword">if</span>可以将test的结果放入指定的域中</span><br><span class="line">    scope 指定存放的域</span><br><span class="line">    <span class="keyword">var</span>   数据名</span><br><span class="line">    --%&gt;</span><br><span class="line">    分数:$&#123;score&#125;&lt;br/&gt; 等级:</span><br><span class="line">    &lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;score ge 90&#125;&quot;</span> scope=<span class="string">&quot;page&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;f1&quot;</span>&gt;A&lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line">    &lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;score ge 80 and score lt 90&#125;&quot;</span> scope=<span class="string">&quot;page&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;f2&quot;</span>&gt;B&lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line">    &lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;score ge 70 and score lt 80&#125;&quot;</span> scope=<span class="string">&quot;page&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;f3&quot;</span>&gt;C&lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line">    &lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;score ge 60 and score lt 70&#125;&quot;</span> scope=<span class="string">&quot;page&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;f4&quot;</span>&gt;D&lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line">    &lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;score lt 60&#125;&quot;</span> scope=<span class="string">&quot;page&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;f5&quot;</span>&gt;E&lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    $&#123;f1&#125;</span><br><span class="line">    $&#123;f2&#125;</span><br><span class="line">    $&#123;f3&#125;</span><br><span class="line">    $&#123;f4&#125;</span><br><span class="line">    $&#123;f5&#125;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    &lt;%--输出分数是否及格--%&gt;</span><br><span class="line">    &lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;score ge 60&#125;&quot;</span> scope=<span class="string">&quot;page&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;flag&quot;</span>&gt;及格&lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line">    &lt;c:<span class="keyword">if</span> test=<span class="string">&quot;$&#123;!pageScope.flag&#125;&quot;</span>&gt;不及格&lt;/c:<span class="keyword">if</span>&gt;</span><br><span class="line">    &lt;hr/&gt;</span><br><span class="line">    &lt;c:choose&gt;</span><br><span class="line">        &lt;c:<span class="keyword">when</span> test=<span class="string">&quot;$&#123;score ge 90&#125;&quot;</span>&gt;A&lt;/c:<span class="keyword">when</span>&gt;</span><br><span class="line">        &lt;c:<span class="keyword">when</span> test=<span class="string">&quot;$&#123;score ge 80&#125;&quot;</span>&gt;B&lt;/c:<span class="keyword">when</span>&gt;</span><br><span class="line">        &lt;c:<span class="keyword">when</span> test=<span class="string">&quot;$&#123;score ge 70&#125;&quot;</span>&gt;C&lt;/c:<span class="keyword">when</span>&gt;</span><br><span class="line">        &lt;c:<span class="keyword">when</span> test=<span class="string">&quot;$&#123;score ge 60&#125;&quot;</span>&gt;D&lt;/c:<span class="keyword">when</span>&gt;</span><br><span class="line">        &lt;c:otherwise&gt;E&lt;/c:otherwise&gt;</span><br><span class="line">    &lt;/c:choose&gt;</span><br></pre></td></tr></table></figure><h4 id="迭代标签c-foreach">迭代标签c:foreach</h4><h5 id="打印乘法表">打印乘法表</h5><p>c:forEach中的<strong>属性</strong></p><ul><li>==var==: 迭代变量, 存放在pageContext作用域</li><li>==begin==: 迭代起始值</li><li>==end==: 迭代结束值</li><li>==step==: 迭代变量变化的步长</li></ul><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%--</span><br><span class="line">    <span class="keyword">for</span> ( <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">1</span>;i&lt;=<span class="number">9</span> ;i+=<span class="number">2</span>)&#123;</span><br><span class="line">        pageContext.setAttribute(<span class="string">&quot;i&quot;</span>,i)</span><br><span class="line">    &#125;</span><br><span class="line">c:foreach 每次执时都会向page域中放入一个名为 i 值为当前值这样的一个操作</span><br><span class="line">    --%&gt;</span><br><span class="line">&lt;c:forEach <span class="keyword">var</span>=<span class="string">&quot;i&quot;</span> begin=<span class="string">&quot;1&quot;</span> end=<span class="string">&quot;9&quot;</span> step=<span class="string">&quot;1&quot;</span>&gt;</span><br><span class="line">    &lt;c:forEach <span class="keyword">var</span>=<span class="string">&quot;j&quot;</span> begin=<span class="string">&quot;1&quot;</span> end=<span class="string">&quot;$&#123;i&#125;&quot;</span> step=<span class="string">&quot;1&quot;</span>&gt;</span><br><span class="line">        $&#123;j&#125; * $&#123;i&#125; = $&#123;i*j&#125; &amp;nbsp;</span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line">    &lt;br/&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure><h5 id="遍历对象数组">遍历对象数组</h5><ul><li>==items==: 要遍历的集合, 需要使用EL表达式取值</li><li>==varStatus==: 迭代变量的状态</li><li>==index:== 索引, 从0开始</li><li>==count:== 计数, 从1开始</li><li>==first==: boolean, 表示是否是第一个</li><li>==last==: boolean, 表示是否是最后一个</li><li>==current==: 对象, 当前迭代的对象值</li></ul><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;%--&lt;%<span class="comment">//原来的遍历</span></span><br><span class="line">       List&lt;Emp&gt; emps = (List&lt;Emp&gt;) request.getAttribute(<span class="string">&quot;emps&quot;</span>);</span><br><span class="line">       <span class="keyword">for</span> (Emp emp : emps) &#123;</span><br><span class="line">           pageContext.setAttribute(<span class="string">&quot;emp&quot;</span>, emp);<span class="comment">//将员工对象放入PageContext 域</span></span><br><span class="line">       %&gt;</span><br><span class="line">       c:foreach</span><br><span class="line">       --%&gt;</span><br><span class="line">       &lt;c:forEach items=<span class="string">&quot;$&#123;emps&#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;emp&quot;</span> varStatus=<span class="string">&quot;empStatus&quot;</span>&gt;</span><br></pre></td></tr></table></figure><h3 id="格式化标签库fmt">格式化标签库fmt</h3><h4 id="导入标签">导入标签</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;fmt&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/fmt&quot;</span>%&gt;</span><br></pre></td></tr></table></figure><h4 id="fmt-formatDate-日期格式标签">&lt;fmt:formatDate&gt;日期格式标签</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;td&gt;</span><br><span class="line">    &lt;fmt:formatDate value=<span class="string">&quot;$&#123;emp.hiredate&#125;&quot;</span> pattern=<span class="string">&quot;yyyy年MM月dd日 HH:mm:ss&quot;</span>/&gt;</span><br><span class="line">&lt;/td&gt;</span><br></pre></td></tr></table></figure><h4 id="数字格式化标签">数字格式化标签</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;td&gt;</span><br><span class="line">    &lt;%--</span><br><span class="line">    <span class="number">0</span> 代表必须有一位数字,如果对应的位置没有值怎么办?自动补充<span class="number">0</span></span><br><span class="line">    # 代表有一位数字,开头和结尾的所有的<span class="number">0</span>不保留</span><br><span class="line">    --%&gt;</span><br><span class="line">    &amp;yen;&lt;fmt:formatNumber value=<span class="string">&quot;$&#123;emp.sal&#125;&quot;</span> pattern=<span class="string">&quot;###,##0.00&quot;</span>/&gt;</span><br><span class="line">&lt;/td&gt;</span><br></pre></td></tr></table></figure><h2 id="showEmp-js页面最终优化">showEmp.js页面最终优化</h2><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br><span class="line">&lt;%<span class="meta">@taglib</span> prefix=<span class="string">&quot;fmt&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/fmt&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">        &lt;style&gt;</span><br><span class="line">            table&#123;</span><br><span class="line">                border: 3px solid blue;</span><br><span class="line">                width: <span class="number">80</span>%;</span><br><span class="line">                margin: 0px auto;</span><br><span class="line">            &#125;</span><br><span class="line">            td,th&#123;</span><br><span class="line">                border: 2px solid green;</span><br><span class="line">            &#125;</span><br><span class="line">        &lt;/style&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;table cellspacing=<span class="string">&quot;0px&quot;</span> cellpadding=<span class="string">&quot;0px&quot;</span>&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;th&gt;序号&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;索引&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;isFirst&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;isLast&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;编号&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;姓名&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;姓名&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;上级编号&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;职务&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;入职日期&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;薪资&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;补助&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;部门号&lt;/th&gt;</span><br><span class="line">                &lt;th&gt;薪资等级&lt;/th&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;%-- &lt;%</span><br><span class="line">    List&lt;Emp&gt; emps = (List&lt;Emp&gt;) request.getAttribute(<span class="string">&quot;emps&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (Emp emp : emps) &#123;</span><br><span class="line">                pageContext.setAttribute(<span class="string">&quot;emp&quot;</span>,emp);<span class="comment">//将员工对象放入PageContext域</span></span><br><span class="line">                %&gt;</span><br><span class="line">            c:foreach</span><br><span class="line">            items 要遍历的数组/List  可以通过EL表达式取出集合之后给改属性赋值</span><br><span class="line">            <span class="keyword">var</span>   中间变量的名称</span><br><span class="line">            varStatus 记录每一个对象状态的设置</span><br><span class="line">            count 个数</span><br><span class="line">            index 索引</span><br><span class="line">            first 如果当前元素是迭代的第一个元素 <span class="literal">true</span> 否则为<span class="literal">false</span></span><br><span class="line">            last  如果当前元素是迭代的最后一个元素 <span class="literal">true</span> 否则为<span class="literal">false</span></span><br><span class="line">            current 当前迭代的元素本身</span><br><span class="line">            --%&gt;</span><br><span class="line">            &lt;c:forEach items=<span class="string">&quot;$&#123;emps&#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;emp&quot;</span> varStatus=<span class="string">&quot;empStatus&quot;</span>&gt;</span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                    &lt;%--使用EL表达式来取出域对象里的对象属性值--%&gt;</span><br><span class="line">                    &lt;%-- &lt;td&gt;&lt;%=emp.getEmpno()%&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getEname()%&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getMgr()%&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getJob()%&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getHiredate()%&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getSal()%&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getComm()%&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getDeptno()%&gt;&lt;/td&gt;--%&gt;</span><br><span class="line">            &lt;td&gt;$&#123;empStatus.count&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;empStatus.index&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;empStatus.first&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;empStatus.last&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;emp.empno&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;emp.ename&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;empStatus.current.ename&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;emp.mgr&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;emp.job&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;fmt:formatDate value=<span class="string">&quot;$&#123;emp.hiredate&#125;&quot;</span> pattern=<span class="string">&quot;yyyy年MM月dd日 HH:mm:ss&quot;</span>/&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;%--</span><br><span class="line">    <span class="number">0</span> 代表必须有一位数字,如果对应的位置没有值怎么办?自动补充<span class="number">0</span></span><br><span class="line">    # 代表有一位数字,开头和结尾的所有的<span class="number">0</span>不保留</span><br><span class="line">    --%&gt;</span><br><span class="line"></span><br><span class="line">                &amp;yen;&lt;fmt:formatNumber value=<span class="string">&quot;$&#123;emp.sal&#125;&quot;</span> pattern=<span class="string">&quot;###,##0.00&quot;</span>/&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;emp.comm&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;emp.deptno&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%--out.print(<span class="string">&quot;&lt;td&gt;&quot;</span>)--%&gt;</span><br><span class="line">                &lt;%--&lt;%</span><br><span class="line">    <span class="type">Double</span> <span class="variable">sal</span> <span class="operator">=</span> emp.getSal();</span><br><span class="line">                <span class="keyword">if</span>(sal&lt;=<span class="number">500</span>)&#123;</span><br><span class="line">                    out.print(<span class="string">&quot;A&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>( sal &lt;=<span class="number">1000</span>)&#123;</span><br><span class="line">                    out.print(<span class="string">&quot;B&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>( sal &lt;=<span class="number">1500</span>)&#123;</span><br><span class="line">                    out.print(<span class="string">&quot;C&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>( sal &lt;=<span class="number">2000</span>)&#123;</span><br><span class="line">                    out.print(<span class="string">&quot;D&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>( sal &lt;=<span class="number">3000</span>)&#123;</span><br><span class="line">                    out.print(<span class="string">&quot;E&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>( sal &lt;=<span class="number">4000</span>)&#123;</span><br><span class="line">                    out.print(<span class="string">&quot;F&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    out.print(<span class="string">&quot;G&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                %&gt;--%&gt;</span><br><span class="line">                &lt;%--使用EL算数表达式来判断等级</span><br><span class="line">    $&#123;emp.sal le <span class="number">500</span>?<span class="string">&quot;A&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                $&#123;emp.sal gt <span class="number">500</span> and emp.sal le <span class="number">1000</span>?<span class="string">&quot;B&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                $&#123;emp.sal gt <span class="number">1000</span> and emp.sal le <span class="number">1500</span>?<span class="string">&quot;C&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                $&#123;emp.sal gt <span class="number">1500</span> and emp.sal le <span class="number">2000</span>?<span class="string">&quot;D&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                $&#123;emp.sal gt <span class="number">2000</span> and emp.sal le <span class="number">3000</span>?<span class="string">&quot;E&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                $&#123;emp.sal gt <span class="number">3000</span> and emp.sal le <span class="number">4000</span>?<span class="string">&quot;F&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                $&#123;emp.sal gt <span class="number">4000</span>?<span class="string">&quot;G&quot;</span>:<span class="string">&quot;&quot;</span>&#125;--%&gt;</span><br><span class="line"></span><br><span class="line">                &lt;%--使用JSTL标签--%&gt;</span><br><span class="line">                &lt;c:choose&gt;</span><br><span class="line">                    &lt;c:<span class="keyword">when</span> test=<span class="string">&quot;$&#123;emp.sal le 500&#125;&quot;</span>&gt;A&lt;/c:<span class="keyword">when</span>&gt;</span><br><span class="line">                    &lt;c:<span class="keyword">when</span> test=<span class="string">&quot;$&#123;emp.sal le 1000&#125;&quot;</span>&gt;B&lt;/c:<span class="keyword">when</span>&gt;</span><br><span class="line">                    &lt;c:<span class="keyword">when</span> test=<span class="string">&quot;$&#123;emp.sal le 1500&#125;&quot;</span>&gt;C&lt;/c:<span class="keyword">when</span>&gt;</span><br><span class="line">                    &lt;c:<span class="keyword">when</span> test=<span class="string">&quot;$&#123;emp.sal le 2000&#125;&quot;</span>&gt;D&lt;/c:<span class="keyword">when</span>&gt;</span><br><span class="line">                    &lt;c:<span class="keyword">when</span> test=<span class="string">&quot;$&#123;emp.sal le 3000&#125;&quot;</span>&gt;E&lt;/c:<span class="keyword">when</span>&gt;</span><br><span class="line">                    &lt;c:<span class="keyword">when</span> test=<span class="string">&quot;$&#123;emp.sal le 4000&#125;&quot;</span>&gt;F&lt;/c:<span class="keyword">when</span>&gt;</span><br><span class="line">                    &lt;c:<span class="keyword">when</span> test=<span class="string">&quot;$&#123;emp.sal gt 4000&#125;&quot;</span>&gt;G&lt;/c:<span class="keyword">when</span>&gt;</span><br><span class="line">                &lt;/c:choose&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;/c:forEach&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>Filter</h1><h2 id="案例：通过过滤验证登录">案例：通过过滤验证登录</h2><p>需求：通过过滤器控制，只有登陆之后可以反复进入welcome.jsp欢迎页，如果没有登录，提示用户进入登录页进行登陆操作。</p><img src="JavaEE/20210808090141-20220507093631591.png" alt="image-20210808090117141" style="zoom:50%;" /><h6 id="login-jsp">login.jsp</h6><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;$Title%sSourceCode%lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;img src=<span class="string">&quot;static/img/logo.png&quot;</span>&gt;</span><br><span class="line">  please login ... ... &lt;br/&gt;</span><br><span class="line">  &lt;form action=<span class="string">&quot;loginController.do&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    用户名:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;user&quot;</span>&gt; &lt;br/&gt;</span><br><span class="line">    密码:&lt;input type=<span class="string">&quot;password&quot;</span> name=<span class="string">&quot;pwd&quot;</span>&gt;&lt;br/&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span>&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h6 id="welcome-jsp">welcome.jsp</h6><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;img src=<span class="string">&quot;static/img/logo.png&quot;</span>&gt;</span><br><span class="line">欢迎$&#123;user.username&#125;登陆!!!</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h6 id="aaa-jsp">aaa.jsp</h6><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"><span class="built_in">this</span> is page aaa</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>准备Controller代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &quot;/loginController.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginController</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 获取用户名和密码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;pwd&quot;</span>);</span><br><span class="line">        System.out.println(username);</span><br><span class="line">        System.out.println(password);</span><br><span class="line">        <span class="comment">// 链接数据库校验登录</span></span><br><span class="line">        <span class="comment">// 登录成功,将用户信息放入Session域</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">User</span>(username,password);</span><br><span class="line">        req.getSession().setAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">        <span class="comment">// 跳转到欢迎页</span></span><br><span class="line">        resp.sendRedirect(<span class="string">&quot;welcome.jsp&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>准备登录控制过滤器</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(urlPatterns = &quot;/*&quot;)</span><span class="comment">// 任何资源都要进行过滤,</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Filter1_LoginFilter</span>  <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        HttpServletRequest req=(HttpServletRequest)servletRequest;</span><br><span class="line">        HttpServletResponse resp=(HttpServletResponse) servletResponse;</span><br><span class="line">        <span class="comment">//无论是否登录过,都要放行的资源   登录页  登录校验Controller 和一些静态资源</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">requestURI</span> <span class="operator">=</span> req.getRequestURI();</span><br><span class="line">        System.out.println(requestURI);</span><br><span class="line">        <span class="keyword">if</span>(requestURI.contains(<span class="string">&quot;login.jsp&quot;</span>)|| requestURI.contains(<span class="string">&quot;loginController.do&quot;</span>)|| requestURI.contains(<span class="string">&quot;/static/&quot;</span>))&#123;</span><br><span class="line">            <span class="comment">// 直接放行</span></span><br><span class="line">            filterChain.doFilter(req,resp);</span><br><span class="line">            <span class="comment">// 后续代码不再执行</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 需要登录之后才能访问的资源,如果没登录,重定向到login.jsp上,提示用户进行登录</span></span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> req.getSession();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">user</span> <span class="operator">=</span> session.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="literal">null</span> != user)&#123;<span class="comment">// 如果登录过 放行</span></span><br><span class="line">            filterChain.doFilter(req,resp);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;<span class="comment">// 没有登录过,跳转至登录页</span></span><br><span class="line">            resp.sendRedirect(<span class="string">&quot;login.jsp&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>Listener</h1><h2 id="案例：记录请求日志">案例：记录请求日志</h2><h6 id="RequestLoginListener-java">RequestLoginListener.java</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestLogListener</span> <span class="keyword">implements</span> <span class="title class_">ServletRequestListener</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> SimpleDateFormat simpleDateFormat=<span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">requestDestroyed</span><span class="params">(ServletRequestEvent sre)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">requestInitialized</span><span class="params">(ServletRequestEvent sre)</span> &#123;</span><br><span class="line">        <span class="comment">// 获得请求发出的IP</span></span><br><span class="line">        <span class="comment">// 获得请求的URL</span></span><br><span class="line">        <span class="comment">// 获得请求产生的时间</span></span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest)sre.getServletRequest();</span><br><span class="line">        <span class="type">String</span> <span class="variable">remoteHost</span> <span class="operator">=</span> request.getRemoteHost();</span><br><span class="line">        <span class="type">String</span> <span class="variable">requestURL</span> <span class="operator">=</span> request.getRequestURL().toString();</span><br><span class="line">        <span class="type">String</span> <span class="variable">reqquestDate</span> <span class="operator">=</span> simpleDateFormat.format(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">        <span class="comment">// 准备输出流</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">PrintWriter</span> <span class="variable">pw</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">PrintWriter</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;d:/msb.txt&quot;</span>),<span class="literal">true</span>));</span><br><span class="line">            pw.println(remoteHost+<span class="string">&quot; &quot;</span>+requestURL+<span class="string">&quot; &quot;</span>+reqquestDate );</span><br><span class="line">            pw.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="案例：显示在线人数">案例：显示在线人数</h2><p><strong>需求</strong>：开启一次会话session 在线人数加一 销毁会话以后在线人数减一</p><p>使用count来计数，然后<strong>存在application域中</strong></p><h6 id="OnlineNumberListener">OnlineNumberListener:</h6><p>获取application域对象，存入数据count，如果一次session开启，++count；一次session关闭，–count</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OnlineNumberListener</span> <span class="keyword">implements</span> <span class="title class_">HttpSessionListener</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sessionCreated</span><span class="params">(HttpSessionEvent se)</span> &#123;</span><br><span class="line">        <span class="comment">//向application域中增加一个数字</span></span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> se.getSession();</span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">application</span> <span class="operator">=</span> session.getServletContext();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">count</span> <span class="operator">=</span> application.getAttribute(<span class="string">&quot;count&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == count) &#123;</span><br><span class="line">            <span class="comment">//第一次放入数据</span></span><br><span class="line">            application.setAttribute(<span class="string">&quot;count&quot;</span>,<span class="number">1</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> (<span class="type">int</span>) count;</span><br><span class="line">            application.setAttribute(<span class="string">&quot;count&quot;</span>, ++c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sessionDestroyed</span><span class="params">(HttpSessionEvent se)</span> &#123;</span><br><span class="line">        <span class="comment">//向application域中减少一个数字</span></span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> se.getSession();</span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">application</span> <span class="operator">=</span> session.getServletContext();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">count</span> <span class="operator">=</span> application.getAttribute(<span class="string">&quot;count&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">count1</span> <span class="operator">=</span> (<span class="type">int</span>) count;</span><br><span class="line">        application.setAttribute(<span class="string">&quot;count&quot;</span>,--count1);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="案例：重启免登录">案例：重启免登录</h2><h3 id="Session序列化和反序列化">Session序列化和反序列化</h3><p>1、序列化与反序列</p><p>把对象转化为字节序列的过程称为序列化（保存到硬盘，持久化）</p><p>把字节序列转化为对象的过程称为反序列化（存放于内存）</p><p>2、序列化的用途</p><p>把对象的字节序列永久保存到硬盘上，通常放到一个文件中。</p><p>把网络传输的对象通过字节序列化，方便传输本节作业</p><p>3、实现步骤</p><p>想实现序列化和反序列化需要手动配置</p><p><img src="JavaEE/20210808154352-20220507093631697.png" alt="image-20210808154350410"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">Context</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Manager</span> <span class="attr">className</span>=<span class="string">&quot;org.apache.catalina.session.PersistentManager&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Store</span> <span class="attr">className</span>=<span class="string">&quot;org.apache.catalina.session.FileStore&quot;</span> <span class="attr">directory</span>=<span class="string">&quot;d:/session&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Manager</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">Context</span>&gt;</span></span><br></pre></td></tr></table></figure><p>==注意实体类必须实现serializable 接口==</p><h3 id="开发过程">开发过程</h3><h4 id="1-准备实体类">1 准备实体类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span>  <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String pwd;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-开发登录信息输入页面">2 开发登录信息输入页面</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">&quot;loginController.do&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">  用户名:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;user&quot;</span>&gt; &lt;br/&gt;</span><br><span class="line">  密码:&lt;input type=<span class="string">&quot;password&quot;</span> name=<span class="string">&quot;pwd&quot;</span>&gt;&lt;br/&gt;</span><br><span class="line">  &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure><h4 id="3开发登录信息验证Servlet">3开发登录信息验证Servlet</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/loginController.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginController</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;pwd&quot;</span>);</span><br><span class="line">    <span class="comment">// user</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">User</span>(username,pwd);</span><br><span class="line">    <span class="comment">// session</span></span><br><span class="line">    <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> req.getSession();</span><br><span class="line">    session.setAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-开发校验当前是否已经登录的Controller">4 开发校验当前是否已经登录的Controller</h4><p>loginCheckController.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &quot;/loginCheckController.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginCheckController</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="comment">// 判断是否登录</span></span><br><span class="line">    <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> req.getSession();</span><br><span class="line">    <span class="type">Object</span> <span class="variable">user</span> <span class="operator">=</span> session.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    <span class="type">Object</span> <span class="variable">listener</span> <span class="operator">=</span> session.getAttribute(<span class="string">&quot;listener&quot;</span>);<span class="comment">// 获得对应的监听器</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span><span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="literal">null</span> != user)&#123;</span><br><span class="line">        message=<span class="string">&quot;您已经登录过&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        message=<span class="string">&quot;您还未登录&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    resp.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">    resp.getWriter().println(message);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-测试">5  测试</h4><p>先登录,<a href="http://xn--loginCheckController-9x08aw463ah2xark6l.do">然后请求loginCheckController.do</a> 校验是否登录过,然后重启项目,<a href="http://xn--loginCheckController-oy96at320b9nugksh.do">再起请求loginCheckController.do</a> 校验是否登录过,发现重启后,仍然是登录过的</p><h4 id="6-监听钝化和活化">6 监听钝化和活化</h4><p><strong>MySessionActivationListener.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MySessionActivationListener</span> <span class="keyword">implements</span> <span class="title class_">HttpSessionActivationListener</span>, Serializable &#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sessionWillPassivate</span><span class="params">(HttpSessionEvent se)</span> &#123;</span><br><span class="line">    System.out.println(se.getSession().hashCode()+<span class="string">&quot;即将钝化&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sessionDidActivate</span><span class="params">(HttpSessionEvent se)</span> &#123;</span><br><span class="line">    System.out.println(se.getSession().hashCode()+<span class="string">&quot;已经活化&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>LoginController登录时绑定监听器</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@WebServlet(&quot;/loginController.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginController</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;pwd&quot;</span>);</span><br><span class="line">        <span class="comment">// user</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">User</span>(username,pwd);</span><br><span class="line">        <span class="comment">// session</span></span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> req.getSession();</span><br><span class="line">        session.setAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">        <span class="comment">// 绑定监听器</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;listener&quot;</span>, <span class="keyword">new</span> <span class="title class_">MySessionActivationListener</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>重启项目 重复测试即可</p><p><img src="JavaEE/20210808161851-20220507093632140.png" alt="image-20210808161834961"></p><p><img src="JavaEE/20210808161855-20220507093631903.png" alt="image-20210808161823274"></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JQuery</title>
      <link href="/2021/06/18/JQuery/"/>
      <url>/2021/06/18/JQuery/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=c3e3e6cc-1524-25a0-5473-905b45f85f48</cover>
      <date>Fri Jun 18 2021 09:56:56 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>引入</h1><h4 id="为什么使用jQuery？">为什么使用jQuery？</h4><p>使用原生JavaScript编码存在问题</p><p>1选择器功能弱</p><p>2 DOM操作繁琐之极</p><p>3浏览器兼容性不好</p><p>4动画功能弱</p><span id="more"></span><h3 id="优点">优点</h3><p>1强大的选择器</p><p>2出色的DOM封装</p><p>3出色的浏览器兼容性</p><p>4强大的动画功能</p><p>5体积小，压缩后只有100KB左右</p><p>6可靠的事件处理机制</p><p>7使用隐式迭代简化编程</p><p>8丰富的插件支持</p><h3 id="定义">定义</h3><p>目前最流行的JavaScript函数库之一，对JavaScript进行了封装。并不是一门新语言。将常用的、复杂的操作进行函数化封装，直接调用，大大降低了使用JavaScript的难度，改变了使用JavaScript的习惯。jQuery能做的JavaScript也能做，但使用jQuery能大幅提高开发效率,由美国人John Resig在2006年推出，目前最新版本是v3.5.1。宗旨：Write less，do more（写更少代码，做更多事情）。官方网址<a href="http://jquery.com/">http://jquery.com/</a></p><h3 id=""></h3><h3 id="-2">==$()==</h3><p>作用一：页面加载函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*jQuery(document).ready(function ()&#123;</span></span><br><span class="line"><span class="comment">                                var domS1=document.getElementById(&quot;s1&quot;);</span></span><br><span class="line"><span class="comment">                                console.log(domS1.innerText);</span></span><br><span class="line"><span class="comment">                        &#125;)*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// jQuery  可以简写 $</span></span><br><span class="line"><span class="comment">/*$(document).ready(function ()&#123;</span></span><br><span class="line"><span class="comment">                                var domS1=document.getElementById(&quot;s1&quot;);</span></span><br><span class="line"><span class="comment">                                console.log(domS1.innerText);</span></span><br><span class="line"><span class="comment">                        &#125;)*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> domS1=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;s1&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(domS1.<span class="property">innerText</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">$(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;第二个页面加载函数&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">$(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;第三个页面加载函数&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>作用二：选择器标志</p><p><strong>$(selector)</strong></p><h1>选择器</h1><h2 id="基本选择器">基本选择器</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//标签选择器 $(&quot;a&quot;)   </span></span><br><span class="line">                  $(<span class="string">&quot;h3&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line">                  $(<span class="string">&quot;p&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line"><span class="comment">// ID选择器 $(&quot;#id&quot;)     $(&quot;p#id&quot;) </span></span><br><span class="line">                  $(<span class="string">&quot;#h31&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line">                  $(<span class="string">&quot;h3#h31&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line"><span class="comment">// 类选择器 $(&quot;.class&quot;)    $(&quot;h2.class&quot;) </span></span><br><span class="line">                  $(<span class="string">&quot;.red1&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line"><span class="comment">// 通配选择器 $(&quot;*&quot;) </span></span><br><span class="line">                  $(<span class="string">&quot;*&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line"><span class="comment">// 并集选择器$(&quot;elem1,elem2,elem3&quot;) </span></span><br><span class="line">                  $(<span class="string">&quot;#h31,span,div&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line"><span class="comment">// 后代选择器$(ul li)   </span></span><br><span class="line">                  $(<span class="string">&quot;p span&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>);   </span><br><span class="line"><span class="comment">//  父子选择器 $(ul&gt;li)   </span></span><br><span class="line">                  $(<span class="string">&quot;p&gt;span&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line"><span class="comment">//  后面第一个兄弟元素 prev + next </span></span><br><span class="line">                  $(<span class="string">&quot;h3+p&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line"><span class="comment">//  后面所有的兄弟元素 prev ~ next </span></span><br><span class="line">                $(<span class="string">&quot;h3~p&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br></pre></td></tr></table></figure><h2 id="属性选择器">属性选择器</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//[attribute] </span></span><br><span class="line">                    $(<span class="string">&quot;a&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line">                    $(<span class="string">&quot;a[href]&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line"><span class="comment">//[attribute1][attribute2] </span></span><br><span class="line">                    $(<span class="string">&quot;a[href][title]&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line"><span class="comment">//[attribute=value]   </span></span><br><span class="line">                    $(<span class="string">&quot;a[href=&#x27;film-2.html&#x27;]&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line"><span class="comment">//[attribute!=value]   </span></span><br><span class="line">                    $(<span class="string">&quot;a[href][href!=&#x27;film-2.html&#x27;]&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line"><span class="comment">//[attribute^=value]   </span></span><br><span class="line">                    $(<span class="string">&quot;a[href^=&#x27;http&#x27;]&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line"><span class="comment">//[attribute$=value   </span></span><br><span class="line">                    $(<span class="string">&quot;a[href$=&#x27;htm&#x27;]&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line"><span class="comment">//[attribute*=value]   </span></span><br><span class="line">                $(<span class="string">&quot;a[href*=&#x27;mashibing&#x27;]&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="位置选择器">位置选择器</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">//位置针对整个页面 </span></span><br><span class="line">                  <span class="comment">//:first     :last   :odd   :even   </span></span><br><span class="line">                  $(<span class="string">&quot;p:first&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line">                  $(<span class="string">&quot;p:last&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line">                  $(<span class="string">&quot;p:odd&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>);<span class="comment">//索引从0开始 奇数的索引 1 3 5 第偶数的元素</span></span><br><span class="line">                  $(<span class="string">&quot;p:even&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); <span class="comment">//</span></span><br><span class="line">                  <span class="comment">//:eq(n)     :gt(n)   :lt(n) </span></span><br><span class="line">                  $(<span class="string">&quot;p:eq(4)&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>);   <span class="comment">//equals </span></span><br><span class="line">                  $(<span class="string">&quot;p:lt(4)&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>);<span class="comment">//less   than  </span></span><br><span class="line">                  $(<span class="string">&quot;p:gt(4)&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>);<span class="comment">//greater   than </span></span><br><span class="line"><span class="comment">//位置针对上级标签 </span></span><br><span class="line">                  <span class="comment">//:first-child    :last-child   :only-child </span></span><br><span class="line">                  $(<span class="string">&quot;p:first-child&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line">                  $(<span class="string">&quot;p:last-child&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line">                  $(<span class="string">&quot;p:only-child&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line">                  <span class="comment">//:nth-child(n)   :nth-child(odd|even) :nth-child(xn+y)</span></span><br><span class="line">                   <span class="comment">// 索引从0开始 只有此处从1开始</span></span><br><span class="line">                  $(<span class="string">&quot;p:nth-child(2)&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>);</span><br><span class="line">                  $(<span class="string">&quot;p:nth-child(odd)&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line">                  $(<span class="string">&quot;p:nth-child(even)&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>); </span><br><span class="line">                  $(<span class="string">&quot;p:nth-child(3n+1)&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;myClass&quot;</span>);<span class="comment">//n=0,1,2,3 </span></span><br></pre></td></tr></table></figure><h2 id="表单选择器">表单选择器</h2><ul><li><p>关于表单项的选择器</p><p>:text   :password  :radio  :checkbox  :hidden  :file  :submit</p><p>:input  匹配所有 input, textarea, select 和 button 元素</p></li><li><p>关于表单项状态的选择器</p><p>:selected  :checked  :enabled  :disabled  :hidden :visible</p></li><li><p>注意<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="normal">&quot;</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">&quot;</mi><mo stretchy="false">)</mo><mtext>和</mtext></mrow><annotation encoding="application/x-tex">(&quot;input&quot;)和</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">&quot;</span><span class="mord mathnormal">in</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord">&quot;</span><span class="mclose">)</span><span class="mord cjk_fallback">和</span></span></span></span>(“:input”)的区别</p><p>$(“input”)：标签选择器，只匹配input标签,</p><p>$(“:input”)： 匹配所有 input, textarea, select 和 button 元素</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:text   :password    :radio  :checkbox  :hidden    :file  :submit </span></span><br><span class="line">                    <span class="keyword">var</span> arr =$(<span class="string">&quot;input&quot;</span>); <span class="comment">// 标签名选择器</span></span><br><span class="line">                  </span><br><span class="line">                    <span class="keyword">var</span> arr = $(<span class="string">&quot;input[type=hidden]&quot;</span>); </span><br><span class="line">                    <span class="keyword">var</span> arr = $(<span class="string">&quot;input:hidden&quot;</span>);              </span><br><span class="line"><span class="comment">//:input  匹配所有 input, textarea, select 和 button 元素 </span></span><br><span class="line">                    <span class="keyword">var</span> arr =   $(<span class="string">&quot;input,select,textarea,button&quot;</span>);   </span><br><span class="line">                  <span class="keyword">var</span> arr = $(<span class="string">&quot;:input&quot;</span>); </span><br><span class="line"><span class="comment">//:selected    :checked  :enabled  :disabled   </span></span><br><span class="line">                    <span class="keyword">var</span> arr = $(<span class="string">&quot;:disabled&quot;</span>); </span><br><span class="line">                    <span class="keyword">var</span> arr = $(<span class="string">&quot;:enabled&quot;</span>); </span><br><span class="line">                    <span class="keyword">var</span> arr = $(<span class="string">&quot;:input:not(:disabled)&quot;</span>); </span><br><span class="line">                    <span class="keyword">var</span> arr = $(<span class="string">&quot;:checked&quot;</span>); </span><br><span class="line">                    <span class="keyword">var</span> arr = $(<span class="string">&quot;:selected&quot;</span>); </span><br><span class="line">                    <span class="comment">//:hidden :visible       </span></span><br><span class="line">                    <span class="keyword">var</span> arr = $(<span class="string">&quot;input:hidden&quot;</span>) </span><br><span class="line">                    <span class="keyword">var</span>   arr = $(<span class="string">&quot;:input:visible&quot;</span>)</span><br><span class="line">                  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                      <span class="variable language_">console</span>.<span class="title function_">info</span>(arr[i]);</span><br><span class="line">                  &#125;</span><br></pre></td></tr></table></figure><h1>完成DOM编程</h1><h2 id="操作属性">操作属性</h2><p>原生js 中的通过元素.属性名或者元素.setAttribute()方式操作元素属性,jQuery给我们封装了attr() 和removeAttr(),更加便捷的操作属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">          *attr() </span></span><br><span class="line"><span class="comment">          * </span></span><br><span class="line"><span class="comment">          * */</span></span><br><span class="line"><span class="comment">//获得属性</span></span><br><span class="line">             <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span><br><span class="line">                  <span class="variable language_">console</span>.<span class="title function_">log</span>($(<span class="string">&quot;#f1&quot;</span>).<span class="title function_">attr</span>(<span class="string">&quot;color&quot;</span>))</span><br><span class="line">                  <span class="variable language_">console</span>.<span class="title function_">log</span>($(<span class="string">&quot;#f1&quot;</span>).<span class="title function_">attr</span>(<span class="string">&quot;id&quot;</span>))</span><br><span class="line">                  <span class="variable language_">console</span>.<span class="title function_">log</span>($(<span class="string">&quot;#f1&quot;</span>).<span class="title function_">attr</span>(<span class="string">&quot;size&quot;</span>))</span><br><span class="line">             &#125;</span><br><span class="line"><span class="comment">//修改属性</span></span><br><span class="line">             <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span><br><span class="line">                 $(<span class="string">&quot;#f1&quot;</span>).<span class="title function_">attr</span>(<span class="string">&quot;color&quot;</span>,<span class="string">&quot;green&quot;</span>)</span><br><span class="line">                 $(<span class="string">&quot;#f1&quot;</span>).<span class="title function_">attr</span>(<span class="string">&quot;size&quot;</span>,<span class="string">&quot;5&quot;</span>)</span><br><span class="line">             &#125;</span><br><span class="line"><span class="comment">//删除属性</span></span><br><span class="line">             <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;</span><br><span class="line">                 $(<span class="string">&quot;#f1&quot;</span>).<span class="title function_">removeAttr</span>(<span class="string">&quot;color&quot;</span>) </span><br><span class="line">             &#125;</span><br><span class="line"><span class="comment">//添加属性</span></span><br><span class="line">             <span class="keyword">function</span> <span class="title function_">fun4</span>(<span class="params"></span>)&#123;</span><br><span class="line">                $(<span class="string">&quot;#f1&quot;</span>).<span class="title function_">attr</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;a&quot;</span>)</span><br><span class="line">             &#125;</span><br></pre></td></tr></table></figure><h2 id="操作样式">操作样式</h2><p>原生js 中的通过元素.style.样式名=’样式值’的方式操作元素样式,jQuery给我们封装了css()方法,便于我们操作样式,多数情况样式选择器使用类选择器,所以jQuery针对于这一情况,给我们封装了==addClass==  ==removeClass== ==toggleClass== 三个方法</p><p>css样式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">          <span class="selector-class">.a</span>&#123;</span></span><br><span class="line"><span class="language-css">              <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">              <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">              <span class="attribute">background-color</span>: pink;</span></span><br><span class="line"><span class="language-css">          &#125;  </span></span><br><span class="line"><span class="language-css">          <span class="selector-class">.b</span>&#123;</span></span><br><span class="line"><span class="language-css">              <span class="attribute">border</span>: <span class="number">10px</span> solid green;</span></span><br><span class="line"><span class="language-css">              <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">          &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>jQuery封装的==css()==方法</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//修改样式</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//获得d1的css样式</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>($(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;width&quot;</span>));</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>($(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;height&quot;</span>));</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>($(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;background-color&quot;</span>));</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//修改d1的css样式</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;width&quot;</span>,<span class="string">&quot;200px&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;height&quot;</span>,<span class="string">&quot;300px&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;background-color&quot;</span>,<span class="string">&quot;yellow&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">              * CSS 样式在实际的研发中,往往通过类选择器作用到元素上</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">              * jQuery就专门的封装了操作class属性值的方法</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">              * */</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//添加class值</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d2&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;b&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//删除class值</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d2&quot;</span>).<span class="title function_">removeClass</span>(<span class="string">&quot;b&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//切换class值</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun4</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d2&quot;</span>).<span class="title function_">toggleClass</span>(<span class="string">&quot;b&quot;</span>)<span class="comment">// 原来有b 则删除,如果没有,则增加b</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="操作文本">操作文本</h2><p>原生js 中的通过元素.innerText和innerHTML和.value属性操作标签内部文本和内容,jQuery给我们封装了==text(),html()和val()==三个方法</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//获得标签内容</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                           * innerText &gt;&gt;&gt;&gt; text();</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                           * innerHTML &gt;&gt;&gt;&gt; html();</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                           * value     &gt;&gt;&gt;&gt; val();</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                           * </span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                           * */</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>($(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">text</span>()) </span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>($(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">html</span>())</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>($(<span class="string">&quot;#i1&quot;</span>).<span class="title function_">val</span>())</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//修改标签内容</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//$(&quot;#d1&quot;).text(&quot;&lt;h1&gt;牛气冲天&lt;/h1&gt;&quot;);</span></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;&lt;h1&gt;牛气冲天&lt;/h1&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#i1&quot;</span>).<span class="title function_">val</span>(<span class="string">&quot;你好&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//删除标签中的内容</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//$(&quot;#d1&quot;).html(&quot;&quot;);</span></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">empty</span>();<span class="comment">// 清空内容</span></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#i1&quot;</span>).<span class="title function_">val</span>(<span class="string">&quot;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="增删元素">增删元素</h2><p>原生js 中的对于元素的创建,增加和删除代码比较繁琐,而jQuery从元素的创建到元素的增加和删除都给我们提供了更加便捷的方法</p><ul><li>创建元素<ul><li>$(‘<span>text<span>’)</li></ul></li><li>追加元素<ul><li>append() appendTo() 添加内部标签</li><li>before() insertBefore() 向前增加标签</li><li>after() insertAfter()  向后增加标签</li></ul></li><li>删除元素<ul><li>empty()  清空字标签</li><li>remove() 移除当前标签</li></ul></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//append() 调用的对象是添加的区域</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 创建元素</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> span1=$(<span class="string">&quot;&lt;span&gt;&lt;/span&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 设置样式</span></span></span><br><span class="line"><span class="language-javascript">        span1.<span class="title function_">css</span>(<span class="string">&quot;color&quot;</span>,<span class="string">&quot;green&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        span1.<span class="title function_">css</span>(<span class="string">&quot;border&quot;</span>,<span class="string">&quot;1px solid blue&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        span1.<span class="title function_">css</span>(<span class="string">&quot;background-color&quot;</span>,<span class="string">&quot;lightgray&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 设置文字</span></span></span><br><span class="line"><span class="language-javascript">        span1.<span class="title function_">text</span>(<span class="string">&quot;今天天气很好&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&#x27;#d1&#x27;</span>).<span class="title function_">append</span>(span1)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//appendTo() 调用的对象是要添加的内容</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> h =$(<span class="string">&quot;&lt;h3&gt;测试文字&lt;/h3&gt;&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;color&quot;</span>,<span class="string">&quot;red&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;border&quot;</span>,<span class="string">&quot;1px solid green&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">        h.<span class="title function_">appendTo</span>($(<span class="string">&#x27;#d1&#x27;</span>))</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//before()</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> span1=$(<span class="string">&#x27;&lt;span style=&quot;color: red; border: 1px solid orangered;&quot;&gt;测试文字&lt;/span&gt;&#x27;</span>) </span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">before</span>(span1);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun4</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> span1=$(<span class="string">&#x27;&lt;span style=&quot;color: red; border: 1px solid orangered;&quot;&gt;测试文字&lt;/span&gt;&#x27;</span>) </span></span><br><span class="line"><span class="language-javascript">        span1.<span class="title function_">insertBefore</span>($(<span class="string">&quot;#d1&quot;</span>));</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//after()</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun5</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> span1=$(<span class="string">&#x27;&lt;span style=&quot;color: red; border: 1px solid orangered;&quot;&gt;测试文字&lt;/span&gt;&#x27;</span>) </span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">after</span>(span1);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun6</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> span1=$(<span class="string">&#x27;&lt;span style=&quot;color: red; border: 1px solid orangered;&quot;&gt;测试文字&lt;/span&gt;&#x27;</span>) </span></span><br><span class="line"><span class="language-javascript">        span1.<span class="title function_">insertAfter</span>($(<span class="string">&quot;#d1&quot;</span>));</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//empty()</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun7</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">empty</span>()</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//remove()</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun8</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">remove</span>(); <span class="comment">// 移除当前元素本身</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="操作事件">操作事件</h2><p>无非就是绑定事件,触发事件,解绑定事件.原生js中的通过DOM编程和在标签上的事件属性绑定事件,</p><p>jQuery中,我们可以使用</p><p>事件的绑定:</p><ul><li>==bind()==</li><li>==live()==(1.8及之前可用)</li><li>==on()==(1.9之后推荐使用),==one()==</li></ul><p>事件解绑定:==unbind()==</p><p>事件的触发:行为触发, jQuery方法触发</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript"><span class="comment">//给元素绑定事件</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//原生JS</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*var div1=document.getElementById(&quot;d1&quot;)</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                div1.onmouseover=function ()&#123;</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                alert(&quot;悬停&quot;)</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                &#125;*/</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/* bind 方法绑定事件</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                * 在jQuery中,事件的名称= 原始名称去掉 on</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                * onclick       click</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                * onmouseover   mouseover</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                * </span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                * */</span></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">bind</span>(<span class="string">&#x27;mouseover&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&#x27;#d1&#x27;</span>).<span class="title function_">css</span>(<span class="string">&quot;background-color&quot;</span>,<span class="string">&#x27;yellow&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*事件名作为方法*/</span></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">mouseleave</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&#x27;#d1&#x27;</span>).<span class="title function_">css</span>(<span class="string">&quot;background-color&quot;</span>,<span class="string">&#x27;lightgreen&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 * one 绑定事件一次 </span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 * </span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 * */</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*$(&quot;#d1&quot;).one(&#x27;mouseover&#x27;,function()&#123;</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                $(&#x27;#d1&#x27;).css(&quot;background-color&quot;,&#x27;yellow&#x27;)</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                &#125;);</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"></span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 $(&quot;#d1&quot;).one(&#x27;mouseleave&#x27;,function()&#123;</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                $(&#x27;#d1&#x27;).css(&quot;background-color&quot;,&#x27;lightgreen&#x27;)</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                &#125;);*/</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript"><span class="comment">//解除绑定</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//$(&quot;#d1&quot;).unbind();  解除绑定的所有事件</span></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">unbind</span>(<span class="string">&quot;mouseover&quot;</span>) <span class="comment">// 接触绑定的指定事件</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript"><span class="comment">//触发事件</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 相当于发生了获得焦点事件</span></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#i1&quot;</span>).<span class="title function_">focus</span>()</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun4</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;获得焦点了&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="jQuery对象和DOM对象的转换">jQuery对象和DOM对象的转换</h2><p>使用原生JS方式获得的页面结点对象我们可以简称为DOM对象,使用jQuery核心函数获得的对象我们可以简称为jQuery对象,这两种方式获得的对象即是是页面上同一个元素,那么也是不一样的,二者之间的API是不通用的.而在某些情况下,我们往往无法选择接收的对象,只能被动使用,那么这个时候我们可以让二者实现转换,以达到可以调用API实现功能的目的</p><p>使用原生JSDOM对象转换成jQuery对象方式是==$(dom对象)==</p><p>jQuery对象转换成DOM对象的方式是==jQuery对象[0]/.get(0)==，</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    $(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//1 原生JS获取页面元素  原生DOM对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> div1=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;d1&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//2 jQuery方式获取页面元素 jQuery对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> div2=$(<span class="string">&quot;#d1&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"> * DOM对象和jQuery对象之间的方法和属性是不通用的</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"> *  </span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"> * */</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(div1.<span class="property">innerText</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(div2.<span class="title function_">text</span>());</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(div1)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(div2)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// DOM对象如何调用jQuery函数  DOM对象转换为jQuery    $(DOM)</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>($(div1).<span class="title function_">text</span>());</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// jQuery对象如何调用DOM对象的属性和方法   jQuery转换为DOM对象  get(0)  [0]</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(div2.<span class="title function_">get</span>(<span class="number">0</span>).<span class="property">innerText</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(div2[<span class="number">0</span>].<span class="property">innerText</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="迭代遍历方式">迭代遍历方式</h2><p>jQuery给我们封装了一个快捷遍历元素的方法,接下来我们就使用一下jQuery中新的遍历方式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    $(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">          * jQuery对象名往往以$开始, 以示和DOM对象区分</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">          * </span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">          * </span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">          * */</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> $lis =$(<span class="string">&quot;li&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>($lis)</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span>(<span class="keyword">var</span> i =<span class="number">0</span>;i&lt;$lis.<span class="property">length</span>;i++)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>($lis.<span class="title function_">get</span>(i))</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">          * jQuery提供了一个each方法帮助我们遍历元素</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">          * */</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        $lis.<span class="title function_">each</span>(<span class="keyword">function</span>(<span class="params">i,e</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">          * e是一个原生DOM对象,所以用的是text()方法来提取文本</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">          * */</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(i+<span class="string">&quot;&gt;&quot;</span>+$(e).<span class="title function_">text</span>())</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        $.<span class="title function_">each</span>($lis,<span class="keyword">function</span>(<span class="params">i,e</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">          * e是一个原生DOM对象</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">          * */</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(i+<span class="string">&quot;&gt;&quot;</span>+$(e).<span class="title function_">text</span>())</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h1>动画效果</h1><h2 id="显示和隐藏">显示和隐藏</h2><ul><li>==show()== :实现简单显示动画效果方法</li><li>==hide()== :实现简单隐藏动画效果方法</li><li>==toggle()== :实现切换简单显示和隐藏动画效果方法</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#d1</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: yellow;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">/*$(&quot;#d1&quot;).show(2000,&#x27;swing&#x27;,function()&#123;</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                                        alert(&quot;动画执行结束&quot;)</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                                &#125;)*/</span></span></span><br><span class="line"><span class="language-javascript">                $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">show</span>(<span class="number">2000</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">hide</span>(<span class="number">3000</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">toggle</span>(<span class="number">5000</span>);<span class="comment">//</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;d1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;show&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun1()&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hide&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun2()&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;toggle&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun3()&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span> </span><br></pre></td></tr></table></figure><h2 id="滑动动画效果">滑动动画效果</h2><ul><li>==slideDown()==:实现向下滑动效果</li><li>==slideUp()==:实现向上滑动效果</li><li>==slideToggle()==:实现滑动切换动画效果</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">slideDown</span>(<span class="number">2000</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">slideUp</span>(<span class="number">3000</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">slideToggle</span>(<span class="number">5000</span>);<span class="comment">//</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="淡入淡出动画效果">淡入淡出动画效果</h2><ul><li>==fadeln()==: 实现淡入动画效果</li><li>==fadeOut()==:实现淡出动画效果</li><li>==fadeToggle()==:实现淡入淡出切换效果</li><li>==fadeTo()==：实现淡入指定透明度效果方法</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//淡入动画</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">fadeIn</span>(<span class="number">2000</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//淡出动画</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">fadeOut</span>(<span class="number">3000</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//淡入淡出切换</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">fadeToggle</span>(<span class="number">5000</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//淡入指定透明度效果</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fun4</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">fadeTo</span>(<span class="number">5000</span>,<span class="number">0.2</span>);<span class="comment">// 0-1 </span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="实现自定义动画效果">实现自定义动画效果</h2><p>==$(“”).animate({动画内容},执行时间,动画结束后要执行的方法)==</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    $(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//$(&quot;&quot;).animate(&#123;动画内容&#125;,执行时间,动画结束后要执行的方法)</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&quot;#d1&quot;</span>).<span class="title function_">animate</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">width</span>:<span class="string">&quot;100px&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">height</span>:<span class="string">&quot;100px&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">opcity</span>:<span class="number">0.5</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">borderRadius</span>:<span class="string">&quot;50px&quot;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,<span class="number">2000</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">alert</span>(<span class="string">&quot;动画执行结束了&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><img src="JQuery/20210731144759.gif" alt="1627712830125 00_00_00-00_00_30" style="zoom: 50%;" /><h1>表单检验</h1><h2 id="表单验证案例">表单验证案例</h2><h4 id="验证要求">验证要求</h4><p>用户名不能为空</p><p>用户名长度大于等于6</p><p>用户名中不能有数字</p><p>密码不少于5位</p><p>两次密码必须一致</p><p>邮箱格式正确 必须有@和.  例如123456789@qq.com</p><h4 id="实现效果">实现效果</h4><p><img src="C:%5CUsers%5CDell%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210731144934316.png" alt="image-20210731144934316"></p><h3 id="代码">代码</h3><p><a href="#form%E8%A1%A8%E5%8D%95%E5%BA%94%E7%94%A8%E6%AD%A3%E5%88%99">代码改进</a></p><h3 id="总结">总结</h3><p>1.对于表单的提交，要给form标签绑定onSubmit事件，而不是给submit按钮绑定onClick事件,onsubmit绑定的方法时要有return关键字,绑定的方法要返回true/false</p><p>1.对于表单的提交，要给form标签绑定onSubmit事件，而不是给submit按钮绑定onClick事件,onsubmit绑定的方法时要有return关键字,绑定的方法要返回true/false</p><p>2.表单项内容不管输入的是字符串、数字、日期，js、jQuery、JSP接收后都是String类型</p><p>3.表单的验证和String对象有密切关系 length charAt(i) indexOf(“@”)</p><p>4.如果表单项内容为空，js收到的不是null，而是空字符串。判断条件不能写 username == null，而要写username==&quot;&quot;或username.length ==0</p><p>5.验证出错要return false，验证无错要return true，并且 onsubmit=&quot;return checkForm()</p><p>6.该示例的缺点主要在于对于邮箱如果采用传统方式进行验证，代码繁琐并且不能保证严谨性,过度依赖String的API。对于邮箱、手机号码、邮政编码等验证，可以使用正则表达式进行验证，严谨而且简单。</p><h2 id="正则表达式">正则表达式</h2><h3 id="1-什么是正则表达式">1. 什么是正则表达式</h3><p>Regular Expression，在代码中常简写为regex,正则表达式使用单个字符串来描述、匹配一系列符合某个句法规则的字符串。在很多文本编辑器里，正则表达式通常被用来检索、替换那些符合某个模式的文本。正则表达式是对字符串（包括普通字符（例如，a 到 z 之间的字母）和特殊字符（称为“元字符”））操作的一种逻辑公式，就是用事先定义好的一些特定字符、及这些特定字符的组合，组成一个“规则字符串”，这个“规则字符串”用来表达对字符串的一种过滤逻辑。正则表达式是一种文本模式，该模式描述在搜索文本时要匹配的一个或多个字符串。</p><h3 id="2-为什么使用正则表达式">2. 为什么使用正则表达式</h3><ul><li>正则表达式可以是文本的校验的代码更加简洁</li><li>正则表达式可以实现更加严谨细致的校验</li></ul><h3 id="3-正则表达式举例">3. 正则表达式举例</h3><p>匹配国内电话号码：\d{3}-\d{8}|\d{4}-\d{7}</p><p>匹配腾讯QQ号：[1-9][0-9]{4,}</p><p>匹配中国邮政编码：\d{6}</p><p>匹配身份证：\d{15}|\d{18}</p><p>匹配由数字和26个英文字母组成的字符串 ^[A-Za-z0-9]+$</p><p>匹配Email地址：\w+([-+.]\w+)<em>@\w+([-.]\w+)</em>.\w+([-.]\w+)*</p><p>匹配中文字符的正则表达式： [\u4e00-\u9fa5] [a-zA-Z]</p><h3 id="4-JS创建正则表达式">4. JS创建正则表达式</h3><p>正则表达式在JS中创建的语法为:</p><p>==var reg=/china/;==</p><p>==var reg=new RegExp(“china”);==</p><h3 id="5-通配符号">5. 通配符号</h3><p><img src="JQuery/20210731151417.png" alt="image-20210731151417254"></p><h3 id="6-重复符号">6. 重复符号</h3><img src="JQuery/20210731151725.png" alt="image-20210731151725582"  /><h3 id="使用正则表达式实现数据验证">使用正则表达式实现数据验证</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"> * 正则表达式不依赖jQuery</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"> * 正则表达式本身就是一个字符串 只不过该字符串用于表述一种规则</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"> * </span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"> * */</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> reg =<span class="regexp">/^\w?$/</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> words =<span class="string">&quot;a&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(reg.<span class="title function_">test</span>(words))</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> regex1 = <span class="regexp">/^\d&#123;6&#125;$/</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> regex2 = <span class="regexp">/^1[3456789]\d&#123;9&#125;$/</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> regex3 = <span class="regexp">/^\w&#123;6,&#125;@[0-9A-Za-z]&#123;2,&#125;(\.[a-zA-Z]&#123;2,3&#125;)&#123;1,2&#125;$/</span>;  </span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="form表单应用正则">form表单应用正则</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">checkUsername</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> reg1=<span class="regexp">/^\D&#123;6,&#125;$/</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> username =$(<span class="string">&quot;#user&quot;</span>).<span class="title function_">val</span>();</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span>(!reg1.<span class="title function_">test</span>(username))&#123;</span></span><br><span class="line"><span class="language-javascript">                    $(<span class="string">&quot;#usertip&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;&lt;font color=&#x27;red&#x27;&gt;格式必须是至少六位的非数字&lt;/font&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 提示OK</span></span></span><br><span class="line"><span class="language-javascript">                $(<span class="string">&quot;#usertip&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;&lt;font color=&#x27;green&#x27;&gt;OK&lt;/font&gt;&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">checkPassword</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> reg2=<span class="regexp">/^\S&#123;5,&#125;$/</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> pwd =$(<span class="string">&quot;#pwd&quot;</span>).<span class="title function_">val</span>();</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span>(!reg2.<span class="title function_">test</span>(pwd))&#123;</span></span><br><span class="line"><span class="language-javascript">                    $(<span class="string">&quot;#pwdtip&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;&lt;font color=&#x27;red&#x27;&gt;至少为5位非空格&lt;/font&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">                $(<span class="string">&quot;#pwdtip&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;&lt;font color=&#x27;green&#x27;&gt;OK&lt;/font&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">checkRepwd</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> p1=$(<span class="string">&quot;#pwd&quot;</span>).<span class="title function_">val</span>();</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> p2=$(<span class="string">&quot;#repwd&quot;</span>).<span class="title function_">val</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span>(p1.<span class="property">length</span>&lt; <span class="number">5</span> || p1 != p2)&#123;</span></span><br><span class="line"><span class="language-javascript">                    $(<span class="string">&quot;#repwdtip&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;&lt;font color=&#x27;red&#x27;&gt;两次密码不一致&lt;/font&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                $(<span class="string">&quot;#repwdtip&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;&lt;font color=&#x27;green&#x27;&gt;OK&lt;/font&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">checkEmail</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> em=$(<span class="string">&quot;#email&quot;</span>).<span class="title function_">val</span>();</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> regex3 = <span class="regexp">/^\w&#123;6,&#125;@[0-9A-Za-z]&#123;2,&#125;(\.[a-zA-Z]&#123;2,3&#125;)&#123;1,2&#125;$/</span>; </span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span>(!regex3.<span class="title function_">test</span>(em) )&#123;</span></span><br><span class="line"><span class="language-javascript">                    $(<span class="string">&quot;#emailtip&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;&lt;font color=&#x27;red&#x27;&gt;邮箱格式有误&lt;/font&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">                $(<span class="string">&quot;#emailtip&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;&lt;font color=&#x27;green&#x27;&gt;OK&lt;/font&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">checkForm</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="title function_">checkUsername</span>()&amp;&amp;<span class="title function_">checkPassword</span>()&amp;&amp;<span class="title function_">checkRepwd</span>()&amp;&amp;<span class="title function_">checkEmail</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">&quot;center&quot;</span> <span class="attr">border</span>=<span class="string">&quot;0&quot;</span> <span class="attr">cellspacing</span>=<span class="string">&quot;0&quot;</span> <span class="attr">cellpadding</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://www.baidu.com&quot;</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span> <span class="attr">onsubmit</span>=<span class="string">&quot;return checkForm()&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span>您的姓名：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">onblur</span>=<span class="string">&quot;checkUsername()&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;usertip&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: inline;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span>输入密码：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;pwd&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">onblur</span>=<span class="string">&quot;checkPassword()&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;pwdtip&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: inline;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span>再输入一遍密码：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;repwd&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">onblur</span>=<span class="string">&quot;checkRepwd()&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;repwdtip&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: inline;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span>您的Email：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">onblur</span>=<span class="string">&quot;checkEmail()&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;emailtip&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;注册&quot;</span> <span class="attr">class</span>=<span class="string">&quot;rb1&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>BootStrap</h1><h2 id="容器类">容器类</h2><p>==.container== 类用于固定宽度并支持响应式布局的容器。</p><p>==.container-fluid== 类用于 100% 宽度，占据全部视口（viewport）的容器。</p><p><strong>二者区别:</strong></p><p>固定容器的响应式布局规则是当窗口大小变化时,在指定的宽度范围内使用固定的宽度,</p><p>流容器的响应式布局规则是随着窗口大小的变化一同变化,横向全部占满</p><p><strong>固定容器的阈值如下图:</strong></p><img src="JQuery/20210731153222.png" alt="image-20210731153222356" style="zoom:50%;" /><h2 id="栅格系统">栅格系统</h2><p>Bootstrap 提供了一套响应式、移动设备优先的流式网格系统，随着屏幕或视口（viewport）尺寸的增加，系统会自动分为最多 12 列。我们也可以根据自己的需要定义列数.</p><h3 id="网格类">网格类</h3><p>Bootstrap 4 网格系统有以下 5 个类:</p><p>==.col-== 针对所有设备</p><p>==.col-sm-== 平板 - 屏幕宽度等于或大于 576px</p><p>==.col-md-== 桌面显示器 - 屏幕宽度等于或大于 768px)</p><p>==.col-lg-== 大桌面显示器 - 屏幕宽度等于或大于 992px)</p><p>==.col-xl-== 超大桌面显示器 - 屏幕宽度等于或大于 1200px)</p><h3 id="网格系统规则">网格系统规则</h3><p>1 网格每一行需要放在设置了 .container (固定宽度) 或 .container-fluid (全屏宽度) 类的容器中，这样就可以自动设置一些外边距与内边距。</p><p>2 使用行来创建水平的列组class=row。</p><p>3 内容需要放置在列中，并且只有列可以是行的直接子节点。</p><p>4 预定义的类如 .row 和 .col-sm-4 可用于快速制作网格布局。</p><p>5 列通过填充创建列内容之间的间隙。 这个间隙是通过 .rows 类上的负边距设置第一行和最后一列的偏移。</p><p>6 网格列是通过跨越指定的 12 个列来创建。 例如，设置三个相等的列，需要使用三个.col-sm-4 来设置。</p><p>7  Bootstrap 3 和 Bootstrap 4 最大的区别在于 Bootstrap 4 现在使用 flexbox（弹性盒子） 而不是浮动。 Flexbox 的一大优势是，没有指定宽度的网格列将自动设置为等宽与等高列 。 如果您想了解有关Flexbox的更多信息，可以阅读我们的CSS Flexbox教程。</p><p><img src="JQuery/20210731153418.png" alt="image-20210731153418460"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--移动端优先的配置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--bootstrap的样式库--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/bootstrap.min.css&quot;</span> &gt;</span></span><br><span class="line">        <span class="comment">&lt;!--jQuery--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery-3.5.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--popper--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/bootstrap.bundle.min.js&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--核心js文件--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/bootstrap.min.js&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-sm-2&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: lavender;border:1px solid #117A8B;&quot;</span>&gt;</span></span><br><span class="line">                    One of three columns</span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-sm-8&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: lavender;border:1px solid #117A8B;&quot;</span>&gt;</span></span><br><span class="line">                    One of three columns</span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-sm-2&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: lavender;border:1px solid #117A8B;&quot;</span>&gt;</span></span><br><span class="line">                    One of three columns</span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-sm-1&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: lavender;border:1px solid #117A8B;&quot;</span>&gt;</span></span><br><span class="line">                    One of three columns</span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-sm-4&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: lavender;border:1px solid #117A8B;&quot;</span>&gt;</span></span><br><span class="line">                    One of three columns</span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-sm-7&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: lavender;border:1px solid #117A8B;&quot;</span>&gt;</span></span><br><span class="line">                    One of three columns</span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="导航栏案例">导航栏案例</h2><p><img src="JQuery/20210731153456.png" alt="image-20210731153456278"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--移动端优先的配置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--bootstrap的样式库--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/bootstrap.min.css&quot;</span> &gt;</span></span><br><span class="line">        <span class="comment">&lt;!--jQuery--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery-3.5.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--popper--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/bootstrap.bundle.min.js&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--核心js文件--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/bootstrap.min.js&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h2</span>&gt;</span>欢迎进入马士兵教育<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Nav pills --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;nav nav-pills&quot;</span> <span class="attr">role</span>=<span class="string">&quot;tablist&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;nav-link active&quot;</span> <span class="attr">data-toggle</span>=<span class="string">&quot;pill&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#home&quot;</span>&gt;</span>主页<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span> <span class="attr">data-toggle</span>=<span class="string">&quot;pill&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#menu1&quot;</span>&gt;</span>讲师介绍<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span> <span class="attr">data-toggle</span>=<span class="string">&quot;pill&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#menu2&quot;</span>&gt;</span>课程介绍<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span> <span class="attr">data-toggle</span>=<span class="string">&quot;pill&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#menu3&quot;</span>&gt;</span>优秀学员<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- Tab panes --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;tab-content&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;home&quot;</span> <span class="attr">class</span>=<span class="string">&quot;container tab-pane active&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border: 10px solid red;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>我们公司<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;menu1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;container tab-pane fade&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border: 10px solid green;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>我们的优秀讲师<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;menu2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;container tab-pane fade&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border: 10px solid yellow;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>我们的课程<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;menu3&quot;</span> <span class="attr">class</span>=<span class="string">&quot;container tab-pane fade&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border: 10px solid blueviolet;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>优秀学员<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="轮播图案例">轮播图案例</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--移动端优先的配置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--bootstrap的样式库--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/bootstrap.min.css&quot;</span> &gt;</span></span><br><span class="line">        <span class="comment">&lt;!--jQuery--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery-3.5.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--popper--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/bootstrap.bundle.min.js&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--核心js文件--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/bootstrap.min.js&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;carouselExampleCaptions&quot;</span> <span class="attr">class</span>=<span class="string">&quot;carousel slide&quot;</span> <span class="attr">data-ride</span>=<span class="string">&quot;carousel&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ol</span> <span class="attr">class</span>=<span class="string">&quot;carousel-indicators&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">data-target</span>=<span class="string">&quot;#carouselExampleCaptions&quot;</span> <span class="attr">data-slide-to</span>=<span class="string">&quot;0&quot;</span> <span class="attr">class</span>=<span class="string">&quot;active&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">data-target</span>=<span class="string">&quot;#carouselExampleCaptions&quot;</span> <span class="attr">data-slide-to</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">data-target</span>=<span class="string">&quot;#carouselExampleCaptions&quot;</span> <span class="attr">data-slide-to</span>=<span class="string">&quot;2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">data-target</span>=<span class="string">&quot;#carouselExampleCaptions&quot;</span> <span class="attr">data-slide-to</span>=<span class="string">&quot;3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;carousel-inner&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;carousel-item active&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://static.runoob.com/images/mix/img_fjords_wide.jpg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;d-block w-100&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;...&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;carousel-caption d-none d-md-block&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">h5</span>&gt;</span>江河<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Nulla vitae elit libero, a pharetra augue mollis interdum.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;carousel-item&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://static.runoob.com/images/mix/img_nature_wide.jpg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;d-block w-100&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;...&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;carousel-caption d-none d-md-block&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">h5</span>&gt;</span>山川<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Lorem ipsum dolor sit amet, consectetur adipiscing elit.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;carousel-item&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://static.runoob.com/images/mix/img_mountains_wide.jpg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;d-block w-100&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;...&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;carousel-caption d-none d-md-block&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">h5</span>&gt;</span>公路<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Praesent commodo cursus magna, vel scelerisque nisl consectetur.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;carousel-item&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://www.12306.cn/index/images/pic/banner0619.jpg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;d-block w-100&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;...&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;carousel-caption d-none d-md-block&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">h5</span>&gt;</span>火车<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Praesent commodo cursus magna, vel scelerisque nisl consectetur.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;carousel-control-prev&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#carouselExampleCaptions&quot;</span> <span class="attr">role</span>=<span class="string">&quot;button&quot;</span> <span class="attr">data-slide</span>=<span class="string">&quot;prev&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;carousel-control-prev-icon&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;sr-only&quot;</span>&gt;</span>Previous<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;carousel-control-next&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#carouselExampleCaptions&quot;</span> <span class="attr">role</span>=<span class="string">&quot;button&quot;</span> <span class="attr">data-slide</span>=<span class="string">&quot;next&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;carousel-control-next-icon&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;sr-only&quot;</span>&gt;</span>Next<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JQuery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS</title>
      <link href="/2021/06/16/JS/"/>
      <url>/2021/06/16/JS/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=0ca04fac-16df-f51c-3734-0912325b98df</cover>
      <date>Wed Jun 16 2021 09:56:56 GMT+0800</date>
      
        <content type="html"><![CDATA[<h2 id="概念">概念</h2><p>JS是运行在浏览器上的一种脚本语言</p><span id="more"></span><h3 id="特点">特点</h3><h4 id="1-脚本语言">1.脚本语言</h4><p>脚本语言是一种简单的程序，规模小,不需要编译,运行快,是由一些ASCII字符构成，可以使用任何一种文本编辑器编写。脚本语言是指在web浏览器内有解释器解释执行的编程语言，每次运行程序的时候，解释器会把程序代码翻译成可执行的格式。一些程序语言（如C、C++、Java等）都必须经过编译，将源代码编译成二进制的可执行文件之后才能运行，而脚本语言不需要事先编译，只要有一个与其相适应的解释器就可以执行。</p><h4 id="2-基于对象的语言">2.基于对象的语言</h4><p>面向对象有三大特点（封装，继承，多态）缺一不可。通常&quot;基于对象&quot;是使用对象，但是无法利用现有的对象模板产生新的对象类型，也就是说&quot;基于对象&quot;没有继承的特点。没有了继承的概念也就无从谈论&quot;多态&quot;</p><h4 id="3-事件驱动">3.事件驱动</h4><p>在网页中执行了某种操作的动作，被称为&quot;事件&quot;(Event)，比如按下鼠标、移动窗口、选择菜单等都可以视为事件。当事件发生后，可能会引起相应的事件响应。</p><h4 id="4-简单性">4.简单性</h4><p>变量类型是采用弱类型，并未使用严格的数据类型。var a,b,c;  a=123;  b=“abc”; a=b;</p><h4 id="5-安全性">5.安全性</h4><p>JavaScript不能访问本地的硬盘，不能将数据存入到服务器上，不能对网络文档进行修改和删除，只能通过浏览器实现信息浏览或动态交互</p><h4 id="6-跨平台性">6.跨平台性</h4><p>JavaScript依赖于浏览器本身，与操作平台无关， 只要计算机安装了支持JavaScript的浏览器（装有JavaScript解释器），JavaScript程序就可以正确执行。</p><h4 id="缺点">缺点</h4><p>各种浏览器支持JavaScript的程度是不一样的，支持和不完全支持JavaScript的 浏览器在浏览同一个带有JavaScript脚本的网页时，效果会有一定的差距，有时甚至会显示不出来。</p><h3 id="JS-和-java的区别">JS 和 java的区别</h3><h4 id="区别1：公司不同，前身不同">区别1：公司不同，前身不同</h4><p>JavaScript是Netscape公司的产品，是为了扩展Netscape Navigator功能而开发的一种可以嵌入Web页面中的基于对象和事件驱动的解释性语言，它的前身是Live Script；Java是SUN公司推出的新一代面向对象的程序设计语言，特别适合于Internet应用程序开发； Java的前身是Oak语言。</p><h4 id="区别2：基于对象和面向对象">区别2：基于对象和面向对象</h4><p>JavaScript是脚本语言，是一种基于对象的语言。本身提供了非常丰富的内部对象供设计人员使用，但不支持继承和多态。Java是面向对象的，是一种真正的面向对象的语言，支持封装、继承和多态。</p><h4 id="区别3：变量类型强弱不同">区别3：变量类型强弱不同</h4><p>Java采用强类型变量检查，即所有变量在编译之前必须声明为某一指定类型。如: int  x=1234;JavaScript中是弱类型变量。统一采用var声明，可赋各种数据类型值。</p><h4 id="区别4-运行的位置不同">区别4: 运行的位置不同</h4><p>Java运行与服务器端的,大型编程语言, JS运行于客户端(浏览器)一种小规模脚本语言</p><h4 id="HTML和CSS和JS这之间的关系">HTML和CSS和JS这之间的关系</h4><p>HTML和CSS和JS都是前端的主要技术,三者各有分工.HTML可以用于制作网页的主体结构,CSS用于给网页做美化,JS用于在网页上添加动态效果</p><h2 id="引入方式">引入方式</h2><h3 id="1-内嵌式引入">1.内嵌式引入</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--内嵌式引入方式</span></span><br><span class="line"><span class="comment">1在head标签中，用一堆script标签嵌入JS</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">/*定义一个函数（方法）*/</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">/*弹窗提示一点信息*/</span></span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">alert</span>(<span class="string">&quot;你好&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;点我呀 &quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun1()&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>效果</p><img src="C:/Users/Dell/AppData/Roaming/Typora/typora-user-images/image-20210719102431728.png" alt="image-20210719102431728" style="zoom: 33%;" /><h3 id="2-链接式引入">2.链接式引入</h3><p>将JS代码放入外部JS文件中,通过script标签引入，提高代码复用度，降低了代码维护的难度<br>1 一个页面可以同时引入多个不同的JS文件<br>2 script标签一点用于引入外部JS文件，就不能在中间定义内嵌式代码<br>3 一个页面上可以用多个script标签 位置也不是非得放到head标签中</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--链接式 引入外部JS文件</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;js/myjs.js&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;点我呀&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun1()&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-URL网络路径">3.URL网络路径</h3><p>略</p><h2 id="数据类型和运算符">数据类型和运算符</h2><p>JS是弱类型的脚本语言，不明显，所有的变量对象数据类型的声明都是用var</p><h3 id="变量的声明和赋值">变量的声明和赋值</h3><p>变量声明时不用确定具体的数据类型，在变量赋值时，确定变量的具体数据类型。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i;</span><br><span class="line">i = <span class="number">10</span>;</span><br></pre></td></tr></table></figure><h3 id="1-数据类型">1. 数据类型</h3><ol><li><p>数值型：</p><p>number<strong>整数和浮点数</strong>统称为数值。例如85或3.1415926等。</p></li><li><p>字符串型：</p><p>String由0个,1个或多个字符组成的序列。在JavaScript中，用<strong>双引号或单引号</strong>括起来表示，如&quot;您好&quot;、‘学习JavaScript’ 等。</p></li><li><p>逻辑（布尔）型：</p><p>boolean用<strong>true或false</strong>来表示。</p></li><li><p>空（null）值：</p><p>表示没有值，用于定义空的或不存在的引用。要注意，空值不等同于空字符串&quot;&quot;或0。</p></li><li><p>未定义（undefined）值：</p><p>它也是一个保留字。表示变量虽然已经声明，但却没有赋值。</p></li><li><p>除了以上五种基本的数据类型之外，JavaScript还支持复合数据类型Object，复合数据类型包括<strong>对象和数组</strong>两种。</p></li></ol><p>JS中的变量可以反复声明，后声明的变量会覆盖原来的变量</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">var</span> i = <span class="number">20</span>;</span><br><span class="line"><span class="title function_">alert</span>(i)</span><br></pre></td></tr></table></figure><p>typeof 查看变量类型</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i = <span class="number">20</span>;</span><br><span class="line"><span class="title function_">alert</span>(<span class="keyword">typeof</span> i);</span><br></pre></td></tr></table></figure><p>当给一个变量赋值为null时，变量的类型就是object</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i ;<span class="comment">/*默认为null*/</span></span><br><span class="line"><span class="keyword">var</span> i = <span class="literal">null</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="keyword">typeof</span> i);<span class="comment">/*Object*/</span></span><br></pre></td></tr></table></figure><p>JS标识符的命名规则与java保持一致即可，不要用$，避免与JQuery冲突</p><h3 id="2-运算符">2.运算符</h3><div align="center" style ="zoom:67%;">    <img src = "C:/Users/Dell/AppData/Roaming/Typora/typora-user-images/image-20210719162049253.png" /></div><h4 id="和">/ 和 %</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">* 能除尽,则默认结果就是一个整数,不能除尽,结果默认就是浮点数</span></span><br><span class="line"><span class="comment">* 除零不会出现异常,而是出现 Infinity</span></span><br><span class="line"><span class="comment">* 和0取余数,出现NaN   not a number 不是一个数字</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line">    <span class="title function_">alert</span>(<span class="number">10</span>/<span class="number">3</span>);</span><br><span class="line">    <span class="title function_">alert</span>(<span class="number">10</span>/<span class="number">0</span>);</span><br><span class="line">    <span class="title function_">alert</span>(<span class="number">10</span>%<span class="number">3</span>);</span><br><span class="line">    <span class="title function_">alert</span>(<span class="number">10</span>%<span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>JS取余数运算对于浮点数仍然有效,如果和0取余数,结果是NaN(not a number)</p><h4 id="">+</h4><p>同时也是连接运算符,看两端的变量类型,如果都是number那么就是算数中的加法 如果有字符串,那么就是连接符号,如果是布尔类型和number相加,那么会将true转化为1 将false 转化为0</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* +号中 如果一段是字符串,就变成了文字拼接</span></span><br><span class="line"><span class="comment">* 数字和 boolean类型相加  true会转变成1  false会转变成0  再做数学运算</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line">    <span class="keyword">var</span> i=<span class="number">1</span>;</span><br><span class="line">    <span class="title function_">alert</span>(i+<span class="number">1</span>);</span><br><span class="line">    <span class="title function_">alert</span>(<span class="number">1</span>+<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    <span class="title function_">alert</span>(<span class="number">1</span>+<span class="literal">true</span>);</span><br></pre></td></tr></table></figure><h4 id="等值符">== (等值符)</h4><p>先比较类型,如果类型一致,再比较内容,如果类型不一致,会强制转换为number再比较内容</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* == 等值符</span></span><br><span class="line"><span class="comment">* 先比较类型,如果类型一致,则比较值是否相同</span></span><br><span class="line"><span class="comment">* 如果类型不一致,会将数据尝试转换number 再比较内容</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line">    <span class="keyword">var</span> a =<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> b=<span class="string">&quot;1&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> c=<span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">var</span> d=<span class="string">&quot;true&quot;</span>;</span><br><span class="line">    <span class="title function_">alert</span>(a==b)<span class="comment">// t</span></span><br><span class="line">    <span class="title function_">alert</span>(a==c)<span class="comment">// t</span></span><br><span class="line">    <span class="title function_">alert</span>(a==d)<span class="comment">// f</span></span><br><span class="line">    <span class="title function_">alert</span>(b==c)<span class="comment">// t</span></span><br><span class="line">    <span class="title function_">alert</span>(b==d)<span class="comment">// f</span></span><br><span class="line">    <span class="title function_">alert</span>(c==d)<span class="comment">// f</span></span><br></pre></td></tr></table></figure><h4 id="等同符">===( 等同符)</h4><p>数据类型不同 直接返回false如果类型相同 才会比较内容</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* === 等同符</span></span><br><span class="line"><span class="comment">* 如果数据类型不同,直接返回false  如果类型相同,才会继续比较内容</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line">    <span class="keyword">var</span> a =<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> b=<span class="string">&quot;1&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> c=<span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">var</span> d=<span class="string">&quot;true&quot;</span>;</span><br><span class="line">    <span class="title function_">alert</span>(a===b)<span class="comment">//f</span></span><br><span class="line">    <span class="title function_">alert</span>(a===c)<span class="comment">//f</span></span><br><span class="line">    <span class="title function_">alert</span>(a===d)<span class="comment">//f</span></span><br><span class="line">    <span class="title function_">alert</span>(b===c)<span class="comment">//f</span></span><br><span class="line">    <span class="title function_">alert</span>(b===d)<span class="comment">//f</span></span><br><span class="line">    <span class="title function_">alert</span>(c===d)<span class="comment">//f</span></span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;asdf&quot;</span>===<span class="string">&quot;asdf&quot;</span>)<span class="comment">//t</span></span><br></pre></td></tr></table></figure><h2 id="流程控制">流程控制</h2><h3 id="分支结构">分支结构</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        <span class="comment">/*</span></span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"><span class="language-xml">                         * 定义变量表示月份</span></span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"><span class="language-xml">                         * 根据月份输出该月的季节和应季活动</span></span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"><span class="language-xml">                         * */</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        <span class="keyword">var</span> i=<span class="number">10</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        <span class="keyword">if</span>(i ==<span class="number">12</span> || i ==<span class="number">1</span> || i==<span class="number">2</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="title function_">alert</span>(<span class="string">&quot;大约在冬季: 冬天吃火锅&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i &gt;= <span class="number">3</span> &amp;&amp; i&lt;=<span class="number">5</span> )&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="title function_">alert</span>(<span class="string">&quot;春天来了: 春天吃青菜&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i &gt;= <span class="number">6</span> &amp;&amp; i &lt;= <span class="number">8</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="title function_">alert</span>(<span class="string">&quot;夏天到了: 吃烧烤喝啤酒&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i &gt;= <span class="number">9</span> &amp;&amp; i &lt;=<span class="number">11</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="title function_">alert</span>(<span class="string">&quot;秋天到了: 贴秋膘&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        &#125;<span class="keyword">else</span>&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="title function_">alert</span>(<span class="string">&quot;月份有误&quot;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        <span class="keyword">switch</span>(i)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="keyword">case</span> <span class="number">3</span>:</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="keyword">case</span> <span class="number">4</span>:</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="keyword">case</span> <span class="number">5</span>:</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                        <span class="title function_">alert</span>(<span class="string">&quot;春眠不觉晓&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                        <span class="keyword">break</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="keyword">case</span> <span class="number">6</span>:</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="keyword">case</span> <span class="number">7</span>:</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="keyword">case</span> <span class="number">8</span>:</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                        <span class="title function_">alert</span>(<span class="string">&quot;夏天蚊子咬&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                        <span class="keyword">break</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="keyword">case</span> <span class="number">9</span>:</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="keyword">case</span> <span class="number">10</span>:</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="keyword">case</span> <span class="number">11</span>:</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                        <span class="title function_">alert</span>(<span class="string">&quot;秋天一身包&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                        <span class="keyword">break</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="keyword">case</span> <span class="number">1</span>:</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="keyword">case</span> <span class="number">2</span>:</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="keyword">case</span> <span class="number">12</span>:</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                        <span class="title function_">alert</span>(<span class="string">&quot;冬天蚊子死翘翘&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                        <span class="keyword">break</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                <span class="attr">default</span>:</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                                        <span class="title function_">alert</span>(<span class="string">&quot;月份有误&quot;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="循环结构">循环结构</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i=<span class="number">1</span>;</span><br><span class="line">      <span class="keyword">while</span>(i&lt;=<span class="number">10</span>)&#123;</span><br><span class="line">              <span class="title function_">alert</span>(i)</span><br><span class="line">              i++;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">       * 考试,直到分数过线为止</span></span><br><span class="line"><span class="comment">       * 求1-10整数和 1+10*(10/2) */</span></span><br><span class="line">      <span class="keyword">var</span> sum=<span class="number">0</span>;</span><br><span class="line">      <span class="keyword">var</span> j=<span class="number">1</span>;</span><br><span class="line">      <span class="keyword">do</span>&#123;</span><br><span class="line">              sum+=j;</span><br><span class="line">              j++;</span><br><span class="line">      &#125;<span class="keyword">while</span>(j&lt;=<span class="number">10</span>);</span><br><span class="line">      <span class="title function_">alert</span>(sum)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> sum2=<span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> z=<span class="number">1</span>;z&lt;=<span class="number">10</span>;z++)&#123;</span><br><span class="line">              sum2+=z;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">alert</span>(sum2)</span><br></pre></td></tr></table></figure><p>九九乘法表</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i =<span class="number">1</span>;i&lt;=<span class="number">9</span>;i++)&#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">1</span>;j&lt;=i;j++)&#123;</span><br><span class="line">          <span class="variable language_">document</span>.<span class="title function_">write</span>(j+<span class="string">&quot;*&quot;</span>+i+<span class="string">&quot;=&quot;</span>+i*j+<span class="string">&quot;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;br/&gt;&quot;</span>)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>效果</p><img src="JS/20210719173226.png" alt="image-20210719173226037" style="zoom:50%;" /><h2 id="函数">函数</h2><p>​类似于java中的方法,JS中也可以定义一些函数,java中的方法签名包含访问修饰符,返回值类型,方法名,参数列表,异常列表,但是JS中定义函数的语法相对简单很多,主要以function作为函数关键字,具备函数名和参数列表,但是没有访问修饰符也没有返回值类型关键字和异常列表。</p><h3 id="三种语法">三种语法</h3><ol><li><p>function 函数名(参数列表){js代码}</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span><br><span class="line">       <span class="title function_">alert</span>(<span class="string">&quot;你好&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>var 函数名=function(参数列表){JS代码}</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fun2=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">       <span class="title function_">alert</span>(<span class="string">&quot;你很好&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>var 函数名=new Function(‘js代码’)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fun3=<span class="keyword">new</span> <span class="title class_">Function</span>(<span class="string">&#x27;alert(&quot;你非常好&quot;);&#x27;</span>);</span><br></pre></td></tr></table></figure></li></ol><p>调用方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调用方法</span></span><br><span class="line"><span class="title function_">fun1</span>();</span><br><span class="line"><span class="title function_">fun2</span>();</span><br><span class="line"><span class="title function_">fun3</span>();</span><br></pre></td></tr></table></figure><h3 id="函数参数和返回值">函数参数和返回值</h3><p>1.传入的实参可以和形参个数不同</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params">a,b,c</span>)&#123;</span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;a:&quot;</span>+a)</span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;b:&quot;</span>+b)</span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;c:&quot;</span>+c)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fun1</span>(<span class="number">10</span>,<span class="string">&quot;hello js&quot;</span>,<span class="literal">false</span>);</span><br><span class="line"><span class="comment">// 少传参数 OK</span></span><br><span class="line"><span class="title function_">fun1</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line"><span class="comment">// 多传参数 OK 多出来的参数相当于没传</span></span><br><span class="line"><span class="title function_">fun1</span>(<span class="number">10</span>,<span class="string">&quot;hello js&quot;</span>,<span class="literal">false</span>,<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2.函数如果有返回值，直接return即可</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params">a,b</span>)&#123;</span><br><span class="line">                <span class="keyword">var</span> c=a*b;</span><br><span class="line">                <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> x =<span class="title function_">fun2</span>(<span class="number">10</span>,<span class="number">20</span>);</span><br><span class="line"><span class="title function_">alert</span>(x)</span><br></pre></td></tr></table></figure><p>3.可以将方法作为参数传进去</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法本身作为参数(了解)</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">funa</span>(<span class="params"> i ,j</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> i+j;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">funb</span>(<span class="params">a</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_">a</span>(<span class="number">10</span>,<span class="number">20</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> sum =<span class="title function_">funb</span>(funa)</span><br><span class="line"><span class="title function_">alert</span>(sum)</span><br></pre></td></tr></table></figure><h2 id="数组">数组</h2><h3 id="1-创建数组">1. 创建数组</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*第一种——创建空数组*/</span></span><br><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line">arr[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr);</span><br><span class="line"><span class="comment">/*第二种——创建定长数组*/</span></span><br><span class="line"><span class="keyword">var</span> arr2= <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">5</span>);</span><br><span class="line">arr2[<span class="number">0</span>]=<span class="string">&quot;x&quot;</span>;</span><br><span class="line">arr2[<span class="number">4</span>]=<span class="literal">true</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr2);</span><br><span class="line"><span class="comment">/*第三种——创建时直接指定元素值*/</span></span><br><span class="line"><span class="keyword">var</span> arr3=<span class="keyword">new</span> <span class="title class_">Array</span>(<span class="string">&#x27;aaa&#x27;</span>,<span class="number">10</span>,<span class="number">20.3</span>,<span class="literal">true</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr3)</span><br><span class="line"><span class="comment">/*第四种——相当于第三种语法的简写*/</span></span><br><span class="line"><span class="keyword">var</span> arr3=[<span class="string">&#x27;aaa&#x27;</span>,<span class="number">10</span>,<span class="number">20.3</span>,<span class="literal">true</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr3)</span><br></pre></td></tr></table></figure><h3 id="2-数组元素和长度">2. 数组元素和长度</h3><ul><li>可以通过修改length属性来改变数组长度</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr=[<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>];</span><br><span class="line">arr.<span class="property">length</span>=<span class="number">5</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr)</span><br></pre></td></tr></table></figure><p><img src="JS/20210719202759.png" alt="image-20210719202759057"></p><ul><li>可以通过索引改变数组长度</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arr[<span class="number">9</span>]=<span class="number">99</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr);</span><br></pre></td></tr></table></figure><p><img src="JS/20210719203014.png" alt="image-20210719203014658"></p><h3 id="3-数组遍历">3. 数组遍历</h3><ul><li>普通for循环</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;arr.<span class="property">length</span>;i++)&#123;</span><br><span class="line">                                <span class="variable language_">console</span>.<span class="title function_">log</span>(arr[i])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>foreach循环遍历数组</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* JS 中foreach写法为  for( var i in 数组)</span></span><br><span class="line"><span class="comment">* i 不是元素  是索引</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> arr)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(arr[i])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-数组常用方法">4.数组常用方法</h3><ul><li><p>查询元素索引</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">  </span><br></pre></td></tr></table></figure></li><li><p>concat()</p><p>合并两个数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr2 = [<span class="number">3</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">7</span>];</span><br><span class="line"><span class="keyword">var</span> arr3 = [<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>];</span><br><span class="line"><span class="keyword">var</span> arr4 = arr2.<span class="title function_">concat</span>(arr3);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr4);</span><br></pre></td></tr></table></figure><img src="JS/20210720090920.png" alt="image-20210720090919483" style="zoom:50%;" /><p>合并三个数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr5 = [<span class="number">3</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">7</span>];</span><br><span class="line"><span class="keyword">var</span> arr6 = [<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>];</span><br><span class="line"><span class="keyword">var</span> arr7 = [<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>];</span><br><span class="line"><span class="keyword">var</span> arr8 = arr5.<span class="title function_">concat</span>(arr6,arr7);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr8);</span><br></pre></td></tr></table></figure><img src="JS/20210720091128.png" alt="image-20210720091128798" style="zoom:50%;" /></li><li><p>join():合并字符串</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fruits=[<span class="string">&#x27;Banana&#x27;</span>,<span class="string">&#x27;Orange&#x27;</span>,<span class="string">&#x27;Apple&#x27;</span>,<span class="string">&#x27;Mango&#x27;</span>]</span><br><span class="line"><span class="keyword">var</span> fs = fruits.<span class="title function_">join</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fs);</span><br></pre></td></tr></table></figure><p><img src="JS/20210720091607.png" alt="image-20210720091607132"></p></li><li><p>pop():移除最后一个元素</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fruit = fruits.<span class="title function_">pop</span>();</span><br></pre></td></tr></table></figure><img src="JS/20210720091849.png" alt="image-20210720091849872" style="zoom:50%;" /></li><li><p>push():想结尾增加元素</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fruits.<span class="title function_">push</span>(<span class="string">&quot;Grape&quot;</span>);</span><br></pre></td></tr></table></figure><img src="JS/20210720092116.png" alt="image-20210720092116089" style="zoom:50%;" /></li><li><p>reverse():反转数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fruits.<span class="title function_">reverse</span>();</span><br></pre></td></tr></table></figure><img src="JS/20210720092352.png" alt="image-20210720092352074" style="zoom:50%;" /></li><li><p>shift():删除数组第一个元素</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ss = fruits.<span class="title function_">shift</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fruits);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(ss);</span><br></pre></td></tr></table></figure><img src="JS/20210720092610.png" alt="image-20210720092610092" style="zoom:50%;" /></li><li><p>unshift():向第一个位置添加元素</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fruits.<span class="title function_">unshift</span>(<span class="string">&quot;火龙果&quot;</span>);</span><br></pre></td></tr></table></figure><img src="JS/20210720092807.png" style="zoom:50%;" /></li><li><p>slice():截取子数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> citrus =fruits.<span class="title function_">slice</span>(<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(citrus)</span><br></pre></td></tr></table></figure><img src="JS/20210720093003.png" alt="image-20210720093003811" style="zoom:50%;" /></li><li><p>splice()</p><p>删除数组中的某些元素 （传入索引和删除元素的个数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>];</span><br><span class="line">num.<span class="title function_">splice</span>(<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num);</span><br></pre></td></tr></table></figure><img src="JS/20210720093244.png" alt="image-20210720093244580" style="zoom:50%;" /><p>如果第二个参数为0，则变为在指定索引位置增加元素</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num.<span class="title function_">splice</span>(<span class="number">2</span>,<span class="number">0</span>,<span class="number">100</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num);</span><br></pre></td></tr></table></figure><img src="JS/20210720094411.png" alt="image-20210720094411730" style="zoom:50%;" /></li><li><p>sort(): 排序</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//按照字母升序排列</span></span><br><span class="line"><span class="keyword">var</span> fruits = [<span class="string">&quot;Banana&quot;</span>, <span class="string">&quot;Orange&quot;</span>, <span class="string">&quot;Apple&quot;</span>, <span class="string">&quot;Mango&quot;</span>];</span><br><span class="line">fruits.<span class="title function_">sort</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fruits)</span><br><span class="line"><span class="comment">//数字的排序：</span></span><br><span class="line"><span class="keyword">var</span> numbers=[<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>];</span><br><span class="line"><span class="comment">//a-b 升序 b-a 降序</span></span><br><span class="line">numbers.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params">a,b</span>)&#123;<span class="keyword">return</span> b-a&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(numbers)</span><br></pre></td></tr></table></figure></li></ul><h2 id="JS对象">JS对象</h2><p>JavaS0cript 中的所有事物都是对象：字符串、数值、数组、函数…   此外，JavaScript 允许自定义对象</p><p>JS基于对象的脚本语言 ,有类和对象,但是没有封装,继承,多态,Java script 中有一些浏览器直接识别并使用的对象,常见的对象有Array（前面的数组也是一个对象）,String对象,Math对象,Number对象,Date对象等等.</p><h3 id="常用对象">常用对象</h3><h4 id="String">String</h4><h5 id="属性">属性</h5><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/jsref/jsref-constructor-string.html">constructor</a></td><td>对创建该对象的函数的引用</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-length-string.html">length</a></td><td>字符串的长度</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-prototype-string.html">prototype</a></td><td>允许您向对象添加属性和方法</td></tr></tbody></table><h5 id="方法">方法</h5><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/jsref/jsref-charat.html">charAt()</a></td><td>返回在指定位置的字符。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-charcodeat.html">charCodeAt()</a></td><td>返回在指定的位置的字符的 Unicode 编码。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-concat-string.html">concat()</a></td><td>连接两个或更多字符串，并返回新的字符串。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-fromcharcode.html">fromCharCode()</a></td><td>将 Unicode 编码转为字符。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-indexof.html">indexOf()</a></td><td>返回某个指定的字符串值在字符串中首次出现的位置。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-string-includes.html">includes()</a></td><td>查找字符串中是否包含指定的子字符串。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-lastindexof.html">lastIndexOf()</a></td><td>从后向前搜索字符串，并从起始位置（0）开始计算返回字符串最后出现的位置。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-match.html">match()</a></td><td>查找找到一个或多个正则表达式的匹配。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-repeat.html"> repeat()</a></td><td>复制字符串指定次数，并将它们连接在一起返回。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-replace.html">replace()</a></td><td>在字符串中查找匹配的子串，并替换与正则表达式匹配的子串。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-replaceall.html">replaceAll()</a></td><td>在字符串中查找匹配的子串，并替换与正则表达式匹配的所有子串。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-search.html">search()</a></td><td>查找与正则表达式相匹配的值。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-slice-string.html">slice()</a></td><td>提取字符串的片断，并在新的字符串中返回被提取的部分。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-split.html">split()</a></td><td>把字符串分割为字符串数组。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-startswith.html">startsWith()</a></td><td>查看字符串是否以指定的子字符串开头。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-substr.html">substr()</a></td><td>从起始索引号提取字符串中指定数目的字符。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-substring.html">substring()</a></td><td>提取字符串中两个指定的索引号之间的字符。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-tolowercase.html">toLowerCase()</a></td><td>把字符串转换为小写。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-touppercase.html">toUpperCase()</a></td><td>把字符串转换为大写。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-trim.html">trim()</a></td><td>去除字符串两边的空白</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-tolocalelowercase.html"> toLocaleLowerCase()</a></td><td>根据本地主机的语言环境把字符串转换为小写。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-tolocaleuppercase.html"> toLocaleUpperCase()</a></td><td>根据本地主机的语言环境把字符串转换为大写。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-valueof-string.html">valueOf()</a></td><td>返回某个字符串对象的原始值。</td></tr><tr><td><a href="https://www.runoob.com/jsref/jsref-tostring.html"> toString()</a></td><td>返回一个字符串。</td></tr></tbody></table><ul><li><p>charAt()根据索引获取字符</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str =<span class="string">&quot;hello js&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> c =str.<span class="title function_">charAt</span>(<span class="number">6</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(c);</span><br></pre></td></tr></table></figure><p><img src="JS/20210724163037.png" alt="image-20210724163032497"></p></li><li><p>concat()：拼接字符串</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">&quot;hi&quot;</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="string">&quot;good&quot;</span></span><br><span class="line"><span class="keyword">var</span> c = <span class="string">&quot;China&quot;</span></span><br><span class="line"><span class="keyword">var</span> d = c.<span class="title function_">concat</span>(a,b)</span><br></pre></td></tr></table></figure><p><img src="JS/20210724163150.png" alt="image-20210724163146111"></p></li><li><p>repeat():重复</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> e = <span class="string">&#x27;absf&#x27;</span></span><br><span class="line"><span class="keyword">var</span> f = e.<span class="title function_">repeat</span>(<span class="number">3</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(f)</span><br></pre></td></tr></table></figure><p><img src="JS/20210724163235.png" alt="image-20210724163232328"></p></li><li><p>substr() substring():截取字符串</p><ul><li>从m开始截取n个字符</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> g = <span class="string">&quot;hello&quot;</span></span><br><span class="line"><span class="keyword">var</span> h = g.<span class="title function_">substr</span>(<span class="number">1</span>,<span class="number">5</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(h)</span><br></pre></td></tr></table></figure><ul><li>从m开始从n结束:包头不包尾</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i = g.<span class="title function_">substring</span>(<span class="number">1</span>,<span class="number">7</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br></pre></td></tr></table></figure><img src="JS/20210724165033.png" alt="image-20210724164332270" style="zoom: 67%;" /></li><li><p>length 属性：获取长度</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="property">length</span>)</span><br></pre></td></tr></table></figure><img src="JS/20210724165806.png" style="zoom: 67%;" /></li><li><p>可以将字符串内容解析成JS代码并运行</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> testStr=<span class="string">&quot;var x=10&quot;</span></span><br><span class="line"><span class="built_in">eval</span>(testStr)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x)</span><br></pre></td></tr></table></figure><img src="JS/20210724171327.png" alt="image-20210724171304740" style="zoom:67%;" /></li></ul><h4 id="Number">Number</h4><h5 id="属性-2">属性</h5><table><thead><tr><th style="text-align:center">属性</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-constructor-number.html">constructor</a></td><td style="text-align:center">返回对创建此对象的 Number 函数的引用。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-max-value.html">MAX_VALUE</a></td><td style="text-align:center">可表示的最大的数。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-min-value.html">MIN_VALUE</a></td><td style="text-align:center">可表示的最小的数。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-negative-infinity.html">NEGATIVE_INFINITY</a></td><td style="text-align:center">负无穷大，溢出时返回该值。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-number-nan.html">NaN</a></td><td style="text-align:center">非数字值。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-positive-infinity.html">POSITIVE_INFINITY</a></td><td style="text-align:center">正无穷大，溢出时返回该值。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-prototype-num.html">prototype</a></td><td style="text-align:center">允许您可以向对象添加属性和方法。</td></tr></tbody></table><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>.<span class="property">MAX_VALUE</span>)<span class="comment">//最大值</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>.<span class="property">MIN_VALUE</span>)<span class="comment">//最小值</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>.<span class="property">MAX_SAFE_INTEGER</span>)<span class="comment">//负无穷</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>.<span class="property">MIN_SAFE_INTEGER</span>)</span><br></pre></td></tr></table></figure><h5 id="方法-2">方法</h5><table><thead><tr><th style="text-align:center">方法</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-isfinite-number.html"> isFinite </a></td><td style="text-align:center">检测指定参数是否为无穷大。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-toexponential.html">toExponential(x)</a></td><td style="text-align:center">把对象的值转换为指数计数法。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-tofixed.html">toFixed(x)</a></td><td style="text-align:center">把数字转换为字符串，结果的小数点后有指定位数的数字。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-toprecision.html">toPrecision(x)</a></td><td style="text-align:center">把数字格式化为指定的长度。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-tostring-number.html">toString()</a></td><td style="text-align:center">把数字转换为字符串，使用指定的基数。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-valueof-number.html">valueOf()</a></td><td style="text-align:center">返回一个 Number 对象的基本数字值。</td></tr></tbody></table><ul><li><p>parseFloat():将字符串转换成浮点数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>.<span class="built_in">parseFloat</span>(<span class="string">&quot;10.123&quot;</span>)+<span class="number">20</span>);</span><br></pre></td></tr></table></figure><img src="C:\Users\Dell\AppData\Roaming\Typora\typora-user-images\image-20210724174135538.png" alt="image-20210724174135538" style="zoom:67%;" /></li><li><p>parseInt():将字符串转换成整型数字</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>.<span class="built_in">parseInt</span>(<span class="string">&quot;30&quot;</span>)+<span class="number">20</span>);</span><br></pre></td></tr></table></figure></li><li><p>相关判断方法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i = <span class="number">10</span>%<span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> j = <span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(j)</span><br><span class="line"><span class="comment">// is not a number 是不是NAN</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>.<span class="title function_">isNAN</span>(i))<span class="comment">//true</span></span><br><span class="line"><span class="comment">//isFinite()：判断数字是不是无限</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>.<span class="built_in">isFinite</span>(j))<span class="comment">//false</span></span><br><span class="line"><span class="comment">//isSafeInteger()：判断数字是不是一个安全的范围的方法</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>.<span class="title function_">isSafeInteger</span>(<span class="title class_">Number</span>.<span class="property">MAX_VALUE</span>))<span class="comment">//false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>.<span class="title function_">isSafeInteger</span>(<span class="title class_">Number</span>.<span class="property">MAX_SAFE_INTEGER</span>))<span class="comment">//false</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="Math">Math</h4><p>其他详情 <a href="https://www.runoob.com/jsref/jsref-obj-math.html">https://www.runoob.com/jsref/jsref-obj-math.html</a></p><ul><li><p>常用方法和属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="number">3.64</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">3.14</span>))<span class="comment">// 向上取整</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">ceil</span>(<span class="number">3.01</span>))<span class="comment">// 向下取整</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5.6</span>))<span class="comment">//最大值</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">min</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5.6</span>))<span class="comment">//最小值</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>())<span class="comment">//随机数</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">sqrt</span>(<span class="number">16</span>))<span class="comment">//开平方</span></span><br><span class="line"><span class="comment">// 属性PI</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="property">PI</span>)</span><br></pre></td></tr></table></figure></li><li><p>生成给定范围内的随机数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> start =<span class="number">10</span>;</span><br><span class="line"><span class="keyword">var</span> end =<span class="number">16</span>;</span><br><span class="line"><span class="keyword">var</span> result =<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*(end-start+<span class="number">1</span>)+start);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br></pre></td></tr></table></figure></li></ul><h4 id="Date">Date</h4><p>Date对象用于处理日期和时间</p><ul><li>创建Date对象的四种方法</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="title class_">Date</span>(milliseconds);</span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="title class_">Date</span>(dateString);</span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="title class_">Date</span>(year, month, day, hours, minutes, seconds, milliseconds);</span><br></pre></td></tr></table></figure><h5 id="属性-3">属性</h5><table><thead><tr><th style="text-align:center">属性</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-constructor-date.html">constructor</a></td><td style="text-align:center">返回对创建此对象的 Date 函数的引用。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-prototype-date.html">prototype</a></td><td style="text-align:center">使您有能力向对象添加属性和方法。</td></tr></tbody></table><h5 id="方法-3">方法</h5><table><thead><tr><th style="text-align:center">方法</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getdate.html">getDate()</a></td><td style="text-align:center">从 Date 对象返回一个月中的某一天 (1 ~ 31)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getday.html">getDay()</a></td><td style="text-align:center">从 Date 对象返回一周中的某一天 (0 ~ 6)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getfullyear.html">getFullYear()</a></td><td style="text-align:center">从 Date 对象以四位数字返回年份。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-gethours.html">getHours()</a></td><td style="text-align:center">返回 Date 对象的小时 (0 ~ 23)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getmilliseconds.html">getMilliseconds()</a></td><td style="text-align:center">返回 Date 对象的毫秒(0 ~ 999)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getminutes.html">getMinutes()</a></td><td style="text-align:center">返回 Date 对象的分钟 (0 ~ 59)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getmonth.html">getMonth()</a></td><td style="text-align:center">从 Date 对象返回月份 (0 ~ 11)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getseconds.html">getSeconds()</a></td><td style="text-align:center">返回 Date 对象的秒数 (0 ~ 59)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-gettime.html">getTime()</a></td><td style="text-align:center">返回 1970 年 1 月 1 日至今的毫秒数。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-gettimezoneoffset.html">getTimezoneOffset()</a></td><td style="text-align:center">返回本地时间与格林威治标准时间 (GMT) 的分钟差。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getutcdate.html">getUTCDate()</a></td><td style="text-align:center">根据世界时从 Date 对象返回月中的一天 (1 ~ 31)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getutcday.html">getUTCDay()</a></td><td style="text-align:center">根据世界时从 Date 对象返回周中的一天 (0 ~ 6)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getutcfullyear.html">getUTCFullYear()</a></td><td style="text-align:center">根据世界时从 Date 对象返回四位数的年份。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getutchours.html">getUTCHours()</a></td><td style="text-align:center">根据世界时返回 Date 对象的小时 (0 ~ 23)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getutcmilliseconds.html">getUTCMilliseconds()</a></td><td style="text-align:center">根据世界时返回 Date 对象的毫秒(0 ~ 999)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getutcminutes.html">getUTCMinutes()</a></td><td style="text-align:center">根据世界时返回 Date 对象的分钟 (0 ~ 59)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getutcmonth.html">getUTCMonth()</a></td><td style="text-align:center">根据世界时从 Date 对象返回月份 (0 ~ 11)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-getutcseconds.html">getUTCSeconds()</a></td><td style="text-align:center">根据世界时返回 Date 对象的秒钟 (0 ~ 59)。</td></tr><tr><td style="text-align:center">getYear()</td><td style="text-align:center">已废弃。 请使用 getFullYear() 方法代替。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-parse.html">parse()</a></td><td style="text-align:center">返回1970年1月1日午夜到指定日期（字符串）的毫秒数。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-setdate.html">setDate()</a></td><td style="text-align:center">设置 Date 对象中月的某一天 (1 ~ 31)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-setfullyear.html">setFullYear()</a></td><td style="text-align:center">设置 Date 对象中的年份（四位数字）。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-sethours.html">setHours()</a></td><td style="text-align:center">设置 Date 对象中的小时 (0 ~ 23)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-setmilliseconds.html">setMilliseconds()</a></td><td style="text-align:center">设置 Date 对象中的毫秒 (0 ~ 999)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-setminutes.html">setMinutes()</a></td><td style="text-align:center">设置 Date 对象中的分钟 (0 ~ 59)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-setmonth.html">setMonth()</a></td><td style="text-align:center">设置 Date 对象中月份 (0 ~ 11)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-setseconds.html">setSeconds()</a></td><td style="text-align:center">设置 Date 对象中的秒钟 (0 ~ 59)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-settime.html">setTime()</a></td><td style="text-align:center">setTime() 方法以毫秒设置 Date 对象。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-setutcdate.html">setUTCDate()</a></td><td style="text-align:center">根据世界时设置 Date 对象中月份的一天 (1 ~ 31)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-setutcfullyear.html">setUTCFullYear()</a></td><td style="text-align:center">根据世界时设置 Date 对象中的年份（四位数字）。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-setutchours.html">setUTCHours()</a></td><td style="text-align:center">根据世界时设置 Date 对象中的小时 (0 ~ 23)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-setutcmilliseconds.html">setUTCMilliseconds()</a></td><td style="text-align:center">根据世界时设置 Date 对象中的毫秒 (0 ~ 999)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-setutcminutes.html">setUTCMinutes()</a></td><td style="text-align:center">根据世界时设置 Date 对象中的分钟 (0 ~ 59)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-setutcmonth.html">setUTCMonth()</a></td><td style="text-align:center">根据世界时设置 Date 对象中的月份 (0 ~ 11)。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-setutcseconds.html">setUTCSeconds()</a></td><td style="text-align:center">setUTCSeconds() 方法用于根据世界时 (UTC) 设置指定时间的秒字段。</td></tr><tr><td style="text-align:center">setYear()</td><td style="text-align:center">已废弃。请使用 setFullYear() 方法代替。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-todatestring.html">toDateString()</a></td><td style="text-align:center">把 Date 对象的日期部分转换为字符串。</td></tr><tr><td style="text-align:center">toGMTString()</td><td style="text-align:center">已废弃。请使用 toUTCString() 方法代替。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-toisostring.html">toISOString()</a></td><td style="text-align:center">使用 ISO 标准返回字符串的日期格式。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-tojson.html">toJSON()</a></td><td style="text-align:center">以 JSON 数据格式返回日期字符串。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-tolocaledatestring.html">toLocaleDateString()</a></td><td style="text-align:center">根据本地时间格式，把 Date 对象的日期部分转换为字符串。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-tolocaletimestring.html">toLocaleTimeString()</a></td><td style="text-align:center">根据本地时间格式，把 Date 对象的时间部分转换为字符串。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-tolocalestring.html">toLocaleString()</a></td><td style="text-align:center">根据本地时间格式，把 Date 对象转换为字符串。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-tostring-date.html">toString()</a></td><td style="text-align:center">把 Date 对象转换为字符串。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-totimestring.html">toTimeString()</a></td><td style="text-align:center">把 Date 对象的时间部分转换为字符串。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-toutcstring.html">toUTCString()</a></td><td style="text-align:center">根据世界时，把 Date 对象转换为字符串。 实例： <code>var today = new Date(); var UTCstring = today.toUTCString();</code></td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-utc.html">UTC()</a></td><td style="text-align:center">根据世界时返回 1970 年 1 月 1 日 到指定日期的毫秒数。</td></tr><tr><td style="text-align:center"><a href="https://www.runoob.com/jsref/jsref-valueof-date.html">valueOf()</a></td><td style="text-align:center">返回 Date 对象的原始值。</td></tr></tbody></table><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>创建Date对象：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 在程序中 西方的月份编号从0开始</span></span><br><span class="line"><span class="comment">* 1 2 3 4 5 6 </span></span><br><span class="line"><span class="comment">* 0 1 2 3 4 5</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">var</span> today = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line"><span class="keyword">var</span> d1 = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&quot;October 13, 1975 11:13:00&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> d2 = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">79</span>,<span class="number">5</span>,<span class="number">24</span>)</span><br><span class="line"><span class="keyword">var</span> d3 = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">79</span>,<span class="number">5</span>,<span class="number">24</span>,<span class="number">11</span>,<span class="number">33</span>,<span class="number">0</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d1);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d2);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d3);</span><br></pre></td></tr></table></figure><img src="JS/20210725090203.png" alt="image-20210725090203847" style="zoom:67%;" /></li><li><p>获得Date对象属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> d4 = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">2048</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">16</span>,<span class="number">51</span>,<span class="number">20</span>,<span class="number">123</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d4)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d4.<span class="title function_">getYear</span>())<span class="comment">//和1900的年份差</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d4.<span class="title function_">getFullYear</span>())<span class="comment">//完整的年份</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d4.<span class="title function_">getMonth</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d4.<span class="title function_">getDate</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d4.<span class="title function_">getHours</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d4.<span class="title function_">getMinutes</span>())</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d4.<span class="title function_">getMilliseconds</span>())<span class="comment">//毫秒</span></span><br></pre></td></tr></table></figure><img src="JS/20210725091429.png" alt="image-20210725091404875" style="zoom:67%;" /></li><li><p>判断日期大小</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> d5 = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">2048</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">16</span>,<span class="number">51</span>,<span class="number">20</span>,<span class="number">456</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(d4&lt;d5)</span><br></pre></td></tr></table></figure><img src="JS/20210725091516.png" alt="image-20210725091516565" style="zoom:67%;" /></li><li><p>自定义日期格式</p><p>format格式化方法可以放在js文件中，不用重复复制</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*date对象的格式化方法*/</span></span><br><span class="line"><span class="comment">/*修改Date原型,添加一个format格式化的方法*/</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">format</span> = <span class="keyword">function</span>(<span class="params">fmt</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> o = &#123;</span><br><span class="line">        <span class="string">&quot;M+&quot;</span> : <span class="variable language_">this</span>.<span class="title function_">getMonth</span>()+<span class="number">1</span>,                 <span class="comment">//月份</span></span><br><span class="line">        <span class="string">&quot;d+&quot;</span> : <span class="variable language_">this</span>.<span class="title function_">getDate</span>(),                    <span class="comment">//日</span></span><br><span class="line">        <span class="string">&quot;h+&quot;</span> : <span class="variable language_">this</span>.<span class="title function_">getHours</span>(),                   <span class="comment">//小时</span></span><br><span class="line">        <span class="string">&quot;m+&quot;</span> : <span class="variable language_">this</span>.<span class="title function_">getMinutes</span>(),                 <span class="comment">//分</span></span><br><span class="line">        <span class="string">&quot;s+&quot;</span> : <span class="variable language_">this</span>.<span class="title function_">getSeconds</span>(),                 <span class="comment">//秒</span></span><br><span class="line">        <span class="string">&quot;q+&quot;</span> : <span class="title class_">Math</span>.<span class="title function_">floor</span>((<span class="variable language_">this</span>.<span class="title function_">getMonth</span>()+<span class="number">3</span>)/<span class="number">3</span>), <span class="comment">//季度</span></span><br><span class="line">        <span class="string">&quot;S&quot;</span>  : <span class="variable language_">this</span>.<span class="title function_">getMilliseconds</span>()             <span class="comment">//毫秒</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="regexp">/(y+)/</span>.<span class="title function_">test</span>(fmt))&#123;</span><br><span class="line">        fmt=fmt.<span class="title function_">replace</span>(<span class="title class_">RegExp</span>.<span class="property">$1</span>, (<span class="variable language_">this</span>.<span class="title function_">getFullYear</span>()+<span class="string">&quot;&quot;</span>).<span class="title function_">substr</span>(<span class="number">4</span> - <span class="title class_">RegExp</span>.<span class="property">$1</span>.<span class="property">length</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> k <span class="keyword">in</span> o)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&quot;(&quot;</span>+ k +<span class="string">&quot;)&quot;</span>).<span class="title function_">test</span>(fmt))&#123;</span><br><span class="line">            fmt = fmt.<span class="title function_">replace</span>(</span><br><span class="line">                <span class="title class_">RegExp</span>.<span class="property">$1</span>, (<span class="title class_">RegExp</span>.<span class="property">$1</span>.<span class="property">length</span>==<span class="number">1</span>) ? (o[k]) : ((<span class="string">&quot;00&quot;</span>+ o[k]).<span class="title function_">substr</span>((<span class="string">&quot;&quot;</span>+ o[k]).<span class="property">length</span>)));  </span><br><span class="line">        &#125;       </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fmt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fmt=d4.<span class="title function_">format</span>(<span class="string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fmt)</span><br></pre></td></tr></table></figure><img src="JS/20210725094240.png" alt="image-20210725094240035" style="zoom:67%;" /></li></ul><h3 id="自定义对象">自定义对象</h3><p>JS除了一些常用方法和类以外,允许我们自己定义对象,在JS中自定义对象有三种可用的语法格式,分别为:</p><h4 id="1-调用系统的构造函数创建对象">1. 调用系统的构造函数创建对象</h4><ul><li><p>实例化对象</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实例化对象*/</span></span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br></pre></td></tr></table></figure></li><li><p>给对象添加属性和方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*给对象添加属性*/</span></span><br><span class="line">obj.<span class="property">name</span>=<span class="string">&quot;陈慧珊&quot;</span></span><br><span class="line">obj.<span class="property">sex</span>=<span class="string">&quot;女&quot;</span></span><br><span class="line">obj.<span class="property">age</span>=<span class="number">20</span>;</span><br></pre></td></tr></table></figure></li><li><p>查看对象属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*给对象添加属性*/</span></span><br><span class="line">obj.<span class="property">name</span>=<span class="string">&quot;陈慧珊&quot;</span></span><br><span class="line">obj.<span class="property">sex</span>=<span class="string">&quot;女&quot;</span></span><br><span class="line">obj.<span class="property">age</span>=<span class="number">20</span>;</span><br></pre></td></tr></table></figure></li><li><p>调用对象方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*给对象添加方法*/</span></span><br><span class="line">obj.<span class="property">miss</span>=<span class="keyword">function</span>(<span class="params">ex</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>+<span class="string">&quot;一直都放不下&quot;</span>+ex)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>查看属性，调用方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*查看对象属性*/</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">name</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">sex</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">age</span>)</span><br><span class="line"><span class="comment">/*调用方法*/</span></span><br><span class="line">obj.<span class="title function_">miss</span>(<span class="string">&quot;谭颖&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="C:%5CUsers%5CDell%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210725102555551.png" alt="image-20210725102555551"></p></li></ul><h4 id="2-自定义构造方法创建对象">2. 自定义构造方法创建对象</h4><ul><li><p>准备一个构造方法：</p><p>可以声明属性还可以声明方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name,sex</span>)&#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">name</span>=name;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">sex</span>=sex;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">miss</span>=<span class="keyword">function</span>(<span class="params">ex</span>)&#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>+<span class="string">&quot;一直都放不下&quot;</span>+ex)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>调用构造方法创建对象</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var obj = new Person(&quot;陈慧珊&quot;,&quot;女&quot;)</span><br></pre></td></tr></table></figure></li><li><p>查看对象属性调用对象方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*查看对象属性*/</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">name</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">sex</span>)</span><br><span class="line"><span class="comment">/*调用方法*/</span></span><br><span class="line">obj.<span class="title function_">miss</span>(<span class="string">&quot;谭颖&quot;</span>)</span><br></pre></td></tr></table></figure><img src="JS/20210725103304.png" alt="image-20210725103304379" style="zoom:67%;" /></li></ul><h4 id="3-字面量的方式创建对象">3. 字面量的方式创建对象</h4><ul><li><p>使用JSON方式</p><p>var 对象名={属性名：属性值，属性名：属性值，…，方法名：方法声明：方法名：方法声明，……}</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*使用JSON方式*/</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;陈慧珊&quot;</span>,</span><br><span class="line">    <span class="attr">sex</span>:<span class="string">&quot;女&quot;</span>,</span><br><span class="line">    <span class="attr">miss</span>:<span class="keyword">function</span>(<span class="params">ex</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>+<span class="string">&quot;一直都放不下&quot;</span>+ex)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>查看属性 调用方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*查看参数 调用方法*/</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">name</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">sex</span>)</span><br><span class="line">obj.<span class="title function_">miss</span>(<span class="string">&quot;谭颖&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="JS/20210725104108.png" alt="image-20210725103839535" style="zoom:67%;" /></li></ul><h3 id="原型">原型</h3><h4 id="构造器与原型的关系">构造器与原型的关系</h4><p>当我们用构造方法创建一个类时,在内存会预先调用构造方法创建一个对象,这对象我们称之为原型对象,构造方法对象中有一个prototype属性指向该对象,原型对象中有一个constructor属性指向构造方法.获得一个类的原型对象可以通过类名.prototype的方式获得.</p><img src="JS/20210725170256.png" alt="image-20210725170234031" style="zoom:67%;" /><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 准备一个构造方法 </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">pname,page</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">pname</span>=pname;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">page</span>=page;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">eat</span>=<span class="keyword">function</span>(<span class="params">food</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">page</span>+<span class="string">&quot;岁的&quot;</span>+<span class="variable language_">this</span>.<span class="property">pname</span>+<span class="string">&quot;正在吃&quot;</span>+food);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Person</span>)<span class="comment">// Constructor对象  构造方法对象</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>)</span><br></pre></td></tr></table></figure><p>控制台打印Person构造器和其原型对象</p><p><img src="JS/20210725161823.png" alt="image-20210725161823746"></p><h4 id="当前类对象与原型的关系">当前类对象与原型的关系</h4><p>当前类的每一个对象内部有一个 _ proto _的一个属性,指向他们的原型, 当我们用对象获取属性和调用方法时,如果当前对象中没有,那么会去他们所对应的原型对象中去找.</p><img src="JS/20210725153638.png" alt="image-20210725153615736" style="zoom:50%;" /><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*为Person所有对象增加属性和方法*/</span></span><br><span class="line"><span class="comment">//通过给Person的原型增加属性</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">ex</span>=<span class="string">&quot;ty&quot;</span></span><br><span class="line"><span class="comment">//通过给Person的原型增加方法</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">emotion</span>=<span class="keyword">function</span>(<span class="params">emo</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">pname</span>+emo+<span class="string">&quot;极了&quot;</span>+<span class="variable language_">this</span>.<span class="property">ex</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;chs&quot;</span>,<span class="number">10</span>);</span><br><span class="line">p1.<span class="title function_">emotion</span>(<span class="string">&quot;讨厌&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;陈慧珊&quot;</span>,<span class="number">10</span>);</span><br><span class="line">p2.<span class="title function_">emotion</span>(<span class="string">&quot;恨&quot;</span>);</span><br></pre></td></tr></table></figure><h4 id="原型链">原型链</h4><p>一个类的原型是一个Object类的对象,也就是说,原型也有一个_proto_属性,指向Object的原型对象,那么也就是说 Person prototype中没有的属性和方法会继续向Object  prototype去找,也就是说,我们在Object原型中添加的属性和方法,我们在person1和person2中也可以使用.那么这种连续的 _proto_属性指向就形成了原型链</p><p><strong>也就是给Object的原型对象添加的属性和方法，所有的对象都可以用</strong></p><img src="JS/20210725170443.png" alt="image-20210725170443721" style="zoom:67%;" /><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 准备一个构造方法 </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">pname,page</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">pname</span>=pname;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">page</span>=page;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">eat</span>=<span class="keyword">function</span>(<span class="params">food</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">page</span>+<span class="string">&quot;岁的&quot;</span>+<span class="variable language_">this</span>.<span class="property">pname</span>+<span class="string">&quot;正在吃&quot;</span>+food);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 给所有的对象增加属性和方法</span></span><br><span class="line"><span class="comment">//给最终原型增加属性</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">gender</span>=<span class="string">&quot;男&quot;</span>;</span><br><span class="line"><span class="comment">//给Person的原型增加一个方法</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sleep</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">page</span>+<span class="string">&quot;岁的&quot;</span>+<span class="variable language_">this</span>.<span class="property">gender</span>+<span class="string">&quot;孩儿&quot;</span>+<span class="variable language_">this</span>.<span class="property">pname</span>+<span class="string">&quot;正在睡觉&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1=<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;张三&quot;</span>,<span class="number">10</span>);</span><br><span class="line">p1.<span class="title function_">eat</span>(<span class="string">&quot;蛋挞&quot;</span>)</span><br><span class="line">p1.<span class="title function_">sleep</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p2=<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;李四&quot;</span>,<span class="number">8</span>);</span><br><span class="line">p2.<span class="title function_">eat</span>(<span class="string">&quot;牛角面包&quot;</span>)</span><br><span class="line">p2.<span class="title function_">sleep</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p2);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="事件">事件</h2><h4 id="鼠标事件">鼠标事件</h4><table><thead><tr><th>属性</th><th>描述</th><th>DOM</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/jsref/event-onclick.html">onclick</a></td><td>当用户点击某个对象时调用的事件句柄。</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-oncontextmenu.html">oncontextmenu</a></td><td>在用户点击鼠标右键打开上下文菜单时触发</td><td></td></tr><tr><td><a href="https://www.runoob.com/jsref/event-ondblclick.html">ondblclick</a></td><td>当用户双击某个对象时调用的事件句柄。</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onmousedown.html">onmousedown</a></td><td>鼠标按钮被按下。</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onmouseenter.html">onmouseenter</a></td><td>当鼠标指针移动到元素上时触发。</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onmouseleave.html">onmouseleave</a></td><td>当鼠标指针移出元素时触发</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onmousemove.html">onmousemove</a></td><td>鼠标被移动。</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onmouseover.html">onmouseover</a></td><td>鼠标移到某元素之上。</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onmouseout.html">onmouseout</a></td><td>鼠标从某元素移开。</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onmouseup.html">onmouseup</a></td><td>鼠标按键被松开。</td><td>2</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.d1</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: greenyellow;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;双击666&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;鼠标按下&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;鼠标抬起&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun4</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;鼠标进入&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun5</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;鼠标离开&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun6</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;鼠标移动&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d1&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">ondblclick</span>=<span class="string">&quot;fun1()&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">onmousedown</span>=<span class="string">&quot;fun2()&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">onmouseup</span>=<span class="string">&quot;fun3()&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">onmouseenter</span>=<span class="string">&quot;fun4()&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">onmouseleave</span>=<span class="string">&quot;fun5()&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">onmousemove</span>=<span class="string">&quot;fun6()&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="JS/20210725200123.png" alt="image-20210725200123159" style="zoom:67%;" /><h4 id="按键事件">按键事件</h4><table><thead><tr><th>属性</th><th>描述</th><th>DOM</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/jsref/event-onkeydown.html">onkeydown</a></td><td>某个键盘按键被按下。</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onkeypress.html">onkeypress</a></td><td>某个键盘按键被按下并松开。</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onkeyup.html">onkeyup</a></td><td>某个键盘按键被松开。</td><td>2</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;按钮按下&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;按钮抬起&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;按钮按下并抬起&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">onkeydown</span>=<span class="string">&quot;fun1()&quot;</span> <span class="attr">onkeyup</span>=<span class="string">&quot;fun2()&quot;</span> <span class="attr">onkeypress</span>=<span class="string">&quot;fun3()&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><img src="JS/20210725201436.png" alt="image-20210725201436412" style="zoom: 50%;" /><h4 id="表单事件">表单事件</h4><table><thead><tr><th>属性</th><th>描述</th><th>DOM</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/jsref/event-onblur.html">onblur</a></td><td>元素失去焦点时触发</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onchange.html">onchange</a></td><td>该事件在表单元素的内容改变时触发( <input>, <keygen>, <select>, 和 <textarea>)</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onfocus.html">onfocus</a></td><td>元素获取焦点时触发</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onfocusin.html">onfocusin</a></td><td>元素即将获取焦点时触发</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onfocusout.html">onfocusout</a></td><td>元素即将失去焦点时触发</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-oninput.html">oninput</a></td><td>元素获取用户输入时触发</td><td>3</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onreset.html">onreset</a></td><td>表单重置时触发</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onsearch.html">onsearch</a></td><td>用户向搜索域输入文本时触发 (  &lt;input=“search”&gt;)</td><td></td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onselect.html">onselect</a></td><td>用户选取文本时触发 ( <input> 和 <textarea>)</td><td>2</td></tr><tr><td><a href="https://www.runoob.com/jsref/event-onsubmit.html">onsubmit</a></td><td>表单提交时触发</td><td>2</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;获得焦点&quot;</span>);&#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;失去焦点&quot;</span>);&#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;正在输入&quot;</span>);&#125;<span class="comment">// 只要输入了,就会触发</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun4</span>(<span class="params"></span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;内容改变&quot;</span>);&#125;<span class="comment">// 内部信息发生变化的同时,要失去焦点</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun5</span>(<span class="params">sel</span>)&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;内容发生改变了&quot;</span>+sel.<span class="property">value</span>)&#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun6</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">alert</span>(<span class="string">&quot;发生了提交事件&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 做了一些运算之后 动态决定表单能否提交</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="literal">false</span> ;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun7</span>(<span class="params"></span>)&#123; </span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;发生了重置事件&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>  <span class="attr">action</span>=<span class="string">&quot;https://www.baidu.com&quot;</span> <span class="attr">onsubmit</span>=<span class="string">&quot;return fun6()&quot;</span> <span class="attr">onreset</span>=<span class="string">&quot;return fun7()&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span>  <span class="attr">value</span>=<span class="string">&quot;&quot;</span>  <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">onfocus</span>=<span class="string">&quot;fun1()&quot;</span> <span class="attr">onblur</span>=<span class="string">&quot;fun2()&quot;</span> <span class="attr">oninput</span>=<span class="string">&quot;fun3()&quot;</span> <span class="attr">onchange</span>=<span class="string">&quot;fun4()&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;city&quot;</span> <span class="attr">onchange</span>=<span class="string">&quot;fun5(this)&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">option</span> <span class="attr">selected</span>&gt;</span>-请选择城市-<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>&gt;</span>天津<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;4&quot;</span>&gt;</span>重庆<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交数据&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;reset&quot;</span>  <span class="attr">value</span>=<span class="string">&quot;重置数据&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="页面加载事件">页面加载事件</h4><p>==onload标签==可以让页面加载完了自动执行相应函数</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">testFun</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> in1=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;i1&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> v1=in1.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(v1)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">&quot;testFun()&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;测试文字&quot;</span> <span class="attr">id</span>=<span class="string">&quot;i1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="BOM编程">BOM编程</h2><h3 id="BOM与DOM的概念和联系">BOM与DOM的概念和联系</h3><p><strong>Browser Object Model 浏览器对象模型</strong></p><ul><li><p>BOM有一系列对象组成，是访问、控制、修改浏览器的属性的方法</p></li><li><p>BOM没有统一的标准(每种客户端都可以自定标准)。</p></li><li><p>BOM的顶层是==window对象==</p></li></ul><p><strong>Document Object Model 文档对象模型</strong></p><ul><li><p>DOM用于XHTML、XML文档的应用程序接口(API)。</p></li><li><p>DOM提供一种结构化的文档描述方式，从而使HTML内容使用结构化的方式显示。</p></li><li><p>DOM由一系列对象组成，是访问、检索、修改XHTML文档内容与结构的标准方法。</p></li><li><p>DOM标准是由w3c制定与维护。DOM是跨平台与跨语言的。</p></li><li><p>DOM的顶层是==document对象==</p></li></ul><p>​                                            &lt;下图红色框内是DOM控制，绿色框内是BOM控制&gt;</p><img src="JS/20210726103714.png" alt="image-20210726103713434" style="zoom:67%;" /><p><strong>联系</strong></p><img src="JS/20210726103848.png" alt="image-20210726103847508" style="zoom:67%;" /><p>也可以说DOM也是归BOM管的.</p><p><strong>BOM</strong>编程就是把整个浏览器抽象成一个对象(window),这个对象中有很多的属性和方法,访问这些属性或者调用这些方法就可以控制浏览器作出…<strong>行为</strong></p><p><strong>DOM</strong>编程就是把浏览器当前页面对应的文档抽象成一个对象(document),这个对象中有很多关于操作文档的一些属性和方法,访问这些属性和方法的时候,我们就可以通过代码动态控制<strong>页面上显示的内容</strong></p><p><strong>BOM 是为了操作浏览器出现的 API，window 是其根对象。</strong></p><p><strong>DOM 是为了操作文档出现的 API，document 是其根对象。</strong></p><h3 id="window对象及常用方法">window对象及常用方法</h3><h4 id="三种弹窗方式">三种弹窗方式</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                                 * 如果是使用window对象调用的方法和访问的属性 那么window对象都可以省略不写</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                                 * </span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                                 * */</span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">window</span>.<span class="title function_">alert</span>(<span class="string">&quot;你好呀&quot;</span>);<span class="comment">//普通信息提示框</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> con =<span class="variable language_">window</span>.<span class="title function_">confirm</span>(<span class="string">&quot;确定要删除***女友吗?&quot;</span>);<span class="comment">// 确认框</span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(con);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> message =<span class="variable language_">window</span>.<span class="title function_">prompt</span>(<span class="string">&quot;请输入3号女友的名字&quot;</span>,<span class="string">&quot;例如:小刚&quot;</span>);<span class="comment">// 信息输入框</span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(message)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;测试按钮&quot;</span>  <span class="attr">onclick</span>=<span class="string">&quot;fun1()&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="JS/20210726141452.png" alt="image-20210726141452790" style="zoom:67%;" /><img src="JS/20210726141503.png" alt="image-20210726141503747" style="zoom:67%;" /><img src="JS/20210726141526.png" alt="image-20210726141526426" style="zoom:67%;" /><h4 id="定时器">定时器</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">/*持续打印的控制器*/</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//定义一个存储因为每次点击而生成的intervalID</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> intervalIDS=<span class="keyword">new</span> <span class="title class_">Array</span>();</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">/*循环执行的定时器任务*/</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">startInterval</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//定时器setInterval()&#123;执行的动作，时间&#125;</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> intervalID = <span class="variable language_">window</span>.<span class="built_in">setInterval</span>(</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">var</span> today=<span class="keyword">new</span> <span class="title class_">Date</span>();</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">var</span> hours = today.<span class="title function_">getHours</span>();</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">var</span> minutes=today.<span class="title function_">getMinutes</span>();</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">var</span> seconds=today.<span class="title function_">getSeconds</span>();</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">var</span> str= hours+<span class="string">&quot;点&quot;</span>+minutes+<span class="string">&quot;分&quot;</span>+seconds+<span class="string">&quot;秒&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">var</span> ta = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;timeArea&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                        ta.<span class="property">value</span>=str;</span></span><br><span class="line"><span class="language-javascript">                    &#125;,</span></span><br><span class="line"><span class="language-javascript">                    <span class="number">1000</span><span class="comment">//1s</span></span></span><br><span class="line"><span class="language-javascript">                );</span></span><br><span class="line"><span class="language-javascript">                intervalIDS.<span class="title function_">push</span>(intervalID);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">/*设置循环停止*/</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">endInterval</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//删除定时器任务</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">while</span>(intervalIDS.<span class="property">length</span>&gt;<span class="number">0</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">//删除数组第一个元素</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">window</span>.<span class="built_in">clearInterval</span>(intervalIDS.<span class="title function_">shift</span>())</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;timeArea&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;开始计时&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;startInterval()&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;停止计时&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;endInterval()&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="JS/20210726152748.png" alt="image-20210726152747997" style="zoom:67%;" /><h4 id="open和close">open和close</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">window</span>.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;打开百度&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun1()&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;关闭页面&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun2()&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="window属性">window属性</h4><h5 id="location">location</h5><p>location对象,是window对象的一个属性,代表浏览器上URL地址栏,使用location对象可以操作地址栏</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">host</span>);<span class="comment">// 服务器的IP+端口号</span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">hostname</span>);<span class="comment">// IP </span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">port</span>);<span class="comment">// 端口号</span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">href</span>);<span class="comment">// 地址栏中具体的文字</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                location.<span class="property">href</span>=<span class="string">&quot;https://www.baidu.com&quot;</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;测试location&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun1()&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="history">history</h5><p>history对象是window对象的一个属性,代表浏览器访问历史记录,通过history的操作我们可以实现翻阅浏览器历史网页</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">window</span>.<span class="property">history</span>.<span class="title function_">forward</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                history.<span class="title function_">back</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                history.<span class="title function_">go</span>(<span class="number">2</span>); <span class="comment">// 正整数 向前跳转 * 页  负整数 向后跳转*页</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;a.html&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_self&quot;</span>&gt;</span>pageA<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;向前&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun1()&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;向后&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun2()&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;go&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun3()&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="screen和navigator">screen和navigator</h5><p>screen代表屏幕,navigator代表浏览器软件本身,通过这两个对象可以获得屏幕和浏览器软件的一些信息</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">width</span>)</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="variable language_">window</span>.<span class="property">screen</span>.<span class="property">height</span>)</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">info</span>(navigator.<span class="property">userAgent</span>)</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">info</span>(navigator.<span class="property">appName</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">&quot;fun1()&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="DOM编程">DOM编程</h2><h3 id="引入">引入</h3><p>DOM编程就是使用<strong>document对象</strong>的API完成对网页HTML文档进行动态修改,以实现网页数据和样式动态变化效果的编程.</p><p><a href="#BOM%E4%B8%8EDOM%E7%9A%84%E6%A6%82%E5%BF%B5%E5%92%8C%E8%81%94%E7%B3%BB">和BOM的联系</a></p><h4 id="document">document</h4><p>document对象代表整个html文档，可用来访问页面中的所有元素，是最复杂的一个dom对象，可以说是学习好dom编程的关键所在。</p><h4 id="document对象">document对象</h4><p>document对象是window对象的一个成员属性，通过window.document来访问，当然也可以直接使用document,根据HTML代码结构特点,document对象本身是一种树形结构的文档对象。</p><p><strong>如何获取？</strong></p><p>document对象是window对象的一个成员属性，通过<strong>window.document</strong>来访问，当然也可以直接使用document,根据HTML代码结构特点,document对象本身是一种树形结构的文档对象。</p><h4 id="-2"></h4><p><img src="C:%5CUsers%5CDell%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210727201824114.png" alt="image-20210727201824114"></p><h4 id="结点对象：Node">结点对象：Node</h4><p>在 HTML DOM (Document Object Model) 中, 所有的都是  <strong>节点</strong></p><p>它有三个子类</p><ul><li><p>元素节点：Element 如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;链接地址&quot;</span>&gt;</span>我的链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>属性节点 Attribute 如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">href=&quot;链接地址&quot;</span><br></pre></td></tr></table></figure></li><li><p>文本节点 Text 如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我的链接</span><br></pre></td></tr></table></figure></li></ul><h4 id="document的操作">document的操作</h4><ol><li><p>查询元素（获取元素,进而操作元素,或者元素的属性,文本）</p></li><li><p>操作文本</p></li><li><p>操作属性</p></li><li><p>操作元素</p></li><li><p>操作CSS样式（一个特殊的属性style）</p></li></ol><h5 id="实例">实例</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>页面分析<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        x</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;d1&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100px;height: 100px; border: 1px solid red;&quot;</span>&gt;</span></span><br><span class="line">            1a</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            2b</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>thank you<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            3c</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>thank you very much<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            4d</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        y</span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>树形结构图</strong></p><p><img src="JS/20210727201506.png" alt="image-20210727201503749"></p><h3 id="获取节点">获取节点</h3><ul><li>id值获取</li><li>class属性值获取</li><li>标签名获取</li><li>name属性值获取</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 获得document对象</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> element1 =<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;d1&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(element1);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                element1.<span class="property">innerText</span>=<span class="string">&quot;这是我的div&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params">className</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> elements =<span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(className);</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(elements)</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">for</span>(<span class="keyword">var</span> i =<span class="number">0</span>;i&lt;elements.<span class="property">length</span>;i++)&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(elements[i])</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun3</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> elements =<span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;input&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(elements);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">for</span>(<span class="keyword">var</span> i =<span class="number">0</span>;i&lt;elements.<span class="property">length</span>;i++)&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(elements[i])</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun4</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> elements=<span class="variable language_">document</span>.<span class="title function_">getElementsByName</span>(<span class="string">&quot;hobby&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(elements);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">for</span>(<span class="keyword">var</span> i =<span class="number">0</span>;i&lt;elements.<span class="property">length</span>;i++)&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(elements[i])</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;d1&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;a&quot;</span>&gt;</span>这是第一个div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;d2&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;a&quot;</span>&gt;</span>这是第二个div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;d3&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;a&quot;</span>&gt;</span>这是第三个div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&#x27;i1&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;a&quot;</span> <span class="attr">name</span>=<span class="string">&#x27;name1&#x27;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;d4&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;b&quot;</span> <span class="attr">name</span>=<span class="string">&#x27;name1&#x27;</span>&gt;</span>这是第四个div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;d5&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;b&quot;</span>&gt;</span>这是第五个div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        爱好:</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span>  <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span>篮球</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span>  <span class="attr">value</span>=<span class="string">&quot;2&quot;</span> /&gt;</span>足球</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span>  <span class="attr">value</span>=<span class="string">&quot;3&quot;</span> /&gt;</span>羽毛球</span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;id值获取&quot;</span> <span class="attr">onclick</span>=<span class="string">&#x27;fun1()&#x27;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;class属性值获取&quot;</span> <span class="attr">onclick</span>=<span class="string">&#x27;fun2(&quot;b&quot;)&#x27;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;标签名获取&quot;</span> <span class="attr">onclick</span>=<span class="string">&#x27;fun3()&#x27;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;name属性值获取&quot;</span> <span class="attr">onclick</span>=<span class="string">&#x27;fun4()&#x27;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="修改操作">修改操作</h3><h4 id="修改节点属性">修改节点属性</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;你好呀&quot;</span> <span class="attr">id</span>=<span class="string">&quot;in1&quot;</span> /&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;变&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun1()&quot;</span>  /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>语法一：获得  节点.属性名    修改  节点.属性名 =属性值</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 语法1     </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(node.<span class="property">type</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(node.<span class="property">value</span>);</span><br><span class="line"><span class="comment">//改变属性值</span></span><br><span class="line">node.<span class="property">type</span>=<span class="string">&quot;button&quot;</span>;</span><br><span class="line">node.<span class="property">value</span>=<span class="string">&quot;你好我也好&quot;</span>;</span><br></pre></td></tr></table></figure></li><li><p>语法二：getAttribute   setAttribute</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 语法2  getAttribute   setAttribute</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(node.<span class="title function_">getAttribute</span>(<span class="string">&quot;type&quot;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(node.<span class="title function_">getAttribute</span>(<span class="string">&quot;value&quot;</span>));</span><br><span class="line">node.<span class="title function_">setAttribute</span>(<span class="string">&quot;type&quot;</span>,<span class="string">&quot;button&quot;</span>);</span><br><span class="line">node.<span class="title function_">setAttribute</span>(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;大家好&quot;</span>);</span><br></pre></td></tr></table></figure></li></ul><h4 id="修改节点样式">修改节点样式</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#div1</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.a</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: lightblue;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: blue;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">font-size</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div1&quot;</span> &gt;</span></span><br><span class="line">            你好呀</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;测试&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun1()&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>节点.style.样式名=样式值</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 节点.style.样式名=样式值</span></span><br><span class="line"><span class="keyword">var</span> element =<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;div1&quot;</span>);</span><br><span class="line">element.<span class="property">style</span>.<span class="property">width</span>=<span class="string">&quot;200px&quot;</span>;</span><br><span class="line">element.<span class="property">style</span>.<span class="property">height</span>=<span class="string">&quot;200px&quot;</span>;</span><br><span class="line">element.<span class="property">style</span>.<span class="property">border</span>=<span class="string">&quot;10px solid green&quot;</span>;</span><br></pre></td></tr></table></figure></li><li><p>css样式在更多的时候是以class选择器的形式作用到元素上<br>可以通过修改class属性,影响div的样式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.a</span>&#123;</span></span><br><span class="line"><span class="language-css">                 <span class="attribute">background-color</span>: lightblue;</span></span><br><span class="line"><span class="language-css">                 <span class="attribute">color</span>: blue;</span></span><br><span class="line"><span class="language-css">                 <span class="attribute">font-size</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">             &#125;</span></span><br><span class="line"><span class="language-css"> </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element.<span class="title function_">setAttribute</span>(<span class="string">&quot;class&quot;</span>,<span class="string">&quot;a&quot;</span>)</span><br></pre></td></tr></table></figure></li></ul><h4 id="修改标签文本">修改标签文本</h4><ul><li><p>innerHtml 操作双标签中间的HTML</p></li><li><p>innerText  操作双标签中间的 Text</p></li><li><p>value      操作表单标签值</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">div</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> element1=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;d1&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                                 * innerText  不包含HTML结构</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                                 * innerHTML  包含HTML结构</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                                 * */</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;innerText&gt;&gt;&gt;&quot;</span>+element1.<span class="property">innerText</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;innerHTML&gt;&gt;&gt;&quot;</span>+element1.<span class="property">innerHTML</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> element2=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;i1&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(element2.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> element1=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;d1&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//element1.innerText=&quot;&lt;h1&gt;一刻也不能分割&lt;/h1&gt;&quot;</span></span></span><br><span class="line"><span class="language-javascript">                element1.<span class="property">innerHTML</span>=<span class="string">&quot;&lt;h1&gt;一刻也不能分割&lt;/h1&gt;&quot;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> element2=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;i1&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                element2.<span class="property">value</span>=<span class="string">&quot;无论我走到哪里&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;d1&#x27;</span>&gt;</span></span><br><span class="line">            a</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>文字<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            b</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;我和我的祖国&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;i1&#x27;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;获取内容&quot;</span>  <span class="attr">onclick</span>=<span class="string">&quot;fun1()&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;修改内容&quot;</span>  <span class="attr">onclick</span>=<span class="string">&quot;fun2()&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="增加删除节点">增加删除节点</h4><p>删除节点需要的知识</p><p>行间距和创建标签</p><p>创建标签输入内筒以后进行进一步的创建w</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#d1</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">80%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> div1=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;d1&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 通过JS创建标签</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> in1=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;input&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                in1.<span class="title function_">setAttribute</span>(<span class="string">&quot;type&quot;</span>,<span class="string">&quot;text&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                in1.<span class="title function_">setAttribute</span>(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;请输入内容&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> in2=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;input&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                in2.<span class="title function_">setAttribute</span>(<span class="string">&quot;type&quot;</span>,<span class="string">&quot;password&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                in2.<span class="title function_">setAttribute</span>(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;123456789&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> in3=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;input&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                in3.<span class="title function_">setAttribute</span>(<span class="string">&quot;type&quot;</span>,<span class="string">&quot;button&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                in3.<span class="title function_">setAttribute</span>(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;删除&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> br=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;br&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                in3.<span class="property">onclick</span>=<span class="keyword">function</span> (<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                    div1.<span class="title function_">removeChild</span>(in1)</span></span><br><span class="line"><span class="language-javascript">                    div1.<span class="title function_">removeChild</span>(in2)</span></span><br><span class="line"><span class="language-javascript">                    div1.<span class="title function_">removeChild</span>(in3)</span></span><br><span class="line"><span class="language-javascript">                    div1.<span class="title function_">removeChild</span>(br)</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">                div1.<span class="title function_">appendChild</span>(in1);</span></span><br><span class="line"><span class="language-javascript">                div1.<span class="title function_">appendChild</span>(in2);</span></span><br><span class="line"><span class="language-javascript">                div1.<span class="title function_">appendChild</span>(in3);</span></span><br><span class="line"><span class="language-javascript">                div1.<span class="title function_">appendChild</span>(br);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;d1&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;增加&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun1()&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="案例">案例</h3><p>Do You Love Me??</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> outerDiv =<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;outerDiv&quot;</span>); </span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 1000</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> left =<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">1000</span>)</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 500</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> top =<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">500</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                outerDiv.<span class="property">style</span>.<span class="property">marginTop</span>=top+<span class="string">&quot;px&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">                outerDiv.<span class="property">style</span>.<span class="property">marginLeft</span>=left+<span class="string">&quot;px&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span>  <span class="title function_">fun2</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">alert</span>(<span class="string">&quot;love you too&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#outerDiv</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border</span>: <span class="number">1px</span> solid gold;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: gray;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin-top</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin-left</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#outerDiv</span> <span class="selector-tag">input</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;outerDiv&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h3</span>&gt;</span>do you love me?<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;是&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun2()&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;否&quot;</span> <span class="attr">onmouseover</span>=<span class="string">&quot;fun1()&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS</title>
      <link href="/2021/06/15/CSS/"/>
      <url>/2021/06/15/CSS/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=e2c73fc7-3092-be3c-1e5d-4163db1aceae</cover>
      <date>Tue Jun 15 2021 09:56:56 GMT+0800</date>
      
        <content type="html"><![CDATA[<p><strong>cascading style sheets</strong></p><h2 id="样式">样式</h2><p><strong>行内样式（优先级最高）、内部样式、外部样式(最常用的)</strong></p><span id="more"></span><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        【书写方式2:内部样式】</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">h1</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: pink;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">font-family</span>: <span class="string">&quot;宋体&quot;</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        【书写方式3:外部样式】</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/样式.css&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        【书写方式1：行内样式】</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">style</span>=<span class="string">&quot;color: deeppink;font-family: &#x27;宋体&#x27;;&quot;</span>&gt;</span>This is a h1 title<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><img src="CSS/20210715095520.png" alt="image-20210715095520870" style="zoom:50%;" /><h2 id="选择器">选择器</h2><h3 id="1-基本选择器">1.基本选择器</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            * [1]基本选择器：元素选择器</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            */</span></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">h1</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">font-family</span>: <span class="string">&quot;楷体&quot;</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">i</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: blue;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">font-family</span>: <span class="string">&quot;黑体&quot;</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            * [2]基本选择器：类选择器</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            */</span></span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.mycls</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: green;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">font-family</span>: <span class="string">&quot;宋体&quot;</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            * [3]基本选择器：唯一选择器</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            */</span></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#myid</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: yellow;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">font-family</span>: <span class="string">&quot;微软雅黑&quot;</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是<span class="tag">&lt;<span class="name">i</span>&gt;</span>一个<span class="tag">&lt;/<span class="name">i</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是一个标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;mycls&quot;</span>&gt;</span>我是一个标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是一个标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">&quot;mycls&quot;</span>&gt;</span>我是h2标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>我是h2标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">id</span>=<span class="string">&quot;myid&quot;</span>&gt;</span>我是h2标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果</p><h3 id="2-关系选择器">2.关系选择器</h3><h4 id="div和span标签">div和span标签</h4><ul><li>div属于块级元素–》换行</li><li>span属于行内元素–》没有换行效果：里面的内容占多大，span包裹的区域就多大</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            我们可以通俗的理解，把div理解为一个“塑料袋”</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            div属于块级元素--》换行</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            span属于行内元素--》没有换行效果</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            span:里面的内容占多大，span包裹的区域就多大*/</span></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">div</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border</span>: <span class="number">1px</span> red solid;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">span</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border</span>: <span class="number">1px</span> greenyellow solid; </span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>马士兵马士兵<span class="tag">&lt;<span class="name">br</span> /&gt;</span>马士兵马士兵<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>马士兵<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>马士兵马士兵<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>马士兵<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>马士兵<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果：</p><img src="CSS/20210715160452.png" alt="image-20210715160452173" style="zoom: 33%;" /><h4 id="选择器-2">选择器</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="comment">/*关系选择器:</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            * 后代选择器：只要是这个元素的后代，样式都会发生变化</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            * div下面的所有h1标签样式都会改变</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            */</span></span></span><br><span class="line"><span class="language-css">            <span class="comment">/*div h1&#123;</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            color: red;</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            &#125;*/</span></span></span><br><span class="line"><span class="language-css">            <span class="comment">/*关系选择器：子代选择器</span></span></span><br><span class="line"><span class="comment"><span class="language-css">            只改变子标签的样式*/</span></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">div</span>&gt;<span class="selector-tag">h1</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: royalblue;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">span</span>&gt;<span class="selector-tag">h1</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: yellow;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>效果：</p><img src="CSS/20210715160407.png" alt="image-20210715160407509" style="zoom: 33%;" /><h3 id="3-属性选择器">3.属性选择器</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="comment">/*属性选择器*/</span></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;password&quot;</span>]</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;text&quot;</span>]</span><span class="selector-attr">[value=<span class="string">&quot;zhaoss1&quot;</span>]</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: yellow;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">            用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;zhaoss1&quot;</span> /&gt;</span></span><br><span class="line">            用户名2：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;zhaoss2&quot;</span> /&gt;</span></span><br><span class="line">            密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123123&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;登录&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-伪类选择器">4.伪类选择器</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.mycls</span><span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;mycls&quot;</span>&gt;</span>我是标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>一般伪类选择器都应用在超链接上</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="comment">/*设置静止状态*/</span></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">a</span><span class="selector-pseudo">:link</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: yellow;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="comment">/*设置鼠标悬浮状态*/</span></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="comment">/*设置触发状态*/</span></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">a</span><span class="selector-pseudo">:active</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: blue;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="comment">/*设置完成状态*/</span></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">a</span><span class="selector-pseudo">:visited</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: green;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;index.html&quot;</span>&gt;</span>超链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="例子：百度导航条">例子：百度导航条</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">ul</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">list-style-type</span>: none;<span class="comment">/*将无序列表前面的图标取消*/</span></span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">li</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">float</span><span class="selector-pseudo">:left</span>;<span class="comment">/*向左浮动*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin-left</span>: <span class="number">20px</span>;<span class="comment">/*设置间隔20px*/</span></span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">a</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">text-decoration</span>: none;<span class="comment">/*去掉下划线*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">font-size</span>: <span class="number">13px</span>;<span class="comment">/*字号*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: black;<span class="comment">/*字体颜色*/</span></span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: <span class="number">#0000FF</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-tag">div</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="comment">/*定位：*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">position</span>: absolute;<span class="comment">/*绝对定位*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">right</span>:<span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;aaaa&quot;</span>&gt;</span>新闻<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;aaaa&quot;</span>&gt;</span>hao123<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;aaaa&quot;</span>&gt;</span>地图<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;aaaa&quot;</span>&gt;</span>视频<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果：</p><img src="CSS/20210715174100.png" alt="image-20210715174100021" style="zoom:50%;" /><img src="CSS/20210715174209.png" alt="image-20210715174209462" style="zoom:50%;" /><h2 id="浮动效果">浮动效果</h2><h3 id="文字环绕图片">文字环绕图片</h3><p>​浮动设计的初衷为了解决<strong>文字环绕图片</strong>问题，浮动后一定不会将文字挡住，这是设计初衷，不能违背的。</p><img src="C:/Users/Dell/AppData/Roaming/Typora/typora-user-images/image-20210718100303705.png" alt="image-20210718100303705" style="zoom: 33%;" /><h3 id="原理">原理</h3><p>​CSS 的 Float（浮动）使元素脱离文档流，按照指定的方向（左或右发生移动），直到它的外边缘碰到包含框或另一个浮动框的边框为止。文档流是文档中可显示对象在排列时所占用的位置/空间，而脱离文档流就是在页面中不占位置了。</p><h3 id="语法">语法</h3><p><img src="CSS/20210718100331.png" alt="image-20210718100331232"></p><h3 id="实例展示">实例展示</h3><p>设置一个大的div，里面放三个小的div</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--外层div--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;background-color: pink;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 100px;height: 100px;background-color: chartreuse;&quot;</span>&gt;</span>11<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 200px;height: 200px;background-color: coral;&quot;</span>&gt;</span>22<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 300px;height: 300px;background-color: yellow&quot;</span>&gt;</span>33<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>没有任何浮动</p><img src="CSS/20210718102727.png" alt="image-20210718102727344" style="zoom: 33%;" /><p>给绿div设置浮动</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 100px;height: 100px;background-color: chartreuse;&quot;</span>&gt;</span>11<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><img src="CSS/20210718103223.png" alt="image-20210718103223765" style="zoom: 33%;" /><p>给橘色小块设置浮动</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 200px;height: 200px;background-color: coral;&quot;</span>&gt;</span>22<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><img src="CSS/20210718103413.png" alt="image-20210718103413403" style="zoom: 33%;" /><p>给黄色小块设置浮动</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 300px;height: 300px;background-color: yellow;float: left;&quot;</span>&gt;</span>33<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><img src="CSS/20210718103540.png" alt="image-20210718103540103" style="zoom: 50%;" /><p>因为所有的小div都浮到上面，大div里没有东西填充，所以就消失了。</p><p>这样如果有其他的div块，就会变位置</p><img src="CSS/20210718104648.png" alt="image-20210718104648829" style="zoom:50%;" /><h3 id="消除浮动影响">消除浮动影响</h3><ol><li><p>给浮动的父节点加入一个属性overflow:hidden</p><p><img src="CSS/20210718104836.png" alt="image-20210718104836651"></p><img src="CSS/20210718105023.png" alt="image-20210718105023259" style="zoom:33%;" /></li><li><p>给父节点加一个高度，让粉色div“撑起来”</p><p><img src="CSS/20210718105114.png" alt="image-20210718105114468"></p><img src="CSS/20210718105102.png" alt="image-20210718105101964" style="zoom: 33%;" /></li><li><p>被影响的元素紫色div：给它加入一个属性clear:both;</p><p><img src="CSS/20210718105219.png" alt="image-20210718105219588"></p><img src="CSS/20210718105205.png" alt="image-20210718105205523" style="zoom:33%;" /></li></ol><h2 id="定位">定位</h2><h3 id="静态定位-static">静态定位(static)</h3><p>就是默认的定位</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--静态定位:</span></span><br><span class="line"><span class="comment">默认效果 效果就是元素出现在本来应该出现的位置 一般就省略不写</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;img/1.jpg&quot;</span> <span class="attr">style</span>=<span class="string">&quot;position: static;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="相对定位-relative">相对定位(relative)</h3><p>相对元素自身所在的原来的位置进行定位,可以设置left,color,bottom,top这四个属性</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--相对定位</span></span><br><span class="line"><span class="comment">        相对元素自身所在的原来的位置进行定位</span></span><br><span class="line"><span class="comment">        可以设置left,color,bottom,top这四个属性</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 500px; height: 500px; background-color: pink;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 100px; height: 100px; background-color: green;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 100px; height: 100px; background-color: red; position: relative; bottom: 10px;&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 100px; height: 100px; background-color: blue;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>z-index属性：</p><p>设置堆叠顺序，设置元素谁在上谁在下。注意：z-index属性要设置在定位的元素上,</p><p>应用场合：<br>（1）元素在小范围移动的时候<br>（2）结合绝对定位使用</p><h3 id="绝对定位-absolute">绝对定位(absolute)</h3><ul><li>设置子块div为绝对定位</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#outer</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: pink;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin-left</span>:<span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#div01</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: cornflowerblue;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">position</span>: absolute;<span class="comment">/*设置一个绝对定位*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">left</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">top</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#div02</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: coral;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;outer&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div01&quot;</span>&gt;</span>111<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div02&quot;</span>&gt;</span>222<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果</p><img src="C:/Users/Dell/AppData/Roaming/Typora/typora-user-images/image-20210718163324246.png" alt="image-20210718163324246" style="zoom: 33%;" /><p>蓝色div相对body产生的位移，相对body进行位置的改变，然后蓝色div发生位移以后，原位置得到了释放。橙色div移动上去了！</p><ul><li>实际开发中，我们往往让蓝色div在粉色div中发生位移效果<br>配合定位来使用：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#outer</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="comment">/*父块设置一个相对定位*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: pink;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin-left</span>:<span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#div01</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: cornflowerblue;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">left</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">top</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#div02</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: coral;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;outer&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div01&quot;</span>&gt;</span>111<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div02&quot;</span>&gt;</span>222<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果</p><img src="CSS/20210718163447.png" alt="image-20210718163447139" style="zoom: 50%;" /><h4 id="总结：">总结：</h4><p>当给一个元素设置了绝对定位的时候，它相对谁变化呢？它会向上一层一层的找父级节点是否有定位，如果直到找到body了也没有定位，那么就相对body进行变化，如果父级节点有定位（绝对定位，相对定位，固定定位），但是一般我们会配合使用父级为相对定位，当前元素为绝对定位，这样这个元素就会相对父级位置产生变化。无论是上面的哪一种，都会释放原来的位置，然后其他元素会占用那个位置。</p><p>开发中建议使用：父级节点relative定位，子级节点使用绝对定位。</p><h3 id="固定定位-fixed">固定定位(fixed)</h3><p>应用场合：在页面过长的时候，将某个元素<strong>固定</strong>在浏览器的某个位置上，当<strong>拉动滚动条的时候，这个元素位置不动。</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#mydiv</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: cadetblue;</span></span><br><span class="line"><span class="language-css">                <span class="comment">/*固定定位*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">right</span>: <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">top</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mydiv&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>你好<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        ...(省略很多行)</span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>你好<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果</p><img src="CSS/20210718163814.png" alt="image-20210718163814128" style="zoom:33%;" /><h2 id="盒子模型">盒子模型</h2><p>​页面上也有很多元素，元素之间的布局/设计 依靠 <strong>盒子模型</strong>：<br>​所有HTML元素可以看作盒子，在CSS中，&quot;box model&quot;这一术语是用来设计和布局时使用。<br>​CSS盒模型本质上是一个盒子，封装周围的HTML元素，它包括：边距，边框，填充，和实际内容。<br>​盒模型允许我们在其它元素和周围元素边框之间的空间放置元素。<br>​下面的图片说明了盒子模型(Box Model)：</p><img src="CSS/20210718190406.png" alt="image-20210718190406052" style="zoom:50%;" /><img src="CSS/20210718190434.png" alt="image-20210718190434286" style="zoom:50%;" /><p>感受盒子模型</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--代码感受盒子的具体含义--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="comment">/*将所有元素的样式：外边距，边框，内边距全部设置为0*/</span></span></span><br><span class="line"><span class="language-css">            <span class="comment">/*没有单独设置盒子模型样式的就遵照总的设置*/</span></span></span><br><span class="line"><span class="language-css">            *&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin</span>:<span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding</span>: <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border</span>: <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#outer</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="comment">/*修改了内边距padding需要更改原来的长和宽 */</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>:<span class="number">450px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">450px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: pink;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin-left</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin-top</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding-left</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding-top</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#mydiv</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>: yellowgreen;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding-left</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding-top</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;outer&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mydiv&quot;</span>&gt;</span>111<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;background-color: blue;width: 100px; height: 100px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>注意修改了内边距以后需要修改原本的长和宽</strong></p><p>效果</p><p><img src="https://gitee.com/TeaSea33/typora-picgo/raw/master/img/20210718194809.png" alt="image-20210718194809665" style="zoom:50%;" /><img src="CSS/20210718200438.png" alt="image-20210718200437875" style="zoom: 67%;" /></p><h1>H+C练习</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#bigdiv</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">65px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">border</span>: solid <span class="number">#D70000</span> ;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">background-color</span>:<span class="number">#FBEECF</span> ;</span></span><br><span class="line"><span class="language-css">                <span class="comment">/*设置div里中文字的效果*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">font-size</span>: <span class="number">17px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">font-family</span>: <span class="string">&quot;微软雅黑&quot;</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">color</span>: <span class="number">#D70000</span>;</span></span><br><span class="line"><span class="language-css">                <span class="comment">/*设置固定定位*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">right</span>: <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">top</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="comment">/*背景图大小的设置*/</span></span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#mydiv</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="comment">/*先写背景图，再写背景色*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">img/小喇叭.png</span>) no-repeat <span class="number">8px</span> <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding-top</span>: <span class="number">60px</span>;<span class="comment">/*盒子模型的页内边距*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding-right</span>: <span class="number">2px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">text-align</span>: center;<span class="comment">/*设置水平居中*/</span></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#mydiv2</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="comment">/*先写背景图，再写背景色*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">img/联系客服.png</span>) no-repeat <span class="number">3px</span> <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding-top</span>: <span class="number">70px</span>;<span class="comment">/*盒子模型的页内边距*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">text-align</span>: center;<span class="comment">/*设置水平居中*/</span></span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#mydiv3</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">height</span>: <span class="number">60px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="comment">/*先写背景图，再写背景色*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">img/二维码.png</span>) no-repeat <span class="number">3px</span> <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding-top</span>: <span class="number">70px</span>;<span class="comment">/*盒子模型的页内边距*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">text-align</span>: center;<span class="comment">/*设置水平居中*/</span></span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">            <span class="selector-id">#mydiv4</span>&#123;</span></span><br><span class="line"><span class="language-css">                <span class="comment">/*先写背景图，再写背景色*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">img/呵护.png</span>) no-repeat <span class="number">3px</span> <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">padding-top</span>: <span class="number">60px</span>;<span class="comment">/*盒子模型的页内边距*/</span></span></span><br><span class="line"><span class="language-css">                <span class="attribute">text-align</span>: center;<span class="comment">/*设置水平居中*/</span></span></span><br><span class="line"><span class="language-css">            &#125;</span></span><br><span class="line"><span class="language-css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;bigdiv&quot;</span> &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mydiv&quot;</span>&gt;</span></span><br><span class="line">                最新<span class="tag">&lt;<span class="name">br</span> /&gt;</span>发布</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">hr</span> <span class="attr">width</span>=<span class="string">&quot;50px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span> <span class="attr">color</span>=<span class="string">&quot;black&quot;</span>  /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mydiv2&quot;</span>&gt;</span></span><br><span class="line">                联系<span class="tag">&lt;<span class="name">br</span> /&gt;</span>客服</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">hr</span> <span class="attr">width</span>=<span class="string">&quot;50px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span> <span class="attr">color</span>=<span class="string">&quot;black&quot;</span>  /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mydiv3&quot;</span>&gt;</span></span><br><span class="line">                APP<span class="tag">&lt;<span class="name">br</span> /&gt;</span>下载</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">hr</span> <span class="attr">width</span>=<span class="string">&quot;50px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span> <span class="attr">color</span>=<span class="string">&quot;black&quot;</span>  /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mydiv4&quot;</span>&gt;</span></span><br><span class="line">                旅游<span class="tag">&lt;<span class="name">br</span> /&gt;</span>出行<span class="tag">&lt;<span class="name">br</span> /&gt;</span>温馨<span class="tag">&lt;<span class="name">br</span> /&gt;</span>提示</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">...省略很多个hello</span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>效果：</p><img src="CSS/20210719085925.png" alt="image-20210719085617279" style="zoom: 33%;" />]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML</title>
      <link href="/2021/06/13/HTML/"/>
      <url>/2021/06/13/HTML/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=b40965c9-2e19-1ba3-c717-72b86b956c87</cover>
      <date>Sun Jun 13 2021 09:54:00 GMT+0800</date>
      
        <content type="html"><![CDATA[<p>超文本标记语言</p><h2 id="head-标签">head 标签</h2><p>head标签用于定义文档的头部，它是所有头部元素的容器。<head> 中的元素可以引用脚本、指示浏览器在哪里找到样式表。文档的头部描述了文档的各种属性和信息，包括文档的标题、在 Web 中的位置以及和其他文档的关系等。绝大多数文档头部包含的数据都不会真正作为内容显示给读者。</p><span id="more"></span><p>下面这些标签可用在 head 部分：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>、<span class="tag">&lt;<span class="name">meta</span>&gt;</span>、<span class="tag">&lt;<span class="name">link</span>&gt;</span>、<span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-xml">、 <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-handlebars"><span class="language-xml">、 <span class="tag">&lt;<span class="name">base</span>&gt;</span>。</span></span></span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">页面注释</span></span><br><span class="line"><span class="comment">可以放入&lt;title&gt;、&lt;meta&gt;、&lt;style&gt;、&lt;script&gt;、&lt;base&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--页面标题--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>百度一下，你就知道<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--设置页面的编码，防止乱码现象</span></span><br><span class="line"><span class="comment">利用meta标签</span></span><br><span class="line"><span class="comment">charset=&quot;UTF-8&quot;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--页面刷新效果--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;meta http-equiv=&quot;refresh&quot; content=&quot;3;http://www.baidu.com&quot;  /&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--页面作者--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span> = <span class="string">&quot;author&quot;</span> <span class="attr">content</span>=<span class="string">&quot;chs;1374347231@qq.com&quot;</span>  /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--页面描述--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span> =<span class="string">&quot;description&quot;</span> <span class="attr">content</span>=<span class="string">&quot;陈慧珊简介&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--link 标签引入外部资源--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span> = <span class="string">&quot;shortcut icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://www.baidu.com/favicon.ico&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/x-icon&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">body标签中：放入页面展示的内容</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">hello 这里是第一个html！！！</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">页面注释</span></span><br><span class="line"><span class="comment">可以放入&lt;title&gt;、&lt;meta&gt;、&lt;style&gt;、&lt;script&gt;、&lt;base&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--页面标题--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>百度一下，你就知道<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--设置页面的编码，防止乱码现象</span></span><br><span class="line"><span class="comment">利用meta标签</span></span><br><span class="line"><span class="comment">charset=&quot;UTF-8&quot;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--页面刷新效果--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;meta http-equiv=&quot;refresh&quot; content=&quot;3;http://www.baidu.com&quot;  /&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--页面作者--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span> = <span class="string">&quot;author&quot;</span> <span class="attr">content</span>=<span class="string">&quot;chs;1374347231@qq.com&quot;</span>  /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--页面描述--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span> =<span class="string">&quot;description&quot;</span> <span class="attr">content</span>=<span class="string">&quot;陈慧珊简介&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--link 标签引入外部资源--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span> = <span class="string">&quot;shortcut icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://www.baidu.com/favicon.ico&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/x-icon&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">body标签中：放入页面展示的内容</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">hello 这里是第一个html！！！</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>运行效果：</p><img src="HTML/20210713192135.png" alt="image-20210713192135511" style="zoom:50%;" /><h2 id="body-标签">body 标签</h2><p>body 元素是定义文档的主体。body 元素包含文档的所有内容（比如文本、超链接、图像、表格和列表等等。）body是用在网页中的一种HTML标签，标签是用在网页中的一种HTML标签，表示网页的主体部分，也就是用户可以看到的内容，可以包含文本、图片、音频、视频等各种内容。</p><h3 id="文本标签">文本标签</h3><div align="center" alt="image-20210713192339192" style="zoom: 50%;">    <img src="https://gitee.com/TeaSea33/typora-picgo/raw/master/img/20210713192339.png" alt="image-20210713192339192"> </div><p>实体名称</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">h1-h6字号逐渐变小，每个标题独占一行，自带换行效果</span></span><br><span class="line"><span class="comment">h7之后属于无效标签，但是浏览器也不会报错，而是以普通文本的形式展现</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>媒体：为人父母，要不要“持证上岗”<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>媒体：为人父母，要不要“持证上岗 ”<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>媒体：为人父母，要不要“持证上岗”<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--横线标签</span></span><br><span class="line"><span class="comment">width：设置宽度</span></span><br><span class="line"><span class="comment">300px 固定宽度</span></span><br><span class="line"><span class="comment">30% 页面宽度的百分比， 会随着页面宽度的变化而变化</span></span><br><span class="line"><span class="comment">align: 设置位置 left,center,right 默认不写的话就是center居中效果</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span> <span class="attr">width</span>=<span class="string">&quot;300px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span> <span class="attr">width</span>=<span class="string">&quot;30%&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">段落标签</span></span><br><span class="line"><span class="comment">段落效果：段落中文字自动换行，段落和段落之间有空行</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span>26日，“建议父母持合格<span class="symbol">&amp;lt;</span>父母证<span class="symbol">&amp;gt;</span>上岗<span class="symbol">&amp;copy;</span>”冲上微博热搜，迅速引发热议。在正在召开的全国两会上，全国政协委员许洪玲建议在社区举办家长课堂，建立“家长教育指导工作室”。针对准备入小学的家长开展相关课程教育，颁发“合格父母”上岗证随学生档案入学。5月26日，“建议父母持合格父母证上岗”冲上微博热搜，迅速引发热议。在正在召开的全国两会上，全国政协委员许洪玲建议在社区举办家长课堂，建立“家长教育指导工作室”。针对准备入小学的家长开展相关课程教育，颁发“合格父母”上岗证随学生档案入学。5月26日，“建议父母持合格父母证上岗”冲上微博热搜，迅速引发热议。在正在召开的全国两会上，全国政协委员许洪玲建议在社区举办家长课堂，建立“家长教育指导工作室”。针对准备入小学的家长开展相关课程教育，颁发“合格父母”上岗证随学生档案入学。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="symbol">&amp;emsp;</span>26日，“建议父母持合格<span class="symbol">&amp;lt;</span>父母证<span class="symbol">&amp;gt;</span>上岗<span class="symbol">&amp;copy;</span>”冲上微博热搜，迅速引发热议。在正在召开的全国两会上，全国政协委员许洪玲建议在社区举办家长课堂，建立“家长教育指导工作室”。针对准备入小学的家长开展相关课程教育，颁发“合格父母”上岗证随学生档案入学。5月26日，“建议父母持合格父母证上岗”冲上微博热搜，迅速引发热议。在正在召开的全国两会上，全国政协委员许洪玲建议在社区举办家长课堂，建立“家长教育指导工作室”。针对准备入小学的家长开展相关课程教育，颁发“合格父母”上岗证随学生档案入学。5月26日，“建议父母持合格父母证上岗”冲上微博热搜，迅速引发热议。在正在召开的全国两会上，全国政协委员许洪玲建议在社区举办家长课堂，建立“家长教育指导工作室”。针对准备入小学的家长开展相关课程教育，颁发“合格父母”上岗证随学生档案入学。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>26日，“建议父母持合格<span class="symbol">&amp;lt;</span>父母证<span class="symbol">&amp;gt;</span>上岗<span class="symbol">&amp;copy;</span>”冲上微博热搜，迅速引发热议。在正在召开的全国两会上，全国政协委员许洪玲建议在社区举办家长课堂，建立“家长教育指导工作室”。针对准备入小学的家长开展相关课程教育，颁发“合格父母”上岗证随学生档案入学。5月26日，“建议父母持合格父母证上岗”冲上微博热搜，迅速引发热议。在正在召开的全国两会上，全国政协委员许洪玲建议在社区举办家长课堂，建立“家长教育指导工作室”。针对准备入小学的家长开展相关课程教育，颁发“合格父母”上岗证随学生档案入学。5月26日，“建议父母持合格父母证上岗”冲上微博热搜，迅速引发热议。在正在召开的全国两会上，全国政协委员许洪玲建议在社区举办家长课堂，建立“家长教育指导工作室”。针对准备入小学的家长开展相关课程教育，颁发“合格父母”上岗证随学生档案入学。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--加粗倾斜下划线--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">b</span>&gt;</span>加粗<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">i</span>&gt;</span>倾斜<span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">u</span>&gt;</span>下划线<span class="tag">&lt;/<span class="name">u</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">i</span>&gt;</span><span class="tag">&lt;<span class="name">u</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>加粗倾斜下划线<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">u</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--一箭穿心--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">del</span>&gt;</span>谭颖<span class="tag">&lt;/<span class="name">del</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--预编译标签：在页面上显示原样效果--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pre</span>&gt;</span></span><br><span class="line">    public static void main(string[] args)&#123;</span><br><span class="line">    stopThinkingAboutHer();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">pre</span>&gt;</span>    </span><br><span class="line">    <span class="comment">&lt;!--换行--&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--字体标签--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">&quot;aqua&quot;</span> <span class="attr">size</span>= <span class="string">&quot;7&quot;</span> <span class="attr">face</span>=<span class="string">&quot;黑体&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行效果：</p><img src="HTML/image-20220512231440829.png" alt="image-20220512231440829" style="zoom:50%;" /><h3 id="多媒体标签">多媒体标签</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--图片</span></span><br><span class="line"><span class="comment">                        src:引入图片的位置</span></span><br><span class="line"><span class="comment">                                引入本地资源</span></span><br><span class="line"><span class="comment">                                引入网络资源</span></span><br><span class="line"><span class="comment">                        width:设置宽度</span></span><br><span class="line"><span class="comment">                        height:设置高度</span></span><br><span class="line"><span class="comment">                        注意:一般高度和宽度只设置一个即可，另一个会按照比例自动适应</span></span><br><span class="line"><span class="comment">                        title:鼠标悬浮在图片上的时候的提示语，默认情况下（没有设置alt属性） 图片如果加载失败那么提示语也是title的内容</span></span><br><span class="line"><span class="comment">                        alt:图片加载失败的提示语</span></span><br><span class="line"><span class="comment">                --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;img/ss6.jpg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;300px&quot;</span> <span class="attr">title</span>=<span class="string">&quot;这是一个美女小姐姐&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;图片加载失败&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=1833909874,761626004&amp;fm=26&amp;gp=0.jpg&quot;</span> /&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--音频--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">embed</span> <span class="attr">src</span>=<span class="string">&quot;music/我要你.mp3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">embed</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--视频--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">embed</span> <span class="attr">src</span>=<span class="string">&quot;video/周杰伦 - 说好的幸福呢.mp4&quot;</span> <span class="attr">width</span>=<span class="string">&quot;500px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;500px&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">embed</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">embed</span> <span class="attr">src</span>=<span class="string">&quot;//player.video.iqiyi.com/38913f9ed7358c0933e82a03d9b26ec1/0/0/v_19rv8qeokk.swf-albumId=9194699400-tvId=9194699400-isPurchase=0-cnId=undefined&quot;</span> <span class="attr">allowFullScreen</span>=<span class="string">&quot;true&quot;</span> <span class="attr">quality</span>=<span class="string">&quot;high&quot;</span> <span class="attr">width</span>=<span class="string">&quot;480&quot;</span> <span class="attr">height</span>=<span class="string">&quot;350&quot;</span> <span class="attr">align</span>=<span class="string">&quot;middle&quot;</span> <span class="attr">allowScriptAccess</span>=<span class="string">&quot;always&quot;</span> <span class="attr">type</span>=<span class="string">&quot;application/x-shockwave-flash&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">embed</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="超链接标签">超链接标签</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--超链接标签：作用：实现页面的跳转功能</span></span><br><span class="line"><span class="comment">                        href:控制跳转的目标位置</span></span><br><span class="line"><span class="comment">                        target:_self 在自身页面打开 （默认效果也是在自身页面打开）    _blank 在空白页面打开</span></span><br><span class="line"><span class="comment">                --&gt;</span> </span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;文本标签.html&quot;</span>&gt;</span>这是一个超链接01<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="comment">&lt;!--跳转到本地资源--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>这是一个超链接02<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="comment">&lt;!--跳转到自身页面--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;abc&quot;</span>&gt;</span>这是一个超链接03<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="comment">&lt;!--跳转的目标找不到，提示找不到资源--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.baidu.com&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_self&quot;</span>&gt;</span>这是一个超链接04<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="comment">&lt;!--跳转到网络资源--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.baidu.com&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>这是一个超链接05<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="comment">&lt;!--跳转到网络资源--&gt;</span></span><br><span class="line">                </span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.baidu.com&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;img/ss.jpg&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="列表标签">列表标签</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--无序列表:</span></span><br><span class="line"><span class="comment">                        type:可以设置列表前图标的样式   type=&quot;square&quot;</span></span><br><span class="line"><span class="comment">                        如果想要更换图标样式，需要借助css技术： style=&quot;list-style:url(img/act.jpg) ;&quot;</span></span><br><span class="line"><span class="comment">                --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h1</span>&gt;</span>起床以后需要做的事<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ul</span> <span class="attr">type</span>=<span class="string">&quot;square&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>睁眼<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>穿衣服<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>上厕所<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>吃早饭<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>洗漱<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>出门<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--有序列表:</span></span><br><span class="line"><span class="comment">                        type:可以设置列表的标号：1,a,A,i,I</span></span><br><span class="line"><span class="comment">                        start:设置起始标号</span></span><br><span class="line"><span class="comment">                --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h1</span>&gt;</span>学习java的顺序<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ol</span> <span class="attr">type</span>=<span class="string">&quot;A&quot;</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>JAVASE<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>ORACLE<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>MYSQL<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>HTML<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>CSS<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span>JS<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="表格标签">表格标签</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--表格：4行4列</span></span><br><span class="line"><span class="comment">                        table:表格</span></span><br><span class="line"><span class="comment">                        tr:行</span></span><br><span class="line"><span class="comment">                        td:单元格</span></span><br><span class="line"><span class="comment">                        th:特殊单元格：表头效果：加粗，居中</span></span><br><span class="line"><span class="comment">                        默认情况下表格是没有边框的，通过属性来增加表框：</span></span><br><span class="line"><span class="comment">                        border:设置边框大小</span></span><br><span class="line"><span class="comment">                        cellspacing：设置单元格和边框之间的空隙</span></span><br><span class="line"><span class="comment">                        align=&quot;center&quot;  设置居中</span></span><br><span class="line"><span class="comment">                        background 设置背景图片 background=&quot;img/ss.jpg&quot;</span></span><br><span class="line"><span class="comment">                        bgcolor :设置背景颜色</span></span><br><span class="line"><span class="comment">                        rowspan:行合并</span></span><br><span class="line"><span class="comment">                        colspan：列合并</span></span><br><span class="line"><span class="comment">                --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1px&quot;</span> <span class="attr">cellspacing</span>=<span class="string">&quot;0px&quot;</span> <span class="attr">width</span>=<span class="string">&quot;400px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;300px&quot;</span> <span class="attr">bgcolor</span>=<span class="string">&quot;darkseagreen&quot;</span> &gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">tr</span> <span class="attr">bgcolor</span>=<span class="string">&quot;bisque&quot;</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">th</span>&gt;</span>学号<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">th</span>&gt;</span>年纪<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">th</span>&gt;</span>成绩<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">td</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span>1001<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">td</span>&gt;</span>丽丽<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">td</span>&gt;</span>19<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">td</span> <span class="attr">rowspan</span>=<span class="string">&quot;3&quot;</span>&gt;</span>90.5<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span>2006<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">td</span>&gt;</span>30<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">td</span>&gt;</span>3007<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">td</span>&gt;</span>小明<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">td</span>&gt;</span>18<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>结果：</p><img src="HTML/20210713191848.png" alt="image-20210713191835355" style="zoom: 67%;" /><h2 id="框架">框架</h2><h3 id="内嵌框架">内嵌框架</h3><p>内嵌框架是用于在网页中嵌入一个网页并让它在网页中显示.<br>添加内嵌框架的语法:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot; URL &quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!--URL --- 指定独立网页的路径--&gt;</span></span><br></pre></td></tr></table></figure><h4 id="实例一：展示商品">实例一：展示商品</h4><ul><li><p>首页</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;音乐导航.html&quot;</span> <span class="attr">height</span>=<span class="string">&quot;700px&quot;</span> <span class="attr">width</span>=<span class="string">&quot;30%&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;展示页面.html&quot;</span> <span class="attr">name</span> =<span class="string">&quot;iframe_my&quot;</span> <span class="attr">height</span>=<span class="string">&quot;700px&quot;</span> <span class="attr">width</span>=<span class="string">&quot;67%&quot;</span>  <span class="attr">src</span>=<span class="string">&quot;img/肆无忌惮.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>目录页</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>音乐导航<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;img/肆无忌惮.png&quot;</span> <span class="attr">target</span>=<span class="string">&quot;iframe_my&quot;</span>&gt;</span>肆无忌惮 ---薛之谦<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;img/梦伴.png&quot;</span> <span class="attr">target</span>=<span class="string">&quot;iframe_my&quot;</span>&gt;</span>梦伴 ---李悦君<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;img/stay.png&quot;</span> <span class="attr">target</span>=<span class="string">&quot;iframe_my&quot;</span>&gt;</span>stay ---The kid LAROL/Justin Bieber<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;img/Blue&amp;Grey.png&quot;</span> <span class="attr">target</span>=<span class="string">&quot;iframe_my&quot;</span>&gt;</span>Blue&amp;Grey ---BTS<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>展示页</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        这是展示列表</span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>效果：</p><img src="HTML/20210713203134.png" alt="image-20210713203134473" style="zoom: 33%;" /></li></ul><h4 id="实例二：邮箱">实例二：邮箱</h4><h5 id="登录首页">登录首页</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">&quot;cornflowerblue&quot;</span> <span class="attr">size</span>= <span class="string">&quot;3&quot;</span> <span class="attr">face</span>=<span class="string">&quot;黑体&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">用户名<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">密<span class="symbol">&amp;emsp;</span>码<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;邮箱首页.html&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>效果：</p><img src="HTML/20210713211204.png" alt="image-20210713211204526" style="zoom:50%;" /><h5 id="邮箱页">邮箱页</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--邮箱上侧的页面--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;邮箱上侧.html&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;middle&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--邮箱左侧页面--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;邮箱左侧.html&quot;</span> <span class="attr">width</span>=<span class="string">&quot;20%&quot;</span> <span class="attr">height</span>=<span class="string">&quot;500px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;left&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--邮箱右侧页面--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;邮箱右侧.html&quot;</span> <span class="attr">name</span>=<span class="string">&quot;if1&quot;</span> <span class="attr">width</span>=<span class="string">&quot;78%&quot;</span> <span class="attr">height</span>=<span class="string">&quot;500px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;right&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>上侧</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">&quot;blueviolet&quot;</span> <span class="attr">face</span>=<span class="string">&quot;黑体&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">                欢迎来到TeaSea33的邮箱！！！</span><br><span class="line">            <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>左侧</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">&quot;cornflowerblue&quot;</span> <span class="attr">size</span>= <span class="string">&quot;5&quot;</span> <span class="attr">face</span>=<span class="string">&quot;黑体&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;img/写信.png&quot;</span> <span class="attr">target</span>=<span class="string">&quot;if1&quot;</span>&gt;</span></span><br><span class="line">                        写信</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;img/收信箱.png&quot;</span> <span class="attr">target</span>=<span class="string">&quot;if1&quot;</span>&gt;</span></span><br><span class="line">                        收信箱</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;img/垃圾箱.png&quot;</span> <span class="attr">target</span>=<span class="string">&quot;if1&quot;</span>&gt;</span></span><br><span class="line">                        垃圾箱</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>右侧</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        展示页面</span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果</p><img src="HTML/20210713211612.png" alt="image-20210713211612138" style="zoom: 25%;" /><h3 id="框架集合">框架集合</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--框架集合：和body是并列的概念，不要将框架集合放入body中--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">frameset</span> <span class="attr">rows</span>=<span class="string">&quot;20%,*,30%&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">frame</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">frameset</span> <span class="attr">cols</span>=<span class="string">&quot;30%,40%,*&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">frame</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">frame</span> <span class="attr">src</span>=<span class="string">&quot;index.html&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">frame</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">frameset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">frameset</span> <span class="attr">cols</span>=<span class="string">&quot;50%,*&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">frame</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">frame</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">frameset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">frameset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>将上面的页面改为</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">frameset</span> <span class="attr">rows</span>=<span class="string">&quot;20%,*&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">frame</span> <span class="attr">src</span>=<span class="string">&quot;邮箱上侧.html&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;middle&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">frameset</span> <span class="attr">cols</span>=<span class="string">&quot;30%,*&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">frame</span> <span class="attr">src</span>=<span class="string">&quot;邮箱左侧.html&quot;</span> <span class="attr">width</span>=<span class="string">&quot;20%&quot;</span> <span class="attr">height</span>=<span class="string">&quot;500px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;left&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">frame</span> <span class="attr">src</span>=<span class="string">&quot;邮箱右侧.html&quot;</span> <span class="attr">name</span>=<span class="string">&quot;if1&quot;</span> <span class="attr">width</span>=<span class="string">&quot;78%&quot;</span> <span class="attr">height</span>=<span class="string">&quot;500px&quot;</span> <span class="attr">align</span>=<span class="string">&quot;right&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">frameset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">frameset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Form表单">Form表单</h2><p>​表单在 Web 网页中用来给访问者填写信息，从而能采集客户端信息，使网页具有交互的功能。一般是将表单设计在一个Html 文档中，当用户填写完信息后做**提交(submit)**操作，于是表单的内容就从客户端的浏览器传送到服务器上，经过服务器上程序处理后，再将用户所需信息传送回客户端的浏览器上，这样网页就具有了交互性。这里我们只讲怎样使用Html 标志来设计表单。<br>​所有的用户输入内容的地方都用表单来写，如登录注册、搜索框。<br>​一个表单一般应该包含用户填写信息的输入框,提交按钮等，这些输入框,按钮叫做控件,表单很像容器,它能够容纳各种各样的控件。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>＝&quot;<span class="attr">url</span>&quot; <span class="attr">method</span>=<span class="string">get|post</span> <span class="attr">name</span>=<span class="string">&quot;myform&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">-name：表单提交时的名称</span><br><span class="line">-action：提交到的地址</span><br><span class="line">-method：提交方式，有get和post两种，默认为get</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--定义form表单</span></span><br><span class="line"><span class="comment">【1】action属性</span></span><br><span class="line"><span class="comment">地址栏信息：</span></span><br><span class="line"><span class="comment">http://127.0.0.1:8020/Form表单/aaa?username=admin&amp;pwd=chcsiu</span></span><br><span class="line"><span class="comment">？之前是提交的资源的目的地址</span></span><br><span class="line"><span class="comment">http:信息交互遵照http协议</span></span><br><span class="line"><span class="comment">127.0.0.1:代表本机的IP地址</span></span><br><span class="line"><span class="comment">8020:端口号---HBuilder内置服务器的端口号</span></span><br><span class="line"><span class="comment">Form表单:指的是你项目的名字</span></span><br><span class="line"><span class="comment">PS:浏览器的地址栏不支持中文，都会转为编码传送，如果在地址栏看到中文，只是当前浏览器给的一个友好展示</span></span><br><span class="line"><span class="comment">？之后是提交的具体数据</span></span><br><span class="line"><span class="comment">username=admin&amp;pwd=chcsiu</span></span><br><span class="line"><span class="comment">我们写的文本框和密码框都要加入一个属性：name</span></span><br><span class="line"><span class="comment">然后name属性和具体录入的信息会拼成一个键值对的形式</span></span><br><span class="line"><span class="comment">多个键值对之间，用&amp;符号进行拼接</span></span><br><span class="line"><span class="comment">PS:只有form表单中的内容才会被收集并提交</span></span><br><span class="line"><span class="comment">【2】 method属性 （默认情况下值为get）</span></span><br><span class="line"><span class="comment">get 提交的数据可见 不安全 提交数据长度有限制 效率高</span></span><br><span class="line"><span class="comment">post 提交的数据不可见 安全 提交的数据 效率低</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;aaa&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">用户名 ：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--提交按钮--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">用户名2：<span class="tag">&lt;<span class="name">input</span>  <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>效果：</p><img src="HTML/20210714093952.png" alt="image-20210714093951886" style="zoom:33%;" /> <h4 id="实例：模仿百度搜索">实例：模仿百度搜索</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>百度一下你就知道<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">sizes</span>=<span class="string">&quot;any&quot;</span> <span class="attr">mask</span> <span class="attr">href</span>=<span class="string">&quot;//www.baidu.com/img/baidu_85beaf5496f291521eb75ba38eacbd87.svg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--百度的连接</span></span><br><span class="line"><span class="comment">https://www.baidu.com/s(找到action)</span></span><br><span class="line"><span class="comment">?</span></span><br><span class="line"><span class="comment">...&amp;wd=java&amp;... (找到文本框名)</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://www.baidu.com/s&quot;</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--文本框--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;wd&quot;</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--提交按钮--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;百度一下&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="表单元素">表单元素</h3><h4 id="1-文本框">1. 文本框</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--文本框</span></span><br><span class="line"><span class="comment">input标签使用很广泛，通过type属性的不同性，来表现不通过的形态，表单元素必须有一个属性：name有了name才可以提交书数据，才可以采集数据，然后提交的时候以键值对的形式拼到一起。</span></span><br><span class="line"><span class="comment">value:就是文本框中的具体内容;键值对：name=value的形式</span></span><br><span class="line"><span class="comment">placeholder--默认提示语</span></span><br><span class="line"><span class="comment">readonly--只读：无法更改</span></span><br><span class="line"><span class="comment">写法：readonly=&quot;true&quot;；readonly；readonly=&quot;readonly&quot;</span></span><br><span class="line"><span class="comment">disabled--禁用：不能提交</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;uname&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入身份证信息&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;uname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span> <span class="attr">readonly</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;uname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span> <span class="attr">readonly</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>效果：</p><img src="HTML/20210714194452.png" style="zoom: 50%;" /><h4 id="2-密码框">2. 密码框</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--密码框--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>效果：</p><img src="HTML/20210714194418.png" alt="image-20210714194418873" style="zoom:50%;" /><h4 id="3-按钮">3. 按钮</h4><h5 id="普通按钮">普通按钮</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--普通按钮：没有什么效果就是可以点击，js可以加入事件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;普通&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>效果：</p><img src="HTML/20210714195057.png" alt="image-20210714195057422" style="zoom:50%;" /><h5 id="单选按钮">单选按钮</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--单选按钮</span></span><br><span class="line"><span class="comment">注意：一组当选按钮，必须通过name属性来控制，让它们在一个分组中，然后在一个分组里只能选择一个</span></span><br><span class="line"><span class="comment">正常状态下，提交数据为:gender=on,后台不能区分你提交的数据</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">性别：</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> <span class="attr">checked</span>/&gt;</span>男</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>/&gt;</span>女<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>效果：</p><img src="HTML/20210714194743.png" alt="image-20210714194743474" style="zoom:50%;" /><h5 id="多选按钮">多选按钮</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--多选按钮</span></span><br><span class="line"><span class="comment">必须通过name属性来控制，让它们在一个分组中，然后在一个分组里可以选择多个</span></span><br><span class="line"><span class="comment">不同的选项的value值要控制为不同，这样后台接收就可以区分了</span></span><br><span class="line"><span class="comment">多个选项提交的时候，键值对用&amp;符号进行拼接：例如下：</span></span><br><span class="line"><span class="comment">favlan=1&amp;favlan=3</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;favlan&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span>java</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;favlan&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>/&gt;</span>python</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;favlan&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>/&gt;</span>php</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;favlan&quot;</span><span class="attr">value</span>=<span class="string">&quot;&quot;</span>/&gt;</span>c#</span><br></pre></td></tr></table></figure><p>效果：</p><img src="HTML/20210714202438.png" alt="image-20210714202438190" style="zoom:50%;" /><h5 id="图片按钮">图片按钮</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--特殊按钮：图片按钮 点击是可以提交的--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;image&quot;</span> <span class="attr">src</span>=<span class="string">&quot;img/1.jpg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100px&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h5 id="重置按钮">重置按钮</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--特殊按钮：重置按钮：将页面恢复到初始状态--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;reset&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h5 id="提交按钮">提交按钮</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--特殊按钮：提交按钮：具备提交功能--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="4-下拉列表">4.下拉列表</h4><p>select</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--下拉列表</span></span><br><span class="line"><span class="comment">selected 默认选中</span></span><br><span class="line"><span class="comment">multiple 多选</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">你喜欢的城市</span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;city&quot;</span> <span class="attr">multiple</span>=<span class="string">&quot;multiple&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span>&gt;</span>---请选择---<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>成都市<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span> <span class="attr">selected</span>=<span class="string">&quot;selected&quot;</span>&gt;</span>北京市<span class="tag">&lt;/<span class="name">option</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span>&gt;</span>重庆市<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;4&quot;</span>&gt;</span>广州市<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果：</p><img src="HTML/20210714211104.png" alt="image-20210714211104496" style="zoom:50%;" /><h4 id="5-多行文本框">5.多行文本框</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--多行文本框</span></span><br><span class="line"><span class="comment">利用css样式来控制大小不可变：style=&quot;resize: none;&quot;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">自我介绍：</span><br><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">style</span>=<span class="string">&quot;resize: none;&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;10&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;30&quot;</span>&gt;</span>请在这里填写信息。。<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>效果：</p><img src="HTML/20210714195641.png" alt="image-20210714195641589" style="zoom: 50%;" /><h4 id="6-文件">6.文件</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;文件&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>效果：</p><img src="HTML/20210714211148.png" alt="image-20210714211148820" style="zoom: 33%;" /><img src="HTML/20210714211226.png" alt="image-20210714211226032" style="zoom: 67%;" /><h4 id="7-隐藏域">7.隐藏域</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--隐藏域--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden &quot;</span> <span class="attr">name</span>=<span class="string">&quot;uname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;12324&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>效果：</p><img src="HTML/20210714202249.png" alt="image-20210714202249659" style="zoom:50%;" /><h4 id="8-label标签">8.label标签</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--label标签</span></span><br><span class="line"><span class="comment">一般会在想要获得焦点的标签上加入一个id属性，然后label中的for属性跟id配合使用。</span></span><br><span class="line"><span class="comment">点击用户名 光标就会到用户名对应的文本框里面</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;uname&quot;</span>&gt;</span>用户名：<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;uername&quot;</span> <span class="attr">id</span>=<span class="string">&quot;uname&quot;</span>/&gt;</span>            </span><br></pre></td></tr></table></figure><h3 id="HTML5新增">HTML5新增</h3><h4 id="增加校验">增加校验</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">html5的类型可以增加校验</span><br><span class="line"><span class="comment">&lt;!--email--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--url--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;url&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--color--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;color&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--number:</span></span><br><span class="line"><span class="comment">min:最小值</span></span><br><span class="line"><span class="comment">max:最大值</span></span><br><span class="line"><span class="comment">step:步长</span></span><br><span class="line"><span class="comment">value:默认值：一定在步长的范围中，否则不能提交</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">min</span>=<span class="string">&quot;1&quot;</span> <span class="attr">max</span>=<span class="string">&quot;10&quot;</span> <span class="attr">step</span>=<span class="string">&quot;3&quot;</span> <span class="attr">value</span>=<span class="string">&quot;4&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--range--&gt;</span></span><br><span class="line">1<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;range&quot;</span> <span class="attr">min</span>=<span class="string">&quot;1&quot;</span> <span class="attr">max</span>=<span class="string">&quot;10&quot;</span> <span class="attr">name</span>=<span class="string">&quot;range&quot;</span> <span class="attr">step</span>=<span class="string">&quot;3&quot;</span>/&gt;</span>10</span><br><span class="line"><span class="comment">&lt;!--date--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;date&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--month--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;month&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--week--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;week&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="新增属性">新增属性</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">HTML5新增属性：</span></span><br><span class="line"><span class="comment">multiple：多选</span></span><br><span class="line"><span class="comment">placehoder:默认提示</span></span><br><span class="line"><span class="comment">autofocus:自动获取焦点</span></span><br><span class="line"><span class="comment">required:必填项</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">multiple</span>=<span class="string">&quot;multiple&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;11111&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">autofocus:</span>&quot;<span class="attr">autofocus</span>&quot; /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">required</span>=<span class="string">&quot;required&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--提交按钮--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDBC</title>
      <link href="/2021/06/07/JDBC/"/>
      <url>/2021/06/07/JDBC/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=3f3b0273-9333-77a8-8735-7edf2dbaff61</cover>
      <date>Mon Jun 07 2021 09:47:10 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>引入</h1><h2 id="1-概念">1. 概念</h2><p><strong>JDBC</strong>（Java DataBase Connectivity,  Java数据库连接) ,是一种用于执行SQL语句的Java API，为多种关系数据库提供统一访问,它由一组用Java语言编写的类和接口组成</p><span id="more"></span><h2 id="2-依赖">2. 依赖</h2><h3 id="导入依赖">导入依赖</h3><p>src下创建一个文件夹命名lib，然后把依赖包复制到里面，右键create library</p><img src="JDBC/20210704112134.png" alt="image-20210704112134768" style="zoom:50%;" /><h3 id="移除依赖">移除依赖</h3><p>setting ——&gt;project structure</p><img src="JDBC/20210704112049.png" alt="image-20210704112049391" style="zoom: 33%;" /><h2 id="3-实例">3. 实例</h2><h4 id="1：加载一个Driver驱动">1：加载一个Driver驱动</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.加载驱动 Driver</span></span><br><span class="line"><span class="type">Driver</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.mysql.cj.jdbc.Driver();</span><br></pre></td></tr></table></figure><h4 id="2：创建数据库连接（Connection）">2：创建数据库连接（Connection）</h4><ul><li><p>url</p><p>格式——协议**://<strong>ip</strong>:<strong>端口/资源路径</strong>?<strong>参数名</strong>=<strong>参数值</strong>&amp;<strong>参数名=参数值</strong>&amp;…**</p><ul><li>协议         jdbc:mysql</li><li>IP          127.0.0.1/localhost</li><li>端口号       3306<ul><li>数据库名字   mydb</li><li>参数  useSSL(是否使用SSL)、useUnicode(是否使用unicod)、characterEncoding(使用unicode类型)、serverTimezone(时区)</li></ul></li></ul></li><li><p>user</p></li><li><p>password</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3.获得链接</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 传入三个参数：url，user，password</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mytestdb?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/ShangHai&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url,user,password);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="3：创建SQL命令发送器Statement">3：创建SQL命令发送器Statement</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//4.获得语句对象statement</span></span><br><span class="line"><span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br></pre></td></tr></table></figure><h4 id="4：通过Statement发送SQL命令并得到结果">4：通过Statement发送SQL命令并得到结果</h4><p><strong>statement.executeUpdate</strong> 在sql操作insert、delete、update时使用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//5.执行SQL语句，返回结果</span></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into dept values(50,&#x27;教学部&#x27;,&#x27;BeiJing&#x27;)&quot;</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> statement.executeUpdate(sql); <span class="comment">//insert delete update</span></span><br><span class="line">System.out.println(<span class="string">&quot;影响行数为&quot;</span>+ row);</span><br></pre></td></tr></table></figure><h4 id="5：关闭数据库资源ResultSet-Statement-Connection">5：关闭数据库资源ResultSet  Statement  Connection</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//6.释放资源</span></span><br><span class="line">statement.close();</span><br><span class="line">connection.close();</span><br></pre></td></tr></table></figure><p>结果</p><img src="JDBC/20210704123012.png" alt="image-20210704123012385" style="zoom:50%;" /><h2 id="4-常见的异常分析">4. 常见的异常分析</h2><p>MySQL8中数据库连接的四个参数有两个发生了变化</p><p>String driver = “com.mysql.cj.jdbc.Driver”;</p><p>String url = “jdbc:mysql://127.0.0.1:3306/mydb?useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai”;</p><p>或者String url = “…serverTimezone=GMT%2B8”;</p><ul><li><strong>错误1：Exception in thread “main” java.lang.ClassNotFoundException: com.mysql.jdbc2.Driver</strong></li></ul><p>原因：没有添加jar包或者com.mysql.jdbc2.Driver路径错误</p><ul><li><strong>错误2：Exception in thread “main” java.sql.SQLException:No suitable driver found for jbdc:mysql://127.0.0.1:3306/stumgr</strong></li></ul><p>原因：url错误</p><ul><li><strong>错误3：Exception in thread “main” java.sql.SQLException:</strong></li></ul><p>Access denied for user ‘root’@‘localhost’ (using password: YES)</p><p>原因：用户名或者密码错误</p><ul><li><strong>错误4：Exception in thread “main” com.mysql.jdbc.exceptions</strong></li><li><img src="JDBC/20210705111903.png" alt="image-20210704153100091"></li></ul><p>.jdbc4.MySQLIntegrityConstraintViolationException:Duplicate entry ‘90’ for key ‘PRIMARY’</p><p>原因：主键冲突</p><ul><li><p><strong>错误5：Public Key Retrieval is not allowed</strong></p><p>如果用户使用 sha256_password 认证，密码在传输过程中必须使用 TLS 协议保护，但是如果 RSA 公钥不可用，可以使用服务器提供的公钥；可以在连接中通过 ServerRSAPublicKeyFile 指定服务器的 RSA 公钥，或者AllowPublicKeyRetrieval=True参数以允许客户端从服务器获取公钥；但是需要注意的是 AllowPublicKeyRetrieval=True可能会导致恶意的代理通过中间人攻击(MITM)获取到明文密码，所以默认是关闭的，必须显式开启<br>在jdbc连接添加上参数<strong>allowPublicKeyRetrieval=true</strong>即可，注意参数间用&amp;</p></li></ul><p>加参数allowPublicKeyRetrieval=true</p><h1>1. 驱动的加载</h1><ul><li><p>在查看Driver的源代码时我们发现,该类内部有一个静态代码块,在代码块中就是在实例化一个驱动并在驱动中心注册.静态代码块会在类进入内存时执行,也就是说,我们只要让该类字节码进入内存,就会自动完成注册,不需要我们手动去new</p><img src="JDBC/20210704145529.png" alt="image-20210704145529583" style="zoom:50%;" /><img src="JDBC/20210704145550.png" alt="image-20210704145550511" style="zoom: 50%;" /></li><li><p>可以通过反射来加载驱动</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//可以通过反射来加载驱动</span></span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br></pre></td></tr></table></figure><p>因为Driver类里面的静态代码块已经注册了驱动，就<strong>不用再单独注册驱动了</strong></p></li><li><p>查看jar包发现,jar包中已经默认配置了驱动类的加载，其实不需要手动加载，程序运行的时候也会自动加载jar包里的类</p><img src="JDBC/20210704150456.png" alt="image-20210704150456396" style="zoom:67%;" /></li></ul><h1>2. 添加异常处理</h1><img src="JDBC/20210704153100.png" alt="image-20210704153100091" style="zoom:67%;" /><p>将需要catch的异常部分 用快捷键<strong>ctrl+alt+T</strong>选择</p><img src="C:/Users/Dell/AppData/Roaming/Typora/typora-user-images/image-20210705110755222.png" alt="image-20210705110755222" style="zoom:50%;" /><p>把最后处理放在finally里面，分别加上try catch</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestJDBC2</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String driver=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;<span class="comment">//</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mytestdb?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true&quot;</span>;<span class="comment">//</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String user= <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url,user,password);</span><br><span class="line">            statement = connection.createStatement();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into dept values(50,&#x27;教学部&#x27;,&#x27;BeiJing&#x27;)&quot;</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> statement.executeUpdate(sql);</span><br><span class="line">            System.out.println(<span class="string">&quot;影响行数为&quot;</span>+ row);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != statement)&#123; <span class="comment">//statement如果创建失败就不需要关了</span></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    statement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != connection)&#123;<span class="comment">// 同上</span></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>3. JDBC完成CURD</h1><h3 id="删除和修改操作">删除和修改操作</h3><p>和上面实例一样，只需要改sql语句</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from emp where deptno = 20 &quot;</span>;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update dept set dname = &#x27;总部&#x27;,loc=&#x27;BeiJing&#x27; where deptno = 30 &quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="查询操作">查询操作</h3><ul><li>使用的方法是executeQuery()，返回的是一个结果集即表格被抽象成的对象 <strong>resultSet</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from emp&quot;</span>;</span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> statement.executeQuery(sql); </span><br></pre></td></tr></table></figure><ul><li><p>循环获得每一列的数据：</p><p><strong>resultset.next()</strong>：返回当前游标所指的行数据是否为空，如果为不为空，返回true，游标向下移动；为空则返回false，游标不移动</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (resultSet.next())&#123;<span class="comment">//判断游标是否为空</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">empno</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;empno&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">ename</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;ename&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">job</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;job&quot;</span>);</span><br><span class="line">    <span class="type">int</span> <span class="variable">MGR</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;MGR&quot;</span>);</span><br><span class="line">    <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> resultSet.getDate(<span class="string">&quot;hiredate&quot;</span>);</span><br><span class="line">    <span class="type">double</span> <span class="variable">sal</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;SAL&quot;</span>);</span><br><span class="line">    <span class="type">double</span> <span class="variable">comm</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;comm&quot;</span>);</span><br><span class="line">    <span class="type">int</span> <span class="variable">deptno</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;deptno&quot;</span>);</span><br><span class="line">    System.out.println(empno+<span class="string">&quot; &quot;</span>+ename+<span class="string">&quot; &quot;</span>+job+<span class="string">&quot; &quot;</span>+MGR+<span class="string">&quot; &quot;</span>+<span class="string">&quot; &quot;</span>+date+<span class="string">&quot; &quot;</span>+sal+<span class="string">&quot; &quot;</span>+comm+<span class="string">&quot; &quot;</span>+deptno);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ps: 获得的date对象不是util包的，而是sql包的对象</p><ul><li><p>关闭resultSet：</p><p>虽然 Statement 关闭、重新执行或用于从多结果序列中获取下一个结果时，ResultSet将被自动关闭，但是一个好的编程习惯很重要嘛，该关的还是要关。</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="literal">null</span> != resultSet)&#123;</span><br><span class="line">              <span class="keyword">try</span> &#123;</span><br><span class="line">                  resultSet.close();</span><br><span class="line">              &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                  e.printStackTrace();</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br></pre></td></tr></table></figure><h4 id="完整代码">完整代码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.chs.test01;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.Class.forName;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChanHuiShan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-07-05 - 07 - 05 - 16:28</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: com.chs.test01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestJDBC4</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">static</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span><span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mytestdb?&quot;</span> +</span><br><span class="line">            <span class="string">&quot;useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        testQuery();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testQuery</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1.加载驱动</span></span><br><span class="line">            forName(driver);</span><br><span class="line">            <span class="comment">//2.建立连接</span></span><br><span class="line">            connection = DriverManager.getConnection(url,user,password);</span><br><span class="line">            <span class="comment">//3.通过连接搭建statement</span></span><br><span class="line">            statement = connection.createStatement();</span><br><span class="line">            <span class="comment">//4.操作sql</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from emp&quot;</span>;</span><br><span class="line">            resultSet = statement.executeQuery(sql);</span><br><span class="line">            <span class="keyword">while</span> (resultSet.next())&#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">empno</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;empno&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">ename</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;ename&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">job</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;job&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">MGR</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;MGR&quot;</span>);</span><br><span class="line">                <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> resultSet.getDate(<span class="string">&quot;hiredate&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">sal</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;SAL&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">comm</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;comm&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">deptno</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;deptno&quot;</span>);</span><br><span class="line">                System.out.println(empno+<span class="string">&quot; &quot;</span>+ename+<span class="string">&quot; &quot;</span>+job+<span class="string">&quot; &quot;</span>+MGR+<span class="string">&quot; &quot;</span>+<span class="string">&quot; &quot;</span>+date+<span class="string">&quot; &quot;</span>+sal+<span class="string">&quot; &quot;</span>+comm+<span class="string">&quot; &quot;</span>+deptno);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="comment">//关闭resultSet</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != resultSet)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    resultSet.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != statement)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    statement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != connection)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>结果：</p><img src="JDBC/20210705182201.png" alt="image-20210705182200681" style="zoom:50%;" /><h3 id="创建实体类封装结果集">创建实体类封装结果集</h3><p>​该实体类是和数据表格名称和字段是一一对应的类，该类主要用处是存储重数据库中查询出来的数据，除此之外该类无其他功能。</p><h4 id="Emp-java">Emp.java</h4><p>要求：</p><ul><li>类名和表名保持一致</li><li>属性个数和表的列数保持一致</li><li>属性的数据类型和列的数据类型保持一致</li><li>属性名和表格列名保持一致</li><li>所有的属性都是私有的 （出于安全考虑）</li><li>实体类的属性推荐写成包装类 （例如int类型不能赋值为null）</li><li>日期类型建议使用java.util.Date(因为是父类,比较方便使用多态）</li><li>所有的属性都要有get和set方法</li><li>必须具备空参构造器</li><li>实体类需要实现序列化接口（mybatis 分布式）</li><li>实体类中其他构造方法可选</li><li>添加toString方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.chs.entity;</span><br><span class="line"><span class="keyword">import</span> com.sun.scenario.effect.impl.prism.PrRenderInfo;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;<span class="comment">//是java.sql.Date的父类</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChanHuiShan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-07-05 - 07 - 05 - 19:07</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: com.chs.entity</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Emp</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;<span class="comment">//实现序列化接口</span></span><br><span class="line">    <span class="keyword">private</span> Integer empno;</span><br><span class="line">    <span class="keyword">private</span> String ename;</span><br><span class="line">    <span class="keyword">private</span> String job;</span><br><span class="line">    <span class="keyword">private</span> Integer mgr;</span><br><span class="line">    <span class="keyword">private</span> Date hiredate;</span><br><span class="line">    <span class="keyword">private</span> Double sal;</span><br><span class="line">    <span class="keyword">private</span> Double comm;</span><br><span class="line">    <span class="keyword">private</span> Integer deptno;</span><br><span class="line">    <span class="comment">//可以有其他构造方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Emp</span><span class="params">(Integer empno, String ename, String job, Integer mgr, Date hiredate, Double sal, Double comm, Integer deptno)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.empno = empno;</span><br><span class="line">        <span class="built_in">this</span>.ename = ename;</span><br><span class="line">        <span class="built_in">this</span>.job = job;</span><br><span class="line">        <span class="built_in">this</span>.mgr = mgr;</span><br><span class="line">        <span class="built_in">this</span>.hiredate = hiredate;</span><br><span class="line">        <span class="built_in">this</span>.sal = sal;</span><br><span class="line">        <span class="built_in">this</span>.comm = comm;</span><br><span class="line">        <span class="built_in">this</span>.deptno = deptno;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//必须有空参构造器</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Emp</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//set和get方法省略</span></span><br><span class="line">    <span class="comment">//toSting省略</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="TestJDBC-java">TestJDBC.java</h4><p>修改—返回的是Emp的List集合对象：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Emp&gt; <span class="title function_">testQuery</span><span class="params">()</span>&#123;&#125;</span><br></pre></td></tr></table></figure><p>main（）方法里面遍历输出：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="comment">//获得方法里返回的集合</span></span><br><span class="line">    List&lt;Emp&gt; emps = testQuery();</span><br><span class="line">    <span class="comment">//遍历集合</span></span><br><span class="line">    <span class="keyword">for</span>(Emp emp:emps)&#123;</span><br><span class="line">        System.out.println(emp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="完整代码-2">完整代码</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChanHuiShan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-07-05 - 07 - 05 - 16:28</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: com.chs.test01</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestJDBC4</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">static</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span><span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mytestdb?&quot;</span> +</span><br><span class="line">            <span class="string">&quot;useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//获得方法里返回的集合</span></span><br><span class="line">        List&lt;Emp&gt; emps = testQuery();</span><br><span class="line">        <span class="comment">//遍历集合</span></span><br><span class="line">        <span class="keyword">for</span>(Emp emp:emps)&#123;</span><br><span class="line">            System.out.println(emp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Emp&gt; <span class="title function_">testQuery</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        List&lt;Emp&gt; list = <span class="literal">null</span>;<span class="comment">//emp对象的集合初始化</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url,user,password);</span><br><span class="line">            statement = connection.createStatement();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from emp&quot;</span>;</span><br><span class="line">            resultSet = statement.executeQuery(sql);</span><br><span class="line">            list= <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">while</span> (resultSet.next())&#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">empno</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;empno&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">ename</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;ename&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">job</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;job&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">MGR</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;MGR&quot;</span>);</span><br><span class="line">                <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> resultSet.getDate(<span class="string">&quot;hiredate&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">sal</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;SAL&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">comm</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;comm&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">deptno</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;deptno&quot;</span>);</span><br><span class="line">                <span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Emp</span>(empno, ename, job, MGR, date, sal, comm, deptno);<span class="comment">//构造每一行数据对象</span></span><br><span class="line">                list.add(emp);<span class="comment">//将每一行都放入集合中</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != resultSet)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    resultSet.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != statement)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    statement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != connection)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;<span class="comment">//返回集合</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>4. 预编译PreparedStatement</h1><h2 id="使用预编译语句来预防SQL注入攻击">使用预编译语句来预防SQL注入攻击</h2><p>​SQL注入攻击指的是通过构建<strong>特殊的输入</strong>作为<strong>参数</strong>传入<strong>Web应用程序</strong>，而这些输入大都是SQL语法里的一些组合，通过执行SQL语句进而执行攻击者所要的操作，其主要原因是程序没有细致地过滤用户输入的数据，致使非法数据侵入系统。</p><h4 id="模拟登录">模拟登录</h4><p>在前台输入用户名和密码，后台判断信息是否正确，并给出前台反馈信息，前台输出反馈信息。</p><p>具体实现步骤：</p><ul><li><p>创建数据库表</p><img src="JDBC/20210706143739.png" style="zoom:50%;" /></li><li><p>创建实体类</p><img src="JDBC/20210706143810.png" alt="image-20210706143810882" style="zoom:50%;" /></li><li><p>测试类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChanHuiShan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-07-06 - 07 - 06 - 14:13</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: com.chs.test02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestInjection</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">static</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span><span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mytestdb?&quot;</span> +</span><br><span class="line">            <span class="string">&quot;useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入用户名：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> sc.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入密码：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> sc.next();</span><br><span class="line">        <span class="type">Account</span> <span class="variable">account</span> <span class="operator">=</span> getAccount(username, pwd);</span><br><span class="line">        System.out.println(<span class="literal">null</span>!=account?(<span class="string">&quot;登录成功&quot;</span>+<span class="string">&quot;用户信息&quot;</span>+account):<span class="string">&quot;登录失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Account <span class="title function_">getAccount</span><span class="params">(String username,String pwd)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Account</span> <span class="variable">account</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1.加载驱动</span></span><br><span class="line">            forName(driver);</span><br><span class="line">            <span class="comment">//2.建立连接</span></span><br><span class="line">            connection = DriverManager.getConnection(url,user,password);</span><br><span class="line">            <span class="comment">//3.通过连接搭建statement</span></span><br><span class="line">            statement = connection.createStatement();</span><br><span class="line">            <span class="comment">//4.操作sql</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from account where username = &#x27;&quot;</span>+username+<span class="string">&quot;&#x27;and password = &#x27;&quot;</span>+pwd+<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">            resultSet = statement.executeQuery(sql);</span><br><span class="line">            <span class="keyword">while</span> (resultSet.next())&#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">aid</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;aid&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">usernamea</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">pwda</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">                <span class="type">Double</span> <span class="variable">balance</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;balance&quot;</span>);</span><br><span class="line">                account = <span class="keyword">new</span> <span class="title class_">Account</span>(aid,usernamea,pwda,balance);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != resultSet)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    resultSet.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != statement)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    statement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != connection)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> account;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>结果：</p><img src="JDBC/20210706152659.png" alt="image-20210706152659400" style="zoom:50%;" /></li></ul><h4 id="注入攻击">注入攻击</h4><p>构建特殊的输入:</p><p>例如输入密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asdf&#x27;or&#x27;a&#x27;=&#x27;a</span><br></pre></td></tr></table></figure><p>整个sql语句就会变为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from account where username = &#x27;asdf&#x27; and password = &#x27;asdf&#x27;or&#x27;a&#x27;=&#x27;a&#x27;;</span><br></pre></td></tr></table></figure><p>导致含义改变。</p><h4 id="通过预编译语句来预防">通过预编译语句来预防</h4><ul><li>使用PreparedStatement语句对象防止注入攻击<ul><li>PreparedStatement 可以使用 <strong>?</strong> 作为参数的占位符,即使是字符串和日期类型,也不使用单独再添加 <strong>’ ’</strong></li><li>connection.createStatement();获得的是普通语句对象 Statement<br>ction.prepareStatement(sql);可以获得一个预编译语句对象PreparedStatement</li><li>如果SQL语句中有?作为参数占位符号,那么要在执行CURD之前先设置参数<br>***(问号的编号,数据) 方法设置参数</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String sql=<span class="string">&quot;select * from account where username = ? and password = ?&quot;</span>;</span><br><span class="line">preparedStatement = connection.prepareStatement(sql);<span class="comment">//这里已经传入SQL语句</span></span><br><span class="line"><span class="comment">//设置参数</span></span><br><span class="line">preparedStatement.setString(<span class="number">1</span>,username );</span><br><span class="line">preparedStatement.setString(<span class="number">2</span>,pwd );</span><br><span class="line"><span class="comment">//执行CURD</span></span><br><span class="line">resultSet = preparedStatement.executeQuery();<span class="comment">// 这里不需要再传入SQL语句，传了会报错，亲身经历man</span></span><br></pre></td></tr></table></figure><p>效果：</p><img src="JDBC/20210707200554.png" alt="image-20210707200553352" style="zoom:50%;" /><p>原理：</p><p>说白了就是把值当中的所有单引号给<strong>转义</strong>了!这就达到了防止sql注入的目的，说白了mysql驱动的PreparedStatement实现类的<strong>setString()</strong>;方法内部做了单引号的转义，而Statement不能防止sql注入，就是因为它没有把单引号做转义，而是简单粗暴的直接拼接字符串，所以达不到防止sql注入的目的。</p><h2 id="预编译的原理">预编译的原理</h2><h3 id="预编译的开启">预编译的开启</h3><p>值得注意的是,我们的Connector/J 5.0.5及之后useServerPrepStmts默认false,就是默认没有开启预编译,之前默认为true, cachePrepStmts 一直默认为false,需要我们手动设置才可以启用预编译,在开启预编译的同时要同时开启预编译缓存才能带来些许的性能提升.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;jdbc:mysql://localhost:3306/mydb?*****&amp;useServerPrepStmts=true&amp;cachePrepStmts=true&quot;</span>; </span><br></pre></td></tr></table></figure><h3 id="优点">优点</h3><ul><li><p>安全性高,可以避免SQL注入</p></li><li><p>简单不繁琐,不用进行字符串拼接</p></li><li><p>性能高，用在执行多个相同数据库DML操作时,可以减少sql语句的编译次数</p></li></ul><h2 id="预编译实现CURD">预编译实现CURD</h2><h4 id="TestPreparedStatement-java">TestPreparedStatement.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChanHuiShan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-07-06 - 07 - 06 - 19:31</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: com.chs.test03</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestPreparedStatement</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mytestdb?&quot;</span> +</span><br><span class="line">            <span class="string">&quot;useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        testAdd(); <span class="comment">//向emp表中增加一条数据</span></span><br><span class="line">        testUpdate();<span class="comment">//根据工号修改员工表中的数据</span></span><br><span class="line">        testDelete();<span class="comment">//根据工号删除员工表中的数据</span></span><br><span class="line">        testQuery();<span class="comment">//查询名字中包含A的员工信息</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testAdd</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//向emp表中增加一条数据</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into emp values(DEFAULT,?,?,?,?,?,?,?)&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);<span class="comment">//这个时候就要传入语句对象</span></span><br><span class="line">            <span class="comment">//设置参数</span></span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>, <span class="string">&quot;Mark&quot;</span>);</span><br><span class="line">            preparedStatement.setString(<span class="number">2</span>, <span class="string">&quot;MANAGER&quot;</span>);</span><br><span class="line">            preparedStatement.setInt(<span class="number">3</span>, <span class="number">7839</span>);</span><br><span class="line">            preparedStatement.setDate(<span class="number">4</span>, <span class="keyword">new</span> <span class="title class_">Date</span>(System.currentTimeMillis()));</span><br><span class="line">            preparedStatement.setDouble(<span class="number">5</span>, <span class="number">3000.12</span>);</span><br><span class="line">            preparedStatement.setDouble(<span class="number">6</span>, <span class="number">0.0</span>);</span><br><span class="line">            preparedStatement.setDouble(<span class="number">7</span>, <span class="number">30</span>);</span><br><span class="line">            <span class="comment">//执行CURD</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">            System.out.println(<span class="string">&quot;影响行数&quot;</span> + rows);</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">catch</span>()&#123;&#125;<span class="keyword">finally</span>&#123;&#125; </span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testUpdate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//根据工号修改员工表中的数据</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update emp set ename =?,job= ? where empno = ?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);<span class="comment">//这个时候就要传入语句对象</span></span><br><span class="line">            <span class="comment">//设置参数</span></span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>, <span class="string">&quot;John&quot;</span>);</span><br><span class="line">            preparedStatement.setString(<span class="number">2</span>, <span class="string">&quot;ANALYST&quot;</span>);</span><br><span class="line">            preparedStatement.setInt(<span class="number">3</span>, <span class="number">7777</span>);</span><br><span class="line">            <span class="comment">//执行CURD</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">            System.out.println(<span class="string">&quot;影响行数&quot;</span> + rows);</span><br><span class="line">        &#125;<span class="keyword">catch</span>()&#123;&#125;<span class="keyword">finally</span>&#123;&#125;<span class="comment">//这部分都省略，同下</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testDelete</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//根据工号删除员工表中的数据</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from emp where empno = ?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);<span class="comment">//这个时候就要传入语句对象</span></span><br><span class="line">            <span class="comment">//设置参数</span></span><br><span class="line">            preparedStatement.setInt(<span class="number">1</span>, <span class="number">7777</span>);</span><br><span class="line">            <span class="comment">//执行CURD</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> preparedStatement.executeUpdate();</span><br><span class="line">            System.out.println(<span class="string">&quot;影响行数&quot;</span> + rows);</span><br><span class="line">        &#125; <span class="keyword">catch</span>()&#123;&#125;<span class="keyword">finally</span>&#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testQuery</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//查询名字中包含A的员工信息</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        List&lt;Emp&gt; list = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from emp where ename like ?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>,<span class="string">&quot;%A%&quot;</span>);</span><br><span class="line">            resultSet = preparedStatement.executeQuery();</span><br><span class="line">            list= <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">empno</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;empno&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">ename</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;ename&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">job</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;job&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">MGR</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;MGR&quot;</span>);</span><br><span class="line">                <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> resultSet.getDate(<span class="string">&quot;hiredate&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">sal</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;SAL&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">comm</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;comm&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">deptno</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;deptno&quot;</span>);</span><br><span class="line">                <span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Emp</span>(empno, ename, job, MGR, date, sal, comm, deptno);</span><br><span class="line">                list.add(emp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> () &#123;&#125; <span class="keyword">finally</span> &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span>(Emp e:list)&#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>5. 批处理</h1><h2 id="概念">概念</h2><p>​当我们有多条sql语句需要发送到数据库执行的时候，有两种发送方式，一种是执行一条发送一条sql语句给数据库,另一个种是发送一个sql集合给数据库，也就是发送一个批sql到数据库。普通的执行过程是：每处理一条数据，就访问一次数据库；而批处理是：累积到一定数量，再一次性提交到数据库，减少了与数据库的交互次数，所以效率会大大提高,很显然两者的数据库执行效率是不同的，我们发送批处理sql的时候数据库执行效率要高</p><h2 id="Statement和preparedStatement的批处理区别">Statement和preparedStatement的批处理区别</h2><ul><li>statement语句对象实现批处理有如下问题<ul><li>缺点：采用硬编码效率低，安全性较差。</li><li>原理：硬编码，每次执行时相似SQL都会进行编译</li></ul></li><li>PreparedStatement+批处理<ul><li>优点：语句只编译一次，减少编译次数。提高了安全性（阻止了SQL注入）</li><li>原理：相似SQL只编译一次，减少编译次数</li></ul></li></ul><h2 id="批处理开启">批处理开启</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&amp;rewriteBatchedStatements=true&quot;</span></span><br></pre></td></tr></table></figure><h2 id="实例">实例</h2><p>向部门表中增加多条数据</p><p>利用循环添加，并每1000为一批，放入之后清除</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into dept values(default ,?,?)&quot;</span>;</span><br><span class="line">preparedStatement = connection.prepareStatement(sql);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10036</span> i++) &#123;</span><br><span class="line">    preparedStatement.setString(<span class="number">1</span>,<span class="string">&quot;name&quot;</span>);</span><br><span class="line">    preparedStatement.setString(<span class="number">2</span>,<span class="string">&quot;location&quot;</span>);</span><br><span class="line">    <span class="comment">//放进一批里</span></span><br><span class="line">    preparedStatement.addBatch();</span><br><span class="line">    <span class="keyword">if</span>(i%<span class="number">1000</span>==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//每1000为一批，放入后清除</span></span><br><span class="line">        preparedStatement.executeBatch();</span><br><span class="line">        preparedStatement.clearBatch();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//没有整除完的部分</span></span><br><span class="line">preparedStatement.executeBatch();</span><br><span class="line">preparedStatement.addBatch();</span><br></pre></td></tr></table></figure><h1>6.JDBC控制事务</h1><p>主要是在学习如何让多个数据库操作成为一个整体，实现要么全部执行成功，要么全部都不执行</p><p>在JDBC中，事务操作是自动提交，一条对数据库的DML代表一项事务操作</p><p>转账的操作：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChanHuiShan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-07-08 - 07 - 08 - 16:02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: com.chs.test05</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestTransaction</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mytestdb?&quot;</span> +</span><br><span class="line">            <span class="string">&quot;useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;&quot;</span> +    <span class="string">&quot;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true&amp;useServerPrepStmts=true&amp;cachePrepStmts=true&amp;rewriteBatchedStatements=true&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        testTransaction();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//定义一个方法，向部门表增加多条数据</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testTransaction</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update account set balance = balance-? where aid =?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            <span class="comment">//转出</span></span><br><span class="line">            preparedStatement.setDouble(<span class="number">1</span>,<span class="number">100</span>);</span><br><span class="line">            preparedStatement.setInt(<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">            <span class="comment">//执行</span></span><br><span class="line">            preparedStatement.executeUpdate();</span><br><span class="line">            <span class="comment">//转入</span></span><br><span class="line">            preparedStatement.setDouble(<span class="number">1</span>,-<span class="number">100</span>);</span><br><span class="line">            preparedStatement.setInt(<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">            <span class="comment">//执行</span></span><br><span class="line">            preparedStatement.executeUpdate();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    preparedStatement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != connection) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>为了保证多个sql语句一起执行，使用事务。</p><p>在JDBC中，事务操作是<strong>自动提交</strong>。一条对数据库的DML(insert、update、delete)代表一项事务操作,操作成功后，系统将自动调用commit()提交，否则自动调用rollback()回滚。</p><h3 id="设置事务手动提交">设置事务手动提交</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">            forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">            <span class="comment">//设置事务手动提交</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update account set balance = balance-? where aid =?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            <span class="comment">//转出</span></span><br><span class="line">            preparedStatement.setDouble(<span class="number">1</span>,<span class="number">100</span>);</span><br><span class="line">            preparedStatement.setInt(<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">            preparedStatement.executeUpdate();</span><br><span class="line">      <span class="comment">//出现异常</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">            <span class="comment">//转入</span></span><br><span class="line">            preparedStatement.setDouble(<span class="number">1</span>,-<span class="number">100</span>);</span><br><span class="line">            preparedStatement.setInt(<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">            preparedStatement.executeUpdate();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">//回滚操作</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span>!=connection)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.rollback();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException ex) &#123;</span><br><span class="line">                    ex.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">//提交操作</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span>!=connection)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.commit();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    preparedStatement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != connection) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h3 id="设置回滚点">设置回滚点</h3><p>作用是保证回滚点之前的数据更改生效，回滚点以后的数据更改操作就会无效。</p><p>并且回滚点的操作值可以进行更改和设置。</p><ul><li>在增加数据操作里面，每一千设置一个回滚点：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">connection.setAutoCommit(<span class="literal">false</span>);<span class="comment">//设置手动提交</span></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into dept values(default ,?,?)&quot;</span>;</span><br><span class="line">preparedStatement = connection.prepareStatement(sql);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10036</span>; i++) &#123;</span><br><span class="line">    preparedStatement.setString(<span class="number">1</span>,<span class="string">&quot;name&quot;</span>);</span><br><span class="line">    preparedStatement.setString(<span class="number">2</span>,<span class="string">&quot;location&quot;</span>);</span><br><span class="line">    preparedStatement.addBatch();</span><br><span class="line">    <span class="keyword">if</span>(i%<span class="number">1000</span>==<span class="number">0</span>)&#123;</span><br><span class="line">        preparedStatement.executeBatch();</span><br><span class="line">        preparedStatement.clearBatch();</span><br><span class="line">        <span class="comment">//每一千条设置回滚点</span></span><br><span class="line">        <span class="type">Savepoint</span> <span class="variable">savepoint</span> <span class="operator">=</span> connection.setSavepoint();</span><br><span class="line">        savepoints.addLast(savepoint);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//期间出现异常</span></span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">10001</span>)&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span><span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">preparedStatement.executeBatch();</span><br><span class="line">preparedStatement.addBatch();</span><br></pre></td></tr></table></figure><ul><li>出现异常是10000以后，在最后一个回滚点回滚，剩下36则不保留</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != connection) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//获得回滚点集合最后一个点</span></span><br><span class="line">            <span class="type">Savepoint</span> <span class="variable">sp</span> <span class="operator">=</span> savepoints.getLast();</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != sp)&#123;</span><br><span class="line">                connection.rollback(sp);&#125;<span class="comment">//回滚</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><ul><li>设置特定的回滚点</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获得特定的回滚点</span></span><br><span class="line"><span class="type">Savepoint</span> <span class="variable">sp</span> <span class="operator">=</span> savepoints.get(<span class="number">4</span>);</span><br></pre></td></tr></table></figure><h1>7. DAO模式</h1><p>项目结构</p><ul><li><p><strong>实体类</strong>：和数据库表格一一对应的类,单独放入一个包中,包名往往是 pojo/entity/bean,要操作的每个表格都应该有对应的实体类</p><ul><li><p>emp &gt; class Emp</p><p>dept &gt; class Dept</p><p>account &gt; class Account</p></li></ul></li><li><p><strong>DAO层</strong>：定义了对数据要执行那些操作的接口和实现类,包名往往是 dao/mapper,要操作的每个表格都应该有对应的接口和实现类</p><ul><li><p>emp &gt; interface EmpDao &gt;EmpDaoImpl</p><p>dept &gt; interface DeptDao&gt; DeptDaoImpl</p></li></ul></li><li><p>Mybatis/Spring-JDBCTemplate 中,对DAO层代码进行了封装,代码编写方式会有其他变化</p></li></ul><p>项目截图</p><img src="JDBC/20210709153202.png" alt="image-20210709153201647" style="zoom: 50%;" /><h2 id="接口类（DAO层）">接口类（DAO层）</h2><h3 id="Emp-java-2">Emp.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChanHuiShan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-07-09 - 07 - 09 - 15:26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: com.chs.dao</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmpDao</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 向数据库Emp表中增加一条数据的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> emp 要增加的数据封装成的Emp类的对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 增加成功返回大于0的整数，增加失败返回0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">addEmp</span><span class="params">(Emp emp)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据员工编号来删除员工信息的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> empno 要删除的员工的编号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 删除成功返回大于0的整数，删除失败返回0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">deleteByEmpno</span><span class="params">(<span class="type">int</span> empno)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有员工的信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 所有员工的信息集合</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;Emp&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据工号修改员工信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> emp 传入修改的信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 修改成功返回大于0的整数，删除失败返回0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">updateEmp</span><span class="params">(Emp emp)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Dept-java">Dept.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChanHuiShan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-07-09 - 07 - 09 - 15:26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: com.chs.dao</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DeptDao</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有部门信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 所有部门信息的集合</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;Dept&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加部门信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dept 需要添加的部门信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 增加成功返回大于0的整数，增加失败返回0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">addDept</span><span class="params">(Dept dept)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="实现类（未被抽取的）">实现类（未被抽取的）</h2><h3 id="EmpDaoImpl-java">EmpDaoImpl.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChanHuiShan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-07-09 - 07 - 09 - 15:28</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: com.chs.dao.impl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">EmpDao</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mytestdb?&quot;</span> +</span><br><span class="line">            <span class="string">&quot;useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addEmp</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">        <span class="comment">//向emp表中增加一条数据</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> rows= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into emp values(DEFAULT,?,?,?,?,?,?,?)&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);<span class="comment">//这个时候就要传入语句对象</span></span><br><span class="line">            <span class="comment">//设置参数</span></span><br><span class="line">            preparedStatement.setObject(<span class="number">1</span>, emp.getEname());</span><br><span class="line">            preparedStatement.setObject(<span class="number">2</span>, emp.getJob());</span><br><span class="line">            preparedStatement.setObject(<span class="number">3</span>, emp.getMgr());</span><br><span class="line">            preparedStatement.setObject(<span class="number">4</span>, emp.getHiredate());</span><br><span class="line">            preparedStatement.setObject(<span class="number">5</span>, emp.getSal());</span><br><span class="line">            preparedStatement.setObject(<span class="number">6</span>, emp.getComm());</span><br><span class="line">            preparedStatement.setObject(<span class="number">7</span>, emp.getDeptno());</span><br><span class="line">            <span class="comment">//执行CURD</span></span><br><span class="line">            rows = preparedStatement.executeUpdate();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;<span class="comment">//释放资源</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    preparedStatement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != connection) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rows;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deleteByEmpno</span><span class="params">(<span class="type">int</span> empno)</span> &#123;</span><br><span class="line">        <span class="comment">//根据工号删除员工表中的数据</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> rows= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from emp where empno = ?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);<span class="comment">//这个时候就要传入语句对象</span></span><br><span class="line">            <span class="comment">//设置参数</span></span><br><span class="line">            preparedStatement.setObject(<span class="number">1</span>, empno);</span><br><span class="line">            <span class="comment">//执行CURD</span></span><br><span class="line">            rows = preparedStatement.executeUpdate();</span><br><span class="line">            <span class="comment">//设置参数然后今次那</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;<span class="comment">//释放资源</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    preparedStatement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != connection) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rows;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Emp&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//查询名字中包含A的员工信息</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        List&lt;Emp&gt; list = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from emp &quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            resultSet = preparedStatement.executeQuery();</span><br><span class="line">            list= <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">empno</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;empno&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">ename</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;ename&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">job</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;job&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">MGR</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;MGR&quot;</span>);</span><br><span class="line">                <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> resultSet.getDate(<span class="string">&quot;hiredate&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">sal</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;SAL&quot;</span>);</span><br><span class="line">                <span class="type">double</span> <span class="variable">comm</span> <span class="operator">=</span> resultSet.getDouble(<span class="string">&quot;comm&quot;</span>);</span><br><span class="line">                <span class="type">int</span> <span class="variable">deptno</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;deptno&quot;</span>);</span><br><span class="line">                <span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Emp</span>(empno, ename, job, MGR, date, sal, comm, deptno);</span><br><span class="line">                list.add(emp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != resultSet) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    resultSet.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    preparedStatement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != connection) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">updateEmp</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">        <span class="comment">//向emp表中增加一条数据</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> rows= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update emp set ename = ?,job = ?,mgr = ?,hiredate=?,sal=?,comm=? ,deptno = ? where empno = ?&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);<span class="comment">//这个时候就要传入语句对象</span></span><br><span class="line">            <span class="comment">//设置参数</span></span><br><span class="line">            preparedStatement.setObject(<span class="number">1</span>, emp.getEname());</span><br><span class="line">            preparedStatement.setObject(<span class="number">2</span>, emp.getJob());</span><br><span class="line">            preparedStatement.setObject(<span class="number">3</span>, emp.getMgr());</span><br><span class="line">            preparedStatement.setObject(<span class="number">4</span>, emp.getHiredate());</span><br><span class="line">            preparedStatement.setObject(<span class="number">5</span>, emp.getSal());</span><br><span class="line">            preparedStatement.setObject(<span class="number">6</span>, emp.getComm());</span><br><span class="line">            preparedStatement.setObject(<span class="number">7</span>, emp.getDeptno());</span><br><span class="line">            preparedStatement.setObject(<span class="number">8</span>,emp.getEmpno());</span><br><span class="line">            <span class="comment">//执行CURD</span></span><br><span class="line">            rows = preparedStatement.executeUpdate();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;<span class="comment">//释放资源</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    preparedStatement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != connection) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rows;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这些操作都很多相似的地方，可以被抽取成为一个总的类，所以可以啊看待</p><h3 id="DeptDaoImpl-java">DeptDaoImpl.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChanHuiShan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-07-09 - 07 - 09 - 15:29</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: com.chs.dao.impl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">DeptDao</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/mytestdb?&quot;</span> +</span><br><span class="line">            <span class="string">&quot;useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8&amp;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Dept&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//查询名字中包含A的员工信息</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        List&lt;Dept&gt; list = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from dept &quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            resultSet = preparedStatement.executeQuery();</span><br><span class="line">            list= <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">deptno</span> <span class="operator">=</span> resultSet.getInt(<span class="string">&quot;deptno&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">dname</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;dname&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">loc</span> <span class="operator">=</span> resultSet.getString(<span class="string">&quot;loc&quot;</span>);</span><br><span class="line">                <span class="type">Dept</span> <span class="variable">dept</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dept</span>(deptno,dname,loc);</span><br><span class="line">                list.add(dept);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != resultSet) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    resultSet.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    preparedStatement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != connection) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addDept</span><span class="params">(Dept dept)</span> &#123;</span><br><span class="line">        <span class="comment">//向emp表中增加一条数据</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> rows= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            forName(driver);</span><br><span class="line">            connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into dept values(?,?,?)&quot;</span>;</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);<span class="comment">//这个时候就要传入语句对象</span></span><br><span class="line">            <span class="comment">//设置参数</span></span><br><span class="line">            preparedStatement.setObject(<span class="number">1</span>,dept.getDeptno());</span><br><span class="line">            preparedStatement.setObject(<span class="number">2</span>,dept.getDname());</span><br><span class="line">            preparedStatement.setObject(<span class="number">3</span>,dept.getLoc());</span><br><span class="line">            <span class="comment">//执行CURD</span></span><br><span class="line">            rows = preparedStatement.executeUpdate();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;<span class="comment">//释放资源</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    preparedStatement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != connection) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rows;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="员工管理系统">员工管理系统</h2><h3 id="EmpManageSystem-java">EmpManageSystem.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChanHuiShan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-07-09 - 07 - 09 - 20:11</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: com.chs.view</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpManageSystem</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">EmpDao</span> <span class="variable">empDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EmpDaoImpl</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DeptDao deptDao= <span class="keyword">new</span> <span class="title class_">DeptDaoImpl</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">SimpleDateFormat</span> <span class="variable">simpleDateFormat</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)&#123;<span class="comment">//控制台循环打印</span></span><br><span class="line">            showMenu();</span><br><span class="line">            System.out.println(<span class="string">&quot;请用户录入选项&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">            <span class="keyword">switch</span> (i)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                    case1();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                    case2();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                    case3();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                    case4();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                    case5();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">                    case6();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;请输入1-7的数字！！！&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">showMenu</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----------------------------&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;1.查看所有员工的信息&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;2.查看所有部门信息&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;3.根据工号删除员工信息&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;4.根据工号修改员工信息&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;5.增加员工信息&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;6.增加部门信息&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;----------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">case1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//查看所有员工的信息</span></span><br><span class="line">        List&lt;Emp&gt; list = empDao.findAll();</span><br><span class="line">        <span class="comment">/*for (Emp e: list)&#123;</span></span><br><span class="line"><span class="comment">            System.out.println(e);</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line">        list.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">case2</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//查看所有部门的信息</span></span><br><span class="line">        List&lt;Dept&gt; list = deptDao.findAll();</span><br><span class="line">        list.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">case3</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//根据工号来删除员工信息</span></span><br><span class="line">        System.out.println(<span class="string">&quot;请输入要删除员工的工号：&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">        <span class="type">int</span> <span class="variable">i1</span> <span class="operator">=</span> empDao.deleteByEmpno(i);</span><br><span class="line">        <span class="keyword">if</span> (i1!=<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;删除成功！&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;删除失败！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">case4</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//根据员工工号修改员工信息</span></span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的编号&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">empno</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的姓名&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">ename</span> <span class="operator">=</span> sc.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的工作&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">job</span> <span class="operator">=</span> sc.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的上级编号&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">mgr</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的聘用日期（格式为yyyy-mm-dd）&quot;</span>);</span><br><span class="line">        <span class="type">Date</span> <span class="variable">hiredate</span> <span class="operator">=</span> <span class="literal">null</span>;<span class="comment">//把参数从try代码块里拿出来初始化，因为创建对象的时候会访问不到这个值</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            hiredate = simpleDateFormat.parse(sc.next());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请按照格式输入!!!&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的薪资&quot;</span>);</span><br><span class="line">        <span class="type">double</span> <span class="variable">sal</span> <span class="operator">=</span> sc.nextDouble();</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的奖金&quot;</span>);</span><br><span class="line">        <span class="type">double</span> <span class="variable">comm</span> <span class="operator">=</span> sc.nextDouble();</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的部门编号&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">deptno</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">        <span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Emp</span>(empno,ename,job,mgr,hiredate,sal,comm,deptno);</span><br><span class="line">        empDao.updateEmp(emp);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">case5</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//添加员工信息</span></span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的姓名&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">ename</span> <span class="operator">=</span> sc.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的工作&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">job</span> <span class="operator">=</span> sc.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的上级编号&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">mgr</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的聘用日期（格式为yyyy-mm-dd）&quot;</span>);</span><br><span class="line">        <span class="type">Date</span> <span class="variable">hiredate</span> <span class="operator">=</span> <span class="literal">null</span>;<span class="comment">//把参数从try代码块里拿出来初始化，因为创建对象的时候会访问不到这个值</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            hiredate = simpleDateFormat.parse(sc.next());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请按照格式输入!!!&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的薪资&quot;</span>);</span><br><span class="line">        <span class="type">double</span> <span class="variable">sal</span> <span class="operator">=</span> sc.nextDouble();</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的奖金&quot;</span>);</span><br><span class="line">        <span class="type">double</span> <span class="variable">comm</span> <span class="operator">=</span> sc.nextDouble();</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入员工的部门编号&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">deptno</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">        <span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Emp</span>(<span class="literal">null</span>,ename,job,mgr,hiredate,sal,comm,deptno);</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> empDao.addEmp(emp);</span><br><span class="line">        <span class="keyword">if</span> (i&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;添加成功&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;添加失败！！！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">case6</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//添加部门信息</span></span><br><span class="line">        System.out.println(<span class="string">&quot;请输入部门号&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">deptno</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入部门名称&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">dname</span> <span class="operator">=</span> sc.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;*请输入部门地址&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">loc</span> <span class="operator">=</span> sc.next();</span><br><span class="line">        <span class="type">Dept</span> <span class="variable">dept</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dept</span>(deptno, dname, loc);</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> deptDao.addDept(dept);</span><br><span class="line">        <span class="keyword">if</span> (i&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;添加成功&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;添加失败！！！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="BaseDao抽取">BaseDao抽取</h2><p>由上面实现类的代码可以看到增删改查方法的代码都很相似，其实可以把相似的部分抽取出来称为一个BaseDao的类</p><h3 id="增删改的抽取–baseUpdate">增删改的抽取–baseUpdate</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 增删改方法的抽取</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sql 传入的sql语句对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args 传入的可变参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 修改成功返回大于0的数，返回失败返回0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">baseUpdate</span><span class="params">(String sql,Object ... args)</span>&#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">int</span> rows= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        forName(driver);</span><br><span class="line">        connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">        preparedStatement = connection.prepareStatement(sql);<span class="comment">//这个时候就要传入语句对象</span></span><br><span class="line">        <span class="comment">//设置参数</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">            preparedStatement.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//执行CURD</span></span><br><span class="line">        rows = preparedStatement.executeUpdate();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;<span class="comment">//释放资源</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                preparedStatement.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != connection) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> rows;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="查询的抽取–baseQuery">查询的抽取–baseQuery</h3><p>通过<strong>反射</strong>获取传入字节码的对象属性</p><p>关于<strong>反射是否破坏封装类</strong>（面试）：<a href="https://www.cnblogs.com/wk-missQ1/p/13304329.html">https://www.cnblogs.com/wk-missQ1/p/13304329.html</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询操作的抽取</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz 传入字节码以便通过反射获得对象的属性，</span></span><br><span class="line"><span class="comment">     *              因为不知道具体会传入什么对象里面是什么属性。</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sql 传入的sql语句对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args 一些可变的参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回一个查询结果集合</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> List <span class="title function_">baseQuery</span><span class="params">(Class clazz,String sql,Object ... args)</span>&#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        forName(driver);</span><br><span class="line">        connection = DriverManager.getConnection(url, user, password);</span><br><span class="line">        preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">        list= <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//设置参数 -- 这里要注意呀</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">            preparedStatement.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//执行CURD</span></span><br><span class="line">        resultSet = preparedStatement.executeQuery();</span><br><span class="line">        <span class="comment">//通过字节码获取对象的属性</span></span><br><span class="line">        Field[] fields = clazz.getDeclaredFields();</span><br><span class="line">        <span class="comment">//获取访问封装类属性的权限--设置为true可以访问</span></span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">            <span class="comment">//通过反射创建对象</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> clazz.newInstance();<span class="comment">//默认通过反射调用对象的空参构造方法</span></span><br><span class="line">            <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> field.getName();<span class="comment">//先将属性名字获得</span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">data</span> <span class="operator">=</span> resultSet.getObject(name);<span class="comment">//通过属性名从结果集中获得</span></span><br><span class="line">                field.set(data,obj);<span class="comment">//将数据放入对象中</span></span><br><span class="line">            &#125;</span><br><span class="line">            list.add(obj);<span class="comment">//将对象加入到链表集合里</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != resultSet) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                resultSet.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                preparedStatement.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != connection) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//设置参数</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">    preparedStatement.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//执行CURD</span></span><br><span class="line">resultSet = preparedStatement.executeQuery();</span><br><span class="line"><span class="comment">//通过字节码获取对象的属性</span></span><br><span class="line">Field[] fields = clazz.getDeclaredFields();</span><br><span class="line"><span class="comment">//获取访问封装类属性的权限--设置为true可以访问</span></span><br><span class="line"><span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">    field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">    <span class="comment">//通过反射创建对象</span></span><br><span class="line">    <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> clazz.newInstance();<span class="comment">//默认通过反射调用对象的空参构造方法</span></span><br><span class="line">    <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> field.getName();<span class="comment">//先将属性名字获得</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">data</span> <span class="operator">=</span> resultSet.getObject(name);<span class="comment">//通过属性名从结果集中获得</span></span><br><span class="line">        field.set(data,obj);<span class="comment">//将数据放入对象中</span></span><br><span class="line">    &#125;</span><br><span class="line">    list.add(obj);<span class="comment">//将对象放入list表中</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样一来，两个实现类中间的增删改操作就可以被简化</p><h3 id="实现类简化结果">实现类简化结果</h3><h4 id="DeptDaoImpl-java-2">DeptDaoImpl.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">BaseDao</span> <span class="keyword">implements</span> <span class="title class_">DeptDao</span> &#123;<span class="comment">//注意继承BaseDao</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Dept&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from dept &quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> baseQuery(Dept.class,sql);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addDept</span><span class="params">(Dept dept)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into dept values(?,?,?)&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> baseUpdate(sql,dept.getDeptno(),dept.getDname(),</span><br><span class="line">                    dept.getLoc());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="EmpDaoImpl-java-2">EmpDaoImpl.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">BaseDao</span> <span class="keyword">implements</span> <span class="title class_">EmpDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addEmp</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into emp values(DEFAULT,?,?,?,?,?,?,?)&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> baseUpdate(sql,emp.getEname(),emp.getJob(),emp.getMgr(),</span><br><span class="line">                    emp.getHiredate(),emp.getSal(),emp.getComm(),emp.getDeptno());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deleteByEmpno</span><span class="params">(<span class="type">int</span> empno)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from emp where empno = ?&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> baseUpdate(sql,empno);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Emp&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from emp &quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> baseQuery(Emp.class,sql);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">updateEmp</span><span class="params">(Emp emp)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update emp set ename = ?,job = ?,mgr = ?,hiredate=?,sal=?,comm=? ,deptno = ? where empno = ?&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> baseUpdate(sql,emp.getEname(),emp.getJob(),emp.getMgr(),</span><br><span class="line">                emp.getHiredate(),emp.getSal(),emp.getComm(),emp.getDeptno(),emp.getEmpno());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="错误总结：">错误总结：</h4><p><strong>java.lang.IllegalArgumentException</strong>：传入参数传错了</p><img src="JDBC/20210711103201.png" alt="image-20210711103159768" style="zoom:50%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">field.set(obj,data);<span class="comment">//将数据放入对象中,不要传反了</span></span><br></pre></td></tr></table></figure><h2 id="连接池">连接池</h2><ul><li><p>传统的连接：</p><p>​首先调用Class.forName()方法加载数据库驱动，然后调用DriverManager.getConnection()方法建立连接.</p><ul><li><p>缺点：</p><p>​Connection对象在每次执行DML和DQL的过程中都要创建一次,DML和DQL执行完毕后,connection对象都会被销毁. connection对象是可以反复使用的,没有必要每次都创建新的.该对象的创建和销毁都是比较消耗系统资源的,如何实现connection对象的反复使用呢?使用连接池技术实现.</p></li></ul></li><li><p>使用连接池：</p><ul><li><p>预先准备一些链接对象,放入连接池中,当多个线程并发执行时,可以避免短时间内一次性大量创建链接对象,减少计算机单位时间内的运算压力,提高程序的响应速度</p></li><li><p>实现链接对象的反复使用,可以大大减少链接对象的创建次数,减少资源的消耗</p></li></ul></li></ul><p>MyConnectionPool.java</p><ul><li><p>创建一个连接对象</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//准备一个池子装连接对象</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> LinkedList&lt;Connection&gt; pool;</span><br></pre></td></tr></table></figure></li><li><p>静态代码块</p><ul><li>加载驱动</li><li>初始化pool</li><li>创建5个链接对象</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用静态代码块加载驱动，创建连接</span></span><br><span class="line"><span class="keyword">static</span>&#123;</span><br><span class="line">    <span class="comment">//加载驱动</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Class.forName(driver);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//初始化pool</span></span><br><span class="line">    pool = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//创建五个链接对象</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; initSize; i++) &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> initConnection();</span><br><span class="line">        <span class="keyword">if</span>(<span class="literal">null</span> != connection)&#123;</span><br><span class="line">            pool.add(connection);</span><br><span class="line">            System.out.println(<span class="string">&quot;初始化连接：&quot;</span>+connection.hashCode()+<span class="string">&quot;放入连接池&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>私有的初始化一个链接对象的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 私有的初始化一个链接对象的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 初始化的连接对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Connection <span class="title function_">initConnection</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> DriverManager.getConnection(url,user,password);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>公有的向外界提供链接对象</p><ul><li>如果池子里有对象<ul><li>remove（）</li></ul></li><li>如果池子没了：创建新的对象</li><li>最后返回对象</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 公有的向外界提供链接对象的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (pool.size()&gt;<span class="number">0</span>)&#123;<span class="comment">//如果连接池里面有元素</span></span><br><span class="line">        connection = pool.remove();<span class="comment">//移出集合中的第一个元素</span></span><br><span class="line">        System.out.println(<span class="string">&quot;连接池中还有链接，获得链接：&quot;</span>+connection.hashCode());</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        connection = initConnection();</span><br><span class="line">        System.out.println(<span class="string">&quot;连接池为空，创建新链接：&quot;</span>+connection);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> connection;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>公有的向链接对象归还链接对象的方法</p><ul><li>若链接没有被关闭<ul><li>调整事务状态，设置为手动提交</li><li>容量小于最大容量<ul><li>池子最后加上connection</li></ul></li><li>容量达到最大容量<ul><li>关闭连接，打印池子满了，关闭连接</li></ul></li></ul></li><li>若已经被关闭，打印：无需关闭，不用归还</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 公有的向链接对象归还链接对象的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> connection</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">returnConnection</span><span class="params">(Connection connection)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != connection)&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!connection.isClosed())</span><br><span class="line">                <span class="keyword">if</span> (pool.size()&lt; maxSize)&#123;</span><br><span class="line">                    connection.setAutoCommit(<span class="literal">true</span>);<span class="comment">//调整事务状态</span></span><br><span class="line">                    pool.addLast(connection);<span class="comment">//归还链接对象给池子</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;连接池未满，归还链接对象：&quot;</span>+connection.hashCode());</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    connection.close();</span><br><span class="line">                    System.out.println(<span class="string">&quot;连接池已满，关闭连接池&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;连接已经关闭无需归还&quot;</span>);<span class="comment">//连接被关了下次是没法用的</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;传入的连接为null，无需归还&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h3 id="测试">测试</h3><ol><li><p>创建多个连接：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">connection1</span> <span class="operator">=</span> MyConnectionPool.getConnection();</span><br><span class="line">...</span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection11</span> <span class="operator">=</span> MyConnectionPool.getConnection();</span><br></pre></td></tr></table></figure><p>结果：前面小于initSize的部分个从连接池里取，后面超过的部分直接初始化。</p><img src="JDBC/20210711185528.png" style="zoom:50%;" /></li><li><p>归还连接</p><ol><li><p>传入null值</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MyConnectionPool.returnConnection(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure><p>结果：</p><img src="JDBC/20210711190848.png" alt="image-20210711190848341" style="zoom:50%;" /></li><li><p>传入已关闭的连接</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">connection1.close();</span><br><span class="line">MyConnectionPool.returnConnection(connection1);</span><br></pre></td></tr></table></figure><p>结果：</p><img src="JDBC/20210711190953.png" alt="image-20210711190953769" style="zoom: 67%;" /></li><li><p>传入超过maxSize的连接</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MyConnectionPool.returnConnection(connection11);<span class="comment">//maxSize=10---11&gt;10</span></span><br></pre></td></tr></table></figure><img src="JDBC/20210711191448.png" alt="image-20210711191448052" style="zoom:50%;" /></li></ol></li></ol><h3 id="BaseDao改进">BaseDao改进</h3><ul><li><p>原来的参数可以删除</p><img src="JDBC/20210711192110.png" alt="image-20210711192110111" style="zoom: 50%;" /></li><li><p>加载驱动和连接部分改进</p><img src="JDBC/20210711192336.png" alt="image-20210711192335963" style="zoom: 67%;" /></li><li><p>连接最后归还</p><img src="JDBC/20210711192550.png" alt="image-20210711192550600" style="zoom:50%;" /></li></ul><h4 id="BaseDao-java">BaseDao.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">BaseDao</span> &#123;</span><br><span class="line">    <span class="comment">//原来的参数全部删除</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 增删改方法的抽取</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sql 传入的sql语句对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args 传入的可变参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 修改成功返回大于0的数，返回失败返回0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">baseUpdate</span><span class="params">(String sql,Object ... args)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> rows= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = MyConnectionPool.getConnection();<span class="comment">//从连接池里获得连接</span></span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);<span class="comment">//这个时候就要传入语句对象</span></span><br><span class="line">            <span class="comment">//设置参数</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">                preparedStatement.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//执行CURD</span></span><br><span class="line">            rows = preparedStatement.executeUpdate();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;<span class="comment">//释放资源</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    preparedStatement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            MyConnectionPool.returnConnection(connection);<span class="comment">//归还到连接池里</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rows;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询操作的抽取</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz 传入字节码以便通过反射获得对象的属性，</span></span><br><span class="line"><span class="comment">     *              因为不知道具体会传入什么对象里面是什么属性。</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sql 传入的sql语句对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args 一些可变的参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回一个查询结果集合</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List <span class="title function_">baseQuery</span><span class="params">(Class clazz,String sql,Object ... args)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = MyConnectionPool.getConnection();</span><br><span class="line">            preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">            list= <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="comment">//设置参数</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">                preparedStatement.setObject(i+<span class="number">1</span>,args[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//执行CURD</span></span><br><span class="line">            resultSet = preparedStatement.executeQuery();</span><br><span class="line">            <span class="comment">//通过字节码获取对象的属性</span></span><br><span class="line">            Field[] fields = clazz.getDeclaredFields();</span><br><span class="line">            <span class="comment">//获取访问封装类属性的权限--设置为true可以访问</span></span><br><span class="line">            <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">               field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">                <span class="comment">//通过反射创建对象</span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> clazz.newInstance();<span class="comment">//默认通过反射调用对象的空参构造方法</span></span><br><span class="line">                <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> field.getName();<span class="comment">//先将属性名字获得</span></span><br><span class="line">                    <span class="type">Object</span> <span class="variable">data</span> <span class="operator">=</span> resultSet.getObject(name);<span class="comment">//通过属性名从结果集中获得</span></span><br><span class="line">                    field.set(obj,data);<span class="comment">//将数据放入对象中</span></span><br><span class="line">                &#125;</span><br><span class="line">                list.add(obj);<span class="comment">//将对象加入到链表集合里</span></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != resultSet) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    resultSet.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="literal">null</span> != preparedStatement) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    preparedStatement.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            MyConnectionPool.returnConnection(connection);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="配置文件优化连接池">配置文件优化连接池</h2><img src="JDBC/20210711193622.png" alt="image-20210711193622546" style="zoom: 50%;" /><p>注意格式：空格不能随便加</p><img src="JDBC/20210711193523.png" alt="image-20210711193523624" style="zoom:50%;" /><h3 id="PropertiesUtil工具类">PropertiesUtil工具类</h3><ul><li>创建工具类<ul><li>定义构造方法<ul><li>传进配置文件的路径</li><li>通过字节码获取文件路径</li><li>加载IO流</li></ul></li><li>定义一个获得参数的方法</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PropertiesUtil</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Properties properties;<span class="comment">//定义配置文件参数</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 定义配置文件构造器</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path 传入配置文件路径</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">PropertiesUtil</span><span class="params">(String path)</span>&#123;</span><br><span class="line">        properties = <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="comment">//通过字节码获取IO流</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">resourceAsStream</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getResourceAsStream(path);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//加载IO流</span></span><br><span class="line">            properties.load(resourceAsStream);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 返回配置文件参数值的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key 参数名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 参数的字符串</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getProperties</span><span class="params">(String key)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> properties.getProperty(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="连接池优化">连接池优化</h3><ul><li><p>删除参数值</p><img src="JDBC/20210712101026.png" alt="image-20210712101026751" style="zoom:50%;" /></li><li><p>在静态代码块里配置参数</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建配置文件对象</span></span><br><span class="line"><span class="type">PropertiesUtil</span> <span class="variable">propertiesUtil</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PropertiesUtil</span>(<span class="string">&quot;/jdbc.properties&quot;</span>);</span><br><span class="line">driver = propertiesUtil.getProperties(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">url = propertiesUtil.getProperties(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">user = propertiesUtil.getProperties(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">password = propertiesUtil.getProperties(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">initSize = Integer.parseInt(propertiesUtil.getProperties(<span class="string">&quot;initSize&quot;</span>));</span><br><span class="line">maxSize = Integer.parseInt(propertiesUtil.getProperties(<span class="string">&quot;maxSize&quot;</span>));</span><br></pre></td></tr></table></figure></li></ul><h3 id="错误总结">错误总结</h3><p>连接池的定义好像出现了某种问题</p><p>Exception in thread “main” java.lang.NoClassDefFoundError: Could not initialize class com.chs.dao.MyConnectionPool</p><p>发现是构造器中没有用到本身的参数，而是重新定义了一个参数：</p><img src="JDBC/20210712110521.png" alt="image-20210712110521532" style="zoom: 67%;" /><h1>8. log4j日志</h1><ol><li><p>什么是日志log</p><p>​异常信息  登录成功失败的信息  其他重要操作的信息，日志可以记录程序的运行状态,运行信息,用户的一些常用操作.日志可以帮助我们分析程序的运行状态,帮我们分析用户的操作习惯,进而对程序进行改</p></li><li><p>如何记录日志</p><ul><li><p>方式1：System.out.println(…)    e.printStackTrace();</p><p>缺点：不是保存到文件，不能长久存储</p></li><li><p>方式2：IO流 将System.out.println(…)  e.printStackTrace();写入文件</p><p>缺点：操作繁琐,IO流操作容易阻塞线程,日志没有等级,日志的格式不能很好的定制,要想实行编程复杂</p></li><li><p>方式3：使用现成的日志框架，比如log4j</p><p>优点：1长久保存 2有等级3格式可以很好的定制 4代码编写简单</p></li></ul></li><li><p>log4j日志的级别</p><pre><code>FATAL：  指出现非常严重的错误事件，这些错误可能导致应用程序异常中止ERROR： 指虽有错误，但仍允许应用程序继续运行WARN：  指运行环境潜藏着危害INFO：    指报告信息，这些信息在粗粒度级别上突出显示应用程序的进程DEBUG： 指细粒度信息事件，对于应用程序的调试是最有用的</code></pre></li><li><p>使用log4j记录日志</p><ul><li><p>加入jar包   <strong>log4j-1.2.8.jar</strong></p><img src="JDBC/20210712120555.png" alt="image-20210712120555879" style="zoom:50%;" /></li><li><p>加入属性文件 src 下 <strong>log4j.properties</strong></p><img src="JDBC/20210712120643.png" alt="image-20210712120643129" style="zoom:50%;" /><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.rootLogger</span>=<span class="string">error,logfile</span></span><br><span class="line"><span class="comment">## 方式一：打印到控制台</span></span><br><span class="line"><span class="attr">log4j.appender.stdout</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="attr">log4j.appender.stdout.Target</span>=<span class="string">System.err</span></span><br><span class="line"><span class="attr">log4j.appender.stdout.layout</span>=<span class="string">org.apache.log4j.SimpleLayout</span></span><br><span class="line"><span class="comment">## 方式二：打印到logfile文件</span></span><br><span class="line"><span class="attr">log4j.appender.logfile</span>=<span class="string">org.apache.log4j.FileAppender</span></span><br><span class="line"><span class="attr">log4j.appender.logfile.File</span>=<span class="string">d:/msb.log</span></span><br><span class="line"><span class="attr">log4j.appender.logfile.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="attr">log4j.appender.logfile.layout.ConversionPattern</span>=<span class="string">%d&#123;yyyy-MM-dd   HH:mm:ss&#125; %l %F %p %m%n</span></span><br></pre></td></tr></table></figure><img src="JDBC/20210712124734.png" alt="image-20210712124734548" style="zoom: 67%;" /><img src="JDBC/20210712125136.png" alt="image-20210712125136115" style="zoom:50%;" /></li><li><p>通过属性文件理解log4j的主要API</p><p>Appender 日志目的地 :ConsoleAppender  FileAppender</p><p>Layout 日志格式化器 ：SimpleLayout  PatternLayout</p></li></ul></li></ol><h3 id="以连接池为例：">以连接池为例：</h3><ul><li><p>添加日志对象</p><img src="JDBC/20210712122737.png" alt="image-20210712122736926" style="zoom:50%;" /></li><li><p>初始化日志</p><img src="JDBC/20210712123200.png" alt="image-20210712123159994" style="zoom:50%;" /></li><li><p>将sout语句和错误打印改为日志输出：</p><ul><li>错误大多使用fatal级别</li></ul><img src="JDBC/20210712124134.png" alt="image-20210712124134859" style="zoom:50%;" /><ul><li>sout提示语句一般使用info级别</li></ul><img src="JDBC/20210712124306.png" alt="image-20210712124306011" style="zoom:50%;" /><p>运行结果：</p><img src="JDBC/20210712124525.png" alt="image-20210712124525739" style="zoom:67%;" /></li></ul><h3 id="补充">补充</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">%p：输出日志信息的优先级，即DEBUG，INFO，WARN，ERROR，FATAL。</span><br><span class="line">%d：输出日志时间点的日期或时间，默认格式为ISO8601，也可以在其后指定格式，如：%d&#123;yyyy/MM/dd HH:mm:ss,SSS&#125;。</span><br><span class="line">%r：输出自应用程序启动到输出该log信息耗费的毫秒数。</span><br><span class="line">%t：输出产生该日志事件的线程名。</span><br><span class="line">%l：输出日志事件的发生位置，相当于%c.%M(%F:%L)的组合，包括类全名、方法、文件名以及在代码中的行数。例如</span><br><span class="line">test.TestLog4j.main(TestLog4j.java:10)。</span><br><span class="line">%c：输出日志信息所属的类目，通常就是所在类的全名。</span><br><span class="line">%M：输出产生日志信息的方法名。</span><br><span class="line">%F：输出日志消息产生时所在的文件名称。</span><br><span class="line">%L:：输出代码中的行号。</span><br><span class="line">%m:：输出代码中指定的具体日志信息。</span><br><span class="line">%n：输出一个回车换行符，Windows平台为&quot;rn&quot;，Unix平台为&quot;n&quot;。</span><br><span class="line">%x：输出和当前线程相关联的NDC(嵌套诊断环境)，尤其用到像java servlets这样的多客户多线程的应用中。</span><br><span class="line">%%：输出一个&quot;%&quot;字符。</span><br></pre></td></tr></table></figure><h1>9. 三大范式</h1><h2 id="第一范式（1NF）"><strong>第一范式（1NF）</strong></h2><p><strong>要求数据库表的每一列都是不可分割的原子数据项。</strong></p><p>举例说明：</p><img src="JDBC/20210712153337.png" alt="img" style="zoom:67%;" /><p>在上面的表中，“家庭信息”和“学校信息”列均不满足原子性的要求，故不满足第一范式，调整如下：</p><img src="JDBC/20210712153335.png" alt="img" style="zoom:67%;" /><p>可见，调整后的每一列都是不可再分的，因此满足第一范式（1NF）；</p><h2 id="第二范式（2NF）"><strong>第二范式（2NF）</strong></h2><p><strong>在1NF的基础上，非码属性必须完全依赖于候选码（在1NF基础上消除非主属性对主码的部分函数依赖）</strong></p><p><strong>第二范式需要确保数据库表中的每一列都和主键相关，而不能只与主键的某一部分相关（主要针对联合主键而言）。</strong></p><p>举例说明：</p><img src="JDBC/20210712153333.png" alt="img" style="zoom:67%;" /><p>在上图所示的情况中，同一个订单中可能包含不同的产品，因此主键必须是“订单号”和“产品号”联合组成，</p><p>但可以发现，产品数量、产品折扣、产品价格与“订单号”和“产品号”都相关，但是订单金额和订单时间仅与“订单号”相关，与“产品号”无关，</p><p>这样就不满足第二范式的要求，调整如下，需分成两个表：</p><p><img src="JDBC/20210712153328.png" alt="img" style="zoom:67%;" /> <img src="JDBC/20210712153331.png" alt="img" style="zoom:67%;" /></p><h2 id="第三范式（3NF）"><strong>第三范式（3NF）</strong></h2><p><strong>在2NF基础上，任何非主<a href="https://baike.baidu.com/item/%E5%B1%9E%E6%80%A7">属性</a>不依赖于其它非主属性（在2NF基础上消除传递依赖）</strong></p><p><strong>第三范式需要确保数据表中的每一列数据都和主键直接相关，而不能间接相关。</strong></p><p>举例说明：</p><img src="JDBC/20210712153325.png" alt="img" style="zoom:67%;" /><p>上表中，所有属性都完全依赖于学号，所以满足第二范式，但是“班主任性别”和“班主任年龄”直接依赖的是“班主任姓名”，</p><p>而不是主键“学号”，所以需做如下调整：</p><p><img src="JDBC/20210712153312.png" alt="img" style="zoom:67%;" /> <img src="JDBC/20210712153317.png" alt="img" style="zoom:67%;" /></p><p>这样以来，就满足了第三范式的要求。</p><p>ps:如果把上表中的班主任姓名改成班主任教工号可能更确切，更符合实际情况，不过只要能理解就行。</p><h2 id="总结">总结</h2><ul><li><p>优点：结构合理、冗余较小、尽量避免插入删除修改异常</p></li><li><p>缺点：性能降低、多表查询比单表查询速度慢。</p></li><li><p>范式是指导数据设计的规范化理论，可以保证数据库设计质量</p><ul><li>第一范式：字段不能再分</li><li>第二范式：不存在局部依赖</li><li>第三范式：不含传递依赖（间接依赖）</li></ul></li><li><p>在实际设计中，要整体遵循范式理论，但某些特定的情况下不能死板遵循，这样会降低数据库的效率，一般单表查询效率会比多表查询高，特定表的的设计可以违反第三范式，增加冗余提高性能</p><ul><li>例如：经常购物车条目的中除了条目编号，商品编号，商品数量外，可以增加经常使用的商品名称，商品价格等</li><li><img src="JDBC/20210712154207.png" alt="image-20210712154207006" style="zoom:50%;" /></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDBC </tag>
            
            <tag> Java </tag>
            
            <tag> DataBase </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL</title>
      <link href="/2021/05/07/MySQL/"/>
      <url>/2021/05/07/MySQL/</url>
      <cover>https://img.soniachen.com/IMG_5493.jpg?_r_=ac836a18-ea18-6edf-89dc-470598c88e35</cover>
      <date>Fri May 07 2021 09:21:10 GMT+0800</date>
      
        <content type="html"><![CDATA[<h1>引入</h1><h2 id="1-数据库基本概念">1.数据库基本概念</h2><h3 id="1-1-数据">1.1 数据</h3><p>所谓数据（Data）是指对客观事物进行描述并可以鉴别的符号，这些符号是可识别的、抽象的。它不仅仅指狭义上的数字，而是有多种表现形式：字母、文字、文本、图形、音频、视频等。现在计算机存储和处理的数据范围十分广泛，而描述这些数据的符号也变得越来越复杂了。</p><h3 id="1-2-数据库">1.2 数据库</h3><p>数据库（Database，DB）指的是以一定格式存放、能够实现多个用户共享、与应用程序彼此独立的数据集合。</p><span id="more"></span><h3 id="1-3-数据库管理系统">1.3 数据库管理系统</h3><p>数据库管理系统（Database Management System，DBMS）是用来定义和管理数据的软件。如何科学的组织和存储数据，如何高效的获取和维护数据，如何保证数据的安全性和完整性，这些都需要靠数据库管理系统完成。目前，比较流行的数据库管理系统有：Oracle、MySQL、SQL Server、DB2等。</p><h3 id="1-4数据库应用程序">1.4数据库应用程序</h3><p>数据库应用程序（Database Application System，DBAS）是在数据库管理系统基础上，使用数据库管理系统的语法，开发的直接面对最终用户的应用程序，如学生管理系统、人事管理系统、图书管理系统等。</p><h3 id="1-5-数据库管理员">1.5 数据库管理员</h3><p>数据库管理员（Database Administrator，DBA）是指对数据库管理系统进行操作的人员，其主要负责数据库的运营和维护。</p><h3 id="1-6-最终用户">1.6 最终用户</h3><p>最终用户（User）指的是数据库应用程序的使用者。用户面向的是数据库应用程序（通过应用程序操作数据），并不会直接与数据库打交道。</p><h3 id="1-7-数据库系统">1.7 数据库系统</h3><p>数据库系统（Database System，DBS）一般是由数据库、数据库管理系统、数据库应用程序、数据库管理员和最终用户构成。其中DBMS是数据库系统的基础和核心</p><h2 id="2-数据库表列类型">2. 数据库表列类型</h2><h3 id="2-1-整数类型">2.1 整数类型</h3><img src="MySQL/20210630201735.png" alt="image-20210630201735014" style="zoom:67%;" /><ol><li><p>MySQL支持选择在该类型关键字后面的括号内指定整数值的<strong>显示宽度</strong>(例如，INT(4))。显示宽度并不限制可以在列内保存的值的范围，也不限制超过列的指定宽度的值的显示</p></li><li><p>主键自增：不使用序列，通过<strong>auto_increment</strong>，要求是<strong>整数类型</strong></p></li><li><p>支持选择在该类型关键字后面的括号内指定整数值的显示宽度</p></li></ol><img src="MySQL/20210630201859.png" alt="image-20210630201859642" style="zoom:67%;" /><h1>表的完整性约束</h1><h2 id="1-非外键约束">1. 非外键约束</h2><table><thead><tr><th><strong>约束条件</strong></th><th><strong>约束描述</strong></th></tr></thead><tbody><tr><td>PRIMARY KEY</td><td>主键约束，约束字段的值可唯一地标识对应的记录</td></tr><tr><td>NOT NULL</td><td>非空约束，约束字段的值不能为空</td></tr><tr><td>UNIQUE</td><td>唯一约束，约束字段的值是唯一的</td></tr><tr><td>CHECK</td><td>检查约束，限制某个字段的取值范围</td></tr><tr><td>DEFAULT</td><td>默认值约束，约束字段的默认值</td></tr><tr><td>AUTO_INCREMENT</td><td>自动增加约束，约束字段的值自动递增</td></tr><tr><td>FOREIGN KEY</td><td>外键约束，约束表与表之间的关系</td></tr></tbody></table><h5 id="实例一：建立一张用来存储学生信息的表"><strong>实例一</strong>：建立一张用来存储学生信息的表</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">建立一张用来存储学生信息的表</span><br><span class="line">字段包含学号、姓名、性别，年龄、入学日期、班级，email等信息</span><br><span class="line">约束：</span><br><span class="line">建立一张用来存储学生信息的表</span><br><span class="line">字段包含学号、姓名、性别，年龄、入学日期、班级，email等信息</span><br><span class="line">【1】学号是主键 = 不能为空 +  唯一 ，主键的作用：可以通过主键查到唯一的一条记录【2】如果主键是整数类型，那么需要自增</span><br><span class="line">【3】姓名不能为空</span><br><span class="line">【4】Email唯一</span><br><span class="line">【5】性别默认值是男</span><br><span class="line">【6】性别只能是男女</span><br><span class="line">【7】年龄只能在18-50之间</span><br><span class="line">*/</span><br><span class="line">-- 创建数据库表：</span><br><span class="line">create table t_student(</span><br><span class="line">        sno int(6) primary key auto_increment, -- 主键自增</span><br><span class="line">        sname varchar(5) not null, </span><br><span class="line">        sex char(1) default &#x27;男&#x27; check(sex=&#x27;男&#x27; || sex=&#x27;女&#x27;),</span><br><span class="line">        age int(3) check(age&gt;=18 and age&lt;=50),</span><br><span class="line">        enterdate date,</span><br><span class="line">        classname varchar(10),</span><br><span class="line">        email varchar(15) unique -- 唯一</span><br><span class="line">);</span><br><span class="line">-- 查看数据：</span><br><span class="line">select * from t_student;</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="MySQL/20210701085258.png" alt="image-20210701085258650" style="zoom:67%;" /><ul><li><p>添加数据：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-- 添加数据：</span><br><span class="line">--  1048 - Column &#x27;sname&#x27; cannot be null 不能为null</span><br><span class="line">-- 3819 - Check constraint &#x27;t_student_chk_1&#x27; is violated. 违反检查约束</span><br><span class="line">insert into t_student values (1,&#x27;张三&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;zs@126.com&#x27;);</span><br><span class="line">-- 1062 - Duplicate entry &#x27;1&#x27; for key &#x27;t_student.PRIMARY&#x27; 主键重复</span><br><span class="line">-- &gt; 1062 - Duplicate entry &#x27;ls@126.com&#x27; for key &#x27;t_student.email&#x27; 违反唯一约束</span><br><span class="line">insert into t_student values (2,&#x27;李四&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;ls@126.com&#x27;);</span><br><span class="line">insert into t_student values (3,&#x27;露露&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;ls@126.com&#x27;);</span><br><span class="line">-- 如果主键没有设定值，或者用null.default都可以完成主键自增的效果</span><br><span class="line">insert into t_student (sname,enterdate) values (&#x27;菲菲&#x27;,&#x27;2029-4-5&#x27;);</span><br><span class="line">insert into t_student values (null,&#x27;小明&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;xm@126.com&#x27;);</span><br><span class="line">insert into t_student values (default,&#x27;小刚&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;xg@126.com&#x27;);</span><br><span class="line">-- 如果sql报错，可能主键就浪费了，后续插入的主键是不连号的，我们主键也不要求连号的</span><br><span class="line">insert into t_student values (null,&#x27;小明&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;oo@126.com&#x27;);</span><br></pre></td></tr></table></figure><p><strong>常见错误：</strong></p><p>–》 1048 - Column ‘sname’ cannot be null <strong>不能为null</strong></p><p>–》 819 - Check constraint ‘t_student_chk_1’ is violated. <strong>违反检查约束</strong></p><p>– 》1062 - Duplicate（重复的） entry ‘1’ for key ‘t_student.PRIMARY’ <strong>主键重复</strong></p><p>– 》1062 - Duplicate entry ‘ls@126.com’ for key ‘t_student.email’ <strong>违反唯一约束</strong></p><ul><li>使用自增的时候用<strong>null和default</strong>都是可以</li><li>如果sql报错，可能<strong>主键</strong>就浪费了，后续插入的主键是不连号的，主键也不要求连号的</li></ul></li></ul><h4 id="列级约束和表级约束">- 列级约束和表级约束</h4><p>(1)   <strong>表级约束</strong>：可以约束表中任意一个或多个字段。与列定义相互独立，不包含在列定义中；与定义用‘，’分隔；必须指出要约束的列的名称；</p><p>(2)   <strong>列级约束</strong>：包含在列定义中，直接跟在该列的其它定义之后 ，用空格分隔；不必指定列名；</p><h5 id="实例二">实例二</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">-- 删除表：</span><br><span class="line">drop table t_student;</span><br><span class="line">-- 创建数据库表：</span><br><span class="line">create table t_student(</span><br><span class="line">        sno int(6) auto_increment, </span><br><span class="line">        sname varchar(5) not null, </span><br><span class="line">        sex char(1) default &#x27;男&#x27;,</span><br><span class="line">        age int(3),</span><br><span class="line">        enterdate date,</span><br><span class="line">        classname varchar(10),</span><br><span class="line">        email varchar(15),</span><br><span class="line">    -- 表级约束：</span><br><span class="line">        constraint pk_stu primary key (sno),  -- pk_stu 主键约束的名字</span><br><span class="line">        constraint ck_stu_sex check (sex = &#x27;男&#x27; || sex = &#x27;女&#x27;),</span><br><span class="line">        constraint ck_stu_age check (age &gt;= 18 and age &lt;= 50),</span><br><span class="line">        constraint uq_stu_email unique (email)</span><br><span class="line">);</span><br><span class="line">-- 添加数据：</span><br><span class="line">insert into t_student values (1,&#x27;张三&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;zs@126.com&#x27;);</span><br><span class="line">-- &gt; 3819 - Check constraint &#x27;ck_stu_sex&#x27; is violated.</span><br><span class="line">-- &gt; 3819 - Check constraint &#x27;ck_stu_age&#x27; is violated.</span><br><span class="line">-- &gt; 1062 - Duplicate entry &#x27;zs@126.com&#x27; for key &#x27;t_student.uq_stu_email&#x27;</span><br><span class="line">insert into t_student values (3,&#x27;李四&#x27;,&#x27;男&#x27;,21,&#x27;2023-9-1&#x27;,&#x27;java01班&#x27;,&#x27;zs@126.com&#x27;);</span><br><span class="line">-- 查看数据：</span><br><span class="line">select * from t_student;</span><br></pre></td></tr></table></figure><h4 id="创建表之后添加约束">- 创建表之后添加约束</h4><h5 id="实例三">实例三</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">-- 删除表：</span><br><span class="line">drop table t_student;</span><br><span class="line">-- 创建数据库表：</span><br><span class="line">create table t_student(</span><br><span class="line">        sno int(6), </span><br><span class="line">        sname varchar(5) not null, </span><br><span class="line">        sex char(1) default &#x27;男&#x27;,</span><br><span class="line">        age int(3),</span><br><span class="line">        enterdate date,</span><br><span class="line">        classname varchar(10),</span><br><span class="line">        email varchar(15)</span><br><span class="line">);</span><br><span class="line">-- &gt; 1075 - Incorrect table definition; there can be only one auto column and it must be defined as a key</span><br><span class="line">-- 错误的解决办法：就是auto_increment去掉</span><br><span class="line">-- 在创建表以后添加约束：</span><br><span class="line">alter table t_student add constraint pk_stu primary key (sno) ; -- 主键约束</span><br><span class="line">alter table t_student modify sno int(6) auto_increment; -- 修改自增条件</span><br><span class="line">alter table t_student add constraint ck_stu_sex check (sex = &#x27;男&#x27; || sex = &#x27;女&#x27;);</span><br><span class="line">alter table t_student add constraint ck_stu_age check (age &gt;= 18 and age &lt;= 50);</span><br><span class="line">alter table t_student add constraint uq_stu_email unique (email);</span><br><span class="line">-- 查看表结构：</span><br><span class="line">desc t_student;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>验证约束添加成功：</p><img src="MySQL/20210701105406.png" alt="image-20210701105405972" style="zoom:67%;" /><h2 id="2-外键约束">2. 外键约束</h2><ul><li>外键约束（FOREIGN KEY，缩写FK）是用来实现数据库表的参照完整性的。<strong>外键约束可以使两张表紧密的结合起来，特别是针对修改或者删除的级联操作时，会保证数据的完整性。</strong></li><li>外键是指表中某个字段的值依赖于另一张表中某个字段的值，而被依赖的字段必须具有主键约束或者唯一约束。被依赖的表我们通常称之为父表或者主表，设置外键约束的表称为子表或者从表。</li><li>只有<strong>表级约束</strong>没有列级约束</li></ul><h5 id="实例四">实例四</h5><p>主表（父表）：班级表  -  班级编号 - 主键</p><p>从表（子表）：学生表 - 班级编号 - 外键</p><ol><li><p>创建父表—班级表：</p></li><li><ul><li><p>cno(主键、自增)；cname（不为空）；room；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 先删除表，先删除从表再删除父表</span><br><span class="line">drop table t_student;</span><br><span class="line">drop table t_class;</span><br><span class="line">-- 先创建父表：班级表：</span><br><span class="line">create table t_class(</span><br><span class="line">        cno int(4) primary key auto_increment,</span><br><span class="line">        cname varchar(10) not null,</span><br><span class="line">        room char(4)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li></ul></li><li><p>创建从表—学生表：</p><ul><li><p>sno(主键、自增)；sname（不为空）；classno（取值参考t_class表中的cno字段，不要求字段名字完全重复，但是类型长度定义 尽量要求相同。);</p></li><li><p><strong>添加外键约束</strong>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 添加学生表，添加外键约束：</span><br><span class="line">create table t_student(</span><br><span class="line">        sno int(6) primary key auto_increment, </span><br><span class="line">        sname varchar(5) not null, </span><br><span class="line">        classno int(4),-- 取值参考t_class表中的cno字段，不要求字段名字完全重复，但是类型长度定义 尽量要求相同。</span><br><span class="line">    -- 外键约束：</span><br><span class="line">        constraint fk_stu_classno foreign key (classno) references t_class (cno)</span><br><span class="line">    </span><br><span class="line">);</span><br></pre></td></tr></table></figure></li></ul><ul><li><p><strong>删除外键约束</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 删除外键约束</span><br><span class="line">alter table EMP</span><br><span class="line">drop foreign key FK_DEPTNO</span><br></pre></td></tr></table></figure></li></ul></li><li><p>添加数据：</p></li><li><p>可以一次性添加多条记录：</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 可以一次性添加多条记录：</span><br><span class="line">insert into t_class values (null,&#x27;java001&#x27;,&#x27;r803&#x27;),(null,&#x27;java002&#x27;,&#x27;r416&#x27;),(null,&#x27;大数据001&#x27;,&#x27;r103&#x27;);</span><br><span class="line">insert into t_student values (null,&#x27;张三&#x27;,1),(null,&#x27;李四&#x27;,1),(null,&#x27;王五&#x27;,2),(null,&#x27;朱六&#x27;,3);</span><br></pre></td></tr></table></figure></li><li><p>查询班级表：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 查看班级表和学生表：</span><br><span class="line">select * from t_class;</span><br><span class="line">select * from t_student;</span><br></pre></td></tr></table></figure></li><li><p><strong>添加外键的效果</strong>：</p><ul><li>删除班级会出错</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 尝试删除班级</span><br><span class="line">delete from t_class where cno = 1;</span><br></pre></td></tr></table></figure><img src="MySQL/20210701111051.png" alt="image-20210701111051536" style="zoom:67%;" /></li></ol><h4 id="外键策略："><strong>外键策略：</strong></h4><p>直接删除班级会错误，有时候必须删，可以加入外键策略</p><h6 id="策略一：no-action-不允许操作">策略一：no action 不允许操作</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 策略1：no action 不允许操作</span><br><span class="line">-- 通过操作sql来完成：</span><br><span class="line">-- 先把班级2的学生对应的班级 改为null </span><br><span class="line">update t_student set classno = null where classno = 2;</span><br><span class="line">-- 然后再删除班级2   </span><br><span class="line">delete from t_class where cno = 2;</span><br></pre></td></tr></table></figure><p>结果：</p><img src="MySQL/20210701112307.png" alt="image-20210701112307207" style="zoom:67%;" /><img src="MySQL/20210701112344.png" alt="image-20210701112344539" style="zoom: 50%;" /><h6 id="策略二：使用cascade级联操作">策略二：使用cascade级联操作</h6><p>操作主表的时候影响从表的外键</p><ul><li><p>先删除外键约束</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 策略2：cascade 级联操作：操作主表的时候影响从表的外键信息：</span><br><span class="line">alter table t_student drop foreign key fk_stu_classno;</span><br></pre></td></tr></table></figure></li><li><p>重新添加外键约束（增加一个级联操作）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 重新添加外键约束：</span><br><span class="line">alter table t_student add constraint fk_stu_classno foreign key (classno) references t_class (cno) on update cascade on delete cascade;</span><br></pre></td></tr></table></figure></li><li><p>试着更新和删除操作：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 试试更新：</span><br><span class="line">update t_class set cno = 5 where cno = 3;</span><br><span class="line">-- 试试删除：</span><br><span class="line">delete from t_class where cno = 5;</span><br></pre></td></tr></table></figure><p>结果</p><img src="MySQL/20210701113031.png" alt="image-20210701113031631" style="zoom:50%;" /></li></ul><h6 id="策略三：set-null-置空操作">策略三：set null     置空操作</h6><ul><li><p>先删除之前的外键约束</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 先删除之前的外键约束：</span><br><span class="line">alter table t_student drop foreign key fk_stu_classno;</span><br></pre></td></tr></table></figure></li><li><p>重新添加外键约束</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 重新添加外键约束：</span><br><span class="line">alter table t_student add constraint fk_stu_classno foreign key (classno) references t_class (cno) on update set null on delete set null;</span><br></pre></td></tr></table></figure></li><li><p>试着更新操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 更新</span><br><span class="line">update t_class set cno = 5 whwere con = 1;</span><br></pre></td></tr></table></figure><p>结果：</p><img src="MySQL/20210701142452.png" alt="image-20210701142451962" style="zoom:67%;" /><img src="MySQL/20210701142510.png" alt="image-20210701142510409" style="zoom: 50%;" /></li></ul><p>注：策略2 级联操作  和  策略2 的  删除操作  可以混着使用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table t_student add constraint fk_stu_classno foreign key (classno) references t_class (cno) on update cascade on delete set null ;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>应用场合：</p><p>– （1）朋友圈删除，点赞。留言都删除  –  级联操作<br>– （2）解散班级，对应的学生 置为班级为null就可以了，-- set null</p><h1>DQL查询操作*</h1><h2 id="1-常见表的准备">1. 常见表的准备</h2><h3 id="部门表-dept">部门表(dept)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table DEPT(  </span><br><span class="line">  DEPTNO int(2) not null,  </span><br><span class="line">  DNAME  VARCHAR(14),  </span><br><span class="line">  LOC    VARCHAR(13)  </span><br><span class="line">);  </span><br><span class="line">alter table DEPT </span><br><span class="line">  add constraint PK_DEPT primary key (DEPTNO); </span><br></pre></td></tr></table></figure><h3 id="员工表（emp">员工表（emp)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">create table EMP  </span><br><span class="line">(  </span><br><span class="line">  EMPNO    int(4) primary key,  </span><br><span class="line">  ENAME    VARCHAR(10),  </span><br><span class="line">  JOB      VARCHAR(9),  </span><br><span class="line">  MGR      int(4),  </span><br><span class="line">  HIREDATE DATE,  </span><br><span class="line">  SAL      double(7,2),  </span><br><span class="line">  COMM     double(7,2),  </span><br><span class="line">  DEPTNO   int(2)  </span><br><span class="line">);  </span><br><span class="line">alter table EMP  </span><br><span class="line">  add constraint FK_DEPTNO foreign key (DEPTNO)  </span><br><span class="line">  references DEPT (DEPTNO);  </span><br></pre></td></tr></table></figure><h3 id="薪资登记表-salgrade">薪资登记表(salgrade)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table SALGRADE  </span><br><span class="line">(  </span><br><span class="line">  GRADE int primary key,  </span><br><span class="line">  LOSAL double(7,2),  </span><br><span class="line">  HISAL double(7,2)  </span><br><span class="line">);  </span><br></pre></td></tr></table></figure><h3 id="奖金表-bonus">奖金表(bonus)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create table BONUS  </span><br><span class="line">(  </span><br><span class="line">  ENAME VARCHAR(10),  </span><br><span class="line">  JOB   VARCHAR(9),  </span><br><span class="line">  SAL   double(7,2),  </span><br><span class="line">  COMM  double(7,2)  </span><br><span class="line">);  </span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="操作">操作</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">-- DEPT</span><br><span class="line">insert into DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line">values (10, &#x27;ACCOUNTING&#x27;, &#x27;NEW YORK&#x27;);  </span><br><span class="line">insert into DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line">values (20, &#x27;RESEARCH&#x27;, &#x27;DALLAS&#x27;);  </span><br><span class="line">insert into DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line">values (30, &#x27;SALES&#x27;, &#x27;CHICAGO&#x27;);  </span><br><span class="line">insert into DEPT (DEPTNO, DNAME, LOC)  </span><br><span class="line">values (40, &#x27;OPERATIONS&#x27;, &#x27;BOSTON&#x27;);  </span><br><span class="line">-- EMP</span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7369, &#x27;SMITH&#x27;, &#x27;CLERK&#x27;, 7902, &#x27;1980-12-17&#x27;, 800, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7499, &#x27;ALLEN&#x27;, &#x27;SALESMAN&#x27;, 7698, &#x27;1981-02-20&#x27;, 1600, 300, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7521, &#x27;WARD&#x27;, &#x27;SALESMAN&#x27;, 7698, &#x27;1981-02-22&#x27;, 1250, 500, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7566, &#x27;JONES&#x27;, &#x27;MANAGER&#x27;, 7839, &#x27;1981-04-02&#x27;, 2975, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7654, &#x27;MARTIN&#x27;, &#x27;SALESMAN&#x27;, 7698, &#x27;1981-09-28&#x27;, 1250, 1400, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7698, &#x27;BLAKE&#x27;, &#x27;MANAGER&#x27;, 7839, &#x27;1981-05-01&#x27;, 2850, null, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7782, &#x27;CLARK&#x27;, &#x27;MANAGER&#x27;, 7839, &#x27;1981-06-09&#x27;, 2450, null, 10);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7788, &#x27;SCOTT&#x27;, &#x27;ANALYST&#x27;, 7566, &#x27;1987-04-19&#x27;, 3000, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7839, &#x27;KING&#x27;, &#x27;PRESIDENT&#x27;, null, &#x27;1981-11-17&#x27;, 5000, null, 10);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7844, &#x27;TURNER&#x27;, &#x27;SALESMAN&#x27;, 7698, &#x27;1981-09-08&#x27;, 1500, 0, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7876, &#x27;ADAMS&#x27;, &#x27;CLERK&#x27;, 7788, &#x27;1987-05-23&#x27;, 1100, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7900, &#x27;JAMES&#x27;, &#x27;CLERK&#x27;, 7698, &#x27;1981-12-03&#x27;, 950, null, 30);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7902, &#x27;FORD&#x27;, &#x27;ANALYST&#x27;, 7566, &#x27;1981-12-03&#x27;, 3000, null, 20);  </span><br><span class="line">insert into EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)  </span><br><span class="line">values (7934, &#x27;MILLER&#x27;, &#x27;CLERK&#x27;, 7782, &#x27;1982-01-23&#x27;, 1300, null, 10);  </span><br><span class="line">-- SALGRADE</span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (1, 700, 1200);  </span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (2, 1201, 1400);  </span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (3, 1401, 2000);  </span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (4, 2001, 3000);  </span><br><span class="line">insert into SALGRADE (GRADE, LOSAL, HISAL)  </span><br><span class="line">values (5, 3001, 9999);  </span><br><span class="line"></span><br><span class="line">-- 查看表：</span><br><span class="line">select * from dept; </span><br><span class="line">-- 部门表：dept:department 部分 ，loc - location 位置</span><br><span class="line">select * from emp;</span><br><span class="line">-- 员工表：emp:employee 员工   ,mgr :manager上级领导编号，hiredate 入职日期  firedate 解雇日期 ，common：补助</span><br><span class="line">-- deptno 外键 参考  dept - deptno字段</span><br><span class="line">-- mgr 外键  参考  自身表emp - empno  产生了自关联</span><br><span class="line">select * from salgrade;</span><br><span class="line">-- losal - lowsal</span><br><span class="line">-- hisal - highsal</span><br><span class="line">select * from bonus;</span><br></pre></td></tr></table></figure><h3 id="结果-表格形式">结果(表格形式)</h3><img src="MySQL/20210701143713.png" alt="image-20210701143713377" style="zoom:67%;" /><img src="MySQL/20210701143726.png" alt="image-20210701143726512" style="zoom:67%;" /><img src="MySQL/20210701143737.png" alt="image-20210701143737874" style="zoom:67%;" /><img src="MySQL/20210701143749.png" alt="image-20210701143749663" style="zoom:67%;" /><h2 id="2-单表查询">2.  单表查询</h2><h3 id="2-1-简单的SQL查询">2.1 简单的SQL查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">-- 对emp表查询：</span><br><span class="line">select * from emp; -- *代表所有数据</span><br><span class="line">-- 显示部分列：</span><br><span class="line">select empno,ename,sal from emp;</span><br><span class="line">-- 显示部分行：where子句</span><br><span class="line">select * from emp where sal &gt; 2000;</span><br><span class="line">-- 显示部分列，部分行：</span><br><span class="line">select empno,ename,job,mgr from emp where sal &gt; 2000;</span><br><span class="line">-- 起别名：</span><br><span class="line">select empno 员工编号,ename 姓名,sal 工资 from emp; -- as 省略，&#x27;&#x27;或者&quot;&quot;省略了</span><br><span class="line">-- as alias 别名</span><br><span class="line">select empno as 员工编号,ename as 姓名,sal as 工资 from emp;</span><br><span class="line">select empno as &#x27;员工编号&#x27;,ename as &quot;姓名&quot;,sal as 工资 from emp;</span><br><span class="line">-- &gt; 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;编号,ename as &quot;姓 名&quot;,sal as 工资 from emp&#x27; at line 1</span><br><span class="line">-- 错误原因：在别名中有特殊符号的时候，&#x27;&#x27;或者&quot;&quot;不可以省略不写</span><br><span class="line">select empno as 员工 编号,ename as &quot;姓 名&quot;,sal as 工资 from emp;</span><br><span class="line">-- 算术运算符：</span><br><span class="line">select empno,ename,sal,sal+1000 as &#x27;涨薪后&#x27;,deptno from emp where sal &lt; 2500;</span><br><span class="line">select empno,ename,sal,comm,sal+comm from emp;  -- ？？？后面再说</span><br><span class="line">-- 去重操作：</span><br><span class="line">select job from emp;</span><br><span class="line">select distinct job from emp;</span><br><span class="line">select job,deptno from emp;</span><br><span class="line">select distinct job,deptno from emp; -- 对后面的所有列组合 去重 ，而不是单独的某一列去重</span><br><span class="line">-- 排序：</span><br><span class="line">select * from emp order by sal; -- 默认情况下是按照升序排列的</span><br><span class="line">select * from emp order by sal asc; -- asc 升序，可以默认不写</span><br><span class="line">select * from emp order by sal desc; -- desc 降序</span><br><span class="line">select * from emp order by sal asc ,deptno desc; -- 在工资升序的情况下，deptno按照降序排列</span><br></pre></td></tr></table></figure><h3 id="2-2-where子句">2.2 where子句</h3><p>将过滤条件放在where子句的后面，可以筛选/过滤出我们想要的符合条件的数据</p><ul><li><p>加关系运算符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-- where 子句 + 关系运算符</span><br><span class="line">select * from emp where deptno = 10;</span><br><span class="line">select * from emp where deptno &gt; 10;</span><br><span class="line">select * from emp where deptno &gt;= 10;</span><br><span class="line">select * from emp where deptno &lt; 10;</span><br><span class="line">select * from emp where deptno &lt;= 10;</span><br><span class="line">select * from emp where deptno &lt;&gt; 10;</span><br><span class="line">select * from emp where deptno != 10;</span><br><span class="line">select * from emp where job = &#x27;CLERK&#x27;; </span><br><span class="line">select * from emp where job = &#x27;clerk&#x27;; -- 默认情况下不区分大小写 </span><br><span class="line">select * from emp where binary job = &#x27;clerk&#x27;; -- binary区分大小写</span><br><span class="line">select * from emp where hiredate &lt; &#x27;1981-12-25&#x27;;</span><br></pre></td></tr></table></figure></li><li><p>加逻辑运算符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- where 子句 + 逻辑运算符：and </span><br><span class="line">select * from emp where sal &gt; 1500 and sal &lt; 3000;  -- (1500,3000)</span><br><span class="line">select * from emp where sal &gt; 1500 &amp;&amp; sal &lt; 3000; </span><br><span class="line">select * from emp where sal &gt; 1500 and sal &lt; 3000 order by sal;</span><br><span class="line">select * from emp where sal between 1500 and 3000; -- [1500,3000]</span><br><span class="line">-- where 子句 + 逻辑运算符：or</span><br><span class="line">select * from emp where deptno = 10 or deptno = 20;</span><br><span class="line">select * from emp where deptno = 10 || deptno = 20;</span><br><span class="line">select * from emp where deptno in (10,20);</span><br><span class="line">select * from emp where job in (&#x27;MANAGER&#x27;,&#x27;CLERK&#x27;,&#x27;ANALYST&#x27;);</span><br></pre></td></tr></table></figure></li><li><p>加模糊查询</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- where子句 + 模糊查询：</span><br><span class="line">-- 查询名字中带A的员工  -- %代表任意多个字符 0,1,2，.....</span><br><span class="line">select * from emp where ename like &#x27;%A%&#x27; ;</span><br><span class="line">-- -任意一个字符</span><br><span class="line">select * from emp where ename like &#x27;__A%&#x27; ;</span><br></pre></td></tr></table></figure></li><li><p>关于null的判断</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 关于null的判断：</span><br><span class="line">select * from emp where comm is null;</span><br><span class="line">select * from emp where comm is not null;</span><br></pre></td></tr></table></figure></li><li><p>小括号的使用：因为不同运算符的优先级别不同，加括号为了可读性</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 小括号的使用  ：因为不同的运算符的优先级别不同，加括号为了可读性</span><br><span class="line">select * from emp where job = &#x27;SALESMAN&#x27; or job = &#x27;CLERK&#x27; and sal &gt;=1500; -- 先and再or  and &gt; or</span><br><span class="line">select * from emp where job = &#x27;SALESMAN&#x27; or (job = &#x27;CLERK&#x27; and sal &gt;=1500); </span><br><span class="line">select * from emp where (job = &#x27;SALESMAN&#x27; or job = &#x27;CLERK&#x27;) and sal &gt;=1500;</span><br></pre></td></tr></table></figure></li></ul><h3 id="2-3-函数">2.3 函数</h3><p><em><strong>除了多行函数（max,min,count,sum,avg），都是单行函数</strong></em></p><h4 id="单行函数">- 单行函数</h4><h5 id="1-字符串函数">1. 字符串函数</h5><table><thead><tr><th><strong>函数</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td>CONCAT(str1, str2, ···, strn)</td><td>将str1、str2···strn拼接成一个新的字符串</td></tr><tr><td>INSERT(str, index, n,  newstr)</td><td>将字符串str从第index位置开始的n个字符替换成字符串newstr</td></tr><tr><td>LENGTH(str)</td><td>获取字符串str的长度</td></tr><tr><td>LOWER(str)</td><td>将字符串str中的每个字符转换为小写</td></tr><tr><td>UPPER(str)</td><td>将字符串str中的每个字符转换为大写</td></tr><tr><td>LEFT(str, n)</td><td>获取字符串str最左边的n个字符</td></tr><tr><td>RIGHT(str, n)</td><td>获取字符串str最右边的n个字符</td></tr><tr><td>LPAD(str, n, pad)</td><td>使用字符串pad在str的最左边进行填充，直到长度为n个字符为止</td></tr><tr><td>RPAD(str, n, pad)</td><td>使用字符串pad在str的最右边进行填充，直到长度为n个字符为止</td></tr><tr><td>LTRIM(str)</td><td>去除字符串str左侧的空格</td></tr><tr><td>RTRIM(str)</td><td>去除字符串str右侧的空格</td></tr><tr><td>TRIM(str)</td><td>去除字符串str左右两侧的空格</td></tr><tr><td>REPLACE(str,oldstr,newstr)</td><td>用字符串newstr替换字符串str中所有的子字符串oldstr</td></tr><tr><td>REVERSE(str)</td><td>将字符串str中的字符逆序</td></tr><tr><td>STRCMP(str1,  str2)</td><td>比较字符串str1和str2的大小</td></tr><tr><td>SUBSTRING(str,index,n)</td><td>获取从字符串str的index位置开始的n个字符</td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 1.字符串函数</span><br><span class="line">select ename,length(ename),substring(ename,2,3) from emp;</span><br><span class="line">-- substring字符串截取，2:从字符下标为2开始，3：截取长度3    （下标从1开始）</span><br></pre></td></tr></table></figure><p>显示结果：</p><img src="MySQL/20210630210116.png" alt="image-20210630210115889" style="zoom:50%;" /><h5 id="2-数值函数">2. 数值函数</h5><table><thead><tr><th style="text-align:left"><strong>函数</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td style="text-align:left">ABS(num)</td><td>返回num的绝对值</td></tr><tr><td style="text-align:left">CEIL(num)</td><td>返回大于num的最小整数（向上取整）</td></tr><tr><td style="text-align:left">FLOOR(num)</td><td>返回小于num的最大整数（向下取整）</td></tr><tr><td style="text-align:left">MOD(num1, num2)</td><td>返回num1/num2的余数（取模）</td></tr><tr><td style="text-align:left">PI()</td><td>返回圆周率的值</td></tr><tr><td style="text-align:left">POW(num,n)/POWER(num,  n)</td><td>返回num的n次方</td></tr><tr><td style="text-align:left">RAND(num)</td><td>返回0~1之间的随机数</td></tr><tr><td style="text-align:left">ROUND(num, n)</td><td>返回x四舍五入后的值，该值保留到小数点后n位</td></tr><tr><td style="text-align:left">TRUNCATE(num, n)</td><td>返回num被舍去至小数点后n位的值</td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 2.数值函数</span><br><span class="line">select abs(-5),ceil(5.3),floor(5.9),round(3.14) from dual; -- dual实际就是一个伪表</span><br><span class="line">select abs(-5) 绝对值,ceil(5.3) 向上取整,floor(5.9) 向下取整,round(3.14) 四舍五入;  </span><br><span class="line">-- 如果没有where条件的话，from dual可以省略不写</span><br><span class="line">select ceil(sal) from emp;</span><br><span class="line">select 10/3,10%3,mod(10,3) ;</span><br></pre></td></tr></table></figure><p>显示结果：</p><img src="MySQL/20210630210456.png" alt="image-20210630210456370" style="zoom:50%;" /><h5 id="3-日期与时间函数">3. 日期与时间函数</h5><table><thead><tr><th><strong>函数</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td>CURDATE()</td><td>返回当前日期</td></tr><tr><td>CURTIME()</td><td>返回当前时间</td></tr><tr><td>NOW()</td><td>返回当前日期和时间</td></tr><tr><td>SYSDATE()</td><td>返回该函数执行时的日期和时间</td></tr><tr><td>DAYOFYEAR(date)</td><td>返回日期date为一年中的第几天</td></tr><tr><td>WEEK(date)/WEEKOFYEAR(date)</td><td>返回日期date为一年中的第几周</td></tr><tr><td>DATE_FORMAT(date,  format)</td><td>返回按字符串format格式化后的日期date</td></tr><tr><td>DATE_ADD(date,  INTERVAL expr unit)    /ADDDATE(date,  INTERVAL expr unit)</td><td>返回date加上一个时间间隔后的新时间值</td></tr><tr><td>DATE_SUB(date,  INTERVAL expr unit)    /SUBDATE(date,  INTERVAL expr unit)</td><td>返回date减去一个时间间隔后的新时间值</td></tr><tr><td>DATEDIFF(date1,  date2)</td><td>返回起始日期date1与结束日期date2之间的间隔天数</td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 3.日期与时间函数 </span><br><span class="line">select * from emp;</span><br><span class="line">select curdate(),curtime() ; -- curdate()年月日 curtime()时分秒</span><br><span class="line">select now(),sysdate(),sleep(3),now(),sysdate() from dual; -- now(),sysdate() 年月日时分秒</span><br><span class="line">insert into emp values (9999,&#x27;lili&#x27;,&#x27;SALASMAN&#x27;,7698,now(),1000,null,30);</span><br><span class="line">-- now()可以表示年月日时分秒，但是插入数据的时候还是要参照表的结构的</span><br><span class="line">desc emp;</span><br></pre></td></tr></table></figure><img src="MySQL/20210630223758.png" alt="image-20210630223758495" style="zoom:50%;" /><img src="MySQL/20210630223819.png" alt="image-20210630223819827" style="zoom:50%;" /><img src="MySQL/20210630223829.png" alt="image-20210630223829883" style="zoom:50%;" /><h5 id="4-流程函数">4. 流程函数</h5><img src="MySQL/20210630224323.png" alt="image-20210630224323874" style="zoom:67%;" /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">-- 4.流程函数</span><br><span class="line">-- if相关</span><br><span class="line">select empno,ename,sal,if(sal&gt;=2500,&#x27;高薪&#x27;,&#x27;底薪&#x27;) as &#x27;薪资等级&#x27; from emp; -- if-else 双分支结构</span><br><span class="line">select empno,ename,sal,comm,sal+ifnull(comm,0) from emp; -- 如果comm是null，那么取值为0 -- 单分支</span><br><span class="line">select nullif(1,1),nullif(1,2) from dual; --  如果value1等于value2，则返回null，否则返回value1  </span><br><span class="line">-- case相关：</span><br><span class="line">-- case等值判断</span><br><span class="line">select empno,ename,job,</span><br><span class="line">case job </span><br><span class="line"> when &#x27;CLERK&#x27; then &#x27;店员&#x27;</span><br><span class="line"> when &#x27;SALESMAN&#x27;  then &#x27;销售&#x27;</span><br><span class="line"> when &#x27;MANAGER&#x27; then &#x27;经理&#x27;</span><br><span class="line"> else &#x27;其他&#x27;</span><br><span class="line">end &#x27;岗位&#x27;,</span><br><span class="line">sal from emp;</span><br><span class="line">-- case区间判断:</span><br><span class="line">select empno,ename,sal,</span><br><span class="line">case </span><br><span class="line"> when sal&lt;=1000 then &#x27;A&#x27;</span><br><span class="line"> when sal&lt;=2000 then &#x27;B&#x27;</span><br><span class="line"> when sal&lt;=3000 then &#x27;C&#x27;</span><br><span class="line"> else &#x27;D&#x27;</span><br><span class="line">end &#x27;工资等级&#x27;,</span><br><span class="line">deptno from emp;</span><br><span class="line">from emp;</span><br></pre></td></tr></table></figure><h5 id="5-JSON函数">5. JSON函数</h5><img src="MySQL/20210630224430.png" alt="image-20210630224430595" style="zoom:67%;" /><h5 id="6-其他函数">6. 其他函数</h5><img src="MySQL/20210630224453.png" alt="image-20210630224453894" style="zoom:67%;" /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> -- 6.其他函数</span><br><span class="line">select database(),user(),version() from dual;</span><br></pre></td></tr></table></figure><h4 id="多行函数">- 多行函数</h4><p>对一组数据进行运算，针对一组数据（多行记录）只返回一个结果，也称<strong>分组函数</strong></p><img src="MySQL/20210630224611.png" alt="image-20210630224611608" style="zoom: 67%;" /><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-- 多行函数：</span><br><span class="line">select max(sal),min(sal),count(sal),sum(sal),sum(sal)/count(sal),avg(sal) from emp;</span><br><span class="line">select * from emp;</span><br><span class="line">-- 多行函数自动忽略null值</span><br><span class="line">select max(comm),min(comm),count(comm),sum(comm),sum(comm)/count(comm),avg(comm) from emp;</span><br><span class="line">-- max(),min(),count()针对所有类型   sum(),avg() 只针对数值型类型有效</span><br><span class="line">select max(ename),min(ename),count(ename),sum(ename),avg(ename) from emp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- count --计数   </span><br><span class="line">-- 统计表的记录数：方式1：</span><br><span class="line">select * from emp;</span><br><span class="line">select count(ename) from emp;</span><br><span class="line">select count(*) from emp;</span><br><span class="line">-- 统计表的记录数：方式2</span><br><span class="line">select 1 from dual;</span><br><span class="line">select 1 from emp;</span><br><span class="line">select count(1) from emp;</span><br></pre></td></tr></table></figure><h3 id="2-4-分组与筛选">2.4 分组与筛选</h3><h4 id="group-by-分组">group by 分组</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select * from emp;</span><br><span class="line">-- 统计各个部门的平均工资 </span><br><span class="line">select deptno,avg(sal) from emp; -- 字段和多行函数不可以同时使用</span><br><span class="line">select deptno,avg(sal) from emp group by deptno; -- 字段和多行函数不可以同时使用,除非这个字段属于分组</span><br><span class="line">select deptno,avg(sal) from emp group by deptno order by deptno desc;</span><br><span class="line">-- 统计各个岗位的平均工资 统计各个岗位的</span><br><span class="line">select job,avg(sal) from emp group by job;</span><br><span class="line">select job,lower(job),avg(sal) from emp group by job;</span><br></pre></td></tr></table></figure><h4 id="having-分组后筛选">having 分组后筛选</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 统计各个部门的平均工资 ,只显示平均工资2000以上的  - 分组以后进行二次筛选 having</span><br><span class="line">select deptno,avg(sal) from emp group by deptno having avg(sal) &gt; 2000;</span><br><span class="line">select deptno,avg(sal) 平均工资 from emp group by deptno having 平均工资 &gt; 2000;</span><br><span class="line">select deptno,avg(sal) 平均工资 from emp group by deptno having 平均工资 &gt; 2000 order by deptno desc;</span><br></pre></td></tr></table></figure><p>where在分组前进行过滤的，having在分组后进行后滤。</p><p>对比实例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 对比实例：统计各个岗位的平均工资,除了MANAGER</span><br><span class="line">-- 方法1：</span><br><span class="line">select job,avg(sal) from emp where job != &#x27;MANAGER&#x27; group by job;</span><br><span class="line">-- 方法2：</span><br><span class="line">select job,avg(sal) from emp group by job having job != &#x27;MANAGER&#x27; ;</span><br><span class="line">-- where在分组前进行过滤的，having在分组后进行后滤。</span><br></pre></td></tr></table></figure><h3 id="总结">总结</h3><h4 id="1-select语句总结">[1] select语句总结</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select column, group_function(column) </span><br><span class="line">from table </span><br><span class="line">[where condition] </span><br><span class="line">[group by  group_by_expression] </span><br><span class="line">[having group_condition] </span><br><span class="line">[order by column]; </span><br></pre></td></tr></table></figure><p>注意：顺序固定，不可以改变顺序</p><h4 id="2-select语句的执行顺序">[2] select语句的执行顺序</h4><p>from — where — group  by —  select — having — order  by</p><h4 id="3-单表查询练习">[3] 单表查询练习</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">-- 单表查询练习：</span><br><span class="line">-- 列出工资最小值小于2000的职位</span><br><span class="line">select job,min(sal)</span><br><span class="line">from emp</span><br><span class="line">group by job</span><br><span class="line">having min(sal) &lt; 2000;</span><br><span class="line">-- 列出平均工资大于1200元的部门和工作搭配组合</span><br><span class="line">select deptno,job,avg(sal)</span><br><span class="line">from emp</span><br><span class="line">group by deptno,job</span><br><span class="line">having avg(sal) &gt; 1200</span><br><span class="line">order by avg(sal);</span><br><span class="line">-- 统计[人数小于4的]部门的平均工资。 </span><br><span class="line">select deptno,count(ename),avg(sal) -- 这里可用 count(1)</span><br><span class="line">from emp</span><br><span class="line">group by deptno</span><br><span class="line">having count(ename) &lt; 4;</span><br><span class="line"></span><br><span class="line">-- 统计各部门的最高工资，排除最高工资小于3000的部门。</span><br><span class="line">select deptno,max(sal)</span><br><span class="line">from emp</span><br><span class="line">group by deptno</span><br><span class="line">having max(sal) &gt;= 3000;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="3-多表查询">3.  多表查询</h2><h3 id="3-1-交叉连接-cross-join">3.1  交叉连接 cross join</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from emp</span><br><span class="line">cross join dept;</span><br></pre></td></tr></table></figure><h3 id="3-2-自然连接-natural">3.2  自然连接 natural</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">natural join dept;</span><br></pre></td></tr></table></figure><p>优点：自动匹配所有的同名列 ，同名列只显示一次，简单</p><p>缺点：查询字段的时候，没有指定字段对应的数据库表，效率低</p><p><strong>解决——指定表名</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select emp.empno,emp.enaem,emp.sal,dept.dname,dept.loc,dept.deptno</span><br><span class="line">from emp</span><br><span class="line">natural join dept;</span><br></pre></td></tr></table></figure><p>缺点：表名太长</p><p><strong>解决——起表名</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select e.empno,e.ename,e.sal,d.dname,d.loc,d.deptno</span><br><span class="line">from emp e</span><br><span class="line">natural join dept d;</span><br></pre></td></tr></table></figure><p>缺点：会自动匹配所有表中同名的字段。有时候我们只需要部分相同的字段</p><h3 id="3-3-内连接-inner-join">3.3 内连接 inner join</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp e</span><br><span class="line">inner join dept d </span><br><span class="line">using(deptno); -- 同名字段才有效</span><br></pre></td></tr></table></figure><p>缺点：连接的表字段不同时using无法使用。</p><p>解决——<strong>使用on子句</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">inner join dept d -- 使用on的时候inner可以省略</span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure><h3 id="3-4-外连接-outer-join">3.4 外连接  outer  join</h3><ul><li>内连接只显示匹配的数据，例如一个部门没有员工就不会显示</li><li><strong>外连接可以显示不匹配的数据</strong></li><li>outer都可以省略的</li></ul><h5 id="左外连接">左外连接</h5><p>左边的那个表的信息，即使不匹配也可以查看出结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">left outer join dept d</span><br><span class="line">on e.deptno = d.deptno</span><br></pre></td></tr></table></figure><p>结果</p><img src="MySQL/20210701170246.png" alt="image-20210701170246009" style="zoom:67%;" /><h5 id="右外连接">右外连接</h5><p>右边的那个表的信息，即使不匹配也可以查看出结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">right outer join dept d</span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure><p>结果</p><img src="MySQL/20210701163643.png" alt="image-20210701163643122" style="zoom:67%;" /><h5 id="全外连接">全外连接</h5><p>这个语法在mysql里面不支持，oracle才支持</p><p>为了代替 可以取左外连接和右外连接的并集</p><h6 id="并集-union">并集 union</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">left outer join dept d</span><br><span class="line">on e.deptno = d.deptno</span><br><span class="line">union -- 并集，不去重，效率低</span><br><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">right outer join dept d</span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure><p>结果</p><img src="MySQL/20210701170831.png" alt="image-20210701170831388" style="zoom:67%;" /><h6 id="union-all">union all</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">left outer join dept d</span><br><span class="line">on e.deptno = d.deptno</span><br><span class="line">union  all -- 不去重的并集， 效率高</span><br><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">right outer join dept d</span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure><p>结果</p><img src="MySQL/20210701171121.png" alt="image-20210701171121236" style="zoom:67%;" /><h3 id="3-5-三表查询">3.5 三表查询</h3><p>案例：查询员工的编号、姓名、薪水、部门编号、部门名称、薪水等级</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">select * from emp;</span><br><span class="line">select * from dept;</span><br><span class="line">select * from salgrade；</span><br><span class="line"></span><br><span class="line">select *</span><br><span class="line">from emp e</span><br><span class="line">right outer join dept d</span><br><span class="line">on e.deptno = d.deptno;</span><br><span class="line">-- 可以看做就是上面的结果是一张表，然后再和第三张表进行连接</span><br><span class="line">inner join salgrade s</span><br><span class="line">on e.sal between salgrade</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>结果</p><img src="MySQL/20210701184545.png" alt="image-20210701184545238" style="zoom:67%;" /><h3 id="3-6-自连接查询">3.6 自连接查询</h3><p>相当于把本身表复制一份，本质与前面的连接没有区别</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-- 查询员工的编号、姓名、上级编号,上级的姓名</span><br><span class="line">select * from emp;</span><br><span class="line">select e1.empno 员工编号,e1.ename 员工姓名,e1.mgr 领导编号,e2.ename 员工领导姓名</span><br><span class="line">from emp e1</span><br><span class="line">inner join emp e2</span><br><span class="line">on e1.mgr = e2.empno;</span><br><span class="line">-- 左外连接：</span><br><span class="line">select e1.empno 员工编号,e1.ename 员工姓名,e1.mgr 领导编号,e2.ename 员工领导姓名</span><br><span class="line">from emp e1</span><br><span class="line">left outer join emp e2</span><br><span class="line">on e1.mgr = e2.empno;</span><br></pre></td></tr></table></figure><p>结果</p><img src="MySQL/20210702094750.png" alt="image-20210702094750390" style="zoom:67%;" /><h3 id="补充：92语法的多表查询">补充：92语法的多表查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">-- 查询员工的编号，员工姓名，薪水，员工部门编号，部门名称：</span><br><span class="line">select e.empno,e.ename,e.sal,e.deptno,d.dname</span><br><span class="line">from emp e,dept d</span><br><span class="line">-- 相当于99语法中的cross join ,出现笛卡尔积，没有意义</span><br><span class="line">select e.empno,e.ename,e.sal,e.deptno,d.dname</span><br><span class="line">from emp e,dept d</span><br><span class="line">where e.deptno = d.deptno;</span><br><span class="line">-- 相当于99语法中的natural join </span><br><span class="line">-- 查询员工的编号，员工姓名，薪水，员工部门编号，部门名称，查询出工资大于2000的员工</span><br><span class="line">select e.empno,e.ename,e.sal,e.deptno,d.dname</span><br><span class="line">from emp e,dept d</span><br><span class="line">where e.deptno = d.deptno and e.sal &gt; 2000;</span><br><span class="line">-- 查询员工的名字，岗位，上级编号，上级名称（自连接）：</span><br><span class="line">select e1.ename,e1.job,e1.mgr ,e2.ename </span><br><span class="line">from emp e1,emp e2</span><br><span class="line">where e1.mgr = e2.empno;</span><br><span class="line">-- 查询员工的编号、姓名、薪水、部门编号、部门名称、薪水等级</span><br><span class="line">select e.empno,e.ename,e.sal,e.deptno,d.dname,s.grade </span><br><span class="line">from emp e,dept d,salgrade s</span><br><span class="line">where e.deptno = d.deptno and e.sal &gt;= s.losal and e.sal &lt;= s.hisal;</span><br><span class="line">-- 总结：</span><br><span class="line">-- 1.92语法麻烦 </span><br><span class="line">-- 2.92语法中 表的连接条件 和  筛选条件  是放在一起的没有分开</span><br><span class="line">-- 3.99语法中提供了更多的查询连接类型：cross,natural,inner,outer </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="4-不相关子查询">4. 不相关子查询</h2><h3 id="引入">引入</h3><p>要查询所有比“CLARK”工资高的员工的信息</p><p>需要两个命令而且第二个命令依托于第一个命令，会相互影响</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 命令一：查询clark的工资</span><br><span class="line">select sal from emp where ename = clark; -- 2450</span><br><span class="line">-- 命令二：查询所有比其工资高的员工信息</span><br><span class="line">select * from emp where sal &gt; 2450;</span><br></pre></td></tr></table></figure><p>子查询可以通过一个命令解决问题 !</p><h3 id="4-1-单行子查询">4.1  单行子查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">-- 将上面两个命令合并</span><br><span class="line">-- 查询工资高于平均工资的雇员的名字和工资</span><br><span class="line">select ename,sal</span><br><span class="line">from emp</span><br><span class="line">where sal &gt; (select sal from emp where sal &gt; avg(sal));</span><br><span class="line"> </span><br><span class="line">-- 查询和CLARK同一部门且比他工资低的雇员的名字和工资</span><br><span class="line">select ename,sal</span><br><span class="line">from emp</span><br><span class="line">where deptno = (select deptno from emp where ename=&#x27;CLARK&#x27;) </span><br><span class="line">  and </span><br><span class="line">  sal &lt; (select sal from emp where ename=&#x27;CLARK&#x27; );</span><br><span class="line"></span><br><span class="line">-- 查询职务和SCOTT相同，比SCOTT雇佣时间早的雇员信息</span><br><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">where job = (select job from emp where ename=&#x27;SCOTT&#x27;)</span><br><span class="line">  and</span><br><span class="line">  hiredate &lt; (select hiredate from emp where ename=&#x27;SCOTT&#x27;);</span><br><span class="line">  </span><br></pre></td></tr></table></figure><h3 id="4-2-多行子查询">4.2  多行子查询</h3><p>子查询查出来的记录为多条：</p><h5 id="实例一">实例一</h5><ul><li>查询部门20中职务同部门10的雇员一样的雇员信息。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 查询雇员信息</span><br><span class="line">select * from emp;</span><br><span class="line">-- 查询部门20中的雇员信息</span><br><span class="line">select * from emp where deptno = 20;-- CLERK,MANAGER,ANALYST</span><br><span class="line">-- 部门10的雇员的职务：</span><br><span class="line">select job from emp where deptno = 10; -- MANAGER,PRESIDENT,CLERK</span><br></pre></td></tr></table></figure><p>如果使用单行子查询，就会报错  -&gt;Subquery returns more than 1 row</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from emp </span><br><span class="line">where deptno = 20 </span><br><span class="line">and job in (select job from emp where deptno = 10)</span><br><span class="line">-- &gt; Subquery returns more than 1 row</span><br></pre></td></tr></table></figure><p>多行子查询可以解决</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from emp </span><br><span class="line">where deptno = 20 </span><br><span class="line">and job = any(select job from emp where deptno = 10) -- any</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="实例二-2">实例二</h5><ul><li><p>查询工资比所有的“SALESMAN”都高的雇员的编号、名字和工资</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 查询雇员的编号、名字和工资</span><br><span class="line">select empno,ename,sal from emp</span><br><span class="line">-- “SALESMAN”的工资：</span><br><span class="line">select sal from emp where job = &#x27;SALESMAN&#x27;</span><br><span class="line">-- 查询工资比所有的“SALESMAN”都高的雇员的编号、名字和工资。</span><br><span class="line">-- 多行子查询：</span><br><span class="line">select empno,ename,sal </span><br><span class="line">from emp </span><br><span class="line">where sal &gt; all(select sal from emp where job = &#x27;SALESMAN&#x27;);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 单行子查询：</span><br><span class="line">select empno,ename,sal </span><br><span class="line">from emp </span><br><span class="line">where sal &gt; (select max(sal) from emp where job = &#x27;SALESMAN&#x27;);</span><br></pre></td></tr></table></figure></li></ul><h5 id="实例三-2">实例三</h5><ul><li>查询工资低于任意一个“CLERK”的工资的雇员信息。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- 查询雇员信息</span><br><span class="line">select * from emp;</span><br><span class="line">-- 查询工资低于任意一个“CLERK”的工资的雇员信息</span><br><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">where sal &lt; any(select sal from emp where job = &#x27;CLERK&#x27;)</span><br><span class="line">and job != &#x27;CLERK&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 单行子查询：</span><br><span class="line">select * </span><br><span class="line">from emp</span><br><span class="line">where sal &lt; (select max(sal) from emp where job = &#x27;CLERK&#x27;)</span><br><span class="line">and job != &#x27;CLERK&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="5-相关子查询">5. 相关子查询</h2><h3 id="引入-2">引入</h3><ul><li><p>不相关的子查询引入：<br>不相关的子查询：子查询可以独立运行，先运行子查询，再运行外查询。<br>相关子查询：子查询不可以独立运行，并且先运行外查询，再运行子查询</p></li><li><p>不相关的子查询优缺点：<br>好处：简单   功能强大（一些使用不相关子查询不能实现或者实现繁琐的子查询，可以使用相关子查询实现）<br>缺点：稍难理解</p></li></ul><h3 id="实例">实例</h3><ol><li><p>查询各个部门最高工资的员工</p><ul><li>不相关子查询</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select * from emp where deptno = 10 and sal = (select max(sal) from emp where deptnp = 10)</span><br><span class="line">union</span><br><span class="line">select * from emp where deptno = 20 and sal = (select max(sal) from emp where deptno = 20)</span><br><span class="line">union</span><br><span class="line">select * from emp where deptno = 30 and sal = (select max(sal) from emp where deptno = 30);</span><br></pre></td></tr></table></figure><p>太复杂了:unamused:</p><ul><li>相关子查询</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from emp e where sal = (select max(sal) from emp where deptno = e.deptno)</span><br></pre></td></tr></table></figure><p>简单多啦:happy:</p></li><li><p>查询工高于所在岗位的平均工资的那些员工</p><ul><li>不相关子查询</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from emp where job = &#x27;&#x27; and sal &gt;= (select avg(sal) from emp where job = &#x27;&#x27;)</span><br><span class="line">union ....</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>相关子查询</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from emp e where sal &gt;= (select avg(sal) from emp where job = e.job);</span><br></pre></td></tr></table></figure></li></ol><h1>数据库对象</h1><h2 id="1-事务">1. 事务</h2><p>**事务（Transaction）**是用来维护数据库完整性的，它能够保证一系列的MySQL操作要么全部执行，要么全不执行。</p><p>eg1.<br>转账操作：A账户要转账给B账户，那么A账户上减少的钱数和B账户上增加的钱数必须一致，也就是说A账户的转出操作和B账户的转入操作要么全部执行，要么全不执行；如果其中一个操作出现异常而没有执行的话，就会导致账户A和账户B的转入转出金额不一致的情况，为而事实上这种情况是不允许发生的，所以为了防止这种情况的发生，需要使用事务处理。<br>eg2.<br>在淘宝购物下订单的时候，商家库存要减少，订单增加记录，付款我的账号少100元…操作要么全部执行，要么全不执行</p><h4 id="概念">概念</h4><p>事务（Transaction）指的是一个操作序列，该操作序列中的多个操作要么都做，要么都不做，是一个不可分割的工作单位，是数据库环境中的逻辑工作单位，由DBMS（数据库管理系统）中的事务管理子系统负责事务的处理。<br>目前常用的存储引擎有InnoDB（MySQL5.5以后默认的存储引擎）和MyISAM（MySQL5.5之前默认的存储引擎），其中InnoDB支持事务处理机制，而MyISAM不支持。</p><h4 id="特性">特性</h4><img src="MySQL/20210703110321.png" alt="image-20210703110320474" style="zoom: 50%;" /><p>事务处理可以确保除非事务性序列内的所有操作都成功完成，否则不会永久更新面向数据的资源。通过将一组相关操作组合为一个要么全部成功要么全部失败的序列，可以简化错误恢复并使应用程序更加可靠。<br>但并不是所有的操作序列都可以称为事务，这是因为一个操作序列要成为事务，必须满足事务的原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）和持久性（Durability）。这四个特性简称为<strong>ACID特性。</strong></p><ol><li><strong>原子性</strong><br>原子是自然界最小的颗粒，具有不可再分的特性。事务中的所有操作可以看做一个原子，事务是应用中不可再分的最小的逻辑执行体。<br>使用事务对数据进行修改的操作序列，要么全部执行，要么全不执行。通常，某个事务中的操作都具有共同的目标，并且是相互依赖的。如果数据库系统只执行这些操作中的一部分，则可能会破坏事务的总体目标，而原子性消除了系统只处理部分操作的可能性。</li><li><strong>一致性</strong><br>一致性是指事务执行的结果必须使数据库从一个一致性状态，变到另一个一致性状态。当数据库中只包含事务成功提交的结果时，数据库处于一致性状态。一致性是通过原子性来保证的。<br>例如：在转账时，只有保证转出和转入的金额一致才能构成事务。也就是说事务发生前和发生后，数据的总额依然匹配。</li><li><strong>隔离性</strong><br>隔离性是指各个事务的执行互不干扰，任意一个事务的内部操作对其他并发的事务，都是隔离的。也就是说：并发执行的事务之间既不能看到对方的中间状态，也不能相互影响。<br>例如：在转账时，只有当A账户中的转出和B账户中转入操作都执行成功后才能看到A账户中的金额减少以及B账户中的金额增多。并且其他的事务对于转账操作的事务是不能产生任何影响的。</li><li><strong>持久性</strong><br>持久性指事务一旦提交，对数据所做的任何改变，都要记录到永久存储器中，通常是保存进物理数据库，即使数据库出现故障，提交的数据也应该能够恢复。但如果是由于外部原因导致的数据库故障，如硬盘被损坏，那么之前提交的数据则有可能会丢失。</li></ol><h5 id="实例：使用事务保证转账安全">实例：使用事务保证转账安全</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-- 创建账户表：id\uname\balance</span><br><span class="line">create table account(</span><br><span class="line">        id int primary key auto_increment,</span><br><span class="line">        uname varchar(10) not null,</span><br><span class="line">        balance double</span><br><span class="line">);</span><br><span class="line">-- 查看账户表：</span><br><span class="line">select * from account;</span><br><span class="line">-- 在表中插入数据：</span><br><span class="line">insert into account values (null,&#x27;丽丽&#x27;,2000),(null,&#x27;小刚&#x27;,2000);</span><br><span class="line">-- 丽丽给小刚 转200元：</span><br><span class="line">update account set balance = balance - 200 where id = 1;</span><br><span class="line">update account set balance = balance + 200 where id = 2;</span><br><span class="line">-- 默认一个DML语句是一个事务，所以上面的操作执行了2个事务。</span><br><span class="line">update account set balance = balance - 200 where id = 1;</span><br><span class="line">update account set balance = balance2 + 200 where id = 2;</span><br></pre></td></tr></table></figure><p><strong>必须让上面的两个操作控制在一个事务中</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 手动开启事务：</span><br><span class="line">start transaction;</span><br><span class="line">-- 操作：</span><br><span class="line">update account set balance = balance - 200 where id = 1;</span><br><span class="line">update account set balance = balance + 200 where id = 2;</span><br><span class="line">-- 手动回滚：刚才执行的操作全部取消：</span><br><span class="line">rollback;</span><br><span class="line">-- 手动提交：</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure><p>在<strong>回滚和提交</strong>之前，数据库中的数据都是操作的缓存中的数据，而不是数据库的真实数据</p><h3 id="事务并发问题">事务并发问题</h3><h5 id="脏读（Dirty-read）">脏读（Dirty read）</h5><p>当一个事务正在访问数据并且对数据进行了修改，而这种修改还没有提交到数据库中，这时另外一个事务也访问了这个数据，然后使用了这个数据。因为这个数据是还没有提交的数据，那么另外一个事务读到的这个数据是“脏数据”，依据“脏数据”所做的操作可能是不正确的。</p><img src="MySQL/20210703111005.png" alt="image-20210703111005503" style="zoom:67%;" /><h5 id="不可重复读-（Unrepeatableread）">不可重复读 （Unrepeatableread）</h5><p>指在一个事务内多次读同一数据。在这个事务还没有结束时，另一个事务也访问该数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改导致第一个事务两次读取的数据可能不太一样。这就发生了在一个事务内两次读到的数据是不一样的情况，因此称为不可重复读。</p><img src="MySQL/20210703111018.png" alt="image-20210703111018492" style="zoom:67%;" /><h5 id="幻读-（Phantom-read）">幻读 （Phantom read）</h5><p>幻读与不可重复读类似。它发生在一个事务（T1）读取了几行数据，接着另一个并发事务（T2）插入了一些数据时。在随后的查询中，第一个事务（T1）就会发现多了一些原本不存在的记录，就好像发生了幻觉一样，所以称为幻读。</p> <img src="MySQL/20210703111036.png" alt="image-20210703111036154" style="zoom:67%;" /><p><strong>不可重复度和幻读区别：</strong></p><p>不可重复读的重点是修改，幻读的重点在于新增或者删除。解决不可重复读的问题只需锁住满足条件的行，解决幻读需要锁表 。</p><p>例1（同样的条件, 你读取过的数据, 再次读取出来发现值不一样了 ）：事务1中的A先生读取自己的工资为 1000的操作还没完成，事务2中的B先生就修改了A的工资为2000，导 致A再读自己的工资时工资变为 2000；这就是不可重复读。</p><p>例2（同样的条件, 第1次和第2次读出来的记录数不一样 ）：假某工资单表中工资大于3000的有4人，事务1读取了所有工资大于3000的人，共查到4条记录，这时事务2 又插入了一条工资大于3000的记录，事务1再次读取时查到的记录就变为了5条，这样就导致了幻读</p><h3 id="事务隔离级别">事务隔离级别</h3><p>​事务的隔离级别用于决定如何控制并发用户读写数据的操作。数据库是允许多用户并发访问的，如果多个用户同时开启事务并对同一数据进行读写操作的话，有可能会出现脏读、不可重复读和幻读问题，所以MySQL中提供了四种隔离级别来解决上述问题。</p><p>​从低到高依次为<strong>READ UNCOMMITTED、READ COMMITTED、REPEATABLE READ以及SERIALIZABLE</strong>，隔离级别越低，越能支持高并发的数据库操作。</p><img src="MySQL/20210703142738.png" alt="image-20210703142738514" style="zoom:67%;" />                        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 查看默认的事务隔离级别  MySQL默认的是repeatable read  </span><br><span class="line">select @@transaction_isolation;  </span><br><span class="line">-- 设置事务的隔离级别   （设置当前会话的隔离级别）</span><br><span class="line">set session transaction isolation level read uncommitted;  </span><br><span class="line">set session transaction isolation level read committed;  </span><br><span class="line">set session transaction isolation level repeatable read;  -- 默认的</span><br><span class="line">set session transaction isolation level serializable;  </span><br><span class="line">start transaction ;</span><br><span class="line">select * from account where id = 1;</span><br></pre></td></tr></table></figure><h5 id="实例-2">实例</h5><p>（必须是两个事务都开始以后执行的操作才会影响）</p><ul><li><p>在read uncommitted的情况下，开始两个事务：</p><ul><li>事务一</li></ul><img src="MySQL/20210703152258.png" alt="image-20210703145526739" style="zoom:67%;" /><ul><li>事务二</li></ul><p><img src="MySQL/20210703152314.png" alt="image-20210703145443742"></p></li><li><p>事务一查询操作：</p><img src="MySQL/20210703152514.png" alt="image-20210703152514123" style="zoom:67%;" /></li><li><p>事务二更新操作，且没提交</p><img src="MySQL/20210703152552.png" alt="image-20210703152552191" style="zoom:67%;" /></li><li><p>事务一再次查询：</p><img src="MySQL/20210703152939.png" alt="image-20210703152939898" style="zoom:67%;" /><p>读到了在脏数据</p></li><li><p>如果设置为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set session transaction isolation level read committed;</span><br></pre></td></tr></table></figure><p>事务二就不会读到脏数据。</p></li></ul><h2 id="2-视图">2. 视图</h2><h4 id="概念-2">概念</h4><p>视图（view）是一个从单张或多张基础数据表或其他视图中构建出来的虚拟表。同基础表一样，视图中也包含了一系列带有名称的列和行数据，但是数据库中只是存放视图的定义，也就是动态检索数据的查询语句，而并不存放视图中的数据，这些数据依旧存放于构建视图的基础表中，只有当用户使用视图是才去数据库请求相对应的数据，即视图中的数据是在引用视图时动态生成的。因此视图中的数据发生了变化，视图中相应的数据也会跟着改变。</p><p>PS：视图本质上就是：一个查询语句，是一个虚拟的表，不存在的表，你查看视图，其实就是查看视图对应的sql语句。</p><h4 id="优点">优点</h4><p>简化用户操作：视图可以使用户将注意力集中在所关心地数据上，而不需要关心数据表的结构、与其他表的关联条件以及查询条件等。</p><p>对机密数据提供安全保护：有了视图，就可以在设计数据库应用系统时，对不同的用户定义不同的视图，避免机密数据（如，敏感字段“salary”）出现在不应该看到这些数据的用户视图上。这样视图就自动提供了对机密数据的安全保护功能</p><h4 id="实例一：单表视图">实例一：单表视图</h4><ul><li><p>创建/替换单表视图：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 创建/替换单表视图：</span><br><span class="line">create or replace view myview01</span><br><span class="line">as</span><br><span class="line">select empno,ename,job,deptno </span><br><span class="line">from emp</span><br><span class="line">where deptno = 20</span><br></pre></td></tr></table></figure></li><li><p>查看视图：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 查看视图：</span><br><span class="line">select * from myview01;</span><br></pre></td></tr></table></figure></li><li><p>向视图中插入满足条件的数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 在视图中插入数据：</span><br><span class="line">insert into myview01 (empno,ename,job,deptno) values (9999,&#x27;lili&#x27;,&#x27;CLERK&#x27;,20);</span><br></pre></td></tr></table></figure><p>查看视图：</p><img src="MySQL/20210703161609.png" alt="image-20210703161609044" style="zoom:67%;" /></li><li><p>向视图中插入不满足条件的数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into myview01 (empno,ename,job,deptno) values (8888,&#x27;nana&#x27;,&#x27;CLERK&#x27;,30);</span><br></pre></td></tr></table></figure><p>查看原来的表，发现成功插进去了</p><img src="MySQL/20210703161731.png" alt="image-20210703161731377" style="zoom:67%;" /></li><li><p>解决上面问题：</p><p>需要加上<strong>check option</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- 创建/替换单表视图：</span><br><span class="line">create or replace view myview01</span><br><span class="line">as</span><br><span class="line">select empno,ename,job,deptno </span><br><span class="line">from emp</span><br><span class="line">where deptno = 20</span><br><span class="line">with check option;</span><br></pre></td></tr></table></figure><p>这样不满足条件的数据就不会轻易被加进去：</p><img src="MySQL/20210703162005.png" alt="image-20210703162005163" style="zoom:67%;" /></li></ul><h4 id="实例二：多表视图">实例二：多表视图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 创建/替换多表视图：</span><br><span class="line">create or replace view myview02</span><br><span class="line">as </span><br><span class="line">select e.empno,e.ename,e.sal,d.deptno,d.dname</span><br><span class="line">from emp e</span><br><span class="line">join dept d</span><br><span class="line">on e.deptno = d.deptno</span><br><span class="line">where sal &gt; 2000 ;</span><br><span class="line">select * from myview02;</span><br></pre></td></tr></table></figure><h4 id="实例三：统计视图">实例三：统计视图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 创建统计视图：</span><br><span class="line">create or replace view myview03</span><br><span class="line">as</span><br><span class="line">select e.deptno,d.dname,avg(sal),min(sal),count(1)</span><br><span class="line">from emp e</span><br><span class="line">join dept d</span><br><span class="line">using(deptno)</span><br><span class="line">group by e.deptno ;</span><br><span class="line">select * from myview03;</span><br></pre></td></tr></table></figure><h4 id="实例四：基于视图的视图">实例四：基于视图的视图</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 创建基于视图的视图：</span><br><span class="line">create or replace view myview04</span><br><span class="line">as</span><br><span class="line">select * from myview03 where deptno = 20;</span><br><span class="line">select * from myview04;</span><br></pre></td></tr></table></figure><h2 id="3-存储过程">3. 存储过程</h2><h4 id="概念-3">概念</h4><ul><li><p>通过前面章节的学习，我们已经知道SQL是一种非常便利的语言。从数据库抽取数据，或者对特定的数据集中更新时，都能通过简洁直观的代码实现。</p></li><li><p>但是这个所谓的“简洁”也是有限制，SQL基本是一个命令实现一个处理，是所谓的非程序语言。</p></li><li><p>在不能编写流程的情况下，所有的处理只能通过一个个命令来实现。当然，通过使用连接及子查询，即使使用SQL的单一命令也能实现一些高级的处理，但是，其局限性是显而易见的。例如，在SQL中就很难实现针对不同条件进行不同的处理以及循环等功能。</p></li><li><p>这个时候就出现了存储过程这个概念，简单地说，存储过程就是数据库中保存(Stored)的一系列SQL命令（Procedure）的集合。也可以将其看作相互之间有关系的SQL命令组织在一起形成的一个小程序。</p></li></ul><h4 id="优点-2">优点</h4><ul><li>提高执行性能。存储过程执行效率之所高，在于普通的SQL语句，每次都会对语法分析，编译，执行，而存储过程只是在第一次执行语法分析，编译，执行，以后都是对结果进行调用。</li><li>可减轻网络负担。使用存储过程，复杂的数据库操作也可以在数据库服务器中完成。只需要从客户端(或应用程序)传递给数据库必要的参数就行，比起需要多次传递SQL命令本身，这大大减轻了网络负担。</li><li>可将数据库的处理黑匣子化。应用程序中完全不用考虑存储过程的内部详细处理，只需要知道调用哪个存储过程就可以了</li></ul><h4 id="实例-3">实例</h4><ul><li><p>定义一个没有返回值的存储过程</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-- 定义一个没有返回值 存储过程</span><br><span class="line">-- 实现：模糊查询操作：</span><br><span class="line">select * from emp where ename like &#x27;%A%&#x27;;</span><br><span class="line">create procedure mypro01(name varchar(10))</span><br><span class="line">begin</span><br><span class="line">        if name is null or name = &quot;&quot; then</span><br><span class="line">                select * from emp; -- 传入null，就查看全表</span><br><span class="line">        else</span><br><span class="line">    select * from emp where ename like concat(&#x27;%&#x27;,name,&#x27;%&#x27;); </span><br><span class="line">        end if;</span><br><span class="line">end;</span><br><span class="line">-- 删除存储过程：</span><br><span class="line">drop procedure mypro01;</span><br><span class="line">-- 调用存储过程：</span><br><span class="line">call mypro01(null);</span><br><span class="line">call mypro01(&#x27;R&#x27;);</span><br></pre></td></tr></table></figure><p>结果：</p><img src="MySQL/20210703171452.png" alt="image-20210703171452630" style="zoom: 50%;" /></li><li><p>定义一个有返回值的存储过程</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-- 定义一个有返回值的存储过程</span><br><span class="line">-- in 参数前面的in可以不写</span><br><span class="line">-- out </span><br><span class="line">-- found_rows() 是mysql定义的一个函数，作用返回查询结果的条数</span><br><span class="line">-- into </span><br><span class="line">create procedure mypro02 (in name varchar(10),out num int(4))</span><br><span class="line">begin </span><br><span class="line">if name is null or name = &quot;&quot; then</span><br><span class="line">select * from emp;</span><br><span class="line">else </span><br><span class="line">select * from emp where name like concat(&#x27;%&#x27;,name,&#x27;%&#x27;);</span><br><span class="line">end if;</span><br><span class="line">select found_rows() into num;</span><br><span class="line">end;</span><br><span class="line">-- 调用存储过程</span><br><span class="line">call mypro02(null,@num);</span><br><span class="line">select @num;</span><br><span class="line">call mypro02(&#x27;A&#x27;,@aaa); -- 传入的参数名不一定要一样</span><br><span class="line">select @aaa;</span><br></pre></td></tr></table></figure><p>结果：</p><img src="MySQL/20210703191518.png" alt="image-20210703191518417" style="zoom:67%;" /></li></ul>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DataBase </tag>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>